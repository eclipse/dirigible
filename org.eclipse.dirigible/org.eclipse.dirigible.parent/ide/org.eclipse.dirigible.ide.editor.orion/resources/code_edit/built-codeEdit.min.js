/*

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
 RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/text for details

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).


 Copyright (c) 2012, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2014 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2011, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013,2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation
  Mihai Sucan (Mozilla Foundation) - fix for Bug#334583 Bug#348471 Bug#349485 Bug#350595 Bug#360726 Bug#361180 Bug#362835 Bug#362428 Bug#362286 Bug#354270 Bug#361474 Bug#363945 Bug#366312 Bug#370584

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2009, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others. All rights reserved.
 This program and the accompanying materials are made available under the
 terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: 
 IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others. All rights reserved.
 This program and the accompanying materials are made available under the
 terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: 
 IBM Corporation - initial API and implementation
 Adrian Aichner - regular expression capture group support in replace

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation
     Andy Clement (vmware) - bug 344614

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: Anton McConville - IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2011,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2014 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation
               Alex Lakatos - fix for bug#369781

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 Pivotal Software Inc. and others
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: Pivotal Software Inc. - initial API and implementation 

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation
 RequireJS i18n 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
*/
(function(O,y){"function"===typeof define&&define.amd?define([],y):(O.orion=O.orion||{},O.orion.codeEdit=y())})(this,function(){var O,y;(function(l){function r(a,e){var u,t,n,g,q,w,x,b,s,v=e&&e.split("/"),d=c.map,m=d&&d["*"]||{};if(a&&"."===a.charAt(0))if(e){v=v.slice(0,v.length-1);a=v.concat(a.split("/"));for(b=0;b<a.length;b+=1)if(u=a[b],"."===u)a.splice(b,1),b-=1;else if(".."===u)if(1===b&&(".."===a[2]||".."===a[0]))break;else 0<b&&(a.splice(b-1,2),b-=2);a=a.join("/")}else 0===a.indexOf("./")&&
(a=a.substring(2));if((v||m)&&d){u=a.split("/");for(b=u.length;0<b;b-=1){t=u.slice(0,b).join("/");if(v)for(s=v.length;0<s;s-=1)if(n=d[v.slice(0,s).join("/")])if(n=n[t]){g=n;q=b;break}if(g)break;!w&&(m&&m[t])&&(w=m[t],x=b)}!g&&w&&(g=w,q=x);g&&(u.splice(0,q,g),a=u.join("/"))}return a}function p(c,a){return function(){return g.apply(l,v.call(arguments,0).concat([c,a]))}}function h(c){return function(a){return r(a,c)}}function f(c){return function(a){e[c]=a}}function d(c){if(t.call(n,c)){var a=n[c];delete n[c];
u[c]=!0;m.apply(l,a)}if(!t.call(e,c)&&!t.call(u,c))throw Error("No "+c);return e[c]}function b(c){var a,e=c?c.indexOf("!"):-1;-1<e&&(a=c.substring(0,e),c=c.substring(e+1,c.length));return[a,c]}function k(a){return function(){return c&&c.config&&c.config[a]||{}}}var m,g,a,s,e={},n={},c={},u={},t=Object.prototype.hasOwnProperty,v=[].slice;a=function(c,a){var e,u=b(c),t=u[0];c=u[1];t&&(t=r(t,a),e=d(t));t?c=e&&e.normalize?e.normalize(c,h(a)):r(c,a):(c=r(c,a),u=b(c),t=u[0],c=u[1],t&&(e=d(t)));return{f:t?
t+"!"+c:c,n:c,pr:t,p:e}};s={require:function(c){return p(c)},exports:function(c){var a=e[c];return"undefined"!==typeof a?a:e[c]={}},module:function(c){return{id:c,uri:"",exports:e[c],config:k(c)}}};m=function(c,b,g,v){var m,k,q,w,x=[],F;v=v||c;if("function"===typeof g){b=!b.length&&g.length?["require","exports","module"]:b;for(w=0;w<b.length;w+=1)if(q=a(b[w],v),k=q.f,"require"===k)x[w]=s.require(c);else if("exports"===k)x[w]=s.exports(c),F=!0;else if("module"===k)m=x[w]=s.module(c);else if(t.call(e,
k)||t.call(n,k)||t.call(u,k))x[w]=d(k);else if(q.p)q.p.load(q.n,p(v,!0),f(k),{}),x[w]=e[k];else throw Error(c+" missing "+k);b=g.apply(e[c],x);if(c)if(m&&m.exports!==l&&m.exports!==e[c])e[c]=m.exports;else if(b!==l||!F)e[c]=b}else c&&(e[c]=g)};O=g=function(e,u,t,b,n){if("string"===typeof e)return s[e]?s[e](u):d(a(e,u).f);e.splice||(c=e,u.splice?(e=u,u=t,t=null):e=l);u=u||function(){};"function"===typeof t&&(t=b,b=n);b?m(l,e,u,t):setTimeout(function(){m(l,e,u,t)},4);return g};g.config=function(a){c=
a;return g};y=function(c,a,u){a.splice||(u=a,a=[]);!t.call(e,c)&&!t.call(n,c)&&(n[c]=[c,a,u])};y.amd={jQuery:!0}})();y("almond",function(){});(function(l,r){"function"===typeof y&&y.amd?y("orion/Deferred",r):"object"===typeof exports?module.exports=r():(l.orion=l.orion||{},l.orion.Deferred=r())})(this,function(){function l(){for(var b;b=f.shift();)b();d=!1}function r(k){f.push(k);d||(d=!0,b())}function p(b){return function(d){b(d)}}function h(){function b(){for(var c;c=n.shift();){var a=c.deferred,
g="fulfilled"===e?"resolve":"reject";c=c[g];if("function"===typeof c)try{var d=c(s),m=d&&("object"===typeof d||"function"===typeof d)&&d.then;if("function"===typeof m)if(d===a.promise)a.reject(new TypeError);else{var k=d.cancel;"function"===typeof k?a._parentCancel=k.bind(d):delete a._parentCancel;m.call(d,p(a.resolve),p(a.reject),p(a.progress))}else a.resolve(d)}catch(f){a.reject(f)}else a[g](s)}}function d(a){delete c._parentCancel;e="rejected";s=a;n.length&&r(b)}function g(a){function t(c){return function(a){(!e||
"assumed"===e)&&c(a)}}delete c._parentCancel;try{var v=a&&("object"===typeof a||"function"===typeof a)&&a.then;if("function"===typeof v)if(a===c)d(new TypeError);else{e="assumed";var f=a&&a.cancel;if("function"!==typeof f){var E=new h;a=E.promise;try{v(E.resolve,E.reject,E.progress)}catch(z){E.reject(z)}f=a.cancel;v=a.then}s=a;v.call(a,t(g),t(d));c._parentCancel=f.bind(a)}else e="fulfilled",s=a,n.length&&r(b)}catch(l){t(d)(l)}}function a(){var a=c._parentCancel;a?(delete c._parentCancel,a()):e||(a=
Error("Cancel"),a.name="Cancel",d(a))}var s,e,n=[],c=this;this.resolve=function(a){e||g(a);return c};this.reject=function(a){e||d(a);return c};this.progress=function(a){e||n.forEach(function(c){if(c.progress)try{c.progress(a)}catch(e){}});return c.promise};this.cancel=function(){c._parentCancel?setTimeout(a,0):a();return c};this.then=function(a,t,g){var s=new h;s._parentCancel=c.promise.cancel;n.push({resolve:a,reject:t,progress:g,deferred:s});("fulfilled"===e||"rejected"===e)&&r(b);return s.promise};
this.promise={then:c.then,cancel:c.cancel}}var f=[],d=!1,b=function(){if("undefined"!==typeof process&&"function"===typeof process.nextTick){var b=process.nextTick;return function(){b(l)}}if("function"===typeof MutationObserver){var d=document.createElement("div");(new MutationObserver(l)).observe(d,{attributes:!0});return function(){d.setAttribute("class","_tick")}}return function(){setTimeout(l,0)}}();h.all=function(b,d){function g(a,b){n||(e[a]=b,0===--s&&c.resolve(e))}function a(a,e){if(!n){if(d)try{g(a,
d(e));return}catch(b){e=b}c.reject(e)}}var s=b.length,e=[],n=!1,c=new h;c.then(void 0,function(){n=!0;b.forEach(function(c){c.cancel&&c.cancel()})});0===s?c.resolve(e):b.forEach(function(c,e){c.then(g.bind(void 0,e),a.bind(void 0,e))});return c.promise};h.when=function(b,d,g,a){var s;b&&"function"===typeof b.then||(s=new h,s.resolve(b),b=s.promise);return b.then(d,g,a)};return h});(function(l){function r(){Error.apply(this,arguments)}function p(f,d){var b=f||"utf-8";if("utf-8"!==b&&"utf8"!==b&&"unicode-1-1-utf-8"!==
b)throw new TypeError("only utf-8 supported");Object.defineProperties(this,{encoding:{value:b,enumerable:!0},_fatal:{value:d&&d.fatal},_saved:{value:[],writable:!0},_checkBOM:{value:!0,writable:!0}})}function h(f){f=f||"utf-8";if("utf-8"!==f&&"utf8"!==f&&"unicode-1-1-utf-8"!==f)throw new TypeError("only utf-8 supported");Object.defineProperties(this,{encoding:{value:f,enumerable:!0},_saved:{value:null,writable:!0}})}r.prototype=Error();r.prototype.constructor=r;r.prototype.name="EncodingError";p.prototype.decode=
function(f,d){function b(){if(this._fatal)throw this._saved.length=e=0,u=c,this._checkBOM=this._checkBOM||!s,new r;t[v++]=65533}f=f instanceof Uint8Array?f:new Uint8Array(f);var k,m,g,a,s=d&&d.stream,e=this._saved.length,n=f.length,c=0,u=0,t=new Uint16Array(n+e),v=0;if(this._checkBOM&&n)if(2<e+n){for(k=e;3>k;k++)this._saved.push(f[c++]);239!==this._saved[0]||187!==this._saved[1]||191!==this._saved[2]?(c=0,this._saved.length=e):e=this._saved.length-=3;this._checkBOM=!1}else if(s)for(;c<n;)this._saved.push(f[c++]);
for(;c<n;){k=0<e?this._saved[0]:f[c++];if(128>k)t[v++]=k;else if(194<=k&&223>=k){if(c===n)break;m=1<e?this._saved[1]:f[c++];if(!(128<=m&&191>=m)){b();continue}t[v++]=(k&31)<<6|m&63}else if(224<=k&&239>=k){if(c===n)break;m=1<e?this._saved[1]:f[c++];if(224===k&&!(160<=m&&191>=m)||237===k&&!(128<=m&&159>=m)||!(128<=m&&191>=m)){b();continue}if(c===n)break;g=2<e?this._saved[2]:f[c++];if(!(128<=g&&191>=g)){b();continue}t[v++]=(k&15)<<12|(m&63)<<6|g&63}else if(240<=k&&244>=k){if(c===n)break;m=1<e?this._saved[1]:
f[c++];if(240===k&&!(144<=m&&191>=m)||244===k&&!(128<=m&&143>=m)||!(128<=m&&191>=m)){b();continue}if(c===n)break;g=2<e?this._saved[2]:f[c++];if(!(128<=g&&191>=g)){b();continue}if(c===n)break;a=f[c++];if(!(128<=a&&191>=a)){b();continue}k=((k&7)<<18|(m&63)<<12|(g&63)<<6|a&63)&65535;t[v++]=k>>10|55296;t[v++]=k&1023|56320}else b();u=c;e&&(this._saved.length=e=0)}for(;u!==c;)this._saved.push(f[u++]);this._checkBOM=this._checkBOM||!s;if(!s&&0!==this._saved.length)throw new r;n=[];for(k=0;k<v;k+=65536)n.push(String.fromCharCode.apply(null,
t.subarray(k,Math.min(v,k+65536))));return n.join("")};h.prototype.encode=function(f,d){f=String(void 0!==f?f:"");for(var b,k,m=d&&d.stream,g=f.length,a=0,s=new Uint8Array(3*(g+(null===this._saved?0:1))),e=0;a<g;)if(null===this._saved?b=f.charCodeAt(a++):(b=this._saved,this._saved=null),128>b)s[e++]=b;else{if(2048>b)s[e++]=192|b>>6;else{if(55296>b||56319<b)s[e++]=224|b>>12;else{if(a<g)k=f.charCodeAt(a++);else if(m){this._saved=b;break}else throw new r;if(!(56320<=k&&57343>=k))throw new r;b=65536|
(b&1023)<<10|k&1023;s[e++]=240|b>>18;s[e++]=128|b>>12&63}s[e++]=128|b>>6&63}s[e++]=128|b&63}if(!m&&null!==this._saved)throw new r;return s.buffer.slice?new Uint8Array(s.buffer.slice(0,e)):s.subarray(0,e)};l.TextDecoder=l.TextDecoder||p;l.TextEncoder=l.TextEncoder||h})("undefined"===typeof global?this||self:global);y("orion/encoding-shim",function(){});(function(){function l(q){if("string"!==typeof q)throw new TypeError;}function r(q){return q?q.split("\x26"):[]}function p(q){return 0===q.length?"":
q.join("\x26")}function h(q){var c=/([^=]*)(?:=?)(.*)/.exec(q);q=c[1]?decodeURIComponent(c[1]):"";c=c[2]?decodeURIComponent(c[2]):"";return[q,c]}function f(q){var c=encodeURIComponent(q[0]);q[1]&&(c+="\x3d"+encodeURIComponent(q[1]));return c}function d(c,a){var e="",u=[],w=0;return{next:function(){e!==c.query&&(e=c.query,u=r(e));if(w<u.length){var b=h(u[w++]);switch(a){case "keys":return b[0];case "values":return b[1];case "keys+values":return[b[0],b[1]];default:throw new TypeError;}}throw q;}}}function b(q){Object.defineProperty(this,
"_url",{get:function(){return q._url}})}function k(q){return q?/[1-9]\d*$/.exec(q)[0]:""}function m(q){var c=[];q.split("/").forEach(function(q){".."===q?c.pop():"."!==q&&c.push(q)});return c.join("/")}function g(q){return q.replace(/\s/g,function(q){return"%"+q.charCodeAt(0).toString(16)})}function a(q,a){if("string"!==typeof q)throw new TypeError;q=g(q);var e=c.exec(q);if(!e)return null;var w={};w.scheme=e[1]||"";if(w.scheme&&!t.test(w.scheme))return null;var b=e[2];if(b&&(b=u.exec(b),w.userinfo=
b[1],w.host=b[2],w.port=b[3],w.port&&!v.test(w.port)))return null;w.path=e[3];w.query=e[4];w.fragment=e[5];!w.scheme&&a&&(w.scheme=a.scheme,!w.host&&a.host&&(w.userinfo=a.userinfo,w.host=a.host,w.port=a.port,w.pathRelative=!0));w.pathRelative&&(w.path?"/"!==w.path[0]&&(e=/^(.*\/)[^\/]*$/.exec(a.path)[1]||"/",w.path=e+w.path):w.path=a.path);w.scheme&&(w.scheme=w.scheme.toLowerCase());w.port&&(w.port=k(w.port));w.host&&w.path&&(w.path=m(w.path));return w}function s(q,c){var e;if(c){c=c.href||c;e=a(c);
if(!e||!e.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:e})}e=a(q,e);if(!e)throw new SyntaxError;Object.defineProperty(this,"_input",{value:q,writable:!0});Object.defineProperty(this,"_url",{value:e,writable:!0});var w=new b(this);Object.defineProperty(this,"query",{get:function(){return this._url?w:null},enumerable:!0})}try{var e;if("function"===typeof self.URL&&0!==self.URL.length&&"http:"===(e=new self.URL("http://www.w3.org?q")).protocol&&e.query)return}catch(n){}var c=
/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,u=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,t=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,v=/^\d*$/,A=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,E=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,z=/^([^?#\s]*)$/,D=/^([^\s]*)$/,B=/^\S*$/,C=/([^:]*):?(.*)/,q="undefined"!==typeof StopIteration?StopIteration:Error("Stop Iteration"),w={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(b.prototype,
{get:{value:function(q){l(q);var c;r(this._url.query).some(function(a){a=h(a);if(a[0]===q)return c=a[1],!0});return c},enumerable:!0},set:{value:function(q,c){l(q);l(c);var a=r(this._url.query);a.some(function(e,w){var u=h(e);if(u[0]===q)return u[1]=c,a[w]=f(u),!0})||a.push(f([q,c]));this._url.query=p(a)},enumerable:!0},has:{value:function(q){l(q);return r(this._url.query).some(function(c){if(h(c)[0]===q)return!0})},enumerable:!0},"delete":{value:function(q){l(q);var c=r(this._url.query),a=c.filter(function(c){return h(c)[0]!==
q});return a.length!==c.length?(this._url.query=p(a),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(c,a){if("function"!==typeof c)throw new TypeError;var e=d(this._url,"keys+values");try{for(;;){var w=e.next();c.call(a,w[1],w[0],this)}}catch(u){if(u!==q)throw u;}},enumerable:!0},keys:{value:function(){return d(this._url,"keys")},enumerable:!0},values:{value:function(){return d(this._url,"values")},enumerable:!0},items:{value:function(){return d(this._url,
"keys+values")}},size:{get:function(){return r(this._url.query).length},enumerable:!0},getAll:{value:function(q){l(q);var c=[];r(this._url.query).forEach(function(a){a=h(a);a[0]===q&&c.push(a[1])});return c},enumerable:!0},append:{value:function(q,c){l(q);l(c);var a=r(this._url.query);a.push(f([q,c]));this._url.query=p(a)},enumerable:!0}});Object.defineProperties(s.prototype,{href:{get:function(){var q;if(this._url){q=this._url;var c=q.scheme?q.scheme+":":"";q.host&&(c+="//",q.userinfo&&(c+=q.userinfo+
"@"),c+=q.host,q.port&&(c+=":"+q.port));c+=q.path;q.query&&(c+="?"+q.query);q.fragment&&(c+="#"+q.fragment);q=c}else q=this._input;return q},set:function(q){l(q);this._input=q;this._url=a(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(q){l(q);if(this._url&&(q=":"===q.slice(-1)?q.substring(0,q.length-1):q,""===q||t.test(q)))this._url.scheme=
q.toLowerCase()},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(q){l(q);this._url&&(this._url.userinfo=q)}},username:{get:function(){if(!this._url)return"";var q=C.exec(this._userinfo);return decodeURIComponent(q[1]||"")},set:function(q){l(q);if(this._url){var c=C.exec(this._userinfo);q=[encodeURIComponent(q||"")];c[2]&&q.push(c[2]);this._userinfo=q.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var q=C.exec(this._userinfo);
return decodeURIComponent(q[2]||"")},set:function(q){l(q);if(this._url){var c=[C.exec(this._userinfo)[1]||""];q&&c.push(encodeURIComponent(q));this._userinfo=c.join(":")}},enumerable:!0},host:{get:function(){var q="";this._url&&this._url.host&&(q+=this._url.host,this._url.port&&(q+=":"+this._url.port));return q},set:function(q){l(q);if(this._url&&(q=E.exec(q)))this._url.host=q[1],this._url.port=k(q[2])},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(q){l(q);
this._url&&A.exec(q)&&(this._url.host=q)},enumerable:!0},port:{get:function(){var q=this._url?this._url.port||"":"";q&&q===w[this.protocol]&&(q="");return q},set:function(q){l(q);this._url&&v.exec(q)&&(this._url.port=k(q))},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(q){l(q);this._url&&z.exec(q)&&(this._url.host&&(q&&"/"!==q[0])&&(q="/"+q),this._url.path=q?m(q):"")},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:
""},set:function(q){l(q);this._url&&(q&&"?"===q[0]&&(q=q.substring(1)),D.exec(q)&&(this._url.query=q))},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(q){l(q);this._url&&(q&&"#"===q[0]&&(q=q.substring(1)),B.exec(q)&&(this._url.fragment=q))},enumerable:!0}});if((e=self.URL||self.webkitURL)&&e.createObjectURL)Object.defineProperty(s,"createObjectURL",{value:e.createObjectURL.bind(e),enumerable:!1}),Object.defineProperty(s,"revokeObjectURL",
{value:e.revokeObjectURL.bind(e),enumerable:!1});self.URL=s})();y("orion/URL-shim",function(){});y("embeddedEditor/helper/embeddedFileImpl",["orion/Deferred","orion/encoding-shim","orion/URL-shim"],function(l){function r(l){this.fileBase=l;this.fileRoot={}}r.prototype={fetchChildren:function(){return(new l).resolve([])},loadWorkspaces:function(){return(new l).resolve([])},loadWorkspace:function(){return(new l).resolve([])},createProject:function(){throw Error("Not supported");},createFolder:function(){throw Error("Not supported");
},createFile:function(){throw Error("Not supported");},moveFile:function(){throw Error("Not supported");},copyFile:function(){throw Error("Not supported");},remoteImport:function(){throw Error("Not supported");},remoteExport:function(){throw Error("Not supported");},writeBlob:function(){throw Error("Not supported");},read:function(p,h){if(h){var f=new URL(p),f={Directory:!1,Length:123,LocaltimeStamp:123,Location:p,Name:f.pathname,Parents:[]};return(new l).resolve(f)}return(new l).resolve(this.fileRoot[p])},
write:function(p,h,f){"string"===typeof h&&(this.fileRoot[p]=h);return(new l).resolve(h)},deleteFile:function(p){this.fileRoot[p]=void 0;return(new l).resolve([])}};return r.prototype.constructor=r});y("orion/EventTarget",[],function(){function l(){this._namedListeners={}}l.prototype={dispatchEvent:function(l){if(!l.type)throw Error("unspecified type");var p=this._namedListeners[l.type];p&&p.forEach(function(h){try{"function"===typeof h?h(l):h.handleEvent(l)}catch(f){"undefined"!==typeof console&&
console.log(f)}});return!l.defaultPrevented},addEventListener:function(l,p){if("function"===typeof p||p.handleEvent)this._namedListeners[l]=this._namedListeners[l]||[],this._namedListeners[l].push(p)},removeEventListener:function(l,p){var h=this._namedListeners[l];if(h)for(var f=0;f<h.length;f++)if(h[f]===p){1===h.length?delete this._namedListeners[l]:h.splice(f,1);break}}};l.prototype.constructor=l;l.attach=function(r){var p=new l;r.dispatchEvent=p.dispatchEvent.bind(p);r.addEventListener=p.addEventListener.bind(p);
r.removeEventListener=p.removeEventListener.bind(p)};return l});y("orion/serviceregistry",["orion/Deferred","orion/EventTarget"],function(l,r){function p(b,d,g){this._properties=g||{};this._properties["service.id"]=b;this._properties.objectClass=d;this._properties["service.names"]=d}function h(b,d,g){this._serviceId=b;this._serviceReference=d;this._internalRegistry=g}function f(b,d){function g(a){return function(){var e;try{if(!d())throw Error("Service was unregistered");var g=b[a].apply(b,Array.prototype.slice.call(arguments));
if(g&&"function"===typeof g.then)return g;e=new l;e.resolve(g)}catch(c){e=new l,e.reject(c)}return e.promise}}for(var a in b)"function"===typeof b[a]&&(this[a]=g(a))}function d(b,d){this.type=b;this.serviceReference=d}function b(){this._entries=[];this._namedReferences={};this._serviceEventTarget=new r;var b=this;this._internalRegistry={isRegistered:function(d){return b._entries[d]?!0:!1},unregisterService:function(m){var g=b._entries[m];if(!g)throw Error("Service has already been unregistered: "+
m);var a=g.reference;b._serviceEventTarget.dispatchEvent(new d("unregistering",a));b._entries[m]=null;a.getProperty("objectClass").forEach(function(g){for(var e=b._namedReferences[g],n=0;n<e.length;n++)if(e[n]===a){1===e.length?delete b._namedReferences[g]:e.splice(n,1);break}})},modifyService:function(m){var g=b._entries[m];if(!g)throw Error("Service not found while trying to send modified event: "+m);b._serviceEventTarget.dispatchEvent(new d("modified",g.reference))}}}p.prototype={getPropertyKeys:function(){var b=
[],d;for(d in this._properties)this._properties.hasOwnProperty(d)&&b.push(d);return b},getProperty:function(b){return this._properties[b]}};p.prototype.constructor=p;h.prototype={unregister:function(){this._internalRegistry.unregisterService(this._serviceId)},getReference:function(){if(!this._internalRegistry.isRegistered(this._serviceId))throw Error("Service has already been unregistered: "+this._serviceId);return this._serviceReference},setProperties:function(b){var d=this._serviceReference._properties;
this._serviceReference._properties=b||{};b["service.id"]=this._serviceId;b.objectClass=d.objectClass;b["service.names"]=d["service.names"];this._internalRegistry.modifyService(this._serviceId)}};h.prototype.constructor=h;b.prototype={getService:function(b){var d;if("string"===typeof b)(b=this._namedReferences[b])&&b.some(function(b){d=this._entries[b.getProperty("service.id")].service;return!!d},this);else if(b=this._entries[b.getProperty("service.id")])d=b.service;return d||null},getServiceReferences:function(b){if(b)return this._namedReferences[b]?
this._namedReferences[b]:[];var d=[];this._entries.forEach(function(b){b&&d.push(b.reference)});return d},registerService:function(b,m,g){if("undefined"===typeof m||null===m)throw Error("invalid service");"string"===typeof b?b=[b]:Array.isArray(b)||(b=[]);var a=this._entries.length,s=new p(a,b,g),e=this._namedReferences;b.forEach(function(a){e[a]=e[a]||[];e[a].push(s)});b=new f(m,this._internalRegistry.isRegistered.bind(null,a));this._entries.push({reference:s,service:b});b=this._internalRegistry;
this._serviceEventTarget.dispatchEvent(new d("registered",s));return new h(a,s,b)},addEventListener:function(b,d){this._serviceEventTarget.addEventListener(b,d)},removeEventListener:function(b,d){this._serviceEventTarget.removeEventListener(b,d)}};b.prototype.constructor=b;return{ServiceRegistry:b}});y("orion/util",[],function(){var l=navigator.userAgent,r=-1!==l.indexOf("MSIE")||-1!==l.indexOf("Trident")?document.documentMode:void 0,p=parseFloat(l.split("Firefox/")[1]||l.split("Minefield/")[1])||
void 0,h=-1!==l.indexOf("Opera")?parseFloat(l.split("Version/")[1]):void 0,f=parseFloat(l.split("Chrome/")[1])||void 0,d=-1!==l.indexOf("Safari")&&!f,b=parseFloat(l.split("WebKit/")[1])||void 0,k=-1!==l.indexOf("Android"),m=-1!==l.indexOf("iPad"),l=-1!==l.indexOf("iPhone"),g=m||l,a=-1!==navigator.platform.indexOf("Mac"),s=-1!==navigator.platform.indexOf("Win"),e=-1!==navigator.platform.indexOf("Linux"),n="undefined"!==typeof document&&"ontouchstart"in document.createElement("input");return{formatMessage:function(c){var a=
arguments;return c.replace(/\$\{([^\}]+)\}/g,function(c,e){return a[(e<<0)+1]})},createElement:function(c,a){return c.createElementNS?c.createElementNS("http://www.w3.org/1999/xhtml",a):c.createElement(a)},isIE:r,isFirefox:p,isOpera:h,isChrome:f,isSafari:d,isWebkit:b,isAndroid:k,isIPad:m,isIPhone:l,isIOS:g,isMac:a,isWindows:s,isLinux:e,isTouch:n,platformDelimiter:s?"\r\n":"\n"}});y("orion/webui/littlelib",["orion/util"],function(l){function r(a,b){b||(b=document);return b.querySelectorAll(a)}function p(a){var b=
a.tabIndex;0===b&&l.isIE&&!{a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0}[a.nodeName.toLowerCase()]&&!a.attributes.tabIndex&&(b=-1);return b}function h(a){if(0<=p(a))return a;if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++){var e=h(a.childNodes[b]);if(e)return e}return null}function f(a){if(0<=p(a))return a;if(a.hasChildNodes())for(var b=a.childNodes.length-1;0<=b;b--){var e=f(a.childNodes[b]);if(e)return e}return null}function d(a,
g){if(3===a.nodeType){var e=b.exec(a.nodeValue);e&&1<e.length&&g(a,e)}if(a.hasChildNodes())for(e=0;e<a.childNodes.length;e++)d(a.childNodes[e],g)}var b=/\$\{([^\}]+)\}/,k=null,m={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46},g=Object.create(null);Object.keys(m).forEach(function(a){g[m[a]]=a});return{$:function(a,b){b||(b=document);return b.querySelector(a)},$$:r,$$array:function(a,b){return Array.prototype.slice.call(r(a,
b))},node:function(a){var b=a;"string"===typeof a&&(b=document.getElementById(a));return b},contains:function(a,b){if(!a||!b)return!1;if(a===b)return!0;var e=a.compareDocumentPosition(b);return Boolean(e&16)},bounds:function(a){a=a.getBoundingClientRect();var b=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),e=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return{left:a.left+b,top:a.top+e,width:a.width,height:a.height}},empty:function(a){for(;a.hasChildNodes();)a.removeChild(a.firstChild)},
firstTabbable:h,lastTabbable:f,stop:function(a){window.document.all&&(a.keyCode=0);a.preventDefault&&(a.preventDefault(),a.stopPropagation())},processTextNodes:function(a,b){d(a,function(a,g){a.parentNode.replaceChild(document.createTextNode(b[g[1]]||g[1]),a)})},processDOMNodes:function(a,b){d(a,function(a,g){var c=b[g[1]];if(c){var u=document.createRange(),t=g.index;u.setStart(a,t);u.setEnd(a,t+g[0].length);u.deleteContents();u.insertNode(c)}})},addAutoDismiss:function(a,b){function e(a){k.forEach(function(c){var e=
!1,b=c.excludeNodes.some(function(c){return document.body.contains(c)?(e=!0,c.contains(a.target)):!1});if(e&&!b)try{c.dismiss(a)}catch(g){"undefined"!==typeof console&&console&&console.error(g&&g.message)}});k=k.filter(function(c){return c.excludeNodes.some(function(c){return document.body.contains(c)})})}null===k&&(k=[],document.addEventListener("click",e,!0),l.isIOS&&document.addEventListener("touchend",function(a){function c(){a.target.removeEventListener("click",c)}0===a.touches.length&&a.target.addEventListener("click",
c)},!1));k.push({excludeNodes:a,dismiss:b})},setFramesEnabled:function(a){for(var b=document.getElementsByTagName("iframe"),e=0;e<b.length;e++)b[e].parentNode.style.pointerEvents=a?"":"none"},getOffsetParent:function(a){a=a.parentNode;for(var b=document.documentElement;a&&a!==b;){var e=window.getComputedStyle(a,null);if(!e)break;e=e.getPropertyValue("overflow-y");if("auto"===e||"scroll"===e)break;a=a.parentNode}return a},removeAutoDismiss:function(a){k=k.filter(function(b){return a!==b.dismiss})},
keyName:function(a){return g[a]||null},KEY:m,createNodes:function(a,b){var e=b,g=null;void 0===e&&(e=document.createElement("div"));e.innerHTML=a;return g=1<e.children.length?e.children:e.firstChild}}});y("orion/splash",["orion/webui/littlelib"],function(l){return{progress:function(r){var p=l.node("splashProgress");p&&(p.innerHTML=r)},takeDown:function(){var r=l.node("splash");r&&r.classList.remove("splashShown")}}});y("orion/pluginregistry",["orion/Deferred","orion/EventTarget","orion/splash","orion/URL-shim"],
function(l,r,p){function h(c,a){var e=Object.keys(c),b=Object.keys(a);if(e.length!==b.length)return!1;e.sort();b.sort();for(var g=0,n=e.length;g<n;g++){var d=e[g];if(d!==b[g])return!1;var s=c[d],d=a[d];if(s!==d&&JSON.stringify(s)!==JSON.stringify(d))return!1}return!0}function f(c){if(-1===c.indexOf("://"))try{return(new URL(c,location.href)).href}catch(a){}return c}function d(c){var a=null,e={key:function(e){return(a=a||Object.keys(c))[e]},getItem:function(a){return c[a]},setItem:function(e,b){c[e]=
b;a=null},removeItem:function(e){delete c[e];a=null},clear:function(){(a=a||Object.keys(c)).forEach(function(a){delete c[a]}.bind(this));a=null}};Object.defineProperty(e,"length",{get:function(){return(a=a||Object.keys(c)).length}});return e}function b(c,a){if(a&&a instanceof XMLHttpRequest){var e,b;try{e=a.status,b=a.statusText}catch(g){e=0,b=""}return{status:e||0,statusText:b}}return a}function k(c){var a=c?JSON.parse(JSON.stringify(c,b)):c;c instanceof Error&&(a.__isError=!0,a.message=a.message||
c.message,a.name=a.name||c.name);return a}function m(c,a){this.type=c;this.plugin=a}function g(c,a){this.__objectId=c;this.__methods=a}function a(c,a,e){function b(q){N&&e.postMessage(q,N)}function n(q){if(!N)return(new l).reject(Error("plugin not connected"));q.id=String(V++);var c=new l;W[q.id]=c;c.then(null,function(c){"active"===H&&(c instanceof Error&&"Cancel"===c.name)&&b({requestId:q.id,method:"cancel",params:c.message?[c.message]:[]})});var a=Object.prototype.toString;q.params.forEach(function(e,
b){if("[object Object]"===a.call(e)&&!(e instanceof g)){var w,u;for(w in e)"[object Function]"===a.call(e[w])&&(u=u||[],u.push(w));if(u){var x=$++;X[x]=e;w=function(){delete X[x]};c.then(w,w);q.params[b]=new g(x,u)}}});e.postMessage(q,N);return c.promise}function d(q,c){q||0===q?b({id:q,result:null,error:c}):console.log(c)}function s(q,c,a,e){e.forEach(function(q,c){if(q&&"undefined"!==typeof q.__objectId){var a={};q.__methods.forEach(function(c){a[c]=function(){return n({objectId:q.__objectId,method:c,
params:Array.prototype.slice.call(arguments)})}});e[c]=a}});var w="undefined"===typeof q?null:{id:q,result:null,error:null};try{var u=a.apply(c,e);w&&(u&&"function"===typeof u.then?(y[q]=u,u.then(function(c){delete y[q];w.result=c;b(w)},function(c){y[q]&&(delete y[q],w.error=k(c),b(w))},function(){b({responseId:q,method:"progress",params:Array.prototype.slice.call(arguments)})})):(w.result=u,b(w)))}catch(g){w&&(w.error=k(g),b(w))}}function f(q){try{if(q.method){var c=q.method,a=q.params||[];if("serviceId"in
q){var b=aa[q.serviceId];b||d(q.id,"service not found");c in b?s(q.id,b,b[c],a):d(q.id,"method not found")}else if("objectId"in q){var w=X[q.objectId];w||d(q.id,"object not found");c in w?s(q.id,w,w[c],a):d(q.id,"method not found")}else if("requestId"in q){var u=y[q.requestId];u&&("cancel"===c&&u.cancel)&&u.cancel.apply(u,a)}else if("responseId"in q){var g=W[q.responseId];g&&("progress"===c&&g.progress)&&g.progress.apply(g,a)}else if("loading"===q.method)N.loading();else if("plugin"===q.method){N.connected();
var n=q.params[0];Y({headers:n.headers,services:n.services}).then(function(){L&&L.resolve(x)})}else if("timeout"===q.method)L&&L.reject(q.error);else throw Error("Bad method: "+q.method);}else{var v=W[String(q.id)];delete W[String(q.id)];if(q.error){var m=e.handleServiceError(x,q.error);v.reject(m)}else v.resolve(q.result)}}catch(k){console.log("Plugin._messageHandler "+k)}}function p(q){var c={};if(q.methods&&(q.methods.forEach(function(a){c[a]=function(){var c={serviceId:q.serviceId,method:a,params:Array.prototype.slice.call(arguments)};
return"active"===H?n(c):x.start({"transient":!0}).then(function(){return n(c)})}}),c.addEventListener&&c.removeEventListener)){var a=new r,e=$++;X[e]={handleEvent:a.dispatchEvent.bind(a)};var b=new g(e,["handleEvent"]),w=c.addEventListener;c.addEventListener=function(q,c){a._namedListeners[q]||w(q,b);a.addEventListener(q,c)};var u=c.removeEventListener;c.removeEventListener=function(q,c){a.removeEventListener(q,c);a._namedListeners[q]||u(q,b)}}return c}function C(q){var a=JSON.parse(JSON.stringify(q.properties));
a.__plugin__=c;q=q.names||q.type||[];Array.isArray(q)||(q=[q]);a.objectClass=q;return a}function q(q){var c=p(q),a=C(q),a=e.registerService(q.names||q.type,c,a);K[q.serviceId]={registration:a,proxy:c}}function w(){e.persist(c,{created:F,headers:J,services:M,autostart:G,lastModified:I})}var x=this;a=a||{};var F=a.created||(new Date).getTime(),J=a.headers||{},M=a.services||[],G=a.autostart,I=a.lastModified||0,H="installed",P,L,N,S,K={},V=0,$=0,y={},W={},X={},aa={},Y;this._default=!1;this._persist=w;
this._resolve=function(){H="resolved";e.dispatchEvent(new m("resolved",x))};this._getAutostart=function(){return G};this._getCreated=function(){return F};this.getLocation=function(){return c};this.getHeaders=function(){return JSON.parse(JSON.stringify(J))};this.getName=function(){var q=this.getHeaders();return q?q.name||"":null};this.getVersion=function(){var q=this.getHeaders();return q?q.version||"0.0.0":null};this.getLastModified=function(){return I};this.getServiceReferences=function(){var q=
[];Object.keys(K).forEach(function(c){q.push(K[c].registration.getReference())});return q};this.setParent=function(q){return S!==q?(S=q,x.stop({"transient":!0}).then(function(){if("started"===G)return x.start({"transient":!0});if("lazy"===G)return x.start({lazy:!0,"transient":!0})})):(new l).resolve()};this.getState=function(){return H};this.getProblemLoading=function(){return x._problemLoading?!0:!1};this.start=function(a){if("uninstalled"===H)return(new l).reject(Error("Plugin is uninstalled"));
if(P)return P.promise.then(this.start.bind(this,a));if("active"===H)return(new l).resolve();if(!a||!a.transient){var b=a&&a.lazy?"lazy":"started";b!==G&&(G=b,w())}b=e.getState();if("starting"!==b&&"active"!==b)return a.transient?(new l).reject(Error("start transient error")):(new l).resolve();if("installed"===H)try{this._resolve()}catch(u){return(new l).reject(u)}"resolved"===H&&M.forEach(function(c){q(c)});if(a&&a.lazy)return"starting"!==H&&(H="starting",e.dispatchEvent(new m("lazy activation",x))),
(new l).resolve();var g=new l;P=g;H="starting";x._problemLoading=null;e.dispatchEvent(new m("starting",x));L=new l;N=e.connect(c,f,S);L.then(function(){L=null;H="active";e.dispatchEvent(new m("started",x));P=null;g.resolve()},function(){L=null;H="stopping";e.dispatchEvent(new m("stopping",x));Object.keys(K).forEach(function(q){K[q].registration.unregister();delete K[q]});e.disconnect(N);N=null;H="resolved";P=null;e.dispatchEvent(new m("stopped",x));x._problemLoading=!0;g.reject(Error("Failed to load plugin: "+
c));x._default&&(I=0,w())});return g.promise};this.stop=function(q){if("uninstalled"===H)return(new l).reject(Error("Plugin is uninstalled"));if(P)return P.promise.then(this.stop.bind(this,q));if((!q||!q.transient)&&"stopped"!==G)G="stopped",w();if("active"!==H&&"starting"!==H)return(new l).resolve();P=q=new l;H="stopping";e.dispatchEvent(new m("stopping",x));Object.keys(K).forEach(function(q){K[q].registration.unregister();delete K[q]});N&&(e.disconnect(N),N=null);H="resolved";P=null;e.dispatchEvent(new m("stopped",
x));q.resolve();return q.promise};Y=function(a){x.problemLoading=null;if("uninstalled"===H)return(new l).reject(Error("Plugin is uninstalled"));if(!a)return 0===I&&(I=(new Date).getTime(),w()),e.loadManifest(c).then(Y,function(){x._problemLoading=!0;x._default&&(I=0,w());console.log("Failed to load plugin: "+c)});var b=J,u=M,g=G;J=a.headers||{};M=a.services||[];G=a.autostart||G;a.lastModified?I=a.lastModified:(I=(new Date).getTime(),w());if(h(J,b)&&h(M,u)&&G===g)return(new l).resolve();if("active"===
H||"starting"===H){var n=[];Object.keys(M).forEach(function(c){var a=M[c];n.push(c);var e=K[c];if(e){if(h(a.methods,Object.keys(e.proxy))){c=C(a);var b=e.registration.getReference(),w={};b.getPropertyKeys().forEach(function(q){w[q]=b.getProperty(q)});h(c,w)||e.registration.setProperties(c);return}e.registration.unregister();delete K[c]}q(a)});Object.keys(K).forEach(function(q){-1===n.indexOf(q)&&(K[q].registration.unregister(),delete K[q])})}"active"===H&&(e.disconnect(N),L=new l,N=e.connect(c,f,
S),L.then(function(){L=null},function(){L=null;H="stopping";e.dispatchEvent(new m("stopping"),x);Object.keys(K).forEach(function(q){K[q].registration.unregister();delete K[q]});e.disconnect(N);N=null;H="resolved";e.dispatchEvent(new m("stopped",x))}));return(new l).resolve()};this.update=function(q){return Y(q).then(function(){e.dispatchEvent(new m("updated",x))})};this.uninstall=function(){if("uninstalled"===H)return(new l).reject(Error("Plugin is uninstalled"));if("active"===H||"starting"===H||
"stopping"===H)return this.stop().then(this.uninstall.bind(this),this.uninstall.bind(this));e.removePlugin(this);H="uninstalled";e.dispatchEvent(new m("uninstalled",x));return(new l).resolve()}}var s=/^http[s]?/i,e=/Worker\.js$/,n=/SharedWorker\.js$/;return{Plugin:a,PluginRegistry:function(c,b){function g(q,c){try{var a;if("undefined"===typeof q.useStructuredClone){var e="string"!==typeof c.data;a=e?c.data:JSON.parse(c.data);q.useStructuredClone=e}else a=q.useStructuredClone?c.data:JSON.parse(c.data);
q.handler(a)}catch(b){}}function v(q){var c=q.source;C.some(function(a){if(c===a.target)return g(a,q),!0})}b=b||{};var k=b.storage||localStorage;k.getItem||(k=d(k));var h=parseInt(k.getItem("pluginregistry.default.timeout"),10)||void 0,z="installed",D,B=[],C=[],q=new r,w={},x={registerService:c.registerService.bind(c),connect:function(q,c,a,b){function w(c){localStorage.pluginLogging&&console.log(c+"("+((new Date).getTime()-x._startTime)+"ms)\x3d"+q)}function u(q){w("timeout");q=Error(q);q.name="timeout";
c({method:"timeout",error:q})}var x={handler:c,url:q};b=b||h;x._updateTimeout=function(){var c,a;if(!this._connected&&!this._closed)if(this._handshake){var e=0;C.forEach(function(q){!q._connected&&!q._closed&&(e+=1E3)});c="Plugin handshake timeout for: "+q;a=(this._loading?6E4:b||5E3)+e}else c="Plugin load timeout for: "+q,a=b||15E3;this._loadTimeout&&clearTimeout(this._loadTimeout);this._loadTimeout=0;a&&(this._loadTimeout=setTimeout(u.bind(null,c),a))};var d=!!(q.match(e)&&"undefined"!==typeof Worker),
s=!!(q.match(n)&&"undefined"!==typeof SharedWorker);if((!localStorage.useSharedWorkers||!s)&&q.match(n))q=q.replace(n,"Worker.js"),s=!1;if((!localStorage.useWorkers||!d)&&q.match(e))q=q.replace(e,"Plugin.html"),d=s=!1;x.url=q;x._updateTimeout();x._startTime=(new Date).getTime();if(d){var v;s?(v=new SharedWorker(q),x.target=v.port,v.port.start(),x._close=function(){v.port.close()}):(v=new Worker(q),x.target=v,x._close=function(){v.terminate()});x.postMessage=function(q){this.target.postMessage(this.useStructuredClone?
q:JSON.stringify(q),[])};x.target.addEventListener("message",function(q){g(x,q)})}else{var m=document.createElement("iframe");m.name=q+"_"+x._startTime;m.src=q;m.onload=function(){p.progress("Loading "+q);w("handshake");x._handshake=!0;x._updateTimeout()};m.sandbox="allow-scripts allow-same-origin allow-forms allow-popups";m.style.width=m.style.height="100%";m.frameBorder=0;(a||D).appendChild(m);x.target=m.contentWindow;x.postMessage=function(q){this.target.postMessage(this.useStructuredClone?q:JSON.stringify(q),
this.url)};x._close=function(){if(m){var q=m.parentNode;q&&q.removeChild(m);m=null}}}x.connected=function(){w("connected");this._connected=!0;this._updateTimeout();p.progress("Loaded "+q)};x.loading=function(){w("loading");this._loading=!0;this._updateTimeout()};x.close=function(){w("closed");this._closed=!0;this._updateTimeout();this._close()};C.push(x);return x},disconnect:function(q){for(var c=0;c<C.length;c++)if(q===C[c]){C.splice(c,1);try{q.close()}catch(a){}break}},removePlugin:function(q){for(var c=
0;c<B.length;c++)if(q===B[c]){B.splice(c,1);break}k.removeItem("plugin."+q.getLocation())},persist:function(q,c){k.setItem("plugin."+q,JSON.stringify(c))},postMessage:function(q,c){c.postMessage(q)},dispatchEvent:function(c){try{q.dispatchEvent(c)}catch(a){console&&console.log("PluginRegistry.dispatchEvent "+a)}},loadManifest:function(q){var c=new l,a=x.connect(q,function(q){a&&q.method&&("manifest"===q.method||"plugin"===q.method?(q=q.params[0],x.disconnect(a),a=null,c.resolve(q)):"timeout"===q.method?
(x.disconnect(a),a=null,c.reject(q.error)):"loading"===q.method&&a.loading())});return c.promise},getState:function(){return z},handleServiceError:function(q,c){if(c&&401===c.status){var a=q.getHeaders(),e=q.getName()||q.getLocation(),b=document.createElement("span");b.appendChild(document.createTextNode("Authentication required for: "+e+"."));a.login&&(b.appendChild(document.createTextNode(" ")),e=document.createElement("a"),e.target="_blank",e.textContent="Login",e.href=a.login,s.test(e.href)?(b.appendChild(e),
b.appendChild(document.createTextNode(" and re-try the request."))):console.log("Illegal Login URL: "+a.login));return{Severity:"Error",HTML:!0,Message:(new XMLSerializer).serializeToString(b)}}if(c.__isError){var w=c;c=Error(w.message);Object.keys(w).forEach(function(q){c[q]=w[q]});delete c.__isError}return c}};this.getLocation=function(){return"System"};this.getHeaders=function(){return{}};this.getName=function(){return"System"};this.getVersion=function(){return"0.0.0"};this.getLastModified=function(){return 0};
this.getState=x.getState;this.init=function(){if(!("starting"===z||"active"===z||"stopping"===z)){addEventListener("message",v,!1);for(var q=[],c=0,e=k.length;c<e;c++)q.push(k.key(c));q.forEach(function(q){if(0===q.indexOf("plugin.")){var c=q.substring(7);q=JSON.parse(k.getItem(q));q.created&&B.push(new a(c,q,x))}});B.sort(function(q,c){return q._getCreated()<c._getCreated()?-1:1});b.parent?D=b.parent:(D=document.createElement("div"),b.visible||(D.style.display="none",D.style.visibility="hidden"),
document.body.appendChild(D));b.plugins&&Object.keys(b.plugins).forEach(function(q){q=f(q);var c=this.getPlugin(q);c?c._default=!0:(c=b.plugins[q],"object"!==typeof c&&(c={}),c.autostart=c.autostart||b.defaultAutostart||"lazy",c=new a(q,c,x),c._default=!0,B.push(c))}.bind(this));z="starting"}};this.start=function(){"starting"!==z&&this.init();if("starting"!==z)return(new l).reject("Cannot start framework. Framework is already "+z+".");var q=[],c=(new Date).getTime();B.forEach(function(a){var e=a._getAutostart();
0===a.getLastModified()?q.push(a.update().then(function(){if("started"===e)return a.start({"transient":!0});if("lazy"===e)return a.start({lazy:!0,"transient":!0});a._resolve()})):"started"===e?q.push(a.start({"transient":!0})):"lazy"===e?(q.push(a.start({lazy:!0,"transient":!0})),c>a.getLastModified()+864E5&&a.update()):a._resolve()});return l.all(q,function(q){console.log("PluginRegistry.stop "+q)}).then(function(){z="active"})};this.stop=function(){if("starting"!==z&&"active"!==z)return(new l).reject("Cannot stop registry. Registry is already "+
z+".");z="stopping";var q=[];B.forEach(function(c){q.push(c.stop({"transient":!0}))});return l.all(q,function(q){console.log("PluginRegistry.stop "+q)}).then(function(){if(!b.parent){var q=D.parentNode;q&&q.removeChild(D)}D=null;removeEventListener("message",v);z="resolved"})};this.update=function(){this.stop().then(this.start.bind(this))};this.uninstall=function(){return(new l).reject("Cannot uninstall registry")};this.installPlugin=function(q,c){q=f(q);var e=this.getPlugin(q);if(e)return(new l).resolve(e);
if(w[q])return w[q];if(c)return e=new a(q,c,x),B.push(e),e._persist(),x.dispatchEvent(new m("installed",e)),(new l).resolve(e);var b=x.loadManifest(q).then(function(c){e=new a(q,c,x);B.push(e);e._persist();delete w[q];x.dispatchEvent(new m("installed",e));return e},function(c){delete w[q];throw c;});return w[q]=b};this.getPlugins=function(){return B.slice()};this.getPlugin=function(q){var c=null;q=f(q);B.some(function(a){if(q===a.getLocation())return c=a,!0});return c};this.addEventListener=q.addEventListener.bind(q);
this.removeEventListener=q.removeEventListener.bind(q);this.resolvePlugins=function(){var q=!0;B.forEach(function(c){q=q&&c._resolve()});return q}}}});var U=null,Q=document.getElementsByTagName("script");if(Q&&Q.length&&0<Q.length){for(var Z=0;2>Z;Z++){for(var T=0;T<Q.length;T++)if(0===Z){if("orion.codeEdit"===Q[T].id){U=Q[T].src;break}}else{var ba=/.*built-codeEdit.*.js/;if(Q[T].src&&ba.exec(Q[T].src)){U=Q[T].src;break}}if(U)break}U||(U=Q[Q.length-1].src)}y("embeddedEditor/helper/bootstrap",["embeddedEditor/helper/embeddedFileImpl",
"orion/serviceregistry","orion/pluginregistry","orion/Deferred","orion/URL-shim"],function(l,r,p,h){var f,d=["../javascript/plugins/javascriptPlugin.html","../webtools/plugins/webToolsPlugin.html","../plugins/embeddedToolingPlugin.html"];return{startup:function(b){if(f)return f;var k=document.createElement("div");k.id="_orion_hidden_actions";document.body.appendChild(k);k.style.display="none";k=b&&b._defaultPlugins?b._defaultPlugins:d;f=new h;var m=new r.ServiceRegistry,g=new l("/__embed/");m.registerService("orion.core.file",
g,{Name:"Embedded File System",top:"/__embed/",pattern:"/__embed/"});var a={};k.forEach(function(e){e=new URL(e,U);a[e.href]={autostart:"lazy"}});k=b&&b.userPlugins?b.defaultPlugins:[];k.forEach(function(e){a[e]={autostart:"lazy"}});var s=new p.PluginRegistry(m,{storage:{},plugins:a});return s.start().then(function(){var a={serviceRegistry:m,pluginRegistry:s};f.resolve(a);return a})}}});y("orion/editor/eventTarget",[],function(){function l(){}l.addMixin=function(r){var p=l.prototype,h;for(h in p)p.hasOwnProperty(h)&&
(r[h]=p[h])};l.prototype={addEventListener:function(l,p,h){this._eventTypes||(this._eventTypes={});var f=this._eventTypes[l];f||(f=this._eventTypes[l]={level:0,listeners:[]});f.listeners.push({listener:p,useCapture:h})},dispatchEvent:function(l){var p=l.type;this._dispatchEvent("pre"+p,l);this._dispatchEvent(p,l);this._dispatchEvent("post"+p,l)},_dispatchEvent:function(l,p){var h=this._eventTypes?this._eventTypes[l]:null;if(h){var f=h.listeners;try{if(h.level++,f)for(var d=0,b=f.length;d<b;d++)if(f[d]){var k=
f[d].listener;"function"===typeof k?k.call(this,p):k.handleEvent&&"function"===typeof k.handleEvent&&k.handleEvent(p)}}finally{if(h.level--,h.compact&&0===h.level){for(d=f.length-1;0<=d;d--)f[d]||f.splice(d,1);0===f.length&&delete this._eventTypes[l];h.compact=!1}}}},isListening:function(l){return!this._eventTypes?!1:void 0!==this._eventTypes[l]},removeEventListener:function(l,p,h){if(this._eventTypes){var f=this._eventTypes[l];if(f){for(var d=f.listeners,b=0,k=d.length;b<k;b++){var m=d[b];if(m&&
m.listener===p&&m.useCapture===h){0!==f.level?(d[b]=null,f.compact=!0):d.splice(b,1);break}}0===d.length&&delete this._eventTypes[l]}}}};return{EventTarget:l}});y("orion/regex",[],function(){return{escape:function(l){return l.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$\x26")},parse:function(l){return(l=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(l))?{pattern:l[1],flags:l[2]}:null}}});y("orion/editor/textModel",["orion/editor/eventTarget","orion/regex","orion/util"],function(l,r,p){function h(f,d){this._lastLineIndex=
-1;this._text=[""];this._lineOffsets=[0];this.setText(f);this.setLineDelimiter(d)}h.prototype={destroy:function(){},find:function(f){1<this._text.length&&(this._text=[this._text.join("")]);var d=f.string,b=f.regex,k=d,m="",g=f.caseInsensitive;if(k)if(b){if(d=r.parse(k))k=d.pattern,m=d.flags}else k=d.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$\x26"),g&&(k=k.replace(/[iI\u0130\u0131]/g,"[Ii\u0130\u0131]"));var a=null,s;if(k){var d=f.reverse,e=f.wrap,b=f.wholeWord,n=f.start||0;f=f.end;var c=null!==f&&
void 0!==f;-1===m.indexOf("g")&&(m+="g");-1===m.indexOf("m")&&(m+="m");g&&-1===m.indexOf("i")&&(m+="i");b&&(k="\\b"+k+"\\b");var u=this._text[0],t,v,A=0;c&&(g=n<f?n:f,u=u.substring(g,n<f?f:n),A=g);var h=RegExp(k,m);d?s=function(){var c=null;for(h.lastIndex=0;;){v=h.lastIndex;t=h.exec(u);if(v===h.lastIndex)return null;if(t){if(!(t.index+A<n)){if(!e||c)break;n=u.length+A}c={start:t.index+A,end:h.lastIndex+A}}else break}c&&(n=c.start);return c}:(c||(h.lastIndex=n),s=function(){for(;;){v=h.lastIndex;
t=h.exec(u);if(v===h.lastIndex)break;if(t)return{start:t.index+A,end:h.lastIndex+A};if(!(0!==v&&e))break}return null});a=s()}return{next:function(){var c=a;c&&(a=s());return c},hasNext:function(){return null!==a}}},getCharCount:function(){for(var f=0,d=0;d<this._text.length;d++)f+=this._text[d].length;return f},getLine:function(f,d){var b=this.getLineCount();if(!(0<=f&&f<b))return null;var k=this._lineOffsets[f];if(f+1<b){b=this.getText(k,this._lineOffsets[f+1]);if(d)return b;for(var k=b.length,m;10===
(m=b.charCodeAt(k-1))||13===m;)k--;return b.substring(0,k)}return this.getText(k)},getLineAtOffset:function(f){var d=this.getCharCount();if(!(0<=f&&f<=d))return-1;var b=this.getLineCount();if(f===d)return b-1;var k,m,g=this._lastLineIndex;if(0<=g&&g<b&&(k=this._lineOffsets[g],m=g+1<b?this._lineOffsets[g+1]:d,k<=f&&f<m))return g;for(var a=b,s=-1;1<a-s;)if(g=Math.floor((a+s)/2),k=this._lineOffsets[g],m=g+1<b?this._lineOffsets[g+1]:d,f<=k)a=g;else if(f<m){a=g;break}else s=g;return this._lastLineIndex=
a},getLineCount:function(){return this._lineOffsets.length},getLineDelimiter:function(){return this._lineDelimiter},getLineEnd:function(f,d){var b=this.getLineCount();if(!(0<=f&&f<b))return-1;if(f+1<b){b=this._lineOffsets[f+1];if(d)return b;for(var k=this.getText(Math.max(this._lineOffsets[f],b-2),b),m=k.length,g;10===(g=k.charCodeAt(m-1))||13===g;)m--;return b-(k.length-m)}return this.getCharCount()},getLineStart:function(f){return!(0<=f&&f<this.getLineCount())?-1:this._lineOffsets[f]},getText:function(f,
d){void 0===f&&(f=0);void 0===d&&(d=this.getCharCount());if(f===d)return"";for(var b=0,k=0,m;k<this._text.length;){m=this._text[k].length;if(f<=b+m)break;b+=m;k++}for(var g=b,a=k;k<this._text.length;){m=this._text[k].length;if(d<=b+m)break;b+=m;k++}if(a===k)return this._text[a].substring(f-g,d-b);g=this._text[a].substring(f-g);b=this._text[k].substring(0,d-b);return g+this._text.slice(a+1,k).join("")+b},onChanging:function(f){return this.dispatchEvent(f)},onChanged:function(f){return this.dispatchEvent(f)},
setLineDelimiter:function(f,d){"auto"===f&&(f=void 0,1<this.getLineCount()&&(f=this.getText(this.getLineEnd(0),this.getLineEnd(0,!0))));this._lineDelimiter=f?f:p.platformDelimiter;if(d){var b=this.getLineCount();if(1<b){for(var k=Array(b),m=0;m<b;m++)k[m]=this.getLine(m);this.setText(k.join(this._lineDelimiter))}}},setText:function(f,d,b){void 0===f&&(f="");void 0===d&&(d=0);void 0===b&&(b=this.getCharCount());if(!(d===b&&""===f)){for(var k=this.getLineAtOffset(d),m=this.getLineAtOffset(b),g=d,a=
b-d,s=m-k,e=f.length,n=0,c=this.getLineCount(),u=0,t=0,v=0,A=[];;){-1!==u&&u<=v&&(u=f.indexOf("\r",v));-1!==t&&t<=v&&(t=f.indexOf("\n",v));if(-1===t&&-1===u)break;v=-1!==u&&-1!==t?u+1===t?t+1:(u<t?u:t)+1:-1!==u?u+1:t+1;A.push(d+v);n++}this.onChanging({type:"Changing",text:f,start:g,removedCharCount:a,addedCharCount:e,removedLineCount:s,addedLineCount:n});0===A.length&&(v=this.getLineStart(k),m=m+1<c?this.getLineStart(m+1):this.getCharCount(),d!==v&&(f=this.getText(v,d)+f,d=v),b!==m&&(f+=this.getText(b,
m),b=m));v=e-a;for(m=k+s+1;m<c;m++)this._lineOffsets[m]+=v;if(5E4>A.length)k=[k+1,s].concat(A),Array.prototype.splice.apply(this._lineOffsets,k);else{v=k+1;this._lineOffsets.splice(v,s);for(c=0;c<A.length;c+=5E4)k=[v,0].concat(A.slice(c,Math.min(A.length,c+5E4))),Array.prototype.splice.apply(this._lineOffsets,k),v+=5E4}for(v=c=0;v<this._text.length;){m=this._text[v].length;if(d<=c+m)break;c+=m;v++}k=c;for(A=v;v<this._text.length;){m=this._text[v].length;if(b<=c+m)break;c+=m;v++}m=this._text[v];d=
this._text[A].substring(0,d-k);b=m.substring(b-c);A=[A,v-A+1];d&&A.push(d);f&&A.push(f);b&&A.push(b);Array.prototype.splice.apply(this._text,A);0===this._text.length&&(this._text=[""]);this.onChanged({type:"Changed",start:g,removedCharCount:a,addedCharCount:e,removedLineCount:s,addedLineCount:n})}}};l.EventTarget.addMixin(h.prototype);return{TextModel:h}});y("orion/editor/undoStack",[],function(){function l(h,f,d,b,k){this.model=h;this.offset=f;this.text=d;this.previousText=b;this.type=k}function r(h){this.owner=
h;this.changes=[]}function p(h,f){this.size=void 0!==f?f:100;this.reset();var d=this;this._listener={onChanging:function(b){d._onChanging(b)},onDestroy:function(b){d._onDestroy(b)}};if(h.getModel){var b=h.getModel();b.getBaseModel&&(b=b.getBaseModel());this.model=b;this.setView(h)}else this.shared=!0,this.model=h;this.model.addEventListener("Changing",this._listener.onChanging)}l.prototype={getRedoChanges:function(){return[{start:this.offset,end:this.offset+this.previousText.length,text:this.text}]},
getUndoChanges:function(){return[{start:this.offset,end:this.offset+this.text.length,text:this.previousText}]},undo:function(h,f){this._doUndoRedo(this.offset,this.previousText,this.text,h,f);return!0},redo:function(h,f){this._doUndoRedo(this.offset,this.text,this.previousText,h,f);return!0},merge:function(h,f,d,b,k){if(b===this.type){if(1===b&&h===this.offset+this.text.length)return this.text+=f,!0;if(-1===b&&k===this.offset)return this.offset=h,this.previousText=d+this.previousText,!0;if(-1===b&&
h===this.offset)return this.previousText+=d,!0}return!1},_doUndoRedo:function(h,f,d,b,k){this.model.setText(f,h,h+d.length);k&&b&&(d=b.getModel(),d!==this.model&&(h=d.mapOffset(h,!0)),b.setSelection(h,h+f.length))}};r.prototype={getRedoChanges:function(){for(var h=[],f=0;f<this.changes.length;f++)h=h.concat(this.changes[f].getRedoChanges());return h},getUndoChanges:function(){for(var h=[],f=this.changes.length-1;0<=f;f--)h=h.concat(this.changes[f].getUndoChanges());return h},add:function(h){this.changes.push(h)},
end:function(h){h&&(this.endSelection=h.getSelections());(h=this.owner)&&h.end&&h.end()},undo:function(h,f){1<this.changes.length&&h&&h.setRedraw(!1);for(var d=this.changes.length-1;0<=d;d--)this.changes[d].undo(h,!1);f&&h&&h.setSelections(this.startSelection);1<this.changes.length&&h&&h.setRedraw(!0);(d=this.owner)&&d.undo&&d.undo();return 0<this.changes.length},redo:function(h,f){1<this.changes.length&&h&&h.setRedraw(!1);for(var d=0;d<this.changes.length;d++)this.changes[d].redo(h,!1);f&&h&&h.setSelections(this.endSelection);
(1<this.changes.length,h)&&h.setRedraw(!0);(d=this.owner)&&d.redo&&d.redo();return 0<this.changes.length},merge:function(h,f,d,b,k,m){var g=this.changes.length;return 0<g&&this===m?this.changes[g-1].merge(h,f,d,b,k):!1},start:function(h){h&&(this.startSelection=h.getSelections());(h=this.owner)&&h.start&&h.start()}};p.prototype={destroy:function(){this._onDestroy()},add:function(h){this.compoundChange?this.compoundChange.add(h):(this.stack.splice(this.index,this.stack.length-this.index,h),this.index++,
this.stack.length>this.size&&(this.stack.shift(),this.index--))},markClean:function(){this._commitUndo();if(this.cleanChange=this.stack[this.index-1])this.cleanChange.type=2},isClean:function(){return this.cleanChange===this.stack[this.index-1]},canUndo:function(){return 0<this.index},canRedo:function(){return 0<this.stack.length-this.index},endCompoundChange:function(){this.compoundChange&&this.compoundChange.end(this.view);this.compoundChange=void 0},getSize:function(){return{undo:this.index,redo:this.stack.length-
this.index}},getRedoChanges:function(){this._commitUndo();for(var h=[],f=this.index;f<this.stack.length;f++)h=h.concat(this.stack[f].getRedoChanges());return h},getUndoChanges:function(){this._commitUndo();for(var h=[],f=this.index;0<=f;f--)h=h.concat(this.stack[f].getUndoChanges());return h},undo:function(){this._commitUndo();var h;h=!1;this._ignoreUndo=!0;do{if(0>=this.index)break;h=this.stack[--this.index]}while(!(h=h.undo(this.view,!0)));this._ignoreUndo=!1;return h},redo:function(){this._commitUndo();
var h;h=!1;this._ignoreUndo=!0;do{if(this.index>=this.stack.length)break;h=this.stack[this.index++]}while(!(h=h.redo(this.view,!0)));this._ignoreUndo=!1;return h},reset:function(){this.index=0;this.cleanChange=void 0;this.stack=[];this._ignoreUndo=!1;this._compoundChange=void 0},setView:function(h){this.view!==h&&(this.view&&h.removeEventListener("Destroy",this._listener.onDestroy),(this.view=h)&&h.addEventListener("Destroy",this._listener.onDestroy))},startCompoundChange:function(h){this._commitUndo();
h=new r(h);this.add(h);this.compoundChange=h;this.compoundChange.start(this.view);return this.compoundChange},_commitUndo:function(){this.endCompoundChange()},_onDestroy:function(h){(!h||!this.shared)&&this.model.removeEventListener("Changing",this._listener.onChanging);this.view&&(this.view.removeEventListener("Destroy",this._listener.onDestroy),this.view=null)},_trackUnsavedChanges:function(h){if(this._unsavedChanges){var f=this._unsavedChanges.length,d=h.removedCharCount,b=h.start,k=h.start+d,
m=0;0===h.addedCharCount?m=-1:0===d&&(m=1);if(0<f&&m===this._previousChangeType){f=this._unsavedChanges[f-1];if(0===d&&b===f.end+f.text.length){f.text+=h.text;return}if(0===h.addedCharCount&&k===f.start){f.start=b;return}}this._previousChangeType=m;this._unsavedChanges.push({start:b,end:k,text:h.text})}},_onChanging:function(h){this._trackUnsavedChanges(h);if(!this._ignoreUndo){var f=h.text,d=h.start,b=h.addedCharCount,k=h.removedCharCount;h=d+k;var m=0;0===b&&1===k?m=-1:1===b&&0===k&&(m=1);b=this.stack.length;
k=this.model.getText(d,h);(!(0<b&&this.index===b)||!this.stack[b-1].merge(d,f,k,m,h,this.compoundChange))&&this.add(new l(this.model,d,f,k,m))}}};return{UndoStack:p}});y("orion/commandsProxy",["orion/util","orion/webui/littlelib"],function(l,r){function p(f,d){f=f||window.event;if(function(b){if(l.isMac){if(b.metaKey&&!b.altKey)return!b.shiftKey&&!b.ctrlKey&&(65===b.keyCode||67===b.keyCode||86===b.keyCode||88===b.keyCode||90===b.keyCode)?!0:!1;if(b.ctrlKey)return!1}else{if(b.ctrlKey&&!b.altKey)return!b.shiftKey&&
(65===b.keyCode||67===b.keyCode||86===b.keyCode||88===b.keyCode||90===b.keyCode)?!0:!1;if(b.altKey&&!b.ctrlKey||b.ctrlKey&&b.altKey)return!1}if(b["char"])return 0<b["char"].length;if(b.charCode||b.keyCode)switch(b=b.charCode||b.keyCode,b){case 8:case 9:case 13:case 46:return!0;default:return 32<=b&&112>b||123<b}return!1}(f)){if("true"===f.target.contentEditable)return;var b=f.target.nodeName.toLowerCase();if("input"===b)switch(f.target.type.toLowerCase()){case "text":case "password":case "search":case "color":case "date":case "datetime":case "datetime-local":case "email":case "month":case "number":case "range":case "tel":case "time":case "url":case "week":return}else if("textarea"===
b)return}d(f)}function h(){this._init()}h.prototype={destroy:function(){this._listener&&(document.removeEventListener("keydown",this._listener),this._listener=null)},setProxy:function(f){this.proxy=f},setKeyBindings:function(f){this.bindings=f},_init:function(){var f=this;document.addEventListener("keydown",this._listener=function(d){return p(d,function(b){var d=f.proxy,m=f.bindings;if(m&&d)for(var g=0;g<m.length;g++)m[g].match(b)&&(d.processKey({type:b.type,keyCode:b.keyCode,altKey:b.altKey,ctrlKey:b.ctrlKey,
metaKey:b.metaKey,shiftKey:b.shiftKey}),r.stop(b))})})}};return{handleKeyEvent:p,CommandsProxy:h}});y("orion/webui/dropdown",["orion/webui/littlelib","orion/EventTarget"],function(l,r){function p(d){r.attach(this);this._init(d)}function h(d,b){var f=document.createElement(void 0===b?"span":b);f.tabIndex=0;f.className="dropdownMenuItem";f.role="menuitem";if(d){var m=document.createElement("span");m.appendChild(document.createTextNode(d));m.classList.add("dropdownCommandName");f.appendChild(m)}m=document.createElement("li");
m.appendChild(f);return m}function f(){var d=document.createElement("li");d.classList.add("dropdownSeparator");return d}p.prototype={_init:function(d){this._dropdownNode=l.node(d.dropdown);if(!this._dropdownNode)throw"no dom node for dropdown found";this._populate=d.populate;this._selectionClass=d.selectionClass;this._parentDropdown=d.parentDropdown;this._positioningNode=d.positioningNode;if(!this._parentDropdown)for(var b=this._dropdownNode.parentNode;b&&document!==b;){if(b.classList&&b.classList.contains("dropdownMenu")){this._parentDropdown=
b.dropdown;break}b=b.parentNode}this._dropdownNode.tabIndex=0;this._triggerNode=d.triggerNode?d.triggerNode:l.$(".dropdownTrigger",this._dropdownNode.parentNode);if(!this._triggerNode)throw"no dom node for dropdown trigger found";var f=function(b){var g=!1;(g=this._triggerNode.classList.contains("dropdownMenuItem")?this.open(b):this.toggle(b))&&l.stop(b)}.bind(this);d.skipTriggerEventListeners||(this._triggerNode.addEventListener("click",f,!1),"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",
function(b){(b.keyCode===l.KEY.ENTER||b.keyCode===l.KEY.SPACE)&&f(b)}.bind(this),!1));this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(d){var b=this;d.addEventListener("click",function(d){b.toggle(d)&&l.stop(d)},!1)},toggle:function(d){return this.isVisible()?this.close():this.open(d)},isVisible:function(){return this._isVisible},open:function(d){var b=!1;this.isVisible()||(this.dispatchEvent({type:"triggered",dropdown:this,event:d}),l.setFramesEnabled(!1),
this._populate&&(this.empty(),this._populate(this._dropdownNode)),0<this.getItems().length&&(this._boundAutoDismiss&&l.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=this._autoDismiss.bind(this),b=l.$$array(".dropdownSubMenu",this._dropdownNode),l.addAutoDismiss([this._triggerNode].concat(b),this._boundAutoDismiss),this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),this._dropdownNode.classList.add("dropdownMenuOpen"),
this._isVisible=!0,this._positionDropdown(d),this._focusDropdownNode(),b=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this)));return b},_focusDropdownNode:function(){this._dropdownNode.focus()},_autoDismiss:function(d){if(this.close(!1)&&this._dropdownNode.contains(d.target))for(d=this._parentDropdown;d;)d.close(!1),d=d._parentDropdown},_positionDropdown:function(d){this._dropdownNode.style.left="";this._dropdownNode.style.top="";if(this._positioningNode)this._dropdownNode.style.left=
this._positioningNode.offsetLeft+"px";else{d=l.bounds(this._dropdownNode);var b=l.bounds(document.body);if(d.left+d.width>b.left+b.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-d.width+"px";else{var f=l.bounds(this._boundingNode(this._triggerNode)),m=l.bounds(this._triggerNode);this._dropdownNode.style.left=m.left-f.left-d.width+m.width+"px"}d=d.top+d.height-(b.top+b.height);0<d&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-
d)+"px")}},_boundingNode:function(d){var b=window.getComputedStyle(d,null);return null===b||"absolute"===b.getPropertyValue("position")||!d.parentNode||d===document.body?d:this._boundingNode(d.parentNode)},close:function(d){var b=!1;this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),l.setFramesEnabled(!0),d&&this._triggerNode.focus(),this._isVisible=
!1,this._selectedItem&&(this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=null),this._boundAutoDismiss&&(l.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null),b=!0);return b},getItems:function(){var d=[],b=this;l.$$array("li:not(.dropdownSeparator) \x3e .dropdownMenuItem",this._dropdownNode,!0).forEach(function(f){f.parentNode.parentNode===b._dropdownNode&&d.push(f)});d.forEach(function(d){d._hasDropdownMouseover||(d.addEventListener("mouseover",
function(f){d.dropdown?d.dropdown.open(f):(b._closeSelectedSubmenu(),l.stop(f));b._selectItem(d)}),d._hasDropdownMouseover=!0)});return d},empty:function(){var d=this;l.$$array("li",this._dropdownNode).forEach(function(b){b.parentNode===d._dropdownNode&&b.parentNode.removeChild(b)})},_dropdownKeyDown:function(d){if(d.keyCode===l.KEY.UP||d.keyCode===l.KEY.DOWN||d.keyCode===l.KEY.RIGHT||d.keyCode===l.KEY.ENTER||d.keyCode===l.KEY.LEFT){var b=this.getItems();if(b.length&&0<b.length){if(this._selectedItem){var f=
b.indexOf(this._selectedItem);0>f&&(f=b.indexOf(this._selectedItem.parentNode));0<=f&&(d.keyCode===l.KEY.UP&&0<f?(f--,this._selectItem(b[f])):d.keyCode===l.KEY.DOWN&&f<b.length-1?(f++,this._selectItem(b[f])):d.keyCode===l.KEY.ENTER||d.keyCode===l.KEY.RIGHT?this._selectedItem.classList.contains("dropdownTrigger")&&this._selectedItem.dropdown?(this._selectedItem.dropdown.open(),this._selectedItem.dropdown._selectItem()):d.keyCode===l.KEY.ENTER&&this._selectedItem.click():d.keyCode===l.KEY.LEFT&&this._selectedItem.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&
(this.close(!0),this._parentDropdown&&this._parentDropdown._dropdownNode.focus()))}else this._selectItem(b[0]);l.stop(d)}}else d.keyCode===l.KEY.ESCAPE&&(this.close(!0),l.stop(d))},_selectItem:function(d){if(d=d||this.getItems()[0])this._selectedItem&&this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=d,this._selectedItem.classList.add("dropdownMenuItemSelected");document.activeElement!==this._dropdownNode&&this._dropdownNode.focus()},submenuOpen:function(d){d!==this._selectedSubmenu&&
(this._closeSelectedSubmenu(),this._selectedSubmenu=d)},_closeSelectedSubmenu:function(){for(var d=this._selectedSubmenu;d;)d.close(),d=d._selectedSubmenu},destroy:function(){this.empty();this._boundAutoDismiss&&(l.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null)},appendMenuItem:function(d,b){var f=h(d,b);this._dropdownNode.appendChild(f);return f},appendSeparator:function(){var d=f();this._dropdownNode.appendChild(d);return d}};p.prototype.constructor=p;return{Dropdown:p,appendKeyBindingString:function(d,
b){var f=document.createElement("span");f.classList.add("dropdownKeyBinding");f.appendChild(document.createTextNode(b));d.appendChild(f)},createMenuItem:h,createSeparator:f}});y("text",["module"],function(l){var r,p,h,f,d,b=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],k=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,m=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,g="undefined"!==typeof location&&location.href,a=g&&location.protocol&&location.protocol.replace(/\:/,""),s=g&&location.hostname,
e=g&&(location.port||void 0),n={},c=l.config&&l.config()||{};r={version:"2.0.12",strip:function(c){if(c){c=c.replace(k,"");var a=c.match(m);a&&(c=a[1])}else c="";return c},jsEscape:function(c){return c.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var c,a,e;if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;
if("undefined"!==typeof ActiveXObject)for(a=0;3>a;a+=1){e=b[a];try{c=new ActiveXObject(e)}catch(g){}if(c){b=[e];break}}return c},parseName:function(c){var a,e,b=!1,g=c.indexOf(".");a=0===c.indexOf("./")||0===c.indexOf("../");-1!==g&&(!a||1<g)?(a=c.substring(0,g),e=c.substring(g+1,c.length)):a=c;c=e||a;g=c.indexOf("!");-1!==g&&(b="strip"===c.substring(g+1),c=c.substring(0,g),e?e=c:a=c);return{moduleName:a,ext:e,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(c,a,e,b){var g,n;g=r.xdRegExp.exec(c);
if(!g)return!0;c=g[2];g=g[3];g=g.split(":");n=g[1];g=g[0];return(!c||c===a)&&(!g||g.toLowerCase()===e.toLowerCase())&&(!n&&!g||n===b)},finishLoad:function(a,e,b,g){b=e?r.strip(b):b;c.isBuild&&(n[a]=b);g(b)},load:function(b,n,d,f){if(f&&f.isBuild&&!f.inlineText)d();else{c.isBuild=f&&f.isBuild;var m=r.parseName(b);f=m.moduleName+(m.ext?"."+m.ext:"");var k=n.toUrl(f),h=c.useXhr||r.useXhr;0===k.indexOf("empty:")?d():!g||h(k,a,s,e)?r.get(k,function(c){r.finishLoad(b,m.strip,c,d)},function(c){d.error&&
d.error(c)}):n([f],function(c){r.finishLoad(m.moduleName+"."+m.ext,m.strip,c,d)})}},write:function(c,a,e,b){n.hasOwnProperty(a)&&(b=r.jsEscape(n[a]),e.asModule(c+"!"+a,"define(function () { return '"+b+"';});\n"))},writeFile:function(c,a,e,b,g){a=r.parseName(a);var n=a.ext?"."+a.ext:"",d=a.moduleName+n,s=e.toUrl(a.moduleName+n)+".js";r.load(d,e,function(a){a=function(q){return b(s,q)};a.asModule=function(q,c){return b.asModule(q,s,c)};r.write(c,d,a,g)},g)}};if("node"===c.env||!c.env&&"undefined"!==
typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"])p=O.nodeRequire("fs"),r.get=function(c,a,e){try{var b=p.readFileSync(c,"utf8");0===b.indexOf("\ufeff")&&(b=b.substring(1));a(b)}catch(g){e&&e(g)}};else if("xhr"===c.env||!c.env&&r.createXhr())r.get=function(a,e,b,g){var n=r.createXhr(),d;n.open("GET",a,!0);if(g)for(d in g)g.hasOwnProperty(d)&&n.setRequestHeader(d.toLowerCase(),g[d]);if(c.onXhr)c.onXhr(n,a);n.onreadystatechange=function(g){if(4===n.readyState&&
(g=n.status||0,399<g&&600>g?(g=Error(a+" HTTP status: "+g),g.xhr=n,b&&b(g)):e(n.responseText),c.onXhrComplete))c.onXhrComplete(n,a)};n.send(null)};else if("rhino"===c.env||!c.env&&"undefined"!==typeof Packages&&"undefined"!==typeof java)r.get=function(c,a){var e,b,g=new java.io.File(c),n=java.lang.System.getProperty("line.separator"),g=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(g),"utf-8")),d="";try{e=new java.lang.StringBuffer;(b=g.readLine())&&(b.length()&&
65279===b.charAt(0))&&(b=b.substring(1));for(null!==b&&e.append(b);null!==(b=g.readLine());)e.append(n),e.append(b);d=String(e.toString())}finally{g.close()}a(d)};else if("xpconnect"===c.env||!c.env&&"undefined"!==typeof Components&&Components.classes&&Components.interfaces)h=Components.classes,f=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),d="@mozilla.org/windows-registry-key;1"in h,r.get=function(c,a){var e,b,g,n={};d&&(c=c.replace(/\//g,"\\"));g=new FileUtils.File(c);
try{e=h["@mozilla.org/network/file-input-stream;1"].createInstance(f.nsIFileInputStream),e.init(g,1,0,!1),b=h["@mozilla.org/intl/converter-input-stream;1"].createInstance(f.nsIConverterInputStream),b.init(e,"utf-8",e.available(),f.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),b.readString(e.available(),n),b.close(),e.close(),a(n.value)}catch(s){throw Error((g&&g.path||"")+": "+s);}};return r});y("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'\x3cbutton class\x3d"dropdownTrigger"\x3e${ButtonText}\x3c!--span class\x3d"dropdownArrowDown core-sprite-openarrow"\x3e\x3c/span--\x3e\x3c/button\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e'});
y("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'\x3cbutton class\x3d"dropdownTrigger dropdownDefaultButton"\x3e${ButtonText}\x3cspan class\x3d"dropdownArrowDown core-sprite-openarrow"\x3e\x3c/span\x3e\x3c/button\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e'});y("text!orion/webui/checkedmenuitem.html",[],function(){return'\x3cli\x3e\x3clabel class\x3d"dropdownMenuItem"\x3e\x3cinput class\x3d"checkedMenuItem" role\x3d"menuitem" type\x3d"checkbox" /\x3e${ItemText}\x3c/label\x3e\x3c/li\x3e'});
y("orion/webui/tooltip",["orion/webui/littlelib"],function(l){function r(l){this._init(l)}r.prototype={_init:function(p){this._node=l.node(p.node);if(!this._node)throw"no dom node for tooltip found";this._position=p.position||["right","above","below","left"];this._text=p.text;this._hideDelay=void 0===p.hideDelay?200:p.hideDelay;this._tailSize=p.tailSize||10;this._trigger=p.trigger||"mouseover";this._afterShowing=p.afterShowing;this._afterHiding=p.afterHiding;var h=this;if("click"===this._trigger)this._showDelay=
0,this._node.addEventListener("click",this._clickHandler=function(d){d.target===h._node&&(h.show(),l.stop(d))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===p.showDelay?500:p.showDelay;p=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(d){l.contains(h._node,d.target)&&(h.show(),l.stop(d))},!1);this._leaveHandler=function(d){l.contains(h._node,d.target)&&h.hide()};for(var f=0;f<p.length;f++)this._node.addEventListener(p[f],this._leaveHandler,
!1)}else"focus"===this._trigger&&(this._showDelay=void 0===p.showDelay?0:p.showDelay,this._hideDelay=void 0===p.hideDelay?0:p.hideDelay,this._node.addEventListener("focus",this._focusHandler=function(d){l.contains(h._node,d.target)&&h.show()},!1),this._blurHandler=function(d){l.contains(h._node,d.target)&&h.hide()},this._node.addEventListener("blur",this._blurHandler,!1))},_makeTipNode:function(){if(!this._tip){this._tip=document.createElement("span");this._tip.classList.add("tooltipContainer");this._tipInner=
document.createElement("div");this._tipInner.classList.add("tooltip");if(this._text){this._tipTextContent=document.createElement("div");this._tipTextContent.classList.add("textContent");this._tipInner.appendChild(this._tipTextContent);var p=document.createTextNode(this._text);this._tipTextContent.appendChild(p)}this._tip.appendChild(this._tipInner);document.body.appendChild(this._tip);var h=this;l.addAutoDismiss([this._tip,this._node],function(){h.hide()});"mouseover"===this._trigger&&(this._tipInner.role=
"tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(f){h._timeout&&(window.clearTimeout(h._timeout),h._timeout=null);h._tip.addEventListener("mouseout",function(d){l.contains(h._tip,d.target)&&(h.hide(),l.stop(d))},!1)},!1))}return this._tip},_positionTip:function(p,h){this._makeTipNode();this._tip.classList.add("tooltipShowing");"left"===p?this._tipInner.classList.add("left"):
this._tipInner.classList.remove("left");var f=this._node,d;for(d=l.bounds(f);f&&!d.width&&!d.height;f=f.parentNode)d=l.bounds(f);var f=l.bounds(this._tipInner),b;switch(p){case "above":b=d.top-f.height-this._tailSize-1;d=d.left-this._tailSize;break;case "below":b=d.top+d.height+this._tailSize+1;d=d.left-this._tailSize;break;case "left":b=d.top-this._tailSize/2;d=d.left-f.width-this._tailSize-1;break;default:b=d.top-this._tailSize/2,d=d.left+d.width+this._tailSize+1}var k=document.body,m=document.documentElement,
g=Math.max(m.scrollLeft,k.scrollLeft),k=Math.max(m.scrollTop,k.scrollTop),a=g+m.clientWidth,m=k+m.clientHeight;if(b+f.height>m)if(h)b=m-f.height-1;else return!1;if(d+f.width>a)if(h)d=a-f.width-1;else return!1;if(d<g)if(h)d=g+4;else return!1;if(b<k)if(h)b=k+4;else return!1;this._tail&&this._tail.previousPosition!==p&&(this._tip.removeChild(this._tail),this._tail=null);this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+p),"above"===p||"left"===p?this._tip.appendChild(this._tail):
this._tip.insertBefore(this._tail,this._tipInner),this._tail.previousPosition=p);this._tip.style.top=b+"px";this._tip.style.left=d+"px";return!0},contentContainer:function(){this._makeTipNode();return this._tipInner},isShowing:function(){return this._tip&&this._tip.classList.contains("tooltipShowing")},show:function(){this.isShowing()||(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=window.setTimeout(this._showImmediately.bind(this),this._showDelay):
this._showImmediately())},_showImmediately:function(){for(var l=!1,h=0;!l&&h<this._position.length;)l=this._positionTip(this._position[h]),h++;l||this._positionTip(this._position[0],!0);this._afterShowing&&this._afterShowing()},hide:function(l){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);if(this.isShowing()){void 0===l&&(l=this._hideDelay);var h=this;this._timeout=window.setTimeout(function(){h._tip.classList.remove("tooltipShowing");h._tip.removeAttribute("style");h._afterHiding&&
h._afterHiding()},l)}},destroy:function(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);this._tip&&(document.body.removeChild(this._tip),this._tail=this._tipTextContent=this._tipInner=this._tip=null);if(this._node){this._node.removeEventListener("click",this._clickHandler,!1);this._node.removeEventListener("mouseover",this._mouseoverHandler,!1);this._node.removeEventListener("focus",this._focusHandler,!1);this._node.removeEventListener("blur",this._blurHandler,!1);for(var l=
["mouseout","click"],h=0;h<l.length;h++)this._node.removeEventListener(l[h],this._leaveHandler,!1)}}};r.prototype.constructor=r;return{Tooltip:r}});y("orion/metrics",[],function(){function l(h,f){var d=window.location.protocol+"//"+window.location.hostname+window.location.pathname+window.location.search,b=window.location.pathname+window.location.search,k=document.title;p=h;p.forEach(function(m){m.pageLoad(d,b,k,f)})}function r(h,f,d,b){p.forEach(function(k){k.logTiming(h,f,d,b)})}var p=[];return{init:l,
initFromRegistry:function(h,f){var d=[];h.getServiceReferences("orion.metrics").forEach(function(b){d.push(h.getService(b))});l(d,f)},logEvent:function(h,f,d,b){p.forEach(function(k){k.logEvent(h,f,d,b)})},logPageLoadTiming:function(h,f){window.performance&&(window.performance.getEntriesByName&&window.performance.mark&&!window.performance.getEntriesByName(h).length)&&(window.performance.mark(h),r("page",h,window.performance.now(),f))},logTiming:r}});y("orion/commands","orion/webui/littlelib orion/commandsProxy orion/webui/dropdown text!orion/webui/dropdowntriggerbutton.html text!orion/webui/dropdowntriggerbuttonwitharrow.html text!orion/webui/checkedmenuitem.html orion/webui/tooltip orion/metrics".split(" "),
function(l,r,p,h,f,d,b,k){function m(c){var a=c.invocation;if(a){var e=c.command;if(e.hrefCallback)return c=e.hrefCallback.call(a.handler||window,a),c.then?c.then(function(c){window.open(c)}):window.open(c),!0;if(a.commandRegistry)return a.commandRegistry._invoke(a),!0;if(e.onClick||e.callback)return window.setTimeout(function(){(e.onClick||e.callback).call(a.handler||window,a)},0),!0}return!1}function g(c,a){for(var e in a)if(a[e]&&(a[e].keyBinding&&a[e].command)&&a[e].keyBinding.match(c)){var b=
a[e],g=b.keyBinding;if((!g.domScope||l.contains(l.node(g.domScope),c.target))&&m(b)){l.stop(c);break}}}function a(){var c={};if(u){var a,e,b;e=Object.keys(t);for(a=0;a<e.length;a++)b=e[a],c[b]=t[b];var g=u();e=Object.keys(g);for(a=0;a<e.length;a++)b=e[a],c[b]=g[b]}else c=t;return c}function s(c){g(c,a())}function e(c,a,e){a.classList.add("commandImage");var b;c.imageClass?c.addImageClassToElement?a.classList.add(c.imageClass):(b=document.createElement("span"),a.appendChild(b),b.classList.add(c.spriteClass),
b.classList.add(c.imageClass)):(b=new Image,b.alt=c.name,b.name=e,b.id=e,b.src=c.image,a.appendChild(b));return b}function n(c,a,e,b,g){this.commandRegistry=g;this.handler=c;this.items=a;this.userData=e;this.command=b;b.parameters&&(this.parameters=b.parameters.makeCopy());this.id=b.id}function c(c){this._init(c)}var u=null,t={};window.document.addEventListener("keydown",function(c){return r.handleKeyEvent(c,s)},!1);n.prototype={collectsParameters:function(){return this.commandRegistry&&this.commandRegistry.collectsParameters()},
makeCopy:function(c){var a=new n(this.handler,this.items,this.userData,this.command,this.commandRegistry);a.domNode=this.domNode;a.domParent=this.domParent;c?a.parameters=c.makeCopy():this.parameters&&(a.parameters=this.parameters.makeCopy());return a}};n.prototype.constructor=n;c.prototype={_init:function(c){this.id=c.id;this.name=c.name;this.tooltip=c.tooltip;this.callback=c.callback;this.preCallback=c.preCallback;this.hrefCallback=c.hrefCallback;this.choiceCallback=c.choiceCallback;this.positioningNode=
c.positioningNode;this.image=c.image||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC";this.imageClass=c.imageClass;this.addImageClassToElement=c.addImageClassToElement;this.extraClass=c.extraClass;this.selectionClass=c.selectionClass;this.spriteClass=c.spriteClass||"commandSprite";this.visibleWhen=c.visibleWhen;this.parameters=c.parameters;this.isEditor=c.isEditor;this.type=c.type;this.checked=
c.checked;this.track=c.track},populateChoicesMenu:function(c,a,e,b,g){e=this.getChoices(a,e,b);var n=e.some(function(c){return c.checked});e.forEach(function(e){if(e.name){var q=document.createElement("li");c.appendChild(q);var b=document.createElement("span");b.tabIndex=0;b.role="menuitem";b.classList.add("dropdownMenuItem");if(n){var x=document.createElement("span");x.classList.add("check");x.appendChild(document.createTextNode(e.checked?"\u25cf":""));b.appendChild(x)}e.imageClass&&(x=document.createElement("span"),
x.classList.add(e.imageClass),b.appendChild(x));var x=document.createElement("span"),u=document.createTextNode(e.name);x.appendChild(u);b.appendChild(x);q.appendChild(b);b.choice=e;b.addEventListener("click",function(q){k.logEvent("command","invoke",this.id+"\x3e"+e.name);e.callback.call(e,a)}.bind(this),!1);b.addEventListener("keydown",function(q){if(q.keyCode===l.KEY.ENTER||q.keyCode===l.KEY.SPACE)k.logEvent("command","invoke",this.id+"\x3e"+e.name),e.callback.call(e,a)}.bind(this),!1)}else g._generateMenuSeparator(c)}.bind(this))},
getChoices:function(c,a,e){return this.choiceCallback?this.choiceCallback.call(a,c,e):null},makeChoiceCallback:function(c,a){return function(e){c.callback&&c.callback.call(c,a,e)}},hasImage:function(){return this.imageClass||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC"!==this.image}};c.prototype.constructor=c;return{Command:c,CommandInvocation:n,createDropdownMenu:function(c,a,b,g,n,u,d,q,w,
x){c=l.node(c);if(!c)throw"no parent node was specified";var t=document.createRange();t.selectNode(c);t=w?t.createContextualFragment(f):t.createContextualFragment(h);l.processTextNodes(t,{ButtonText:a});c.appendChild(t);c=c.lastChild;var s;w?(w=c.previousSibling,s=w.lastChild):w=c.previousSibling;g?w.classList.add(g):(w.classList.add("orionButton"),w.classList.add("commandButton"));x&&x.split(" ").forEach(w.classList.add.bind(w.classList));n&&(u||(w.textContent="",w.setAttribute("aria-label",a)),
e({spriteClass:"commandSprite",imageClass:n},w,a),w.classList.add("orionButton"));w.dropdown=new p.Dropdown({dropdown:c,populate:b,selectionClass:d,skipTriggerEventListeners:!!s,positioningNode:q});c.dropdown=w.dropdown;return{menuButton:w,menu:c,dropdown:w.dropdown,dropdownArrow:s}},createCheckedMenuItem:function(c,a,e,b){c=l.node(c);if(!c)throw"no parent node was specified";var g=document.createRange();g.selectNode(c);g=g.createContextualFragment(d);l.processTextNodes(g,{ItemText:a});c.appendChild(g);
c=l.$(".checkedMenuItem",c.lastChild);c.checked=e;c.addEventListener("change",b,!1);return c},createCommandItem:function(c,a,g,n,u,d,s){var q,w;d=d||!a.name&&a.hasImage();var x=function(){if(d)a.hasImage()?(e(a,q,n),a.name&&q.setAttribute("aria-label",a.name)):(q.classList.add("commandButton"),q.classList.add("commandMissingImageButton"),q.appendChild(document.createTextNode(a.name)));else{q.classList.add("commandButton");var c=document.createTextNode(a.name);q.appendChild(c)}};if(a.hrefCallback)q=
w=document.createElement("a"),q.id=n,d&&a.hasImage()?e(a,q,n):(q.className="commandLink",q.appendChild(document.createTextNode(a.name))),s=a.hrefCallback.call(g.handler,g),s.then?s.then(function(c){q.href=c}):q.href=s?s:"#";else{if("switch"===a.type){q=document.createElement("div");q.tabIndex=0;q.className="orionSwitch";var f=w=document.createElement("input");f.type="checkbox";f.className="orionSwitchCheck";f.id="orionSwitchCheck"+a.id;c.id&&(f.id+=c.id);q.appendChild(f);x=document.createElement("label");
x.className="orionSwitchLabel";x.setAttribute("for",f.id);var m=document.createElement("span");m.className="orionSwitchInner";var k=document.createElement("span");k.className="orionSwitchSwitch";x.appendChild(m);x.appendChild(k);q.appendChild(x);q.addEventListener("keydown",function(q){(q.keyCode===l.KEY.ENTER||q.keyCode===l.KEY.SPACE)&&f.click()},!1);f.checked=a.checked;m.classList.add(a.imageClass)}else"toggle"===a.type?(q=w=document.createElement("button"),q.className="orionButton",q.classList.add(a.checked?
"orionToggleOn":"orionToggleOff"),q.id="orionToggle"+a.id,c.id&&(q.id+=c.id)):(q=w=document.createElement("button"),q.className="orionButton",a.extraClass&&q.classList.add(a.extraClass)),x();var h=s||a.callback;if(h){var p=function(){h.call(g.handler,g)};a.onClick=h;w.addEventListener("click",function(c){var e;e="switch"===a.type||"toggle"===a.type?function(c){"toggle"===a.type?(c&&(a.checked=!a.checked),a.checked?(q.classList.remove("orionToggleOff"),q.classList.add("orionToggleOn")):(q.classList.remove("orionToggleOn"),
q.classList.add("orionToggleOff")),q.classList.add("orionToggleAnimate")):c?a.checked=f.checked:f.checked=!f.checked;c&&window.setTimeout(p,250)}:function(q){q&&p()};a.preCallback?a.preCallback(g).then(function(q){e(q)}):e(!0);c.stopPropagation()},!1)}}"ul"===c.nodeName.toLowerCase()?(s=document.createElement("li"),c.appendChild(s),c=s):q.classList.add("commandMargins");c.appendChild(q);a.tooltip&&(q.commandTooltip=new b.Tooltip({node:q,text:a.tooltip,position:["above","below","right","left"]}));
u&&(t[a.id]={keyBinding:u,command:a,invocation:g});return q},createCommandMenuItem:function(c,a,e,g,n,u){var d,q,w=c.dropdown;if(a.hrefCallback)q=p.createMenuItem(a.name,"a"),d=q.firstElementChild,n=a.hrefCallback.call(e.handler,e),n.then?n.then(function(q){d.href=q}):d.href=n?n:"#",d.addEventListener("keydown",function(q){(q.keyCode===l.KEY.ENTER||q.keyCode===l.KEY.SPACE)&&d.click()},!1);else{q=p.createMenuItem(a.name);d=q.firstElementChild;var x=n||a.callback;x&&(a.onClick=x,d.addEventListener("click",
function(q){w&&w.close(!0);x.call(e.handler,e)},!1),d.addEventListener("keydown",function(q){if(q.keyCode===l.KEY.ENTER||q.keyCode===l.KEY.SPACE)q.preventDefault(),d.click()},!1))}a.tooltip&&(d.commandTooltip=new b.Tooltip({node:d,text:a.tooltip,position:["above","below","right","left"]}));u&&p.appendKeyBindingString(d,u);c.appendChild(q);g&&(t[a.id]={keyBinding:g,command:a,invocation:e});return d},executeBinding:m,setKeyBindingProvider:function(c){u=c},localKeyBindings:t,getKeyBindings:a,processKey:s,
NO_IMAGE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",_testMethodProcessKey:g}});y("orion/explorers/navigationUtils",[],function(){function l(l,h,f,d){!r&&l&&(l.push({domNode:h}),h.style.outline="none")}var r=-1!==navigator.userAgent.indexOf("iPad");return{addNavGrid:function(p,h,f){p&&(p=p.getGridNavHolder(h,!0))&&l(p,f)},generateNavGrid:l,removeNavGrid:function(l,h){if(l)for(var f=0;f<l.length;f++)if(l[f].domNode===
h){l.splice(f,1);break}}}});y("orion/PageUtil",[],function(){var l=/^http[s]?/i;return{hash:function(){var l=window.location.href.split("#")[1];return l?"#"+l:""},matchResourceParameters:function(l){l=l||window.location.toString();var p={resource:""},h=l.indexOf("#");if(-1!==h&&(l=l.substring(h+1),0!==l.length)){l=l.split(",");p.resource=decodeURIComponent(l[0]);for(h=1;h<l.length;h++){var f=/([^=]*)(=?)(.*)/.exec(l[h]),d=decodeURIComponent(f[1]||""),f=decodeURIComponent(f[3]||"");""!==d&&"resource"!==
d&&(p[d]=f)}}return p},validateURLScheme:function(r,p){var h=r;if(-1===r.indexOf("://")){var f=document.createElement("a");f.href=r;h=f.href}f=!1;if(f=p?p.some(function(d){return RegExp("^"+d+":","i").test(h)}):l.test(h))return r;console.log("Illegal URL Scheme: '"+r+"'");return""}}});(function(){function l(f,d,b,k,m,g){d[f]&&(b.push(f),(!0===d[f]||1===d[f])&&k.push(m+f+"/"+g))}function r(f,d,b,k,m){d=k+d+"/"+m;O._fileExists(f.toUrl(d+".js"))&&b.push(d)}function p(f,d,b){for(var k in d)d.hasOwnProperty(k)&&
(!f.hasOwnProperty(k)||b)?f[k]=d[k]:"object"===typeof d[k]&&(!f[k]&&d[k]&&(f[k]={}),p(f[k],d[k],b))}var h=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;y("i18n",["module"],function(f){var d=f.config?f.config():{};return{version:"2.0.4",load:function(b,f,m,g){g=g||{};g.locale&&(d.locale=g.locale);var a=h.exec(b),s=a[1],e=a[4],n=a[5],c=e.split("-"),u=[],t={},v,A="";a[5]?(s=a[1],b=s+n):(n=a[4],e=d.locale,e||(e=d.locale="undefined"===typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),
c=e.split("-"));if(g.isBuild){u.push(b);r(f,"root",u,s,n);for(v=0;v<c.length;v++)e=c[v],A+=(A?"-":"")+e,r(f,A,u,s,n);if(g.locales)for(a=0;a<g.locales.length;a++){e=g.locales[a];c=e.split("-");A="";for(b=0;b<c.length;b++)e=c[b],A+=(A?"-":"")+e,r(f,A,u,s,n)}f(u,function(){m()})}else f([b],function(a){var e=[],b;l("root",a,e,u,s,n);for(v=0;v<c.length;v++)b=c[v],A+=(A?"-":"")+b,l(A,a,e,u,s,n);f(u,function(){var c,b,q;for(c=e.length-1;-1<c&&e[c];c--){q=e[c];b=a[q];if(!0===b||1===b)b=f(s+q+"/"+n);p(t,b)}m(t)})})}}})})();
y("orion/nls/messages",{root:!0});y("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Edit",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings",orionClientLabel:"Orion client repository","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer",
"Orion Markdown Editor":"Orion Markdown Editor","Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor","View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.",ShowAllKeyBindings:"Show a list of all the keybindings on this page","Show Keys":"Show Keys",HideShowBannerFooter:"Hide or show the page banner","Toggle banner and footer":"Toggle banner",ChooseFileOpenEditor:"Choose a file by name and open an editor on it",
FindFile:"Find File Named...","System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item",NoSearchAvailableErr:"Can't search: no search service is available",Related:"Related",Options:"Options","LOG: ":"LOG: ",View:"View",
"no parent":"no parent","no tree model":"no tree model","no renderer":"no renderer","could not find table row ":"could not find table row ",Operations:"Operations","Operations running":"Operations running",SomeOpWarning:"Some operations finished with warning",SomeOpErr:"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",
More:"More","Recent searches":"Recent searches","Regular expression":"Regular expression","Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification",OpPressSpaceMsg:"Operations - Press spacebar to show current operations","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site","Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.",
"Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",outlineTimeout:"Outline service timed out. Try reloading the page and opening the outline again.",UnknownError:"An unknown error occurred.",Filter:"Filter (* \x3d any string, ? \x3d any character)",TemplateExplorerLabel:"Templates",OpenTemplateExplorer:"Open Template Explorer",
Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu","Wrote: ${0}":"Wrote: ${0}",GenerateHTML:"Generate HTML file",GenerateHTMLTooltip:"Write an HTML file generated from the current Markdown editor content","alt text":"alt text",blockquote:"blockquote",code:"code","code (block)":"code (block)","code (span)":"code (span)",emphasis:"emphasis","fenced code (${0})":"fenced code (${0})","header (${0})":"header (${0})","horizontal rule":"horizontal rule",label:"label","link (auto)":"link (auto)","link (image)":"link (image)",
"link (inline)":"link (inline)","link label":"link label","link label (optional)":"link label (optional)","link (ref)":"link (ref)","list item (bullet)":"list item (bullet)","list item (numbered)":"list item (numbered)","strikethrough (${0})":"strikethrough (${0})",strong:"strong","table (${0})":"table (${0})",text:"text","title (optional)":"title (optional)",url:"url",TogglePaneOrientationTooltip:"Toggle split pane orientation",WarningDuplicateLinkId:"Duplicate link ID: ${0} (link IDs are not case-sensitive)",
WarningHeaderTooDeep:"Header level cannot exceed 6",WarningLinkHasNoText:"Link has no text",WarningLinkHasNoURL:"Link has no URL",WarningOrderedListItem:"Ordered list item within unordered list",WarningOrderedListShouldStartAt1:"The first item in an ordered list should have index 1",WarningUndefinedLinkId:"Undefined link ID: ${0}",WarningUnorderedListItem:"Unordered list item within ordered list",PageTitleFormat:"${0} - ${1}",KeyCTRL:"Ctrl",KeySHIFT:"Shift",KeyALT:"Alt",KeyBKSPC:"Backspace",KeyDEL:"Del",
KeyEND:"End",KeyENTER:"Enter",KeyESCAPE:"Esc",KeyHOME:"Home",KeyINSERT:"Ins",KeyPAGEDOWN:"Page Down",KeyPAGEUP:"Page Up",KeySPACE:"Space",KeyTAB:"Tab","a year":"a year",years:"${0} years","a month":"a month",months:"${0} months","a day":"a day",days:"${0} days","an hour":"an hour",hours:"${0} hours","a minute":"a minute",minutes:"${0} minutes",timeAgo:"${0} ago",justNow:"just now"});y("orion/i18nUtil",[],function(){return{formatMessage:function(l){var r=/\$\{([^\}]+)\}/g,p=arguments;return 2===p.length&&
p[1]&&"object"===typeof p[1]?l.replace(r,function(h,f){return p[1][f]}):l.replace(r,function(h,f){return p[(f<<0)+1]})}}});y("orion/uiUtils",["i18n!orion/nls/messages","orion/webui/littlelib","orion/i18nUtil"],function(l,r,p){function h(a){var b="";m?(a.mod4&&(b+="\u2303"),a.mod3&&(b+="\u2325"),a.mod2&&(b+="\u21e7"),a.mod1&&(b+="\u2318")):(a.mod1&&(b+=l.KeyCTRL+"+"),a.mod2&&(b+=l.KeySHIFT+"+"),a.mod3&&(b+=l.KeyALT+"+"));if(a.alphaKey)return b+a.alphaKey;if("keypress"===a.type)return b+a.keyCode;var e=
a.keyCode,n=g[e];if(n)return b+n;if(e=r.keyName(e))return e=l["Key"+e]||e,b+e;var c;switch(a.keyCode){case 59:c=a.mod2?":":";";break;case 61:c=a.mod2?"+":"\x3d";break;case 188:c=a.mod2?"\x3c":",";break;case 190:c=a.mod2?"\x3e":".";break;case 191:c=a.mod2?"?":"/";break;case 192:c=a.mod2?"~":"`";break;case 219:c=a.mod2?"{":"[";break;case 220:c=a.mod2?"|":"\\";break;case 221:c=a.mod2?"}":"]";break;case 222:c=a.mod2?'"':"'"}return c?b+c:112<=a.keyCode&&123>=a.keyCode?b+"F"+(a.keyCode-111):b+String.fromCharCode(a.keyCode)}
function f(a){var b=-1!==window.navigator.platform.indexOf("Mac");return b&&a.metaKey||!b&&a.ctrlKey}function d(a,b){if(!a||!a.tagName)return!1;switch(a.tagName.toLowerCase()){case "button":case "fieldset":case "form":case "input":case "keygen":case "label":case "legend":case "meter":case "optgroup":case "output":case "progress":case "select":case "textarea":return!0}return a.parentNode===b?!1:a.parentNode&&d(a.parentNode,b)}function b(a,b,e){return 0<a?1===a?l[b]:p.formatMessage(l[e],a):""}function k(a){a=
new Date(a);var g=(new Date).getTime()-a.getTime();a=Math.floor(g/1E3/60/60/24/365);var g=g-31536E6*a,e=Math.floor(g/1E3/60/60/24/30),g=g-2592E6*e,n=Math.floor(g/1E3/60/60/24),g=g-864E5*n,c=Math.floor(g/1E3/60/60),u=Math.floor((g-36E5*c)/1E3/60),g=b(a,"a year","years"),d=b(e,"a month","months"),f=b(n,"a day","days"),m=b(c,"an hour","hours"),u=b(u,"a minute","minutes"),k="";g?k=0<a?g:g+d:d?k=0<e?d:d+f:f?k=0<n?f:f+m:m?k=0<c?m:m+u:u&&(k=u);return k}var m=-1!==navigator.platform.indexOf("Mac"),g=Object.create(null);
g[r.KEY.DOWN]="\u2193";g[r.KEY.UP]="\u2191";g[r.KEY.RIGHT]="\u2192";g[r.KEY.LEFT]="\u2190";m&&(g[r.KEY.BKSPC]="\u232b",g[r.KEY.DEL]="\u2326",g[r.KEY.END]="\u21f2",g[r.KEY.ENTER]="\u23ce",g[r.KEY.ESCAPE]="\u238b",g[r.KEY.HOME]="\u21f1",g[r.KEY.PAGEDOWN]="\u21df",g[r.KEY.PAGEUP]="\u21de",g[r.KEY.SPACE]="\u2423",g[r.KEY.TAB]="\u21e5");return{getUserKeyString:function(a){var b="";a=a.getKeys();for(var e=0;e<a.length;e++)0!==e&&(b+=" "),b+=h(a[e]);return b},getUserText:function(a){var b=a.id,e=a.refNode,
g=a.hideRefNode,c=a.initialText,u=a.onComplete,d=a.onEditDestroy,f=a.selectTo,m=a.isInitialValid;a=a.insertAsChild;var k=!1,h=function(a){return function(f){if(!k){var q=r.node(b),w=q.value;q&&(a&&f.keyCode===r.KEY.ESCAPE?(g&&(e.style.display="inline"),k=!0,q.parentNode.removeChild(q),d&&d()):a&&f.keyCode!==r.KEY.ENTER||(0===w.length||!m&&w===c?g&&(e.style.display="inline"):(u(w),g&&e.parentNode&&(e.style.display="inline")),k=!0,q.parentNode&&q.parentNode.removeChild(q),d&&d()))}}},l=document.createElement("input");
l.id=b;l.value=c||"";a?e.appendChild(l):e.parentNode.insertBefore(l,e.nextSibling);l.classList.add("userEditBoxPrompt");g&&(e.style.display="none");l.addEventListener("keydown",h(!0),!1);l.addEventListener("blur",h(!1),!1);window.setTimeout(function(){l.focus();if(c){var a=r.node(b),e=f?c.indexOf(f):-1;0<e?a.createTextRange?(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",0),a.moveEnd("character",e),a.select()):a.setSelectionRange?a.setSelectionRange(0,e):void 0!==a.selectionStart&&(a.selectionStart=
0,a.selectionEnd=e):a.select()}},0)},openInNewWindow:f,followLink:function(a,b){b&&f(b)?window.open(a):window.location=a},createButton:function(a,b){var e=document.createElement("button");e.className="orionButton commandButton commandMargins";e.addEventListener("click",function(a){b();r.stop(a)},!1);a&&e.appendChild(document.createTextNode(a));return e},createDropdownButton:function(a,b,e){},isFormElement:d,path2FolderName:function(a,b,e){return a.substring(0,a.length-encodeURIComponent(b).length-
(e?0:1))},timeElapsed:k,displayableTimeElapsed:function(a){return(a=k(a))?p.formatMessage(l.timeAgo,a):l.justNow}}});y("text!orion/webui/submenutriggerbutton.html",[],function(){return'\x3cli class\x3d"dropdownSubMenu"\x3e\x3cspan class\x3d"dropdownTrigger dropdownMenuItem" role\x3d"menuitem" tabindex\x3d"0"\x3e\x3cspan class\x3d"dropdownCommandName"\x3e${ButtonText}\x3c/span\x3e\x3cspan class\x3d"dropdownArrowRight core-sprite-closedarrow"\x3e\x3c/span\x3e\x3c/span\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e\x3c/li\x3e'});
y("orion/commandRegistry","orion/commands orion/explorers/navigationUtils orion/PageUtil orion/uiUtils orion/webui/littlelib orion/webui/dropdown orion/webui/tooltip text!orion/webui/submenutriggerbutton.html orion/metrics".split(" "),function(l,r,p,h,f,d,b,k,m){function g(c){this._commandList={};this._contributionsByScopeId={};this._activeBindings={};this._urlBindings={};this._pendingBindings={};this._init(c||{});this._parameterCollector=null}function a(c,a){this.token=c;this.parameterName=a}function s(c,
a,e){this.event=c;this.handler=a;this.capture=e||!1}function e(c,a,e,b,g,n,d){this.name=c;this.type=a;this.label=e;this.value=b;this.lines=g||1;this.validator=d;this.eventListeners=Array.isArray(n)?n:n?[n]:[]}function n(c,a,e){this._storeParameters(c);this._hasOptionalParameters=a&&a.hasOptionalParameters;this._options=a;this.optionsRequested=!1;this.getParameters=e;this.clientCollect=a&&a.clientCollect;this.getParameterElement=a&&a.getParameterElement;this.getSubmitName=a&&a.getSubmitName;this.getCancelName=
a&&a.getCancelName;this.message=a&&a.message}g.prototype={_init:function(c){this._selectionService=c.selection;var a=this;l.setKeyBindingProvider(function(){return a._activeBindings})},processURL:function(c){for(var a in this._urlBindings)if(this._urlBindings[a]&&this._urlBindings[a].urlBinding&&this._urlBindings[a].command){var e=this._urlBindings[a].urlBinding.match(c);if(e){var b=this._urlBindings[a],g=b.command,n=b.invocation;if(n&&n.parameters&&g.callback){n.parameters.setValue(e.parameterName,
e.parameterValue);var d=this;window.setTimeout(function(){d._invoke(n)},0);break}}}},findCommand:function(c){return this._commandList[c]},runCommand:function(c,a,e,b,g,n){if(a){if((c=this._commandList[c])&&(c.visibleWhen?c.visibleWhen(a):1)&&c.callback)return a=new l.CommandInvocation(e,a,g,c,this),a.domParent=n,this._invoke(a,b)}else if((n=this._urlBindings[c])&&n.command&&n.command.callback)return this._invoke(n.invocation,b)},getSelectionService:function(){return this._selectionService},setParameterCollector:function(c){this._parameterCollector=
c},openParameterCollector:function(c,a,e){this._parameterCollector&&(this._parameterCollector.close(),this._parameterCollector.open(c,a,e))},confirm:function(c,a,e,g,n,d){var s=!1;if(this._parameterCollector&&!n){var f=this,m=function(){f._parameterCollector.close()};n=function(q,c){var b=document.createElement("span");b.classList.add("parameterPrompt");b.textContent=a;q.appendChild(b);b=document.createElement("button");b.addEventListener("click",function(q){s=!0;d(s);m()},!1);c.appendChild(b);b.appendChild(document.createTextNode(e));
b.className="dismissButton";var w=document.createElement("button");w.addEventListener("click",function(q){s=!1;m()},!1);c.appendChild(w);w.appendChild(document.createTextNode(g));w.className="dismissButton";return b};this._parameterCollector.close();if(!this._parameterCollector.open(c,n,function(){})){var k=new b.Tooltip({node:c,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above","left"]});c=k.contentContainer();c.classList.add("parameterPopup");var q=window.document.activeElement,
m=function(){q&&q.focus();k.destroy()},w=document.createElement("div");w.classList.add("parameterMessage");c.appendChild(w);var x=document.createElement("div");c.appendChild(x);x.classList.add("layoutRight");x.classList.add("parametersDismiss");var h=n(w,x);k.show();h&&window.setTimeout(function(){h.focus();h.select&&h.select()},0)}}else s=window.confirm(a),d(s)},closeParameterCollector:function(){this._parameterCollector&&this._parameterCollector.close()},collectsParameters:function(){return this._parameterCollector},
_invoke:function(c,a){return this._collectAndInvoke(c.makeCopy(a),!1)},_collectAndInvoke:function(c,a,e){if(c)if(this._parameterCollector&&c.parameters&&c.parameters.hasParameters()&&(a||c.parameters.shouldCollectParameters())){a=!1;c.parameters.updateParameters(c);if(c.parameters.shouldCollectParameters()&&(a=this._parameterCollector.collectParameters(c,e),!a)){var g=new b.Tooltip({node:c.domNode||c.domParent,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above",
"left"]});a=g.contentContainer();a.classList.add("parameterPopup");var n=window.document.activeElement,d=this._parameterCollector.getFillFunction(c,function(){n&&n.focus();g.destroy()},e)(a);g.show();d&&window.setTimeout(function(){d.focus();d.select&&d.select()},0);a=!0}if(!a)return m.logEvent("command","invoke",c.command.id),c.command.callback.call(c.handler||window,c)}else return m.logEvent("command","invoke",c.command.id),c.command.callback.call(c.handler||window,c);else window.console.log("Client attempted to invoke command without an available (rendered) command invocation")},
collectParameters:function(c,a){this._collectAndInvoke(c,!0,a)},showKeyBindings:function(c){function a(c){return function(){l.executeBinding(c)}}var e={},b,g,n=[],d;for(d in this._activeBindings)(g=this._activeBindings[d])&&(g.keyBinding&&g.command&&(g.command.name||g.command.tooltip))&&n.push(g);n.sort(function(c,a){return(c.command.name||c.command.tooltip).localeCompare(a.command.name||a.command.tooltip)});for(d=0;d<n.length;d++)g=n[d],g.keyBinding.scopeName?(e[g.keyBinding.scopeName]||(e[g.keyBinding.scopeName]=
[]),e[g.keyBinding.scopeName].push(g)):(b=h.getUserKeyString(g.keyBinding),c.createItem(b,g.command.name||g.command.tooltip,a(g)));for(var s in e)e[s].length&&0<e[s].length&&(c.createHeader(s),e[s].forEach(function(e){b=h.getUserKeyString(e.keyBinding);c.createItem(b,e.command.name||e.command.tooltip,a(e))}))},addCommand:function(c){this._commandList[c.id]=c;var a=this._pendingBindings[c.id];if(a){var e=this;a.forEach(function(a){e._addBinding(c,a.type,a.binding,a.bindingOnly)});delete this._pendingBindings[c.id]}},
addCommandGroup:function(c,a,e,b,g,n,d,s,f,m,q){this._contributionsByScopeId[c]||(this._contributionsByScopeId[c]={});c=this._contributionsByScopeId[c];g&&(c=this._createEntryForPath(c,g));c[a]?(b&&(c[a].title=b),e&&(c[a].position=e),d&&(c[a].imageClass=d),s&&(c[a].tooltip=s),f&&(c[a].selectionClass=f),q&&(c[a].extraClass=q),!0===m?c[a].pretendDefaultActionId=!0:c[a].defaultActionId=m,c[a].emptyGroupMessage=n):(c[a]={title:b,position:e,emptyGroupMessage:n,imageClass:d,tooltip:s,selectionClass:f,defaultActionId:!0===
m?null:m,pretendDefaultActionId:!0===m,children:{},extraClasses:q},c.sortedContributions=null)},_createEntryForPath:function(c,a){a&&a.split("/").forEach(function(a){1<a.length&&(c[a]||(c[a]={position:0,children:{}},c.sortedContributions=null),c=c[a].children)});return c},registerSelectionService:function(a,e){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});this._contributionsByScopeId[a].localSelectionService=e},registerCommandContribution:function(a,e,b,g,n,d,s,f){this._contributionsByScopeId[a]||
(this._contributionsByScopeId[a]={});a=this._contributionsByScopeId[a];g&&(a=this._createEntryForPath(a,g));a[e]={position:b,handler:f};d&&((b=this._commandList[e])?this._addBinding(b,"key",d,n):this._addPendingBinding(e,"key",d,n));s&&((b=this._commandList[e])?this._addBinding(b,"url",s,n):this._addPendingBinding(e,"url",s,n));a.sortedContributions=null},unregisterCommandContribution:function(a,e,b){if(this._contributionsByScopeId[a]){delete this._commandList[e];delete this._activeBindings[e];delete this._urlBindings[e];
delete this._pendingBindings[e];var g=this._contributionsByScopeId[a];b&&b.split("/").forEach(function(a){1<a.length&&g[a]&&(g=g[a].children)});delete g[e];g.sortedContributions=null}},_addBinding:function(a,e,b,g){if(!a.id)throw Error("No command id: "+a);"key"===e?this._activeBindings[a.id]={command:a,keyBinding:b,bindingOnly:g}:"url"===e&&(this._urlBindings[a.id]={command:a,urlBinding:b,bindingOnly:g})},_addPendingBinding:function(a,e,b,g){this._pendingBindings[a]=this._pendingBindings[a]||[];
this._pendingBindings[a].push({type:e,binding:b,bindingOnly:g})},_checkForTrailingSeparator:function(a,e,b){var g;if("tool"===e||"button"===e)if((g=0<a.childNodes.length?a.childNodes[a.childNodes.length-1]:null)&&g.classList.contains("commandSeparator"))return b?(a.removeChild(g),!1):!0;if("menu"===e&&(a=f.$$array("li \x3e *",a),0<a.length&&a[a.length-1].classList.contains("dropdownSeparator")))if(g=a[a.length-1],b)g.parentNode.parentNode.removeChild(g.parentNode);else return!0;return!1},renderCommands:function(a,
e,b,g,n,d,s){if("string"!==typeof a)throw"a scope id for rendering must be specified";e=f.node(e);if(!e)throw"no parent";var m=this._contributionsByScopeId[a];if(!b&&m){b=m.localSelectionService||this._selectionService;var k=this;b&&b.getSelections(function(b){k.renderCommands(a,e,b,g,n,d)})}else m&&(this._render(m,e,b,g,n||"button",d,s),this._checkForTrailingSeparator(e,n,!0))},destroy:function(a){a=f.node(a);if(!a)throw"no parent";for(;a.hasChildNodes();){var e=a.firstChild;e.commandTooltip&&e.commandTooltip.destroy();
e.emptyGroupTooltip&&e.emptyGroupTooltip.destroy();this.destroy(e);a.removeChild(e)}},_render:function(a,e,g,n,d,s,f,m){m=a.sortedContributions;if(!m){m=[];var k=!1,p;for(p in a)if(Object.prototype.hasOwnProperty.call(a,p)){var q=a[p];q&&"number"===typeof q.position&&(q.id=p,m.push(q),k=!0)}k&&(m.sort(function(q,a){return q.position-a.position}),a.sortedContributions=m)}var w=0,x=this;m.forEach(function(q){var a,c;q.imageClass||(q.imageClass=null);if(q.children&&0<Object.getOwnPropertyNames(q.children).length)if(a=
q.children,"tool"===d||"button"===d)if(q.title){var m;q.defaultActionId&&(q.pretendDefaultActionId=!0===q.defaultActionId,(a=x._commandList[q.defaultActionId])&&(a.visibleWhen?a.visibleWhen(g):1)?(m=new l.CommandInvocation(n,g,s,a,x),m.domParent=e):q.pretendDefaultActionId=!0);a=x._createDropdownMenu(e,q.title,null,null,q.imageClass,q.tooltip,q.selectionClass,null,m,q.pretendDefaultActionId,q.extraClasses);f&&r.generateNavGrid(f,a.menuButton);a&&(x._render(q.children,a.menu,g,n,"menu",s,f),x._checkForTrailingSeparator(a.menu,
"menu",!0),0===a.menu.childNodes.length?q.emptyGroupMessage?a.menuButton.emptyGroupTooltip||(a.menuButton.emptyGroupTooltip=new b.Tooltip({node:a.menuButton,text:q.emptyGroupMessage,trigger:"click",position:["below","right","above","left"]})):(f&&r.removeNavGrid(f,a.menuButton),q=function(q){q&&q.parentNode&&q.parentNode.removeChild(q)},q(a.menu),q(a.menuButton),q(a.destroyButton)):a.menuButton.style.visibility="visible")}else{var k;0<e.childNodes.length&&!x._checkForTrailingSeparator(e,d)&&(k=x.generateSeparatorImage(e));
x._render(a,e,g,n,d,s,f);0<e.childNodes.length&&e.childNodes[e.childNodes.length-1]!==k&&(k=x.generateSeparatorImage(e))}else if(q.title){if(q=x._createDropdownMenu(e,q.title,!0,null,null,q.imageClass))x._render(a,q.menu,g,n,"menu",s,f),x._checkForTrailingSeparator(q.menu,"menu",!0),0===q.menu.childNodes.length&&q.destroyButton&&e.removeChild(q.destroyButton)}else 0<e.childNodes.length&&x._generateMenuSeparator(e),x._render(a,e,g,n,d,s,f),0<e.childNodes.length&&x._generateMenuSeparator(e);else{var p=
x._commandList[q.id];m=p?!0:!1;k=a=null;if(p){c=new l.CommandInvocation(q.handler||n,g,s,p,x);c.domParent=e;q=!1;try{q=m&&(p.visibleWhen?p.visibleWhen(g,c):!0)}catch(D){throw console.log(D),D;}x._activeBindings[p.id]&&x._activeBindings[p.id].keyBinding&&(a=x._activeBindings[p.id],a.invocation=q?c:null,a.bindingOnly&&(m=!1));x._urlBindings[p.id]&&x._urlBindings[p.id].urlBinding&&(k=x._urlBindings[p.id],k.invocation=q?c:null,k.bindingOnly&&(m=!1));m=m&&q}m&&(p.choiceCallback?("tool"===d||"button"===
d?(q=e,a=!1,"ul"===e.nodeName.toLowerCase()&&(q=document.createElement("li"),e.appendChild(q))):(q=e,a=!0),x._createDropdownMenu(q,p.name,a,function(q){p.populateChoicesMenu(q,g,n,s,x)}.bind(p),p.imageClass,p.tooltip||p.title,p.selectionClass,p.positioningNode)):(c.handler=c.handler||this,c.domParent=e,q=function(q){x._invoke(c)},"menu"===d?(m=null,a&&a.keyBinding&&(m=h.getUserKeyString(a.keyBinding)),q=l.createCommandMenuItem(e,p,c,null,q,m)):"quickfix"===d?(a=d+p.id+w,m=document.createElement("div"),
e.appendChild(m),q=l.createCommandItem(m,p,c,a,null,"button"===d,q)):(a=d+p.id+w,q=l.createCommandItem(e,p,c,a,null,"tool"===d,q)),r.generateNavGrid(f,q),c.domNode=q,w++))}})},_createDropdownMenu:function(a,e,g,n,s,m,h,p,r,C,q){a=f.node(a);if(!a||!f.contains(document.body,a))return null;var w,x,F=a;if(g)x=document.createRange(),x.selectNode(a),x=x.createContextualFragment(k),f.processTextNodes(x,{ButtonText:e}),a.appendChild(x),x=a.lastChild,s=x.lastChild,e=s.previousSibling,e.dropdown=new d.Dropdown({dropdown:s,
populate:n,parentDropdown:a.dropdown}),s.dropdown=e.dropdown;else{"ul"===a.nodeName.toLowerCase()&&(F=document.createElement("li"),a.appendChild(F),x=F);a=null;s&&(a="dropdownButtonWithIcon",m=m||e);m=s?m||e:m;var J=l.createDropdownMenu(F,e,n,a,s,!1,h,p,r||C,q);w=J.dropdownArrow;e=J.menuButton;if(w){r&&(r.domNode=J.menuButton);var M=this;e.onclick=function(q){var a=f.bounds(w);(q.clientX>=a.left||!0===C)&&J.dropdown?J.dropdown.toggle(q):M._invoke(r)};J.dropdown&&(e.onkeydown=function(q){f.KEY.DOWN===
q.keyCode&&(J.dropdown.toggle(q),f.stop(q))})}s=J.menu;if(n=r&&r.command&&(r.command.tooltip||r.command.name)?r.command.tooltip||r.command.name:m)e.commandTooltip=new b.Tooltip({node:e,text:n,position:["above","below","right","left"]})}return{menuButton:e,menu:s,dropdown:e.dropdown,destroyButton:x,dropdownArrow:w}},_generateMenuSeparator:function(a){if(!this._checkForTrailingSeparator(a,"menu")){var e=document.createElement("li");e.classList.add("dropdownSeparator");var b=document.createElement("span");
b.classList.add("dropdownSeparator");e.appendChild(b);a.appendChild(e)}},generateSeparatorImage:function(a){var e;e="ul"===a.nodeName.toLowerCase()?document.createElement("li"):document.createElement("span");a.appendChild(e);e.classList.add("core-sprite-sep");e.classList.add("imageSprite");e.classList.add("commandSeparator");return e}};g.prototype.constructor=g;a.prototype={match:function(a){a=p.matchResourceParameters(a);return"undefined"!==typeof a[this.token]?(this.parameterValue=a[this.token],
this):null}};a.prototype.constructor=a;s.prototype.constructor=s;e.prototype={optionsRequested:function(){return this.optionsRequested}};e.prototype.constructor=e;n.prototype={_storeParameters:function(a){this.parameterTable=null;if(a){var e=this.parameterTable={};a.forEach(function(a){e[a.name]=a})}},updateParameters:function(a){"function"===typeof this.getParameters&&this._storeParameters(this.getParameters(a))},hasParameters:function(){return null!==this.parameterTable},shouldCollectParameters:function(){return!this.clientCollect&&
this.hasParameters()},parameterNamed:function(a){return this.parameterTable[a]},valueFor:function(a){return(a=this.parameterTable[a])?a.value:null},setValue:function(a,e){var b=this.parameterTable[a];b&&(b.value=e)},forEach:function(a){for(var e in this.parameterTable)this.parameterTable[e].type&&this.parameterTable[e].name&&a(this.parameterTable[e])},validate:function(a,e){var b=this.parameterTable[a];return b&&b.validator?b.validator(e):!0},makeCopy:function(){var a=[];this.forEach(function(b){b=
new e(b.name,b.type,b.label,b.value,b.lines,b.eventListeners,b.validator);a.push(b)});var b=new n(a,this._options,this.getParameters);b.clientCollect=this.clientCollect;b.message=this.message;return b},hasOptionalParameters:function(){return this._hasOptionalParameters}};n.prototype.constructor=n;return{CommandRegistry:g,URLBinding:a,ParametersDescription:n,CommandParameter:e,CommandEventListener:s}});y("orion/edit/nls/messages",{root:!0});y("orion/edit/nls/root/messages",{Editor:"Editor",switchEditor:"Switch Editor",
Fetching:"Fetching: ${0}",confirmUnsavedChanges:"There are unsaved changes. Do you still want to navigate away?",searchFiles:"Quick Search...",searchTerm:"Enter search term:",unsavedChanges:"There are unsaved changes.",unsavedAutoSaveChanges:"Please stay on the page until Auto Save is complete.",Save:"Save",Saved:"Saved",Blame:"Blame",BlameTooltip:"Show blame annotations",Diff:"Diff",DiffTooltip:"Show diff annotations",saveOutOfSync:"Resource is out of sync with the server. Do you want to save it anyway?",
loadOutOfSync:"Resource is out of sync with the server. Do you want to load it anyway? This will overwrite your local changes.",ReadingMetadata:"Reading metadata of ${0}",ReadingMetadataError:"Cannot get metadata of ${0}",Reading:"Reading ${0}",readonly:"Read Only.",saveFile:"Save this file",toggleZoomRuler:"Toggle Zoom Ruler",gotoLine:"Go to line...",gotoLineTooltip:"Go to specified line number",gotoLinePrompt:"Go to line:",Undo:"Undo",Redo:"Redo",Find:"Find...",noResponse:"No response from server. Check your internet connection and try again.",
savingFile:"Saving file ${0}",running:"Running ${0}","Saving...":"Saving...",View:"View",SplitSinglePage:"Single Page",SplitVertical:"Split Vertical",SplitHorizontal:"Split Horizontal",SplitPipInPip:"Picture in Picture",SplitModeTooltip:"Change split editor mode",SidePanel:"Side Panel",SidePanelTooltip:"Choose what to show in the side panel.",Slideout:"Slideout",Actions:"Actions",Navigator:"Navigator",FolderNavigator:"Folder Navigator",Project:"Project",New:"New",File:"File",Edit:"Edit",Tools:"Tools",
Add:"Add",noActions:"There are no actions for the current selection.",NoFile:"Use the ${0} to create new files and folders. Click a file to start coding.",LocalEditorSettings:"Local Editor Settings",NoProject:"${0} is not a project. To convert it to a project use ${1}.",NoProjects:"There are no projects in your workspace. Use the ${0} menu to create projects.",Disconnected:"${0} (disconnected)",ChooseFS:"Choose Filesystem",ChooseFSTooltip:"Choose the filesystem you want to view.",FSTitle:"${0} (${1})",
Deploy:"Deploy","Deploy As":"Deploy As",Import:"Import",Export:"Export",OpenWith:"Open with",OpenRelated:"Open related",Dependency:"Dependency",UnnamedCommand:"Unnamed",searchInFolder:"Search in folder...","Global Search":"Global Search...",ClickEditLabel:"Click to edit",ProjectInfo:"Project Information",Name:"Name",Description:"Description",Site:"Site",projectsSectionTitle:"Projects",listingProjects:"Listing projects...",gettingWorkspaceInfo:"Getting workspace information...",showProblems:"Show problems...",
showTooltip:"Show Tooltip",showTooltipTooltip:"Shows the tooltip immediately based on the caret position",emptyDeploymentInfoMessage:"Use the Launch Configurations dropdown to deploy this project"});y("orion/explorers/navigatorRenderer",[],function(){return{getClickedItem:function(){return null}}});y("orion/objects",[],function(){function l(l){for(var p=Object.prototype.hasOwnProperty,h=1,f=arguments.length;h<f;h++){var d=arguments[h],b;for(b in d)p.call(d,b)&&(l[b]=d[b])}return l}return{clone:function(r){if(Array.isArray(r))return Array.prototype.slice.call(r);
var p=Object.create(Object.getPrototypeOf(r));l(p,r);return p},mixin:l,toArray:function(l){return Array.isArray(l)?l:[l]}}});y("orion/inputManager","i18n!orion/edit/nls/messages orion/explorers/navigatorRenderer orion/i18nUtil orion/Deferred orion/EventTarget orion/objects orion/PageUtil orion/metrics".split(" "),function(l,r,p,h,f,d,b,k){function m(a){this._document=a.document||document;this._timeout=a.timeout;a=["mousedown","keypress","keydown","keyup"];for(var e=function(a){this._resetTimer()}.bind(this),
b=0;b<a.length;b++)this._document.addEventListener(a[b],e,!0);f.attach(this)}function g(a,e){if(a){if(!e.Severity){var b=e,c={Severity:"Error",Message:l.noResponse};if("Cancel"===b.name)e={Severity:"Warning",Message:b.name,Cancel:!0};else{if(0===b.status)c.Cancel=!0;else if(b.responseText){b=b.responseText;try{var g=JSON.parse(b);c.Severity=g.Severity||c.Severity;c.Message=g.Message||c.Message}catch(d){c.Message=b}}else try{c.Message=JSON.stringify(b)}catch(f){}e=c}}a.setProgressResult(e);return e}window.console.log(e)}
function a(a){f.attach(this);this.serviceRegistry=a.serviceRegistry;this.statusService=a.statusService;this.fileClient=a.fileClient;this.progressService=a.progressService;this.contentTypeRegistry=a.contentTypeRegistry;this.selection=a.selection;this._input=this._title=""}m.prototype={_resetTimer:function(){var a=this._document.defaultView||this._document.parentWindow;this._timer&&(a.clearTimeout(this._timer),this._timer=null);-1!==this._timeout&&(this._timer=a.setTimeout(function(){this.onIdle({type:"Idle"});
this._timer=null;this._resetTimer()}.bind(this),this._timeout))},onIdle:function(a){return this.dispatchEvent(a)},setTimeout:function(a){this._timeout=a;this._resetTimer()}};d.mixin(a.prototype,{_maybeLoadWorkspace:function(a){var e=this.fileClient,b=a;b.indexOf("?")&&(b=b.split("?")[0]);return b===e.fileServiceRootURL(b)?e.loadWorkspace(b).then(function(a){return a.Location}):(new h).resolve(a)},_read:function(a){var e=this.cachedMetadata||r.getClickedItem();if(e&&e.Location===a&&e.Parents&&e.Attributes&&
e.ETag)return(new h).resolve(e);var b=this.fileClient,c=Array.prototype.slice.call(arguments,1);return this._maybeLoadWorkspace(a).then(function(a){return b.read.apply(b,[a].concat(c))})},_isSameParent:function(a){return this._lastMetadata&&this._lastMetadata.Parents&&0<this._lastMetadata.Parents.length?(a=a.substring(0,a.lastIndexOf("/",a.length-("/"===a[a.length-1]?2:1))+1),this._lastMetadata.Parents[0].Location===a):!1},load:function(){var a=this.getInput();if(a){var e=this.fileClient,b=this._parsedLocation.resource,
c=this.progressService,u=function(a,e,b){return!c?a:c.progress(a,p.formatMessage(e,b))},t=this.getEditor();if(this._fileMetadata)!this._fileMetadata._saving&&(!this._fileMetadata.Directory&&!this.getReadOnly())&&u(e.read(b,!0),l.ReadingMetadata,a).then(function(c){this._fileMetadata&&(this._fileMetadata.Location===c.Location&&this._fileMetadata.ETag!==c.ETag)&&(this._fileMetadata=d.mixin(this._fileMetadata,c),(!t.isDirty()||window.confirm(l.loadOutOfSync))&&u(e.read(b),l.Reading,a).then(function(c){t.setInput(a,
null,c);this._clearUnsavedChanges()}.bind(this)))}.bind(this));else{var f=window.setTimeout(function(){f=null;this.reportStatus(p.formatMessage(l.Fetching,a))}.bind(this),800),m=function(){this.reportStatus("");f&&window.clearTimeout(f)}.bind(this),k=function(a){m();var c=null;this.serviceRegistry?c=this.serviceRegistry.getService("orion.page.message"):this.statusService&&(c=this.statusService);g(c,a);this._setNoInput()}.bind(this);this._acceptPatch=null;var z=b;this._isSameParent(z)||(z=new URL(z),
z.query.set("tree",localStorage.useCompressedTree?"compressed":"decorated"),z=z.href);u(this._read(z,!0),l.ReadingMetadata,b).then(function(c){c?c.Directory?h.when(c.Children||u(e.fetchChildren(c.ChildrenLocation),l.Reading,a),function(e){m();c.Children=e;this._setInputContents(this._parsedLocation,a,e,c)}.bind(this),k):this._isText(c)?u(e.read(b,!1,!0),l.Reading,a).then(function(e){m();"string"!==typeof e&&(this._acceptPatch=e.acceptPatch,e=e.result);this._setInputContents(this._parsedLocation,a,
e,c)}.bind(this),k):u(e._getService(b).readBlob(b),l.Reading,a).then(function(e){m();this._setInputContents(this._parsedLocation,a,e,c)}.bind(this),k):k({responseText:p.formatMessage(l.ReadingMetadataError,b)})}.bind(this),k)}}},processParameters:function(a){var e=this.getEditor();return e&&e.processParameters?e.processParameters(a):!1},getAutoLoadEnabled:function(){return this._autoLoadEnabled},getAutoSaveEnabled:function(){return this._autoSaveEnabled},getEditor:function(){return this.editor},getInput:function(){return this._input},
getLocation:function(){return this._location},getTitle:function(){return this._title},getFileMetadata:function(){return this._fileMetadata},isSaveEnabled:function(){return!this.getReadOnly()},getReadOnly:function(){var a=this._fileMetadata;return this._readonly||!a||a.Attributes&&a.Attributes.ReadOnly},getContentType:function(){return this._contentType},onFocus:function(a){this._autoSaveEnabled&&this._errorSaving?this.save():this._autoLoadEnabled&&this._fileMetadata&&this.load()},reportStatus:function(a){this.statusReporter?
this.statusReporter(a):this.editor&&this.editor.reportStatus(a)},save:function(a){function e(a){var q=d._savingDeferred;q.resolve(a);d._savingDeferred=null;d._saving=!1;return q}function b(q){E===t.getInput()&&(d.ETag=q.ETag,f.setInput(E,null,z,!0));t.reportStatus("");m&&F&&F.setProgressResult({Message:l.Saved,Severity:"Normal"});t.postSave&&t.postSave(a);return e(q)}function c(a){t.reportStatus("");a=g(F,a);k.logEvent("status","exception",(t._autoSaveActive?"Auto-save: ":"Save: ")+a.Message);t._errorSaving=
!0;return e()}var d=this.getFileMetadata();if(!d)return(new h).reject();if(d._saving)return d._savingDeferred;var t=this;d._savingDeferred=new h;d._saving=!0;var f=this.getEditor();if(!f||!f.isDirty()||this.getReadOnly())return e();var m=this._errorSaving,E=this.getInput();this.reportStatus(l["Saving..."]);this._saveEventLogged||(this._logMetrics("save"),this._saveEventLogged=!0);this.dispatchEvent({type:"Saving",inputManager:this});f.markClean();var z=f.getText(),r=z;if(this._getSaveDiffsEnabled()&&
!this._errorSaving){var B=this._getUnsavedChanges();if(B){for(var C=0,q=0;q<B.length;q++)C+=B[q].text.length;z.length>C&&(r={diff:B})}}this._clearUnsavedChanges();this._errorSaving=!1;var w=this._parsedLocation.resource,r=this.fileClient.write(w,r,{ETag:d.ETag}),x=this.progressService,F=null;this.serviceRegistry&&(F=this.serviceRegistry.getService("orion.page.message"));x&&(r=x.progress(r,p.formatMessage(l.savingFile,E)));r.then(b,function(a){if(412===a.status)if(window.confirm(l.saveOutOfSync))a=
t.fileClient.write(w,z),x&&(a=x.progress(a,p.formatMessage(l.savingFile,E))),a.then(b,c);else return e();else c(a)});return d._savingDeferred},setAutoLoadEnabled:function(a){this._autoLoadEnabled=a},setAutoSaveTimeout:function(a){this._autoSaveEnabled=-1!==a;this._autoSaveActive=!1;this._idle?this._idle.setTimeout(a):(this._idle=new m({document:document,timeout:a}),this._idle.addEventListener("Idle",function(){this._errorSaving||(this._autoSaveActive=!0,this.save().then(function(){this._autoSaveActive=
!1}))}.bind(this)))},setContentType:function(a){this._contentType=a},setInput:function(a){if(!this._ignoreInput&&(a||(a=b.hash()),"string"===typeof a)){var e=this.getEditor();a&&"#"!==a[0]&&(a="#"+a);var g=b.matchResourceParameters(a),c=this._parsedLocation||{};if(e&&e.isDirty()){var d=this._location;if(c.resource!==g.resource)if(this._autoSaveEnabled)this.save();else if(!window.confirm(l.confirmUnsavedChanges)){window.location.hash=d;return}}e=e&&c.editor!==g.editor;this._location=a;this._parsedLocation=
g;this._ignoreInput=!0;this.selection&&this.selection.setSelections(a);this._ignoreInput=!1;a={type:"InputChanging",input:g};this.dispatchEvent(a);c=g.resource;a.metadata?(this.reportStatus(""),this._input=c,this._setInputContents(g,c,null,a.metadata)):c?c===this._input?e?(this.reportStatus(""),this._setInputContents(g,c,null,this._fileMetadata,this._isText(this._fileMetadata))):this.processParameters(g):(this._input=c,this._readonly=!1,this._lastMetadata=this._fileMetadata,this._fileMetadata=null,
this.load()):this._setNoInput(!0)}},setTitle:function(a){var e=a.lastIndexOf("/");-1!==e&&(a=a.substring(e+1));this._title=a},setSaveDiffsEnabled:function(a){this._saveDiffsEnabled=a;(a=this.editor)&&!a.isDirty()&&this._clearUnsavedChanges()},_getSaveDiffsEnabled:function(){return this._saveDiffsEnabled&&this._acceptPatch&&-1!==this._acceptPatch.indexOf("application/json-patch")},_logMetrics:function(a){var e="(none)",b=this.getContentType(),c=this.getFileMetadata();if(b)e=b.id;else if(c)if(b=c.Name,
c=b.lastIndexOf("."),0<=c)e="unregistered: "+b.substring(c);else switch(b){case "AUTHORS":case "config":case "LICENSE":case "make":case "Makefile":e="unregistered: "+b}k.logEvent("editor",a,e)},_unknownContentTypeAsText:function(){return!0},_isText:function(a){a=this.contentTypeRegistry.getFileContentType(a);if(!a)return this._unknownContentTypeAsText();var e=this.contentTypeRegistry.getContentType("text/plain");return this.contentTypeRegistry.isExtensionOf(a,e)},_setNoInput:function(a){a?this.fileClient.loadWorkspace("").then(function(a){this._input=
a.ChildrenLocation;this._setInputContents(a.ChildrenLocation,null,a,a)}.bind(this)):(this._input=this._title=this._fileMetadata=null,this.setContentType(null),this.dispatchEvent({type:"InputChanged",input:null}))},_setInputContents:function(a,e,b,c,g){var d,f=!1;c?(this._fileMetadata=c,this.setTitle(c.Location||String(c)),this.setContentType(this.contentTypeRegistry.getFileContentType(c)),d=c.Name,f=c.Directory):(this._fileMetadata=null,this.setTitle(e),this.setContentType(this.contentTypeRegistry.getFilenameContentType(this.getTitle())),
d=this.getTitle());var m=this.getEditor();this._focusListener&&(m&&(m.getTextView&&m.getTextView())&&m.getTextView().removeEventListener("Focus",this._focusListener),this._focusListener=null);c={type:"InputChanged",input:a,name:d,title:e,contentType:this.getContentType(),metadata:c,location:window.location,contents:b};this._logMetrics("open");this.dispatchEvent(c);this.editor=m=c.editor;f||(g||m.setInput(e,null,b),m&&(m.getTextView&&m.getTextView())&&m.getTextView().addEventListener("Focus",this._focusListener=
this.onFocus.bind(this)),this._clearUnsavedChanges(),this.processParameters(a)||c.session&&c.session.apply());this._saveEventLogged=!1;k.logPageLoadTiming("interactive",window.location.pathname)},_getUnsavedChanges:function(){var a=this.editor;return a&&a.getUndoStack&&a.getUndoStack()?a.getUndoStack()._unsavedChanges:null},_clearUnsavedChanges:function(){var a=this.editor;a&&(a.getUndoStack&&a.getUndoStack())&&(a.getUndoStack()._unsavedChanges=this._getSaveDiffsEnabled()?[]:null)}});return{handleError:g,
InputManager:a}});y("orion/navigate/nls/messages",{root:!0});y("orion/navigate/nls/root/messages",{Navigator:"Navigator","Strings Xtrnalizr":"Strings Xtrnalizr","Externalize strings":"Externalize strings from JavaScript files in this folder.",NotSupportFileSystem:"${0} is not supported in this file system",SrcNotSupportBinRead:"Source file service does not support binary read",TargetNotSupportBinWrite:"Target file service does not support binary write",NoFileSrv:"No matching file service for location: ${0}",
"Choose a Folder":"Choose a Folder","Copy of ${0}":"Copy of ${0}",EnterName:"Enter a new name for '${0}'",ChooseFolder:"Choose folder...",Rename:"Rename",RenameFilesFolders:"Rename the selected files or folders",CompareEach:"Compare with each other","Compare 2 files":"Compare the selected 2 files with each other","Compare with...":"Compare with...",CompareFolders:"Compare the selected folder with a specified folder",Delete:"Delete","Unknown item":"Unknown item","delete item msg":"Are you sure you want to delete these ${0} items?",
DeleteTrg:"Are you sure you want to delete '${0}'?",Zip:"Zip",ZipDL:"Create a zip file of the folder contents and download it","New File":"File","Create a new file":"Create a new file",FailedToCreateProject:"Failed to create project: ${0}",FailedToCreateFile:"Failed to create file: ${0}",CopyFailed:"Copy operation failed",MoveFailed:"Move operation failed","Name:":"Name:","New Folder":"Folder","Folder name:":"Folder name:","Create a new folder":"Create a new folder","Creating folder":"Creating folder",
Folder:"Folder","Create an empty folder":"Create an empty folder",CreateEmptyMsg:"Create an empty folder on the Orion server. You can import, upload, or create content in the editor.","Sample HTML5 Site":"Sample HTML5 Site","Generate a sample":"Generate a sample",'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.':'Generate an HTML5 "Hello World" website, including JavaScript, HTML, and CSS files.',"Creating a folder for ${0}":"Creating a folder for ${0}","SFTP Import":"SFTP Import",
"Import content from SFTP":"Import content from SFTP","Imported Content":"Imported Content","Upload a Zip":"Upload a Zip","Upload content from a local zip file":"Upload content from a local zip file","Uploaded Content":"Uploaded Content","Clone Git Repository":"Clone Git Repository","Clone a git repository":"Clone a git repository","Link to Server":"Link to Server",LinkContent:"Link to existing content on the server",CreateLinkedFolder:"Create a folder that links to an existing folder on the server.",
"Server path:":"Server path:",NameLocationNotClear:"The name and server location were not specified.","Go Up":"Go Up",GoUpToParent:"Move up to the parent folder","Go Into":"Go Into",GoSelectedFolder:"Move into the selected folder","File or zip archive":"File or zip archive",ImportLcFile:"Import a file or zip archive from your local file system","SFTP from...":"SFTP",CpyFrmSftp:"Copy files and folders from a specified SFTP connection","Importing from ${0}":"Importing from ${0}","SFTP to...":"SFTP",
CpyToSftp:"Copy files and folders to a specified SFTP location",Exporting:"Exporting to ${0}","Pasting ${0}":"Pasting ${0}","Copy to":"Copy to","Move to":"Move to","Copying ${0}":"Copying ${0}","Moving ${0}":"Moving ${0}","Renaming ${0}":"Renaming ${0}","Deleting ${0}":"Deleting ${0}","Creating ${0}":"Creating ${0}","Linking to ${0}":"Linking to ${0}",MvToLocation:"Move files and folders to a new location",Cut:"Cut",Copy:"Copy","Fetching children of ":"Fetching children of ",Paste:"Paste","Open With":"Open With",
"Loading ":"Loading ",New:"New",File:"File",Actions:"Actions","Orion Content":"Orion Content","Create new content":"Create new content","Import from HTTP...":"HTTP","File URL:":"File URL:",ImportURL:"Import a file from a URL and optionally unzip it","Unzip *.zip files:":"Unzip *.zip files:","Extracted from:":"Extracted from:",FolderDropNotSupported:"Did not drop ${0}. Folder drop is not supported in this browser.",CreateFolderErr:"You cannot copy files directly into the workspace. Create a folder first.",
"Unzip ${0}?":"Unzip ${0}?","Upload progress: ":"Upload progress: ","Uploading ":"Uploading ","Cancel upload":"Cancel upload",UploadingFileErr:"Uploading the following file failed: ","Enter project name:":"Enter project name:","Create new project":"Create new project","Creating project ${0}":"Creating project ${0}",NoFile:"Use the ${0} menu to create new files and folders. Click a file to start coding.",Download:"Download",Download_tooltips:"Download the file contents as the displayed name","Downloading...":"Reading file contents...",
"Download not supported":"Contents download is not supported in this browser.",gettingContentFrom:"Getting content from ",confirmLaunchDelete:'Delete Launch Configuration "${0}" ?',deletingLaunchConfiguration:"Deleting launch configuration...",deployTo:"Deploy to ",deploy:"Deploy ",connect:"Connect",fetchContent:"Fetch content",fetchContentOf:"Fetch content of ",disconnectFromProject:"Disconnect from project",doNotTreatThisFolder:"Do not treat this folder as a part of the project",checkStatus:"Check status",
checkApplicationStatus:"Check application status",checkApplicationState:"Check application state",stop:"Stop",start:"Start",stopApplication:"Stop the application",startApplication:"Start the application",manage:"Manage",manageThisApplicationOnRemote:"Manage this application on remote server",deleteLaunchConfiguration:"Delete this launch configuration",editLaunchConfiguration:"Edit this launch configuration",deployThisApplication:"Deploy the application using the workspace contents",associatedFolder:"Associated Folder",
associateAFolderFromThe:"Associate a folder from the workspace with this project.",convertToProject:"Convert to project",convertThisFolderIntoA:"Convert this folder into a project",thisFolderIsAProject:"This folder is a project already.",basic:"Basic","createAnEmptyProject.":"Create an empty project.",sFTP:"SFTP",createAProjectFromAn:"Create a project from an SFTP site.",readMeCommandName:"Readme File",readMeCommandTooltip:"Create a README.md file in this project",zipArchiveCommandName:"Zip archive",
zipArchiveCommandTooltip:"Create a project from a local zip archive.","Url:":"Url:",notZip:"The following files are not zip files: ${0}. Would you like to continue the import?",notZipMultiple:"There are multiple non-zip files being uploaded. Would you like to continue the import?",Cancel:"Cancel",Ok:"Ok",missingCredentials:"Enter the ${0} authentication credentials associated with ${1} to check its status.",deploying:"deploying",starting:"restarting",stopping:"stopping",checkingStateShortMessage:"checking status"});
y("orion/fileClient",["i18n!orion/navigate/nls/messages","orion/Deferred","orion/i18nUtil"],function(l,r,p){function h(b,d,f){if(!b[d])throw Error(p.formatMessage(l.NotSupportFileSystem,d));return b[d].apply(b,f)}function f(b,d,m,g){if(!b.readBlob)throw Error(l.SrcNotSupportBinRead);if(!m.writeBlob)throw Error(l.TargetNotSupportBinWrite);if("/"!==d[d.length-1])return h(b,"readBlob",[d]).then(function(a){return h(m,"writeBlob",[g,a])});var a=g.substring(0,g.length-1),s=decodeURIComponent(a.substring(a.lastIndexOf("/")+
1)),a=a.substring(0,a.lastIndexOf("/")+1);return h(m,"createFolder",[a,s]).then(function(){},function(){}).then(function(){return h(b,"fetchChildren",[d]).then(function(a){for(var d=[],c=0;c<a.length;++c){var u=a[c].Location,t=u;a[c].Directory&&(t=u.substring(0,u.length-1));t=decodeURIComponent(t.substring(t.lastIndexOf("/")+1));t=g+encodeURIComponent(t);a[c].Directory&&(t+="/");d[c]=f(b,u,m,t)}return r.all(d)})})}function d(b,d){function f(a){var c=new r;c.reject(l["No Matching FileService for location:"]+
a);return c}var g=b.getServiceReferences("orion.core.file"),a=g;if(d)for(var a=[],s=0;s<g.length;++s)d(g[s])&&a.push(g[s]);a.sort(function(a,c){var e=a.getProperty("ranking")||0,b=c.getProperty("ranking")||0;return e-b});for(var e=[],n=[],c=[],u=[],t={fetchChildren:function(){var a=new r;a.resolve(u);return a},createWorkspace:function(){var a=new r;a.reject(l["no file service"]);return a},loadWorkspaces:function(){var a=new r;a.reject(l["no file service"]);return a},loadWorkspace:function(a){var c=
new r;window.setTimeout(function(){c.resolve({Directory:!0,Length:0,LocalTimeStamp:0,Name:l["File Servers"],Location:"/",Children:u,ChildrenLocation:"/"})},100);return c},search:f,createProject:f,createFolder:f,createFile:f,deleteFile:f,moveFile:f,copyFile:f,read:f,write:f},g=0;g<a.length;++g){u[g]={Directory:!0,Length:0,LocalTimeStamp:0,Location:a[g].getProperty("top"),ChildrenLocation:a[g].getProperty("top"),Name:a[g].getProperty("Name")||a[g].getProperty("NameKey")};s=a[g].getProperty("pattern")||
a[g].getProperty("top").replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");Array.isArray(s)||(s=[s]);for(var v=[],h=0;h<s.length;h++){var E=s[h];"^"!==E[0]&&(E="^"+E);v.push(RegExp(E))}e[g]=v;n[g]=b.getService(a[g]);c[g]=a[g].getProperty("Name")||a[g].getProperty("NameKey")}this._getServiceIndex=function(a){if("/"===a)return-1;if(!a||a.length&&0===a.length)return n[0]?0:-1;for(var c=0;c<e.length;++c)for(var b=0;b<e[c].length;b++)if(e[c][b].test(a))return c;throw Error(p.formatMessage(l.NoFileSrv,a));};
this._getService=function(a){a=this._getServiceIndex(a);return-1===a?t:n[a]};this._getServiceName=function(a){a=this._getServiceIndex(a);return-1===a?t.Name:c[a]};this._getServiceRootURL=function(a){a=this._getServiceIndex(a);return-1===a?t.Location:u[a].Location}}d.prototype={getService:function(b){return this._getService(b)},fileServiceName:function(b){return this._getServiceName(b)},fileServiceRootURL:function(b){return this._getServiceRootURL(b)},fetchChildren:function(b){return h(this._getService(b),
"fetchChildren",arguments)},createWorkspace:function(b){return h(this._getService(),"createWorkspace",arguments)},loadWorkspaces:function(){return h(this._getService(),"loadWorkspaces",arguments)},loadWorkspace:function(b){return h(this._getService(b),"loadWorkspace",arguments)},createProject:function(b,d,f,g){return h(this._getService(b),"createProject",arguments)},createFolder:function(b,d){return h(this._getService(b),"createFolder",arguments)},createFile:function(b,d){return h(this._getService(b),
"createFile",arguments)},deleteFile:function(b){return h(this._getService(b),"deleteFile",arguments)},moveFile:function(b,d,m){var g=this._getService(b),a=this._getService(d);if(g===a)return h(g,"moveFile",arguments);var s="/"===b[b.length-1],e=d;"/"!==e[e.length-1]&&(e+="/");if(m)e+=encodeURIComponent(m);else{var n=b;s&&(n=n.substring(0,n.length-1));e+=n.substring(n.lastIndexOf("/")+1)}s&&"/"!==e[e.length-1]&&(e+="/");return f(g,b,a,e).then(function(){return h(g,"deleteFile",[b])})},copyFile:function(b,
d,m){var g=this._getService(b),a=this._getService(d);if(g===a)return h(g,"copyFile",arguments);var s="/"===b[b.length-1],e=d;"/"!==e[e.length-1]&&(e+="/");if(m)e+=encodeURIComponent(m);else{var n=b;s&&(n=n.substring(0,n.length-1));e+=n.substring(n.lastIndexOf("/")+1)}s&&"/"!==e[e.length-1]&&(e+="/");return f(g,b,a,e)},read:function(b,d){return h(this._getService(b),"read",arguments)},readBlob:function(b){return h(this._getService(b),"readBlob",arguments)},write:function(b,d,f){return h(this._getService(b),
"write",arguments)},remoteImport:function(b,d){return h(this._getService(b),"remoteImport",arguments)},remoteExport:function(b,d){return h(this._getService(b),"remoteExport",arguments)},search:function(b){return h(this._getService(b.resource),"search",arguments)}};d.prototype.constructor=d;return{FileClient:d}});y("orion/contentTypes",[],function(){function l(b,a){if("string"!==typeof b)return null;var d=null,e;e=b.indexOf(".");e++;for(var n=b.substring(e).toLowerCase(),c=0;c<a.length;c++){e=a[c];
if(0<=e.filename.indexOf(b)){d=e;break}-1!==e.extension.indexOf(n)&&(d=e)}if(!d)for(e=n.indexOf(".");!d&&0<=e;){e++;n=n.substring(e);for(c=0;c<a.length;c++)if(e=a[c],-1!==e.extension.indexOf(n)){d=e;break}e=n.indexOf(".")}return d}function r(b){return null===b||"undefined"===typeof b?[]:Array.isArray(b)?b:[b]}function p(b){return r(b).map(function(a){return String.prototype.toLowerCase.call(a)})}function h(b){return{id:b.id,name:b.name,image:b.image,imageClass:b.imageClass,"extends":b["extends"],
extension:p(b.extension),filename:r(b.filename)}}function f(b){var a=Object.create(null);b.map(h).forEach(function(b){Object.prototype.hasOwnProperty.call(a,b.id)||(a[b.id]=b)});return a}function d(g){if(g&&g.registerService){this.serviceRegistry=g;for(var a=g.getServiceReferences(k).concat(g.getServiceReferences(m)),d=[],e=0;e<a.length;e++)for(var n=r(a[e].getProperty("contentTypes")),c=0;c<n.length;c++)d.push(n[c]);this.map=f(d);g.registerService(b,this)}else if(Array.isArray(g))this.serviceRegistry=
null,this.map=f(g);else throw Error("Invalid parameter");}var b="orion.core.contentTypeRegistry",k="orion.core.contenttype",m="orion.file.contenttype";d.prototype={getContentTypes:function(){var b=this.getContentTypesMap(),a=[],d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&a.push(b[d]);return a},getContentTypesMap:function(){return this.map},getFileContentType:function(b){return l(b.Name,this.getContentTypes())},getFilenameContentType:function(b){return l(b,this.getContentTypes())},getContentType:function(b){return this.map[b]||
null},isExtensionOf:function(b,a){b="string"===typeof b?this.getContentType(b):b;a="string"===typeof a?this.getContentType(a):a;if(!b||!a)return!1;if(b.id===a.id)return!0;for(var d=b,e={};d&&(d=this.getContentType(d["extends"]));){if(d.id===a.id)return!0;if(e[d.id])throw Error("Cycle: "+d.id);e[d.id]=!0}return!1},isSomeExtensionOf:function(b,a){for(var d=0;d<a.length;d++)if(this.isExtensionOf(b,a[d]))return!0;return!1}};return{ContentTypeRegistry:d,isImage:function(b){switch(b&&b.id){case "image/jpeg":case "image/png":case "image/gif":case "image/ico":case "image/tiff":case "image/svg":return!0}return!1},
isBinary:function(b){return!b?!1:"application/octet-stream"===b.id||"application/octet-stream"===b["extends"]},getFilenameContentType:l}});y("orion/editor/nls/messages",{root:!0});y("orion/editor/nls/root/messages",{multipleAnnotations:"Multiple annotations:",line:"Line: ${0}",breakpoint:"Breakpoint",bookmark:"Bookmark",task:"Task",error:"Error",warning:"Warning",currentSearch:"Current Search",currentLine:"Current Line",matchingBracket:"Matching Bracket",currentBracket:"Current Bracket",diffAdded:"Diff Added Lines",
diffDeleted:"Diff Deleted Lines",diffModified:"Diff Modified Lines",lineUp:"Line Up",lineDown:"Line Down",lineStart:"Line Start",lineEnd:"Line End",charPrevious:"Previous Character",charNext:"Next Character",pageUp:"Page Up",pageDown:"Page Down",scrollPageUp:"Scroll Page Up",scrollPageDown:"Scroll Page Down",scrollLineUp:"Scroll Line Up",scrollLineDown:"Scroll Line Down",wordPrevious:"Previous Word",wordNext:"Next Word",textStart:"Document Start",textEnd:"Document End",scrollTextStart:"Scroll Document Start",
scrollTextEnd:"Scroll Document End",centerLine:"Center Line",selectLineUp:"Select Line Up",selectLineDown:"Select Line Down",selectWholeLineUp:" Select Whole Line Up",selectWholeLineDown:"Select Whole Line Down",selectLineStart:"Select Line Start",selectLineEnd:"Select Line End",selectCharPrevious:"Select Previous Character",selectCharNext:"Select Next Character",selectPageUp:"Select Page Up",selectPageDown:"Select Page Down",selectWordPrevious:"Select Previous Word",selectWordNext:"Select Next Word",
selectTextStart:"Select Document Start",selectTextEnd:"Select Document End",deletePrevious:"Delete Previous Character",deleteNext:"Delete Next Character",deleteWordPrevious:"Delete Previous Word",deleteWordNext:"Delete Next Word",deleteLineStart:"Delete Line Start",deleteLineEnd:"Delete Line End",tab:"Insert Tab",enter:"Insert Line Delimiter",enterNoCursor:"Insert Line Delimiter",escape:"Escape",selectAll:"Select All",copy:"Copy",cut:"Cut",paste:"Paste",uppercase:"To Upper Case",lowercase:"To Lower Case",
capitalize:"Capitalize",reversecase:"Reverse Case",toggleWrapMode:"Toggle Wrap Mode",toggleTabMode:"Toggle Tab Mode",toggleOverwriteMode:"Toggle Overwrite Mode",committerOnTime:"${0} on ${1}",emacs:"Emacs",exchangeMarkPoint:"Exchange Mark and Point",setMarkCommand:"Set Mark",clearMark:"Clear Mark",digitArgument:"Digit Argument ${0}",negativeArgument:"Negative Argument",Comment:"Comment","Flat outline":"Flat outline",incrementalFindStr:"Incremental find: ${0}",incrementalFindStrNotFound:"Incremental find: ${0} (not found)",
incrementalFindReverseStr:"Reverse Incremental find: ${0}",incrementalFindReverseStrNotFound:"Reverse Incremental find: ${0} (not found)",find:"Find...",undo:"Undo",redo:"Redo",cancelMode:"Cancel Current Mode",findNext:"Find Next Occurrence",findPrevious:"Find Previous Occurrence",incrementalFind:"Incremental Find",incrementalFindReverse:"Incremental Find Reverse",indentLines:"Indent Lines",unindentLines:"Unindent Lines",moveLinesUp:"Move Lines Up",moveLinesDown:"Move Lines Down",copyLinesUp:"Copy Lines Up",
copyLinesDown:"Copy Lines Down",deleteLines:"Delete Lines",gotoLine:"Goto Line...",gotoLinePrompty:"Goto Line:",nextAnnotation:"Next Annotation",prevAnnotation:"Previous Annotation",expand:"Expand",collapse:"Collapse",expandAll:"Expand All",collapseAll:"Collapse All",lastEdit:"Last Edit Location",trimTrailingWhitespaces:"Trim Trailing Whitespaces",toggleLineComment:"Toggle Line Comment",addBlockComment:"Add Block Comment",removeBlockComment:"Remove Block Comment",linkedModeEntered:"Linked Mode: Enter or ESC to exit",
linkedModeExited:"Linked Mode exited",syntaxError:"Syntax Error",contentAssist:"Content Assist",lineColumn:"Line ${0} : Column ${1}",multiSelections:"${0} selection regions",vi:"vi",vimove:"(Move)",viyank:"(Yank)",videlete:"(Delete)",vichange:"(Change)",viLeft:"${0} Left",viRight:"${0} Right",viUp:"${0} Up",viDown:"${0} Down",viw:"${0} Next Word",vib:"${0} Beginning of Word",viW:"${0} Next Word (ws stop)",viB:"${0} Beginning of Word (ws stop)",vie:"${0} End of Word",viE:"${0} End of Word (ws stop)",
vi$:"${0} End of the line","vi^_":"${0} First non-blank Char Current Line","vi+":"${0} First Char Next Line","vi-":"${0} First Char Previous Line","vi|":"${0} nth Column in Line",viH:"${0} Top of Page",viM:"${0} Middle of Page",viL:"${0} Bottom of Page","vi/":"${0} Search Forward","vi?":"${0} Search Backward",vin:"${0} Next Search",viN:"${0} Previous Search",vif:"${0} Search Char Fwd",viF:"${0} Search Char Bckwd",vit:"${0} Search Before Char Fwd",viT:"${0} Search Before Char Bckwd","vi,":"${0} Repeat Reverse Char Search",
"vi;":"${0} Repeat Char Search",viG:"${0} Go to Line",viycd:"${0} Current Line",via:"Append After Cursor",viA:"Append to End of Line",vii:"Insert Before Cursor",viI:"Insert at Beginning of Line",viO:"Insert Line Above",vio:"Insert Line Below",viR:"Begin Overwriting Text",vis:"Substitute a Character",viS:"Substitute Entire Line",viC:"Change Text Until Line End",vip:"Paste After Char or Line",viP:"Paste Before Char or Line",viStar:"Search Word Under Cursor",next:"Next",previous:"Previous",replace:"Replace",
replaceAll:"Replace All",findWith:"Find With",replaceWith:"Replace With",caseInsensitive:"Aa",regex:"/.*/",wholeWord:"\\b",caseInsensitiveTooltip:"Toggle Case Insensitive",regexTooltip:"Toggle Regex",wholeWordTooltip:"Toggle Whole Word",closeTooltip:"Close",replacingAll:"Replacing all...",replacedMatches:"Replaced ${0} matches",nothingReplaced:"Nothing replaced",notFound:"Not found"});y("orion/keyBinding",["orion/util"],function(l){function r(h,f,d,b,k,m){this.type=m||"keydown";this.keyCode="string"===
typeof h&&"keydown"===this.type?h.toUpperCase().charCodeAt(0):h;this.mod1=void 0!==f&&null!==f?f:!1;this.mod2=void 0!==d&&null!==d?d:!1;this.mod3=void 0!==b&&null!==b?b:!1;this.mod4=void 0!==k&&null!==k?k:!1}function p(h){this.keys=h}r.prototype={getKeys:function(){return[this]},match:function(h,f){if(void 0!==f){if(0!==f)return!1}else if(h instanceof Array){if(1<h.length)return!1;h=h[0]}return h.type!==this.type?!1:this.keyCode===h.keyCode||this.keyCode===String.fromCharCode(l.isOpera?h.which:void 0!==
h.charCode?h.charCode:h.keyCode)?this.mod1!==(l.isMac?h.metaKey:h.ctrlKey)||"keydown"===this.type&&this.mod2!==h.shiftKey||this.mod3!==h.altKey||l.isMac&&this.mod4!==h.ctrlKey?!1:!0:!1},equals:function(h){return!h||this.keyCode!==h.keyCode||this.mod1!==h.mod1||this.mod2!==h.mod2||this.mod3!==h.mod3||this.mod4!==h.mod4||this.type!==h.type?!1:!0}};p.prototype={getKeys:function(){return this.keys.slice(0)},match:function(h,f){var d=this.keys;if(void 0!==f)return f>d.length?!1:d[f].match(h)?f===d.length-
1?!0:f+1:!1;h instanceof Array||(h=[h]);if(h.length>d.length)return!1;var b;for(b=0;b<h.length;b++)if(!d[b].match(h[b]))return!1;return b===d.length?!0:b},equals:function(h){if(!h.keys||h.keys.length!==this.keys.length)return!1;for(var f=0;f<h.keys.length;f++)if(!h.keys[f].equals(this.keys[f]))return!1;return!0}};return{KeyBinding:r,KeyStroke:r,KeySequence:p}});y("orion/editor/keyModes",["orion/keyBinding","orion/util"],function(l,r){function p(f){f&&(this._view=f,this._keyBindings=this.createKeyBindings(),
this._keyBindingIndex=0)}function h(f){p.call(this,f)}p.prototype={createKeyBindings:function(){return[]},getKeyBindings:function(f){for(var d=[],b=this._keyBindings,k=0;k<b.length;k++)b[k].actionID===f&&d.push(b[k].keyBinding);return d},getView:function(){return this._view},isActive:function(){return-1!==this._view.getKeyModes().indexOf(this)},match:function(f){if("keydown"===f.type)switch(f.keyCode){case 16:case 17:case 18:case 91:return}for(var d=this._keyBindingIndex,b=this._matchingKeyBindings||
this._keyBindings,k=[],m=0;m<b.length;m++){var g=b[m],a=g.keyBinding.match(f,d);if(!0===a)return this._keyBindingIndex=0,this._matchingKeyBindings=null,g.actionID;"number"===typeof a&&k.push(g)}if(0===k.length)this._keyBindingIndex=0,this._matchingKeyBindings=null;else return this._keyBindingIndex++,this._matchingKeyBindings=k,"noop"},setKeyBinding:function(f,d){for(var b=this._keyBindings,k=0;k<b.length;k++){var m=b[k];if(m.keyBinding.equals(f)){d?m.actionID=d:m.predefined?m.actionID="noop":b.splice(k,
1);return}}d&&b.push({keyBinding:f,actionID:d})},setView:function(f){this._view=f}};h.prototype=new p;h.prototype.createKeyBindings=function(){var f=l.KeyBinding,d=[];d.push({actionID:"lineUp",keyBinding:new f(38),predefined:!0});d.push({actionID:"lineDown",keyBinding:new f(40),predefined:!0});d.push({actionID:"charPrevious",keyBinding:new f(37),predefined:!0});d.push({actionID:"charNext",keyBinding:new f(39),predefined:!0});r.isMac?(d.push({actionID:"scrollPageUp",keyBinding:new f(33),predefined:!0}),
d.push({actionID:"scrollPageDown",keyBinding:new f(34),predefined:!0}),d.push({actionID:"pageUp",keyBinding:new f(33,null,null,!0),predefined:!0}),d.push({actionID:"pageDown",keyBinding:new f(34,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new f(37,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new f(39,!0),predefined:!0}),d.push({actionID:"wordPrevious",keyBinding:new f(37,null,null,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new f(39,null,null,
!0),predefined:!0}),d.push({actionID:"scrollTextStart",keyBinding:new f(36),predefined:!0}),d.push({actionID:"scrollTextEnd",keyBinding:new f(35),predefined:!0}),d.push({actionID:"textStart",keyBinding:new f(38,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new f(40,!0),predefined:!0}),d.push({actionID:"scrollPageUp",keyBinding:new f(38,null,null,null,!0),predefined:!0}),d.push({actionID:"scrollPageDown",keyBinding:new f(40,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",
keyBinding:new f(37,null,null,null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new f(39,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new f(38,null,null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new f(40,null,null,!0),predefined:!0})):(d.push({actionID:"pageUp",keyBinding:new f(33),predefined:!0}),d.push({actionID:"pageDown",keyBinding:new f(34),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new f(36),predefined:!0}),d.push({actionID:"lineEnd",
keyBinding:new f(35),predefined:!0}),d.push({actionID:"wordPrevious",keyBinding:new f(37,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new f(39,!0),predefined:!0}),d.push({actionID:"textStart",keyBinding:new f(36,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new f(35,!0),predefined:!0}));r.isFirefox&&r.isLinux&&(d.push({actionID:"lineUp",keyBinding:new f(38,!0),predefined:!0}),d.push({actionID:"lineDown",keyBinding:new f(40,!0),predefined:!0}));r.isWindows&&(d.push({actionID:"scrollLineUp",
keyBinding:new f(38,!0),predefined:!0}),d.push({actionID:"scrollLineDown",keyBinding:new f(40,!0),predefined:!0}));d.push({actionID:"selectLineUp",keyBinding:new f(38,null,!0),predefined:!0});d.push({actionID:"selectLineDown",keyBinding:new f(40,null,!0),predefined:!0});d.push({actionID:"selectCharPrevious",keyBinding:new f(37,null,!0),predefined:!0});d.push({actionID:"selectCharNext",keyBinding:new f(39,null,!0),predefined:!0});d.push({actionID:"selectPageUp",keyBinding:new f(33,null,!0),predefined:!0});
d.push({actionID:"selectPageDown",keyBinding:new f(34,null,!0),predefined:!0});r.isMac?(d.push({actionID:"selectLineStart",keyBinding:new f(37,!0,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new f(39,!0,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",keyBinding:new f(37,null,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new f(39,null,!0,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new f(36,null,!0),predefined:!0}),d.push({actionID:"selectTextEnd",
keyBinding:new f(35,null,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new f(38,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new f(40,!0,!0),predefined:!0}),d.push({actionID:"selectLineStart",keyBinding:new f(37,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new f(39,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineStart",keyBinding:new f(38,null,!0,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new f(40,
null,!0,!0),predefined:!0})):(r.isLinux&&(d.push({actionID:"selectWholeLineUp",keyBinding:new f(38,!0,!0),predefined:!0}),d.push({actionID:"selectWholeLineDown",keyBinding:new f(40,!0,!0),predefined:!0})),d.push({actionID:"selectLineStart",keyBinding:new f(36,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new f(35,null,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",keyBinding:new f(37,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new f(39,!0,
!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new f(36,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new f(35,!0,!0),predefined:!0}));d.push({actionID:"undo",keyBinding:new l.KeyBinding("z",!0),predefined:!0});r.isMac?d.push({actionID:"redo",keyBinding:new l.KeyBinding("z",!0,!0),predefined:!0}):d.push({actionID:"redo",keyBinding:new l.KeyBinding("y",!0),predefined:!0});d.push({actionID:"deletePrevious",keyBinding:new f(8),predefined:!0});d.push({actionID:"deletePrevious",
keyBinding:new f(8,null,!0),predefined:!0});d.push({actionID:"deleteNext",keyBinding:new f(46),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new f(8,!0),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new f(8,!0,!0),predefined:!0});d.push({actionID:"deleteWordNext",keyBinding:new f(46,!0),predefined:!0});d.push({actionID:"tab",keyBinding:new f(9),predefined:!0});d.push({actionID:"shiftTab",keyBinding:new f(9,null,!0),predefined:!0});d.push({actionID:"enter",keyBinding:new f(13),
predefined:!0});d.push({actionID:"enter",keyBinding:new f(13,null,!0),predefined:!0});d.push({actionID:"escape",keyBinding:new f(27),predefined:!0});d.push({actionID:"selectAll",keyBinding:new f("a",!0),predefined:!0});d.push({actionID:"toggleTabMode",keyBinding:new f("m",!0),predefined:!0});r.isMac&&(d.push({actionID:"deleteNext",keyBinding:new f(46,null,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",keyBinding:new f(8,null,null,!0),predefined:!0}),d.push({actionID:"deleteWordNext",keyBinding:new f(46,
null,null,!0),predefined:!0}));d.push({actionID:"toggleWrapMode",keyBinding:new l.KeyBinding("w",!0,!1,!0)});d.push({actionID:"toggleOverwriteMode",keyBinding:new l.KeyBinding(45)});if(!r.isFirefox){var b=r.isMac&&r.isChrome;d.push({actionID:"noop",keyBinding:new f("u",!b,!1,!1,b),predefined:!0});d.push({actionID:"noop",keyBinding:new f("i",!b,!1,!1,b),predefined:!0});d.push({actionID:"noop",keyBinding:new f("b",!b,!1,!1,b),predefined:!0})}r.isFirefox&&(d.push({actionID:"copy",keyBinding:new f(45,
!0),predefined:!0}),d.push({actionID:"paste",keyBinding:new f(45,null,!0),predefined:!0}),d.push({actionID:"cut",keyBinding:new f(46,null,!0),predefined:!0}));r.isMac&&(d.push({actionID:"lineStart",keyBinding:new f("a",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new f("e",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineUp",keyBinding:new f("p",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineDown",keyBinding:new f("n",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charPrevious",
keyBinding:new f("b",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charNext",keyBinding:new f("f",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deletePrevious",keyBinding:new f("h",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteNext",keyBinding:new f("d",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineEnd",keyBinding:new f("k",!1,!1,!1,!0),predefined:!0}),r.isFirefox?(d.push({actionID:"scrollPageDown",keyBinding:new f("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineStart",
keyBinding:new f("u",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",keyBinding:new f("w",!1,!1,!1,!0),predefined:!0})):(d.push({actionID:"pageDown",keyBinding:new f("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"centerLine",keyBinding:new f("l",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"enterNoCursor",keyBinding:new f("o",!1,!1,!1,!0),predefined:!0})));return d};return{KeyMode:p,DefaultKeyMode:h}});y("orion/editor/textTheme",["require","orion/editor/eventTarget","orion/util"],
function(l,r,p){function h(d){d=d||{};this._document=d.document||document}var f={};h.getTheme=function(d){d=d||"default";var b=f[d];b||(b=f[d]=new h);return b};h.prototype={getThemeClass:function(){return this._themeClass},setThemeClass:function(d,b){var f=this,m=f._themeClass;f._themeClass=d;this._load(d,b,function(){f.onThemeChanged({type:"ThemeChanged",oldValue:m,newValue:f.getThemeClass()})})},onThemeChanged:function(d){return this.dispatchEvent(d)},buildStyleSheet:function(d,b){var f=function(a){return a.replace(this._capitalRegEx,
function(a){return"-"+a}.bind(this)).toLowerCase()}.bind(this),m=function(a,b,e,g,c){var d=[];Object.keys(a).forEach(function(t){var v=a[t];"string"===typeof v?d.push("\t"+f(t)+": "+v+";"):m(v,e===t?b:b+(g?" .":".")+t,e,!1,c)});d.length&&(c.push(b+(g?".textview":"")+" {"),c.push.apply(c,d),c.push("}"))},g=[""];m(b.styles,"."+d,b.className,!0,g);return g.join("\n")},_createStyle:function(d,b,f,m){var g=this._document;d="orion-theme-"+d;var a=g.getElementById(d);if(a){if(m||a.firstChild.data===b)return;
a.removeChild(a.firstChild);a.appendChild(g.createTextNode(b))}else m?(a=p.createElement(g,"link"),a.rel="stylesheet",a.type="text/css",a.href=b,a.addEventListener("load",function(){f()})):(a=p.createElement(g,"style"),a.appendChild(g.createTextNode(b))),a.id=d,(g.getElementsByTagName("head")[0]||g.documentElement).appendChild(a);m||f()},_load:function(d,b,f){if(d)if("string"===typeof b)this._createStyle(d,b,f);else if(b=b.href,".css"!==b.substring(b.length-4)&&(b+=".css"),/^\//.test(b)||/[a-zA-Z0-9]+:\/\//i.test(b)||
!l.toUrl)this._createStyle(d,b,f,!0);else{var m=this;l(["text!"+b],function(b){m._createStyle(d,b,f,!1)})}else f()},_capitalRegEx:/[A-Z]/g};r.EventTarget.addMixin(h.prototype);return{TextTheme:h}});y("orion/editor/util",[],function(){return{contains:function(l,r){if(!r)return!1;if(!l.compareDocumentPosition){for(var p=r;p;){if(l===p)return!0;p=p.parentNode}return!1}return l===r||0!==(l.compareDocumentPosition(r)&16)},getNodeStyle:function(l,r,p){var h;if(l&&(h=l.style[r],!h))if(l.currentStyle){for(h=
0;-1!==(h=r.indexOf("-",h));)r=r.substring(0,h)+r.substring(h+1,h+2).toUpperCase()+r.substring(h+2);h=l.currentStyle[r]}else h=(l=l.ownerDocument.defaultView.getComputedStyle(l,null))?l.getPropertyValue(r):null;return h||p},addEventListener:function(l,r,p,h){"function"===typeof l.addEventListener?l.addEventListener(r,p,!0===h):l.attachEvent("on"+r,p)},removeEventListener:function(l,r,p,h){"function"===typeof l.removeEventListener?l.removeEventListener(r,p,!0===h):l.detachEvent("on"+r,p)},Animation:function(){function l(l){this.options=
l}l.prototype.play=function(){var l="number"===typeof this.options.duration?this.options.duration:350,p=this.options.easing||this.defaultEasing,h=this.options.onAnimate||function(){},f=this.options.curve[0],d=this.options.curve[1],b=d-f,k=-1,m,g=this;this.interval=this.options.window.setInterval(function(){k=-1===k?(new Date).getTime():k;var a=((new Date).getTime()-k)/l;1>a?(a=p(a),m=f+a*b,h(m)):(h(d),g.stop())},"number"===typeof this.options.rate?this.options.rate:20)};l.prototype.stop=function(){this.options.window.clearInterval(this.interval);
(this.options.onEnd||function(){})()};l.prototype.defaultEasing=function(l){return Math.sin(l*(Math.PI/2))};return l}()}});y("orion/editor/textView","i18n!orion/editor/nls/messages orion/editor/textModel orion/editor/keyModes orion/editor/eventTarget orion/editor/textTheme orion/editor/util orion/util orion/metrics".split(" "),function(l,r,p,h,f,d,b,k){function m(a,c,e){if(e){c.className="";e=c.attributes;for(var g=e.length;0<g--;)(!b.isIE||9<=b.isIE||9>b.isIE&&e[g].specified)&&c.removeAttribute(e[g].name)}if(a){a.styleClass&&
(c.className=a.styleClass);if(e=a.style)for(var d in e)e.hasOwnProperty(d)&&(c.style[d]=e[d]);if(a=a.attributes)for(var n in a)a.hasOwnProperty(n)&&c.setAttribute(n,a[n])}}function g(a){return a instanceof Array?a.slice(0):a}function a(a,c){if(!a)return c;if(!c)return a;for(var b in c)c.hasOwnProperty(b)&&(a.hasOwnProperty(b)||(a[b]=c[b]));return a}function s(a,c){if(a===c)return!0;if(a&&!c||!a&&c||a&&a.constructor===String||c&&c.constructor===String)return!1;if(a instanceof Array||c instanceof Array){if(!(a instanceof
Array&&c instanceof Array)||a.length!==c.length)return!1;for(var b=0;b<a.length;b++)if(!s(a[b],c[b]))return!1;return!0}if(!(a instanceof Object)||!(c instanceof Object))return!1;for(b in a)if(a.hasOwnProperty(b)&&(!c.hasOwnProperty(b)||!s(a[b],c[b])))return!1;for(b in c)if(!a.hasOwnProperty(b))return!1;return!0}function e(a,c,b){for(var e=0,g=0,d=0,n=a.length;d<n;){-1!==e&&e<=d&&(e=a.indexOf("\r",d));-1!==g&&g<=d&&(g=a.indexOf("\n",d));var t=d,f;if(-1===g&&-1===e){c(a.substring(d));break}-1!==e&&
-1!==g?e+1===g?(f=e,d=g+1):(f=e<g?e:g,d=(e<g?e:g)+1):-1!==e?(f=e,d=e+1):(f=g,d=g+1);c(a.substring(t,f));b?b():d===n&&c("")}}function n(a){var c,b,e,g,d=a.ownerDocument.defaultView||a.ownerDocument.parentWindow;d.getComputedStyle?(a=d.getComputedStyle(a,null),c=a.getPropertyValue("padding-left"),b=a.getPropertyValue("padding-top"),e=a.getPropertyValue("padding-right"),g=a.getPropertyValue("padding-bottom")):a.currentStyle&&(c=a.currentStyle.paddingLeft,b=a.currentStyle.paddingTop,e=a.currentStyle.paddingRight,
g=a.currentStyle.paddingBottom);return{left:parseInt(c,10)||0,top:parseInt(b,10)||0,right:parseInt(e,10)||0,bottom:parseInt(g,10)||0}}function c(a){var c,b,e,g,d=a._trim;if(!d){var d=n(a),f=a.ownerDocument.defaultView||a.ownerDocument.parentWindow;f.getComputedStyle?(g=f.getComputedStyle(a,null),c=g.getPropertyValue("border-left-width"),b=g.getPropertyValue("border-top-width"),e=g.getPropertyValue("border-right-width"),g=g.getPropertyValue("border-bottom-width")):a.currentStyle&&(c=a.currentStyle.borderLeftWidth,
b=a.currentStyle.borderTopWidth,e=a.currentStyle.borderRightWidth,g=a.currentStyle.borderBottomWidth);c=parseInt(c,10)||0;b=parseInt(b,10)||0;e=parseInt(e,10)||0;g=parseInt(g,10)||0;d.left+=c;d.top+=b;d.right+=e;d.bottom+=g;a._trim=d}return d}function u(a,c,b,e){function g(c){if(c.animationName===n){var b=c.target;"function"===typeof b.__DOMReady&&(a.defaultView||a.parentWindow).setTimeout(function(){b.__DOMReady()},0)}}function d(a,q){for(var c=["","-webkit-","-moz-","-ms-","-o-"],b="",e="body ."+
a+" {\n",g=0;g<c.length;g++)b+="@"+c[g]+"keyframes "+q+" {\nfrom { opacity: 0.99; }\nto { opacity: 1; }\n}\n",e+=c[g]+"animation-duration: 0.001s;\n"+c[g]+"animation-name: "+q+";\n";return b+(e+"}")}b="_"+b+"DOMReady";c.className=c.className?c.className+" "+b:b;c.__DOMReady=e;e=b+"Style";if(!a.getElementById(e)){var n=b+"Animation";D(a,"animationstart",g,!1);D(a,"MSAnimationStart",g,!1);D(a,"webkitAnimationStart",g,!1);c=a.createElement("style");c.id=e;e=a.getElementsByTagName("head")[0]||a.documentElement;
c.appendChild(a.createTextNode(d(b,n)));e.insertBefore(c,e.firstChild)}}function t(a,c,b){this.start=a;this.end=c;this.caret=b;this._columnX=-1}function v(a){this._view=a;this._divs=[];for(var c=a._clipDiv||a._rootDiv,b=0;3>b;b++){var e=a._createSelectionDiv();c.appendChild(e);this._divs.push(e)}}function A(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom}function E(a,c,b){this.view=a;this.lineIndex=c;this._lineDiv=b}function z(a){this._init(a||{})}var D=d.addEventListener,
B=d.removeEventListener,C=d.Animation;t.compare=function(a,c){if(a.length!==c.length)return!1;for(var b=0;b<a.length;b++)if(!a[b].equals(c[b]))return!1;return!0};t.editing=function(a,c){var b;if(c){for(b=a.length-1;0<=b;b--)if(a[b]._editing)return a[b];return a[a.length-1]}for(b=0;b<a.length;b++)if(a[b]._editing)return a[b];return a[0]};t.convert=function(a){return 1===a.length?a[0]:a};t.contains=function(a,c){return a.some(function(a){return a.contains(c)})};t.merge=function(a){if(1>=a.length)return a;
a.sort(function(a,q){return a.start-q.start});for(var c=[],b=a[0],e=1;e<a.length;e++)a[e].start>=b.end||b._editing||a[e]._editing?(c.push(b),b=a[e]):b.end=Math.max(b.end,a[e].end);c.push(b);return c};t.prototype={clone:function(){var a=new t(this.start,this.end,this.caret);a._columnX=this._columnX;a._editing=this._editing;a._docX=this._docX;return a},contains:function(a){return this.start<=a&&a<this.end?!0:!1},collapse:function(){this.caret?this.end=this.start:this.start=this.end},extend:function(a){this.caret?
this.start=a:this.end=a;this.start>this.end&&(a=this.start,this.start=this.end,this.end=a,this.caret=!this.caret)},setCaret:function(a){this.end=this.start=a;this.caret=!1},getCaret:function(){return this.caret?this.start:this.end},getAnchor:function(){return this.caret?this.end:this.start},getOrientedSelection:function(){return{start:this.getAnchor(),end:this.getCaret()}},toString:function(){return"start\x3d"+this.start+" end\x3d"+this.end+(this.caret?" caret is at start":" caret is at end")},isEmpty:function(){return this.start===
this.end},equals:function(a){return this.caret===a.caret&&this.start===a.start&&this.end===a.end&&this._editing===a._editing}};v.prototype={destroy:function(){this._divs&&(this._divs.forEach(function(a){a.parentNode.removeChild(a)}),this._divs=null)},setPrimary:function(a){this.primary=a},update:function(){var a=this._view,c=this.primary,e=a._hasFocus,a=a._cursorVisible,g=!this.primary&&this._selection&&this._selection.isEmpty(),d;d=g?"textviewSelectionCaret":e?"textviewSelection":"textviewSelectionUnfocused";
this._divs[0].style.visibility=g&&a&&e||!g?"visible":"hidden";this._divs[0].style.zIndex=a&&g?"2":"0";this._divs.forEach(function(a){a.className=d;b.isWebkit&&c&&(a.style.background=e?"transparent":"")})},setSelection:function(a){this._selection=a;this.update();var c=this._view,b=c._model,e=b.getLineAtOffset(a.start),g=b.getLineAtOffset(a.end),d=c._getLineNext();if(d){var n=c._getLinePrevious(),f;e<d.lineIndex?(e=d,f=b.getLineStart(d.lineIndex)):e>n.lineIndex?(e=n,f=b.getLineStart(n.lineIndex)):(e=
c._getLineNode(e),f=a.start);g<d.lineIndex?(c=d,b=b.getLineStart(d.lineIndex)):g>n.lineIndex?(c=n,b=b.getLineStart(n.lineIndex)):(c=c._getLineNode(g),b=a.end);this._setDOMSelection(e,f,c,b,a.caret)}},_setDOMSelection:function(a,c,e,g,d){this._setDOMFullSelection(a,c,e,g);if(this.primary){var n=this._view;a=a._line.getNodeOffset(c);e=e._line.getNodeOffset(g);if(a.node&&e.node)if(g=n._getWindow(),c=n._parent.ownerDocument,g.getSelection){var f=g.getSelection();g=c.createRange();g.setStart(a.node,a.offset);
g.setEnd(e.node,e.offset);if(n._hasFocus&&(f.anchorNode!==a.node||f.anchorOffset!==a.offset||f.focusNode!==e.node||f.focusOffset!==e.offset||f.anchorNode!==e.node||f.anchorOffset!==e.offset||f.focusNode!==a.node||f.focusOffset!==a.offset))n._anchorNode=a.node,n._anchorOffset=a.offset,n._focusNode=e.node,n._focusOffset=e.offset,n._ignoreSelect=!1,0<f.rangeCount&&f.removeAllRanges(),f.addRange(g),n._ignoreSelect=!0;n._cursorDiv&&(g=c.createRange(),d?(g.setStart(a.node,a.offset),g.setEnd(a.node,a.offset)):
(g.setStart(e.node,e.offset),g.setEnd(e.node,e.offset)),d=g.getClientRects()[0],a=n._cursorDiv.parentNode,e=a.getBoundingClientRect(),d&&e&&(n._cursorDiv.style.top=d.top-e.top+a.scrollTop+"px",n._cursorDiv.style.left=d.left-e.left+a.scrollLeft+"px"))}else c.selection&&n._hasFocus&&(d=c.body,g=b.createElement(c,"div"),d.appendChild(g),d.removeChild(g),g=d.createTextRange(),g.moveToElementText(a.node.parentNode),g.moveStart("character",a.offset),d=d.createTextRange(),d.moveToElementText(e.node.parentNode),
d.moveStart("character",e.offset),g.setEndPoint("EndToStart",d),n._ignoreSelect=!1,g.select(),n._ignoreSelect=!0)}},_setDOMFullSelection:function(a,c,e,g){this._divs.forEach(function(a){a.style.width=a.style.height="0px"});var d=this._view;if(d._fullSelection&&!b.isIOS&&!(a===e&&c===g&&this.primary)){var n=d._getViewPadding(),f=d._clientDiv.getBoundingClientRect(),t=d._viewDiv.getBoundingClientRect(),u=t.left+n.left,m=f.right,n=t.top+n.top,s=f.bottom,t=f=0;d._clipDiv?(t=d._clipDiv.getBoundingClientRect(),
f=t.left-d._clipDiv.scrollLeft):(t=d._rootDiv.getBoundingClientRect(),f=t.left);t=t.top;d._ignoreDOMSelection=!0;var v=new E(d,a.lineIndex,a),k=v.getBoundingClientRect(c,!1),h=k.left;a===e&&c===g?(c=v,g=k):(c=new E(d,e.lineIndex,e),g=c.getBoundingClientRect(g,!1));c=g.left;d._ignoreDOMSelection=!1;var v=this._divs[0],h=Math.min(m,Math.max(u,h)),A=Math.min(s,Math.max(n,k.top)),l=m,d=Math.min(s,Math.max(n,k.bottom));v.style.left=h-f+"px";v.style.top=A-t+"px";v.style.width=Math.max(0,l-h)+"px";v.style.height=
Math.max(0,d-A)+"px";a.lineIndex===e.lineIndex?(l=Math.min(c,m),v.style.width=Math.max(this.primary?0:1,l-h)+"px"):(k=Math.min(s,Math.max(n,g.top)),c=Math.min(m,Math.max(u,c)),n=Math.min(s,Math.max(n,g.bottom)),s=this._divs[2],s.style.left=u-f+"px",s.style.top=k-t+"px",s.style.width=Math.max(0,c-u)+"px",s.style.height=Math.max(0,n-k)+"px",1<Math.abs(a.lineIndex-e.lineIndex)&&(a=this._divs[1],a.style.left=u-f+"px",a.style.top=d-t+"px",a.style.width=Math.max(0,m-u)+"px",a.style.height=Math.max(0,k-
d)+"px"))}}};A.prototype={toString:function(){return"{l\x3d"+this.left+", t\x3d"+this.top+", r\x3d"+this.right+", b\x3d"+this.bottom+"}"}};E.prototype={create:function(a,c){if(!this._lineDiv){var b=this._lineDiv=this._createLine(a,c,this.lineIndex);b._line=this;return b}},_createLine:function(a,c,e){var g=this.view,d=g._model,n=d.getLine(e),f=d.getLineStart(e),t={type:"LineStyle",textView:g,lineIndex:e,lineText:n,lineStart:f};g.onLineStyle(t);var u=a.ownerDocument,d=c||b.createElement(u,"div");if(!c||
!s(c.viewStyle,t.style))m(t.style,d,c),c&&(c._trim=null),d.viewStyle=t.style,d.setAttribute("role","presentation");d.lineIndex=e;if(c&&d.viewLineText===n&&s(t.ranges,d.viewRanges))return d;d.viewRanges=t.ranges;d.viewLineText=n;e=[];this._createRanges(t.ranges,n,0,n.length,f,{tabOffset:0,ranges:e});t=" ";!g._fullSelection&&9>b.isIE&&(t="\ufeff");g={text:t,style:g._metrics.largestFontStyle,ignoreChars:1};0===e.length||!e[e.length-1].style||"div"!==e[e.length-1].style.tagName?e.push(g):e.splice(e.length-
1,0,g);var v,k,h,A=t=0;if(b.isFirefox&&2E3<n.length){c&&(d.innerHTML="",c.lineWidth=void 0);c=u.createDocumentFragment();for(n=0;n<e.length;n++)g=e[n],f=g.text,v=g.style,v=this._createSpan(d,f,v,g.ignoreChars),c.appendChild(v);d.appendChild(c)}else{var l,E;if(c){if(k=c.modelChangedEvent)0===k.removedLineCount&&0===k.addedLineCount?(E=k.start-f,l=k.addedCharCount-k.removedCharCount):E=-1,c.modelChangedEvent=void 0;k=c.firstChild}for(n=0;n<e.length;n++){g=e[n];f=g.text;t+=f.length;v=g.style;if(k)if(h=
k.firstChild.data,u=k.viewStyle,h===f&&s(v,u)){A+=h.length;k._rectsCache=void 0;v=k=k.nextSibling;continue}else for(;k;){if(-1!==E){u=t;u>=E&&(u-=l);h=(h=k.firstChild.data)?h.length:0;if(A+h>u)break;A+=h}u=k.nextSibling;d.removeChild(k);k=u}v=this._createSpan(d,f,v,g.ignoreChars);k?d.insertBefore(v,k):d.appendChild(v);c&&(c.lineWidth=void 0)}if(c)for(l=v?v.nextSibling:null;l;)u=l.nextSibling,c.removeChild(l),l=u}d.parentNode||a.appendChild(d);return d},_createRanges:function(a,c,b,e,g,d){if(!(b>e)){if(a)for(var n=
0;n<a.length;n++){var f=a[n];if(!(f.end<g+b)){var t=Math.max(g+b,f.start)-g;if(t>e)break;var u=Math.min(g+e,f.end)-g;if(t<=u){t=Math.max(b,t);u=Math.min(e,u);b<t&&this._createRange(c,b,t,null,d);if(!f.style||!f.style.unmergeable)for(;n+1<a.length&&a[n+1].start-g===u&&s(f.style,a[n+1].style);)f=a[n+1],u=Math.min(g+e,f.end)-g,n++;this._createRange(c,t,u,f.style,d);b=u}}}b<e&&this._createRange(c,b,e,null,d)}},_createRange:function(a,c,b,e,g){if(!(c>b)){var d=this.view._customTabSize;if(d&&8!==d)for(var n=
a.indexOf("\t",c);-1!==n&&n<b;){c<n&&(c={text:a.substring(c,n),style:e},g.ranges.push(c),g.tabOffset+=c.text.length);c=d-g.tabOffset%d;if(0<c){for(var f="\u00a0",t=1;t<c;t++)f+=" ";c={text:f,style:e,ignoreChars:c-1};g.ranges.push(c);g.tabOffset+=c.text.length}c=n+1;if(c===b)return;n=a.indexOf("\t",c)}c<=b&&(c={text:a.substring(c,b),style:e},g.ranges.push(c),g.tabOffset+=c.text.length)}},_createSpan:function(a,c,e,g){var d=this.view,n="span";e&&e.tagName&&(n=e.tagName.toLowerCase());var f="a"===n;
f&&(this.hasLink=!0);f&&!d._linksVisible&&(n="span");f=a.ownerDocument;a=b.createElement(a.ownerDocument,n);a.appendChild(f.createTextNode(e&&e.text?e.text:c));e&&e.html?(a.innerHTML=e.html,a.ignore=!0):e&&e.node&&(a.appendChild(e.node),a.ignore=!0);m(e,a);if("a"===n){var t=d._getWindow();D(a,"click",function(a){return d._handleLinkClick(a?a:t.event)},!1)}a.viewStyle=e;g&&(a.ignoreChars=g);return a},_ensureCreated:function(){return this._lineDiv?this._lineDiv:this._createdDiv=this.create(this.view._clientDiv,
null)},getBoundingClientRect:function(a,c){var e=this._ensureCreated(),g=this.view;if(void 0===a)return this._getLineBoundingClientRect(e,!0);var d=g._model,n=e.ownerDocument,f=this.lineIndex,t=null;if(a<d.getLineEnd(f)){var u=d.getLineStart(f);this.forEach(function(c){var d=c.firstChild,w=this._nodeLength(c);if(u+w>a){var f=a-u;if(1===d.length)t=new A(c.getBoundingClientRect());else if(g._isRangeRects)w=n.createRange(),w.setStart(d,f),w.setEnd(d,f+1),t=new A(w.getBoundingClientRect());else if(b.isIE)w=
n.body.createTextRange(),w.moveToElementText(c),w.collapse(),(d=0===f&&8===b.isIE)&&(f=1),w.moveEnd("character",f+1),w.moveStart("character",f),t=new A(w.getBoundingClientRect()),d&&(t.left=c.getClientRects()[0].left);else{var m=d.data;c.removeChild(d);c.appendChild(n.createTextNode(m.substring(0,f)));var s=b.createElement(n,"span");s.appendChild(n.createTextNode(m.substring(f,f+1)));c.appendChild(s);c.appendChild(n.createTextNode(m.substring(f+1)));t=new A(s.getBoundingClientRect());c.innerHTML=
"";c.appendChild(d);this._createdDiv||(c=g._getSelections()[0],(u<=c.start&&c.start<u+w||u<=c.end&&c.end<u+w)&&g._updateDOMSelection())}11>b.isIE&&(f=e.ownerDocument.defaultView||e.ownerDocument.parentWindow,c=f.screen.logicalXDPI/f.screen.deviceXDPI,f=f.screen.logicalYDPI/f.screen.deviceYDPI,t.left*=c,t.right*=c,t.top*=f,t.bottom*=f);return!1}u+=w;return!0})}d=this.getBoundingClientRect();t||(g._wrapMode?(f=this.getClientRects(),t=f[f.length-1],t.left=t.right,t.left+=d.left,t.top+=d.top,t.right+=
d.left,t.bottom+=d.top):(t=new A(d),t.left=t.right));if(c||void 0===c)t.left-=d.left,t.top-=d.top,t.right-=d.left,t.bottom-=d.top;return t},forEach:function(a){for(var c=this._ensureCreated().firstChild;c;){var b=c.nextSibling;if(!c.ignore&&!a.call(this,c))break;c=b}},_getClientRects:function(a,c){var b,e,g,d;if(!a._rectsCache){b=a.getClientRects();e=Array(b.length);for(d=0;d<b.length;d++)g=e[d]=new A(b[d]),g.left-=c.left,g.top-=c.top,g.right-=c.left,g.bottom-=c.top;a._rectsCache=e}b=a._rectsCache;
e=[b.length];for(d=0;d<b.length;d++)e[d]=new A(b[d]);return e},getClientRects:function(a){if(!this.view._wrapMode)return[this.getBoundingClientRect()];var c=[],b=this._ensureCreated().getBoundingClientRect();this.forEach(function(a){a=this._getClientRects(a,b);for(var e=0;e<a.length;e++){var q=a[e],g,d;if(q.top!==q.bottom){var n=q.top+(q.bottom-q.top)/2;for(g=0;g<c.length&&!(d=c[g],d.top<=n&&n<d.bottom);g++);g===c.length?c.push(q):(q.left<d.left&&(d.left=q.left),q.top<d.top&&(d.top=q.top),q.right>
d.right&&(d.right=q.right),q.bottom>d.bottom&&(d.bottom=q.bottom))}}return!0});return void 0!==a?c[a]:c},_getLineBoundingClientRect:function(a,b){var e=new A(a.getBoundingClientRect());if(!this.view._wrapMode){e.right=e.left;for(var g=a.lastChild;g&&g.ignoreChars===g.firstChild.length;)g=g.previousSibling;g&&(g=g.getBoundingClientRect(),e.right=g.right+c(a).right)}b&&(g=c(a),e.left+=g.left,e.right-=g.right);return e},getLineCount:function(){return!this.view._wrapMode?1:this.getClientRects().length},
getLineIndex:function(a){if(!this.view._wrapMode)return 0;var c=this.getClientRects();a=this.getBoundingClientRect(a);a=a.top+(a.bottom-a.top)/2;for(var e=0;e<c.length;e++)if(c[e].top<=a&&a<c[e].bottom)return e;return c.length-1},getLineStart:function(a){if(!this.view._wrapMode||0===a)return this.view._model.getLineStart(this.lineIndex);var c=this.getClientRects();return this.getOffset(c[a].left+1,c[a].top+1)},_nodeLength:function(a){if(!a||a.ignore)return 0;var c=a.firstChild.length;a.ignoreChars&&
(c-=a.ignoreChars);return c},getModelOffset:function(a,c){if(!a)return 0;var e=0;this.forEach(function(b){var g=b.firstChild;if(g===a)return b.ignoreChars&&(e-=b.ignoreChars),e+=c,!1;b.ignoreChars&&(e-=b.ignoreChars);e+=g.data.length;return!0});return Math.max(0,e)+this.view._model.getLineStart(this.lineIndex)},getNodeOffset:function(a){var c=0,e,b,g=this.view._model,d=g.getLineStart(this.lineIndex),n=a-d,f=g.getLineEnd(this.lineIndex)-d;this.forEach(function(a){var q=a.firstChild,g=this._nodeLength(a);
if(g+c>n||c+g>=f)return e=q,b=n-c,a.ignoreChars&&(0<g&&b===g)&&(b+=a.ignoreChars),!1;c+=g;return!0});return{node:e,offset:b}},getText:function(a){var c="",e=0;this.forEach(function(b){var g;if(b.ignoreChars){g=b.lastChild;for(var d=0,n=[],f=-1;g;){var t=g.data;if(t)for(var u=t.length-1;0<=u;u--){var m=t.substring(u,u+1);d<b.ignoreChars&&(" "===m||"\ufeff"===m)?d++:n.push("\u00a0"===m?"\t":m)}a===g&&(f=n.length);g=g.previousSibling}n=n.reverse().join("");-1!==f&&(e=c.length+n.length-f);c+=n}else for(g=
b.firstChild;g;)a===g&&(e=c.length),c+=g.data,g=g.nextSibling;return!0});return{text:c,offset:e}},getOffset:function(a,c){function e(g,u,x){var k=g.firstChild,h=v._nodeLength(g),A=m.ownerDocument,l=A.defaultView||A.parentWindow,F=11>b.isIE?l.screen.logicalXDPI/l.screen.deviceXDPI:1,E=11>b.isIE?l.screen.logicalYDPI/l.screen.deviceYDPI:1,z,p,r,l=x.left+s.left,D,B;if(b.isIE||d._isRangeRects){for(var A=d._isRangeRects?A.createRange():A.body.createTextRange(),C=h,S=-1;1<C-S;){var K=Math.floor((C+S)/2);
x=S+1;z=K===h-1&&g.ignoreChars?k.length:K+1;D=0===x&&8===b.isIE;d._isRangeRects?(A.setStart(k,x),A.setEnd(k,z)):(D&&(x=1),A.moveToElementText(g),A.move("character",x),A.moveEnd("character",z-x));B=A.getClientRects();for(var H=!1,V=0;V<B.length;V++)if(x=B[V],z=(D?l:x.left)*F-s.left,r=x.right*F-s.left,p=x.top*E-s.top,x=x.bottom*E-s.top,z<=a&&a<r&&(!d._wrapMode||p<=c&&c<=x)){H=!0;break}H?C=K:S=K}u+=C;x=C;z=C===h-1&&g.ignoreChars?k.length:Math.min(C+1,k.length);d._isRangeRects?(A.setStart(k,x),A.setEnd(k,
z)):(A.moveToElementText(g),A.move("character",x),A.moveEnd("character",z-x));B=A.getClientRects();h=!1;0<B.length&&(x=B[0],z=(D?l:x.left)*F-s.left,r=x.right*F-s.left,h=a>z+(r-z)/2);g=u-t;k=n.getLine(f);F=k.charCodeAt(g);55296<=F&&56319>=F&&h?g<k.length&&(F=k.charCodeAt(g+1),56320<=F&&57343>=F&&(u+=1)):56320<=F&&(57343>=F&&!h)&&0<g&&(F=k.charCodeAt(g-1),55296<=F&&56319>=F&&(u-=1));h&&u++}else{F=[];for(D=0;D<h;D++)F.push("\x3cspan\x3e"),D===h-1?F.push(k.data.substring(D)):F.push(k.data.substring(D,
D+1)),F.push("\x3c/span\x3e");g.innerHTML=F.join("");for(F=g.firstChild;F;){x=F.getBoundingClientRect();z=x.left-s.left;r=x.right-s.left;if(z<=a&&a<r){a>z+(r-z)/2&&u++;break}u++;F=F.nextSibling}v._createdDiv||(g.innerHTML="",g.appendChild(k),g=d._getSelections()[0],(u<=g.start&&g.start<u+h||u<=g.end&&g.end<u+h)&&d._updateDOMSelection())}return u}function g(e){if(e.ignore)return null;e=v._getClientRects(e,s);for(var b=0;b<e.length;b++){var n=e[b];if(n.left<=a&&a<n.right&&(!d._wrapMode||n.top<=c&&c<=
n.bottom))return n}return null}var d=this.view,n=d._model,f=this.lineIndex,t=n.getLineStart(f),u=n.getLineEnd(f);if(t===u)return t;var m=this._ensureCreated(),s=this.getBoundingClientRect(),v=this,k,h;if(d._wrapMode){k=this.getClientRects();c<k[0].top&&(c=k[0].top);for(var A=0;A<k.length&&!(h=k[A],h.top<=c&&c<h.bottom);A++);a<h.left&&(a=h.left);a>h.right&&(a=h.right-1)}else 0>a&&(a=0),a>s.right-s.left&&(a=s.right-s.left);var l,E;if(this._lastHitChild&&this._lastHitChild.parentNode){if(l=this._lastHitOffset,
E=this._lastHitChild,h=g(E),!h){k=l;for(var A=l+this._nodeLength(E),z=E.previousSibling,p=E.nextSibling;z||p;){if(z){k-=this._nodeLength(z);if(h=g(z)){E=z;l=k;break}z=z.previousSibling}if(p){if(h=g(p)){E=p;l=A;break}A+=this._nodeLength(p);p=p.nextSibling}}}}else l=t,this.forEach(function(a){E=a;if(h=g(E))return!1;l+=this._nodeLength(E);return!0});E&&h&&(this._lastHitChild=E,this._lastHitOffset=l,l=e(E,l,h));return Math.min(u,Math.max(t,l))},getNextOffset:function(a,c){if("line"===c.unit){var e=this.view._model,
g=e.getLineAtOffset(a);if(0<c.count)return c.count--,e.getLineEnd(g);c.count++;return e.getLineStart(g)}return"wordend"===c.unit||"wordWS"===c.unit||"wordendWS"===c.unit?this._getNextOffset_W3C(a,c):b.isIE?this._getNextOffset_IE(a,c):this._getNextOffset_W3C(a,c)},_getNextOffset_W3C:function(a,c){function e(a){return 33<=a&&47>=a||58<=a&&64>=a||91<=a&&94>=a||96===a||123<=a&&126>=a}function b(a){return 32===a||9===a}var g=this.view._model,d=g.getLineAtOffset(a),n=g.getLine(d),f=g.getLineStart(d),g=
g.getLineEnd(d),d=n.length,t=a-f,u,m=0>c.count?-1:1;if("word"===c.unit||"wordend"===c.unit||"wordWS"===c.unit||"wordendWS"===c.unit)for(var s,v,k;0!==c.count;){if(0<c.count){if(t===d)return g;u=n.charCodeAt(t);s=e(u);v=!s&&!b(u);for(t++;t<d;){u=n.charCodeAt(t);if("wordWS"!==c.unit&&"wordendWS"!==c.unit){k=e(u);if("wordend"===c.unit){if(!k&&s)break}else if(k&&!s)break;u=!k&&!b(u)}else u=!b(u);if("wordend"===c.unit||"wordendWS"===c.unit){if(!u&&v)break}else if(u&&!v)break;v=u;s=k;t++}}else{if(0===t)return f;
t--;u=n.charCodeAt(t);s=e(u);for(v=!s&&!b(u);0<t;){u=n.charCodeAt(t-1);if("wordWS"!==c.unit&&"wordendWS"!==c.unit){k=e(u);if("wordend"===c.unit){if(k&&!s)break}else if(!k&&s)break;u=!k&&!b(u)}else u=!b(u);if("wordend"===c.unit||"wordendWS"===c.unit){if(u&&!v)break}else if(!u&&v)break;v=u;s=k;t--}}c.count-=m}else for(;0!==c.count&&0<=t+m&&t+m<=d;)t+=m,u=n.charCodeAt(t),56320<=u&&57343>=u&&0<t&&(u=n.charCodeAt(t-1),55296<=u&&56319>=u&&(t+=m)),c.count-=m;return f+t},_getNextOffset_IE:function(a,c){var e=
this._ensureCreated(),b=this.view._model,g=this.lineIndex,d=0,n;n=b.getLineStart(g);var t=b.getLine(g),f=b.getLineStart(g),u=e.ownerDocument,m=0>c.count?-1:1;if(a===b.getLineEnd(g)){for(e=e.lastChild;e&&e.ignoreChars===e.firstChild.length;)e=e.previousSibling;if(!e)return n;d=u.body.createTextRange();d.moveToElementText(e);n=d.text.length;d.moveEnd(c.unit,m);d=a+d.text.length-n}else if(a===n&&0>c.count)d=n;else for(e=e.firstChild;e;){b=this._nodeLength(e);if(n+b>a){d=u.body.createTextRange();if(a===
n&&0>c.count){for(n=e.previousSibling;n&&(!n.firstChild||!n.firstChild.length);)n=n.previousSibling;d.moveToElementText(n?n:e.previousSibling)}else d.moveToElementText(e),d.collapse(),d.moveEnd("character",a-n);n=d.text.length;d.moveEnd(c.unit,m);d=a+d.text.length-n;break}n=b+n;e=e.nextSibling}n=d-f;d=t.charCodeAt(n);56320<=d&&57343>=d&&0<n&&(d=t.charCodeAt(n-1),55296<=d&&56319>=d&&(n+=m));c.count-=m;return n+f},updateLinks:function(){var a=this._ensureCreated();if(this.hasLink){var c=this;this.forEach(function(e){var b=
e.viewStyle;b&&(b.tagName&&"a"===b.tagName.toLowerCase())&&a.replaceChild(c._createSpan(a,e.firstChild.data,b),e);return!0})}},destroy:function(){var a=this._createdDiv;a&&(a.parentNode.removeChild(a),this._createdDiv=null)}};z.prototype={addKeyMode:function(a,c){var e=this._keyModes;void 0!==c?e.splice(c,0,a):e.push(a);a._modeAdded&&a._modeAdded()},addRuler:function(a,c){var e=this._rulers;if(void 0!==c){var b,g;for(g=b=0;b<e.length&&g<c;b++)a.getLocation()===e[b].getLocation()&&g++;e.splice(g,0,
a);c=g}else e.push(a);this._createRuler(a,c);a.setView(this);this._update()},computeSize:function(){var a=0,c=0,e=this._model,g=this._clientDiv;if(!g)return{width:a,height:c};var d=g.style.width;b.isWebkit&&(g.style.width="0x7fffffffpx");for(var e=e.getLineCount(),n=0;n<e;n++){var t=this._getLine(n),f=t.getBoundingClientRect(),a=Math.max(a,f.right-f.left),c=c+(f.bottom-f.top);t.destroy()}b.isWebkit&&(g.style.width=d);g=this._getViewPadding();a+=g.right+g.left+this._metrics.scrollWidth;c+=g.bottom+
g.top+this._metrics.scrollWidth;return{width:a,height:c}},convert:function(a,c,e){if(!this._clientDiv)return a;var b=this._getScroll(),g=this._getViewPadding(),d=this._viewDiv.getBoundingClientRect();"document"===c&&(void 0!==a.x&&(a.x+=-b.x+d.left+g.left),void 0!==a.y&&(a.y+=-b.y+d.top+g.top));"document"===e&&(void 0!==a.x&&(a.x+=b.x-d.left-g.left),void 0!==a.y&&(a.y+=b.y-d.top-g.top));return a},destroy:function(){for(var a=0;a<this._rulers.length;a++)this._rulers[a].setView(null);this.rulers=null;
this._destroyView();this.onDestroy({type:"Destroy"});this._parent=null;this._model&&this._model.destroy&&this._model.destroy();this._actions=this._keyModes=this._doubleClickSelection=this._selection=this._theme=this._model=null},focus:function(){this._clientDiv&&(this._updateDOMSelection(),this._clientDiv.focus(),this._updateDOMSelection())},hasFocus:function(){return this._hasFocus},getActionDescription:function(a){if(a=this._actions[a])return a.actionDescription},getActions:function(a){var c=[],
e=this._actions,b;for(b in e)e.hasOwnProperty(b)&&(a||!e[b].defaultHandler)&&c.push(b);return c},getBottomIndex:function(a){return!this._clientDiv?0:this._getBottomIndex(a)},getBottomPixel:function(){return!this._clientDiv?0:this._getScroll().y+this._getClientHeight()},getCaretOffset:function(){return this._getSelection().getCaret()},getClientArea:function(){if(!this._clientDiv)return{x:0,y:0,width:0,height:0};var a=this._getScroll();return{x:a.x,y:a.y,width:this._getClientWidth(),height:this._getClientHeight()}},
getHorizontalPixel:function(){return!this._clientDiv?0:this._getScroll().x},getKeyBindings:function(a){for(var c=[],e=this._keyModes,b=0;b<e.length;b++)c=c.concat(e[b].getKeyBindings(a));return c},getKeyModes:function(){return this._keyModes.slice(0)},getLineHeight:function(a){return!this._clientDiv?0:this._getLineHeight(a)},getLineIndex:function(a){return!this._clientDiv?0:this._getLineIndex(a)},isValidTextPosition:function(a,c){if(!this._clientDiv)return!1;var e=this._getLineIndex(c,!0);if(0>e)return!1;
var e=this._getLine(e),b=this.getOffsetAtLocation(a,c),b=e.getBoundingClientRect(b);e.destroy();return a>b.right?!1:!0},getLinePixel:function(a){return!this._clientDiv?0:this._getLinePixel(a)},getLocationAtOffset:function(a){if(!this._clientDiv)return{x:0,y:0};var c=this._model;a=Math.min(Math.max(0,a),c.getCharCount());var c=c.getLineAtOffset(a),e=this._getLine(c);a=e.getBoundingClientRect(a);e.destroy();e=a.left;c=this._getLinePixel(c)+a.top;return{x:e,y:c}},getNextOffset:function(a,c){var e=new t(a,
a,!1);this._doMove(c,e);return e.getCaret()},getOptions:function(){var a;if(0===arguments.length)a=this._defaultOptions();else if(1===arguments.length){if(a=arguments[0],"string"===typeof a)return g(this["_"+a])}else{a={};for(var c in arguments)arguments.hasOwnProperty(c)&&(a[arguments[c]]=void 0)}for(var e in a)a.hasOwnProperty(e)&&(a[e]=g(this["_"+e]));return a},getModel:function(){return this._model},getOffsetAtLocation:function(a,c){if(!this._clientDiv)return 0;var e=this._getLineIndex(c),b=this._getLine(e),
e=b.getOffset(a,c-this._getLinePixel(e));b.destroy();return e},getLineAtOffset:function(a){return this.getModel().getLineAtOffset(a)},getLineStart:function(a){return this.getModel().getLineStart(a)},getRulers:function(){return this._rulers.slice(0)},getSelection:function(){return this._getSelection()},getSelections:function(){return this._getSelections()},getSelectionText:function(a){var c=[],e=this;this._getSelections().forEach(function(a){a.isEmpty()||c.push(e._getBaseText(a.start,a.end))});return c.join(void 0!==
a?a:this._model.getLineDelimiter())},getText:function(a,c){return this._model.getText(a,c)},getTopIndex:function(a){return!this._clientDiv?0:this._getTopIndex(a)},getTopPixel:function(){return!this._clientDiv?0:this._getScroll().y},invokeAction:function(a,c,e){if(this._clientDiv){if(a=this._actions[a]){a.actionDescription&&a.actionDescription.id&&k.logEvent("editor","action",a.actionDescription.id);if(!c&&a.handler&&a.handler(e))return!0;if(a.defaultHandler)return"boolean"===typeof a.defaultHandler(e)}return!1}},
isDestroyed:function(){return!this._clientDiv},onContextMenu:function(a){return this.dispatchEvent(a)},onDragStart:function(a){return this.dispatchEvent(a)},onDrag:function(a){return this.dispatchEvent(a)},onDragEnd:function(a){return this.dispatchEvent(a)},onDragEnter:function(a){return this.dispatchEvent(a)},onDragOver:function(a){return this.dispatchEvent(a)},onDragLeave:function(a){return this.dispatchEvent(a)},onDrop:function(a){return this.dispatchEvent(a)},onDestroy:function(a){return this.dispatchEvent(a)},
onSaving:function(a){return this.dispatchEvent(a)},onInputChanged:function(a){return this.dispatchEvent(a)},onLineStyle:function(a){return this.dispatchEvent(a)},onKeyDown:function(a){return this.dispatchEvent(a)},onKeyPress:function(a){return this.dispatchEvent(a)},onKeyUp:function(a){return this.dispatchEvent(a)},onModelChanged:function(a){return this.dispatchEvent(a)},onModelChanging:function(a){return this.dispatchEvent(a)},onModify:function(a){return this.dispatchEvent(a)},onMouseDown:function(a){return this.dispatchEvent(a)},
onMouseUp:function(a){return this.dispatchEvent(a)},onMouseMove:function(a){return this.dispatchEvent(a)},onMouseOver:function(a){return this.dispatchEvent(a)},onMouseOut:function(a){return this.dispatchEvent(a)},onTouchStart:function(a){return this.dispatchEvent(a)},onTouchMove:function(a){return this.dispatchEvent(a)},onTouchEnd:function(a){return this.dispatchEvent(a)},onOptions:function(a){return this.dispatchEvent(a)},onSelection:function(a){return this.dispatchEvent(a)},onScroll:function(a){return this.dispatchEvent(a)},
onVerify:function(a){return this.dispatchEvent(a)},onFocus:function(a){return this.dispatchEvent(a)},onBlur:function(a){return this.dispatchEvent(a)},redraw:function(){if(!(0<this._redrawCount)){var a=this._model.getLineCount();this.redrawRulers(0,a);this.redrawLines(0,a)}},redrawRulers:function(a,c){if(!(0<this._redrawCount))for(var e=this.getRulers(),b=0;b<e.length;b++)this.redrawLines(a,c,e[b])},redrawLines:function(a,c,e){if(!(0<this._redrawCount)&&(void 0===a&&(a=0),void 0===c&&(c=this._model.getLineCount()),
a!==c)){var b=this._clientDiv;if(b){if(e)for(b=this._getRulerParent(e).firstChild;b&&b._ruler!==e;)b=b.nextSibling;e?b.rulerChanged=!0:this._lineHeight&&this._resetLineHeight(a,c);var g=-1;!e&&-1!==this._imeOffset&&(g=this._model.getLineAtOffset(this._imeOffset));if(!e||"page"===e.getOverview())for(b=b.firstChild;b;){var d=b.lineIndex;a<=d&&(d<c&&d!==g)&&(b.lineChanged=!0);b=b.nextSibling}!e&&(!this._wrapMode&&a<=this._maxLineIndex&&this._maxLineIndex<c)&&(this._checkMaxLineIndex=this._maxLineIndex,
this._maxLineIndex=-1,this._maxLineWidth=0);this.dispatchEvent({type:"Redraw",startLine:a,endLine:c,ruler:e});this._queueUpdate()}}},redrawRange:function(a,c){if(!(0<this._redrawCount)){var e=this._model;void 0===a&&(a=0);void 0===c&&(c=e.getCharCount());var b=e.getLineAtOffset(a),e=e.getLineAtOffset(Math.max(a,c-1))+1;this.redrawLines(b,e)}},removeKeyMode:function(a){for(var c=this._keyModes,e=0;e<c.length;e++)if(c[e]===a){c.splice(e,1);break}a._modeRemoved&&a._modeRemoved()},removeRuler:function(a){for(var c=
this._rulers,e=0;e<c.length;e++)if(c[e]===a){c.splice(e,1);a.setView(null);this._destroyRuler(a);this._update();break}},resize:function(){this._clientDiv&&this._handleResize(null)},setAction:function(a,c,e){if(a){var b=this._actions,g=b[a];g||(g=b[a]={});g.handler=c;void 0!==e&&(g.actionDescription=e)}},setKeyBinding:function(a,c){this._keyModes[0].setKeyBinding(a,c)},setCaretOffset:function(a,c,e){var b=this._model.getCharCount();a=Math.max(0,Math.min(a,b));a=new t(a,a,!1);this._setSelection(a,void 0===
c||c,!0,e)},setHorizontalPixel:function(a){this._clientDiv&&(a=Math.max(0,a),this._scrollView(a-this._getScroll().x,0))},setRedraw:function(a){a?0===--this._redrawCount&&this.redraw():this._redrawCount++},setModel:function(a){if(a!==this._model){a=a||new r.TextModel;this._model.removeEventListener("preChanging",this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);var c=this._model.getLineCount(),e=this._model.getCharCount(),b=a.getLineCount(),
g=a.getCharCount(),d={type:"ModelChanging",text:a.getText(),start:0,removedCharCount:e,addedCharCount:g,removedLineCount:c,addedLineCount:b};this.onModelChanging(d);this._model=a;d={type:"ModelChanged",start:0,removedCharCount:e,addedCharCount:g,removedLineCount:c,addedLineCount:b};this.onModelChanged(d);this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._reset();this._update()}},setOptions:function(a){var c=
this._defaultOptions(),e;for(e in a)if(a.hasOwnProperty(e)){var b=a[e];if(!s(this["_"+e],b)){var d=c[e]?c[e].update:null;d?d.call(this,b):this["_"+e]=g(b)}}this.onOptions({type:"Options",options:a})},setSelection:function(a,c,e,b){var g=a>c;if(g){var d=a;a=c;c=d}d=this._model.getCharCount();a=Math.max(0,Math.min(a,d));c=Math.max(0,Math.min(c,d));a=new t(a,c,g);this._setSelection(a,void 0===e||e,!0,b)},setSelections:function(a,c,e){a=this._rangesToSelections(a);this._setSelection(a,void 0===c||c,!0,
e)},setText:function(a,c,e,g,d){var n="string"===typeof a,f=void 0===c&&void 0===e&&n;n?(void 0===c&&(c=0),void 0===e&&(e=this._model.getCharCount()),a={text:a,selection:[new t(c,e,!1)]}):a.selection=this._rangesToSelections(a.selection);a._code=!0;f&&(this._variableLineHeight=!1);this._modifyContent(a,!f,void 0===g||g,d);f&&13>b.isFirefox&&this._fixCaret()},setTopIndex:function(a,c){this._clientDiv&&this._scrollViewAnimated(0,this._getLinePixel(Math.max(0,a))-this._getScroll().y,c)},setTopPixel:function(a,
c){this._clientDiv&&this._scrollViewAnimated(0,Math.max(0,a)-this._getScroll().y,c)},showSelection:function(a,c){return this._showCaret(a?!1:!0,c,a)},update:function(a,c){this._clientDiv&&((a||this._metrics.invalid)&&this._updateStyle(),void 0===c||c?this._update():this._queueUpdate())},_handleRootMouseDown:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)){13>b.isFirefox&&1===a.which&&(this._clientDiv.contentEditable=!1,this._ignoreBlur=(this._overlayDiv||this._clientDiv).draggable=
!0);var c=this._overlayDiv||this._clientDiv;9>b.isIE&&(c=this._viewDiv);for(var e=a.target?a.target:a.srcElement;e;){if(c===e||e.className&&-1!==e.className.indexOf("textViewFind"))return;e=e.parentNode}a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();if(!this._isW3CEvents){var g=this;this._getWindow().setTimeout(function(){g._clientDiv.focus()},0)}}},_handleRootMouseUp:function(a){this._ignoreEvent(a)||(13>b.isFirefox&&1===a.which&&(this._clientDiv.contentEditable=!0,(this._overlayDiv||
this._clientDiv).draggable=!1),b.isFirefox&&1===a.which&&(this._fixCaret(),this._ignoreBlur=!1))},_handleBlur:function(){this._cancelCheckSelection();if(!this._ignoreBlur){this._commitIME();this._hasFocus=!1;if(9>b.isIE&&!this._getSelections()[0].isEmpty()){var a=this._rootDiv,c=b.createElement(a.ownerDocument,"div");a.appendChild(c);a.removeChild(c)}this._cursorDiv&&(this._cursorDiv.style.display="none");if(this._domSelection)if(this._domSelection.forEach(function(a){a.update()}),a=this._getWindow(),
c=this._parent.ownerDocument,a.getSelection){c=a.getSelection();for(a=c.anchorNode;a;){if(a===this._clientDiv){0<c.rangeCount&&c.removeAllRanges();break}a=a.parentNode}}else if(c.selection){this._ignoreSelect=!1;for(a=c.selection.createRange().parentElement();a;){if(a===this._clientDiv){c.selection.empty();break}a=a.parentNode}this._ignoreSelect=!0}if(!this._ignoreFocus)this.onBlur({type:"Blur"})}},_handleCompositionStart:function(a){this._ignoreEvent(a)||(this._imeTimeout&&(this._getWindow().clearTimeout(this._imeTimeout),
this._imeTimeout=null),this._imeText&&(this._commitIME(this._imeText),this._imeText=null),this._startIME(),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null))},_handleCompositionUpdate:function(a){this._ignoreEvent(a)||(this._imeText=a.data)},_handleCompositionEnd:function(a){this._ignoreEvent(a)||(this._imeText=a.data,this._imeTimeout=this._getWindow().setTimeout(function(){this._commitIME(this._imeText);this._imeText=this._imeTimeout=null}.bind(this),0))},
_handleContextMenu:function(a){if(!this._ignoreEvent(a)){b.isIE&&3===this._lastMouseButton&&this._updateDOMSelection();var c=!1;this.isListening("ContextMenu")?(c=this._createMouseEvent("ContextMenu",a),c.screenX=a.screenX,c.screenY=a.screenY,this.onContextMenu(c),c=c.defaultPrevented):b.isMac&&(b.isFirefox&&0===a.button)&&(c=!0);if(c)return a.preventDefault&&a.preventDefault(),!1;this._contextMenuOpen=!0;b.isFirefox&&(this._checkSelectionChange=!0,this._pollSelectionChange(!0))}},_handleCopy:function(a){this._cancelCheckSelection();
if(!this._ignoreEvent(a)&&!this._ignoreCopy&&this._doCopy(a))return a.preventDefault&&a.preventDefault(),!1},_handleCut:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)&&this._doCut(a))return a.preventDefault&&a.preventDefault(),!1},_handleDataModified:function(a){this._ignoreEvent(a)||this._startIME()},_handleDblclick:function(a){this._ignoreEvent(a)||(this._lastMouseTime=a.timeStamp?a.timeStamp:(new Date).getTime(),2!==this._clickCount&&(this._clickCount=2,this._handleMouse(a)))},
_handleDragStart:function(a){if(!this._ignoreEvent(a)){if(13>b.isFirefox){var c=this;this._getWindow().setTimeout(function(){c._clientDiv.contentEditable=!0;c._clientDiv.draggable=!1;c._ignoreBlur=!1},0)}if(this.isListening("DragStart")&&-1!==this._dragOffset)this._isMouseDown=!1,this.onDragStart(this._createMouseEvent("DragStart",a)),this._dragOffset=-1;else return a.preventDefault&&a.preventDefault(),!1}},_handleDrag:function(a){if(!this._ignoreEvent(a)&&this.isListening("Drag"))this.onDrag(this._createMouseEvent("Drag",
a))},_handleDragEnd:function(a){if(!this._ignoreEvent(a)){this._dropTarget=!1;this._dragOffset=-1;if(this.isListening("DragEnd"))this.onDragEnd(this._createMouseEvent("DragEnd",a));13>b.isFirefox&&(this._fixCaret(),"none"===a.dataTransfer.dropEffect&&!a.dataTransfer.mozUserCancelled&&this._fixCaret())}},_handleDragEnter:function(a){if(!this._ignoreEvent(a)){var c=!0;this._dropTarget=!0;this.isListening("DragEnter")&&(c=!1,this.onDragEnter(this._createMouseEvent("DragEnter",a)));if(b.isWebkit||c)return a.preventDefault&&
a.preventDefault(),!1}},_handleDragOver:function(a){if(!this._ignoreEvent(a)){var c=!0;this.isListening("DragOver")&&(c=!1,this.onDragOver(this._createMouseEvent("DragOver",a)));if(b.isWebkit||c)return c&&(a.dataTransfer.dropEffect="none"),a.preventDefault&&a.preventDefault(),!1}},_handleDragLeave:function(a){if(!this._ignoreEvent(a)&&(this._dropTarget=!1,this.isListening("DragLeave")))this.onDragLeave(this._createMouseEvent("DragLeave",a))},_handleDrop:function(a){if(!this._ignoreEvent(a)){this._dropTarget=
!1;if(this.isListening("Drop"))this.onDrop(this._createMouseEvent("Drop",a));a.preventDefault&&a.preventDefault();return!1}},_handleFocus:function(){this._hasFocus=!0;b.isIOS&&void 0!==this._lastTouchOffset?(this.setCaretOffset(this._lastTouchOffset,!0),this._lastTouchOffset=void 0):this._updateDOMSelection();this._cursorDiv&&(this._cursorDiv.style.display="block");this._domSelection&&this._domSelection.forEach(function(a){a.update()});if(!this._ignoreFocus)this.onFocus({type:"Focus"})},_handleKeyDown:function(a){this._cancelCheckSelection();
if(!this._ignoreEvent(a)){if(this.isListening("KeyDown")){var c=this._createKeyEvent("KeyDown",a);this.onKeyDown(c);if(c.defaultPrevented){b.isFirefox&&(this._keyDownPrevented=!0);a.preventDefault();return}}c=!1;switch(a.keyCode){case 16:case 17:case 18:case 91:c=!0;break;default:this._setLinksVisible(!1)}if(229===a.keyCode){if(this._readonly)return a.preventDefault&&a.preventDefault(),!1;c=!0;b.isSafari&&b.isMac&&a.ctrlKey&&(c=!1,a.keyCode=129);c&&this._startIME()}else c||this._commitIME();if((b.isMac||
b.isLinux)&&4>b.isFirefox||12.16>b.isOpera)return this._keyDownEvent=a,!0;if(this._doAction(a))return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),!1}},_handleKeyPress:function(a){if(!this._ignoreEvent(a))if(this._keyDownPrevented)a.preventDefault&&(a.preventDefault(),a.stopPropagation()),this._keyDownPrevented=void 0;else{if(b.isMac&&b.isWebkit&&(63232<=a.keyCode&&63487>=a.keyCode||13===a.keyCode||8===a.keyCode)||((b.isMac||b.isLinux)&&
4>b.isFirefox||12.16>b.isOpera)&&this._doAction(this._keyDownEvent))return a.preventDefault&&a.preventDefault(),!1;var c=b.isMac?a.metaKey:a.ctrlKey;if(void 0!==a.charCode&&c)switch(a.charCode){case 99:case 118:case 120:return!0}if(this.isListening("KeyPress")&&(c=this._createKeyEvent("KeyPress",a),this.onKeyPress(c),c.defaultPrevented)){a.preventDefault();return}if(this._doAction(a))return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),
!1;c=!1;if(b.isMac){if(a.ctrlKey||a.metaKey)c=!0}else if(b.isFirefox){if(a.ctrlKey||a.altKey)c=!0}else a.ctrlKey^a.altKey&&(c=!0);if(!c&&(c=b.isOpera?a.which:void 0!==a.charCode?a.charCode:a.keyCode,31<c))return this._doContent(String.fromCharCode(c)),a.preventDefault&&a.preventDefault(),!1}},_handleDocKeyUp:function(a){(b.isMac?a.metaKey:a.ctrlKey)||this._setLinksVisible(!1)},_handleKeyUp:function(a){if(!this._ignoreEvent(a)){if(this.isListening("KeyUp")){var c=this._createKeyEvent("KeyUp",a);this.onKeyUp(c);
if(c.defaultPrevented){a.preventDefault();return}}this._handleDocKeyUp(a);13===a.keyCode&&this._commitIME()}},_handleLinkClick:function(a){if(!(b.isMac?a.metaKey:a.ctrlKey))return a.preventDefault&&a.preventDefault(),!1},_handleMouse:function(a){var c=this._getWindow(),e=!0,g=c;if(b.isIE||b.isFirefox&&!this._overlayDiv)g=this._clientDiv;if(this._overlayDiv){this._hasFocus&&(this._ignoreFocus=!0);var d=this;c.setTimeout(function(){d.focus();d._ignoreFocus=!1},0)}var c=a.shiftKey,n=a.altKey,f=b.isMac?
a.metaKey:a.ctrlKey;this._blockSelection=this._doubleClickSelection=null;1===this._clickCount?(e=(!b.isOpera||12.16<=b.isOpera)&&this._hasFocus&&this.isListening("DragStart"),(e=this._setSelectionTo(a.clientX,a.clientY,!0,c,f,e))&&this._setGrab(g)):(this._isW3CEvents&&this._setGrab(g),this._setSelectionTo(a.clientX,a.clientY,!0,c,f,!1),this._doubleClickSelection=t.editing(this._getSelections()));n&&(this._blockSelection=t.editing(this._getSelections()));return e},_handleMouseDown:function(a){if(!this._ignoreEvent(a)){if(this._linksVisible)if("A"!==
(a.target||a.srcElement).tagName)this._setLinksVisible(!1);else return;this._commitIME();var c=a.which;c||(4===a.button&&(c=2),2===a.button&&(c=3),1===a.button&&(c=1));var e=2!==c&&a.timeStamp?a.timeStamp:(new Date).getTime(),g=e-this._lastMouseTime,d=Math.abs(this._lastMouseX-a.clientX),n=Math.abs(this._lastMouseY-a.clientY),t=this._lastMouseButton===c;this._lastMouseX=a.clientX;this._lastMouseY=a.clientY;this._lastMouseTime=e;this._lastMouseButton=c;1===c&&(this._isMouseDown=!0,t&&g<=this._clickTime&&
d<=this._clickDist&&n<=this._clickDist?this._clickCount++:this._clickCount=1);if(this.isListening("MouseDown")&&(e=this._createMouseEvent("MouseDown",a),this.onMouseDown(e),e.defaultPrevented)){a.preventDefault();return}if(1===c&&this._handleMouse(a)&&(9<=b.isIE||b.isOpera||b.isChrome||b.isSafari||b.isFirefox&&!this._overlayDiv))this._hasFocus||this.focus(),a.preventDefault();b.isFirefox&&3===this._lastMouseButton&&this._updateDOMSelection()}},_handleMouseOver:function(a){if(!this._ignoreEvent(a)&&
!this._animation&&this.isListening("MouseOver"))this.onMouseOver(this._createMouseEvent("MouseOver",a))},_handleMouseOut:function(a){if(!this._ignoreEvent(a)&&!this._animation&&this.isListening("MouseOut"))this.onMouseOut(this._createMouseEvent("MouseOut",a))},_handleMouseMove:function(a){if(!this._animation){var c=this._isClientDiv(a);if(this.isListening("MouseMove")&&(c||this._isMouseDown)){var e=this._createMouseEvent("MouseMove",a);this.onMouseMove(e);if(e.defaultPrevented){a.preventDefault();
return}}if(!this._dropTarget){e=this._linksVisible||this._lastMouseMoveX!==a.clientX||this._lastMouseMoveY!==a.clientY;this._lastMouseMoveX=a.clientX;this._lastMouseMoveY=a.clientY;this._setLinksVisible(e&&!this._isMouseDown&&a.altKey&&(b.isMac?a.metaKey:a.ctrlKey));this._checkOverlayScroll();if(!this._isW3CEvents){if(0===a.button)return this._setGrab(null),!0;if(!this._isMouseDown&&1===a.button&&0!==(this._clickCount&1)&&c)return this._clickCount=2,this._handleMouse(a,this._clickCount)}if(this._isMouseDown&&
-1===this._dragOffset){c=a.clientX;a=a.clientY;var g=this._getViewPadding(),d=this._viewDiv.getBoundingClientRect(),n=this._getClientWidth(),t=this._getClientHeight(),e=d.left+g.left,f=d.top+g.top,n=d.left+g.left+n,g=d.top+g.top+t;a<f?this._doAutoScroll("up",c,a-f):a>g?this._doAutoScroll("down",c,a-g):c<e&&!this._wrapMode?this._doAutoScroll("left",c-e,a):c>n&&!this._wrapMode?this._doAutoScroll("right",c-n,a):(this._endAutoScroll(),this._setSelectionTo(c,a,!1,!0))}}}},_isClientDiv:function(a){var c=
this._overlayDiv||this._clientDiv;for(a=a.target?a.target:a.srcElement;a;){if(c===a)return!0;a=a.parentNode}return!1},_createKeyEvent:function(a,c){return{type:a,event:c,preventDefault:function(){this.defaultPrevented=!0}}},_createMouseEvent:function(a,c){var e=this.convert({x:c.clientX,y:c.clientY},"page","document");return{type:a,event:c,clickCount:this._clickCount,x:e.x,y:e.y,preventDefault:function(){this.defaultPrevented=!0}}},_createTouchEvent:function(a,c){var e=c.touches.length?this.convert({x:c.touches[0].clientX,
y:c.touches[0].clientY},"page","document"):{};return{type:a,event:c,touchCount:c.touches.length,x:e.x,y:e.y,preventDefault:function(){this.defaultPrevented=!0}}},_handleMouseUp:function(a){var c=a.which?0===a.button:1===a.button;if(this.isListening("MouseUp")&&(this._isClientDiv(a)||c&&this._isMouseDown)){var e=this._createMouseEvent("MouseUp",a);this.onMouseUp(e);if(e.defaultPrevented){a.preventDefault();this._isMouseDown=!1;return}}if(!this._linksVisible){if(c&&this._isMouseDown){var e=this._getSelections(),
g=t.editing(e);e.forEach(function(a){a._editing=!1});-1!==this._dragOffset&&(g.extend(this._dragOffset),g.collapse(),e=g,this._dragOffset=-1);this._setSelection(e,!1);this._isMouseDown=!1;this._endAutoScroll();this._isW3CEvents&&this._setGrab(null)}c&&b.isFirefox&&(this._updateDOMSelection(),a.preventDefault())}},_handleMouseWheel:function(a){if(!this._noScroll){var c=this._getLineHeight(),e=0,g=0;b.isIE||b.isOpera?g=-a.wheelDelta/40*c:b.isFirefox?"wheel"===a.type?a.deltaMode?(e=Math.max(-256,Math.min(256,
a.deltaX))*c,g=Math.max(-256,Math.min(256,a.deltaY))*c):(e=a.deltaX,g=a.deltaY):(c=b.isMac?3*a.detail:Math.max(-256,Math.min(256,a.detail))*c,a.axis===a.HORIZONTAL_AXIS?e=c:g=c):b.isMac?(g=a.timeStamp-this._wheelTimeStamp,this._wheelTimeStamp=a.timeStamp,e=0!==a.wheelDeltaX%120?1:40>g?40/(40-g):40,g=0!==a.wheelDeltaY%120?1:40>g?40/(40-g):40,e=Math.ceil(-a.wheelDeltaX/e),-1<e&&0>e&&(e=-1),0<e&&1>e&&(e=1),g=Math.ceil(-a.wheelDeltaY/g),-1<g&&0>g&&(g=-1),0<g&&1>g&&(g=1)):(e=-a.wheelDeltaX,g=8*(-a.wheelDeltaY/
120)*c);if(b.isSafari||b.isChrome&&b.isMac){for(c=a.target;c&&void 0===c.lineIndex;)c=c.parentNode;this._mouseWheelLine=c}c=this._getScroll();this._scrollView(e,g);e=this._getScroll();if(c.x!==e.x||c.y!==e.y)return a.preventDefault&&a.preventDefault(),!1}},_handlePaste:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)&&!this._ignorePaste&&this._doPaste(a)){if(b.isIE){var c=this;this._ignoreFocus=!0;this._getWindow().setTimeout(function(){c._updateDOMSelection();c._ignoreFocus=!1},
0)}a.preventDefault&&a.preventDefault();return!1}},_handleResize:function(){var a=this._rootDiv.clientWidth,c=this._rootDiv.clientHeight;if(this._rootWidth!==a||this._rootHeight!==c)this._rootWidth!==a&&this._wrapMode&&this._resetLineHeight(),this._rootWidth=a,this._rootHeight=c,a=9>b.isIE,c=this._calculateMetrics(),s(c,this._metrics)||(this._metrics.invalid&&!c.invalid?this._updateStyle(!1,c):(this._variableLineHeight&&(this._variableLineHeight=!1,this._resetLineHeight()),this._metrics=c),a=!0),
a?this._queueUpdate():this._update(),this.dispatchEvent({type:"Resize"})},_handleRulerEvent:function(a){for(var c=a.target?a.target:a.srcElement,e=c.lineIndex;c&&!c._ruler;)void 0===e&&void 0!==c.lineIndex&&(e=c.lineIndex),c=c.parentNode;var b=c?c._ruler:null;if(void 0===e&&b&&"document"===b.getOverview()){var g=this._getClientHeight(),d=this._model.getLineCount(),n=this._getViewPadding(),e=this._viewDiv.getBoundingClientRect(),t=this._getLineHeight(),g=g+n.top+n.bottom-2*this._metrics.scrollWidth;
t*d<g?n=n.top:(t=g/d,n=this._metrics.scrollWidth);e=Math.floor((a.clientY-e.top-n)/t);0<=e&&e<d||(e=void 0)}if(b)switch(a.type){case "click":if(b.onClick)b.onClick(e,a);break;case "dblclick":if(b.onDblClick)b.onDblClick(e,a);break;case "mousemove":if(b.onMouseMove)b.onMouseMove(e,a);break;case "mouseover":if(b.onMouseOver)b.onMouseOver(e,a);break;case "mouseout":if(b.onMouseOut){for(d=a.relatedTarget;d&&d!==this._rootDiv;){if(d===c)return;d=d.parentNode}b.onMouseOut(e,a)}}},_handleScroll:function(){this._lastScrollTime=
(new Date).getTime();var a=this._getScroll(!1),c=this._hScroll,e=this._vScroll;if(c!==a.x||e!==a.y)this._hScroll=a.x,this._vScroll=a.y,this._commitIME(),this._update(e===a.y),this.onScroll({type:"Scroll",oldValue:{x:c,y:e},newValue:a})},_handleSelectStart:function(a){var c=this._contextMenuOpen;this._contextMenuOpen=!1;if(c)this._checkSelectionChange=!0;else if(this._ignoreSelect)return a&&a.preventDefault&&a.preventDefault(),!1},_getModelOffset:function(a,c){if(a){var e;e="DIV"===a.tagName?a:a.parentNode.parentNode;
return!e._line?0:e._line.getModelOffset(a,c)}},_updateSelectionFromDOM:function(){if(!b.isIOS&&!b.isAndroid&&!this._checkSelectionChange)return!1;var a=this._getWindow().getSelection(),c=this._getModelOffset(a.anchorNode,a.anchorOffset),e=this._getModelOffset(a.focusNode,a.focusOffset),g=this._getSelections()[0];if(void 0===c||void 0===e||g.start===c&&g.end===e)return!1;if(this._checkSelectionChange){var g=this._getLineNext(),d=this._getLinePrevious();if(a.anchorNode===g.firstChild.firstChild&&0===
a.anchorOffset&&a.focusNode===d.firstChild.firstChild&&0===a.focusOffset)return!1;if(a.anchorNode===g.firstChild.firstChild&&0===a.anchorOffset&&a.focusNode===d.lastChild.firstChild||a.anchorNode===this._clientDiv&&a.focusNode===this._clientDiv)c=0,e=this.getModel().getCharCount()}this._setSelection(new t(c,e),!1,!1);this._checkSelectionChange=!1;return!0},_cancelCheckSelection:function(){this._checkSelectionChange&&(this._checkSelectionChange=!1,this._cancelPollSelectionChange())},_cancelPollSelectionChange:function(){this._selPollTimer&&
(this._getWindow().clearTimeout(this._selPollTimer),this._selPollTimer=null)},_pollSelectionChange:function(a){var c=this,e=this._getWindow();this._cancelPollSelectionChange();this._selPollTimer=e.setTimeout(function(){c._selPollTimer=null;c._clientDiv&&!c._updateSelectionFromDOM()&&a&&c._pollSelectionChange(a)},100)},_handleSelectionChange:function(){-1===this._imeOffset&&(b.isAndroid?this._pollSelectionChange():this._updateSelectionFromDOM())},_handleTextInput:function(a){if(!this._ignoreEvent(a)&&
-1===this._imeOffset){var c=this._getWindow().getSelection();if(c.anchorNode!==this._anchorNode||c.focusNode!==this._focusNode||c.anchorOffset!==this._anchorOffset||c.focusOffset!==this._focusOffset){for(var e=c.anchorNode;e&&void 0===e.lineIndex;)e=e.parentNode;if(e){var b=this._model,g=e.lineIndex,d=b.getLine(g),n=d,t=0,b=b.getLineStart(g);0<c.rangeCount&&(c.getRangeAt(0).deleteContents(),g=e.ownerDocument.createTextNode(a.data),c.getRangeAt(0).insertNode(g),t=this._getDOMText(e,g),n=t.text,t=t.offset,
g.parentNode.removeChild(g));e.lineRemoved=!0;for(e=0;d.charCodeAt(e)===n.charCodeAt(e)&&e<t;)e++;c=d.length-1;for(g=n.length-d.length;d.charCodeAt(c)===n.charCodeAt(c+g)&&c+g>=t+a.data.length;)c--;c++;d=n.substring(e,c+g);e+=b;c+=b;n=this._getSelections();t=n[0].start-e;b=n[0].end-c;n[0].start=e;n[0].end=c;for(e=1;e<n.length;e++)n[e].start-=t,n[e].end-=b;this._modifyContent({text:d,selection:n,_ignoreDOMSelection:!0},!0)}}else this._doContent(a.data);a.preventDefault()}},_handleTouchStart:function(a){if(this.isListening("TouchStart")){var c=
this._createTouchEvent("TouchStart",a);this.onTouchStart(c);if(c.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}this._commitIME();c=this._getWindow();this._touchScrollTimer&&(this._vScrollDiv.style.display="none",this._hScrollDiv.style.display="none",c.clearInterval(this._touchScrollTimer),this._touchScrollTimer=null);var e=a.touches;if(1===e.length){var e=e[0],g=e.clientX,d=e.clientY;this._touchStartX=g;this._touchStartY=d;if(b.isAndroid&&(d<e.pageY-c.pageYOffset||g<e.pageX-
c.pageXOffset))g=e.pageX-c.pageXOffset,d=e.pageY-c.pageYOffset;c=this.convert({x:g,y:d},"page","document");this._lastTouchOffset=this.getOffsetAtLocation(c.x,c.y);this._touchStartTime=a.timeStamp;this._touching=!0}},_handleTouchMove:function(a){if(this.isListening("TouchMove")){var c=this._createTouchEvent("TouchMove",a);this.onTouchMove(c);if(c.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}c=a.touches;if(1===c.length){c=c[0];this._touchCurrentX=c.clientX;this._touchCurrentY=
c.clientY;if(!this._touchScrollTimer&&200>a.timeStamp-this._touchStartTime){this._vScrollDiv.style.display="block";this._wrapMode||(this._hScrollDiv.style.display="block");var e=this,b=this._getWindow();this._touchScrollTimer=b.setInterval(function(){var a=0,c=0;if(e._touching)a=e._touchStartX-e._touchCurrentX,c=e._touchStartY-e._touchCurrentY,e._touchSpeedX=a/10,e._touchSpeedY=c/10,e._touchStartX=e._touchCurrentX,e._touchStartY=e._touchCurrentY;else{if(0.1>Math.abs(e._touchSpeedX)&&0.1>Math.abs(e._touchSpeedY)){e._vScrollDiv.style.display=
"none";e._hScrollDiv.style.display="none";b.clearInterval(e._touchScrollTimer);e._touchScrollTimer=null;return}a=10*e._touchSpeedX;c=10*e._touchSpeedY;e._touchSpeedX*=0.95;e._touchSpeedY*=0.95}e._scrollView(a,c)},10)}this._touchScrollTimer&&a.preventDefault()}},_handleTouchEnd:function(a){if(this.isListening("TouchEnd")){var c=this._createTouchEvent("TouchEnd",a);this.onTouchEnd(c);if(c.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}0===a.touches.length&&(this._touching=!1)},
_doAction:function(a){var c,e,b=this._keyModes;for(e=b.length-1;0<=e;e--)if(c=b[e],"function"===typeof c.match&&(c=c.match(a),void 0!==c))return this.invokeAction(c);return!1},_doMove:function(a,c){var e=this._model,b=c.getCaret(),g=e.getLineAtOffset(b);a.count||(a.count=1);for(;0!==a.count;){var d=e.getLineStart(g);if(0>a.count&&b===d)if(0<g)"character"===a.unit&&a.count++,g--,c.extend(e.getLineEnd(g));else break;else if(0<a.count&&b===e.getLineEnd(g))if(g+1<e.getLineCount())"character"===a.unit&&
a.count--,g++,c.extend(e.getLineStart(g));else break;else{var n=!1;a.expandTab&&("character"===a.unit&&0===(b-d)%this._tabSize)&&(d=e.getText(d,b),n=!/[^ ]/.test(d));n?(c.extend(b-this._tabSize),a.count+=0>a.count?1:-1):(d=this._getLine(g),c.extend(d.getNextOffset(b,a)),d.destroy())}b=c.getCaret()}return c},_doBackspace:function(a){var c=this,e=this._getSelections();e.forEach(function(e){e.isEmpty()&&(a.count||(a.count=1),a.count*=-1,a.expandTab=c._expandTab,c._doMove(a,e))});this._modifyContent({text:"",
selection:e},!0);return!0},_doCase:function(a){var c=this,e=this._getSelections(),b=[];e.forEach(function(e){c._doMove(a,e);e=c.getText(e.start,e.end);switch(a.type){case "lower":e=e.toLowerCase();break;case "capitalize":e=e.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()});break;case "reverse":for(var g="",d=0;d<e.length;d++)var n=e[d],t=n.toLowerCase(),n=t!==n?t:n.toUpperCase(),g=g+n;e=g;break;default:e=e.toUpperCase()}b.push(e)});return this._modifyContent({text:b,selection:e,_ignoreDOMSelection:!0},
!0)},_doContent:function(a){var c=this,e=this._getSelections();e.forEach(function(a){if(c._overwriteMode&&a.isEmpty()){var e=c._model,b=e.getLineAtOffset(a.end);a.end<e.getLineEnd(b)&&(e=c._getLine(b),a.extend(e.getNextOffset(a.getCaret(),{unit:"character",count:1})),e.destroy())}});return this._modifyContent({text:a,selection:e,_ignoreDOMSelection:!0},!0)},_doCopy:function(a){var c=this.getSelectionText();return c?this._setClipboardText(c,a):!0},_doCursorNext:function(a){var c=this,e=this._getSelections();
e.forEach(function(e){!e.isEmpty()&&!a.select?e.start=e.end:c._doMove(a,e);a.select||e.collapse()});this._setSelection(e,!0);return!0},_doCursorPrevious:function(a){var c=this,e=this._getSelections();e.forEach(function(e){!e.isEmpty()&&!a.select?e.end=e.start:(a.count||(a.count=1),a.count*=-1,c._doMove(a,e));a.select||e.collapse()});this._setSelection(e,!0);return!0},_doCut:function(a){var c=this.getSelectionText();return c?(this._doContent(""),this._setClipboardText(c,a)):!0},_doDelete:function(a){var c=
this,e=this._getSelections();e.forEach(function(e){e.isEmpty()&&c._doMove(a,e)});this._modifyContent({text:"",selection:e},!0);return!0},_doEnd:function(a){var c=this._model,e=this,b=this._getSelections();b.forEach(function(b){if(a.ctrl)b.extend(c.getCharCount());else{var g=b.getCaret(),d=c.getLineAtOffset(g);if(e._wrapMode){var n=e._getLine(d),g=n.getLineIndex(g),g=g===n.getLineCount()-1?c.getLineEnd(d):n.getLineStart(g+1)-1;n.destroy()}else a.count&&0<a.count&&(d=Math.min(d+a.count-1,c.getLineCount()-
1)),g=c.getLineEnd(d);b.extend(g)}a.select||b.collapse()});this._setSelection(b,!0,!0,a.ctrl?function(){}:null);return!0},_doEnter:function(a){if(this._singleMode)return!0;var c=this._model,e=this._getSelections();this._doContent(c.getLineDelimiter());a&&a.noCursor&&(e.forEach(function(a){a.end=a.start}),this._setSelection(e,!0));return!0},_doEscape:function(){var a=this._getSelections();1<a.length&&this._setSelection(a[0],!0);return!0},_doHome:function(a){var c=this._model,e=this,b=this._getSelections();
b.forEach(function(b){if(a.ctrl)b.extend(0);else{var g=b.getCaret(),d=c.getLineAtOffset(g);e._wrapMode?(d=e._getLine(d),g=d.getLineIndex(g),g=d.getLineStart(g),d.destroy()):g=c.getLineStart(d);b.extend(g)}a.select||b.collapse()});this._setSelection(b,!0,!0,a.ctrl?function(){}:null);return!0},_doLineDown:function(a){var c=this._model,e=this,g=this._getSelections();g.forEach(function(g){var d=g.getCaret(),n=c.getLineAtOffset(d),t=e._getLine(n),f=g._columnX,u=1,m=!1;if(-1===f||a.wholeLine||a.select&&
b.isIE)f=a.wholeLine?c.getLineEnd(n+1):d,f=g._columnX=t.getBoundingClientRect(f).left;(d=t.getLineIndex(d))<t.getLineCount()-1?u=t.getClientRects(d+1).top+1:(d=c.getLineCount()-1,m=n===d,a.count&&0<a.count?n=Math.min(n+a.count,d):n++);d=!1;if(m){if(a.select||b.isMac||b.isLinux)g.extend(c.getCharCount()),d=!0}else t.lineIndex!==n&&(t.destroy(),t=e._getLine(n)),g.extend(t.getOffset(f,u)),d=!0;d&&(a.select||g.collapse());t.destroy()});e._setSelection(g,!0,!0,null,0,!1,!0);return!0},_doLineUp:function(a){var c=
this._model,e=this,g=this._getSelections();g.forEach(function(g){var d=g.getCaret(),n=c.getLineAtOffset(d),t=e._getLine(n),f=g._columnX,u=!1,m;if(-1===f||a.wholeLine||a.select&&b.isIE)f=a.wholeLine?c.getLineStart(n-1):d,f=g._columnX=t.getBoundingClientRect(f).left;0<(d=t.getLineIndex(d))?m=t.getClientRects(d-1).top+1:(u=0===n,u||(a.count&&0<a.count?n=Math.max(n-a.count,0):n--,m=e._getLineHeight(n)-1));d=!1;if(u){if(a.select||b.isMac||b.isLinux)g.extend(0),d=!0}else t.lineIndex!==n&&(t.destroy(),t=
e._getLine(n)),g.extend(t.getOffset(f,m)),d=!0;d&&(a.select||g.collapse());t.destroy()});e._setSelection(g,!0,!0,null,0,!1,!0);return!0},_doNoop:function(){return!0},_doPageDown:function(a){var c=this,e=this._model,g=this._getSelections(),d=e.getLineCount(),n=this._getScroll(),t=this._getClientHeight(),f=this._getLineHeight(),u=Math.floor(t/f),m,s,v;g.forEach(function(g){var k=g.getCaret(),h=e.getLineAtOffset(k);if(c._lineHeight){m=g._columnX;var A=c._getBoundsAtOffset(k);if(-1===m||a.select&&b.isIE)m=
g._columnX=A.left;k=c._getLineIndex(A.top+t);s=c._getLine(k);var h=c._getLinePixel(k),k=s.getOffset(m,A.top+t-h),l=s.getBoundingClientRect(k);s.destroy();g.extend(k);a.select||g.collapse();v=void 0!==v?Math.min(v,l.top+h-A.top):l.top+h-A.top}else if(h<d-1){A=Math.min(d-h-1,u);A=Math.max(1,A);m=g._columnX;if(-1===m||a.select&&b.isIE)s=c._getLine(h),m=g._columnX=s.getBoundingClientRect(k).left,s.destroy();s=c._getLine(h+A);g.extend(s.getOffset(m,0));s.destroy();a.select||g.collapse();g=d*f;k=n.y+A*
f;k+t>g&&(k=g-t);v=void 0!==v?Math.min(v,k-n.y):k-n.y}});this._setSelection(g,!0,!0,function(){},v,!1,!0);return!0},_doPageUp:function(a){var c=this,e=this._model,g=this._getSelections(),d=this._getScroll(),n=this._getClientHeight(),t=this._getLineHeight(),f=Math.floor(n/t),u,m,s;g.forEach(function(g){var v=g.getCaret(),k=e.getLineAtOffset(v);if(c._lineHeight){u=g._columnX;k=c._getBoundsAtOffset(v);if(-1===u||a.select&&b.isIE)u=g._columnX=k.left;v=c._getLineIndex(k.bottom-n);m=c._getLine(v);var h=
c._getLinePixel(v),v=m.getOffset(u,k.bottom-n-h),A=m.getBoundingClientRect(v);m.destroy();g.extend(v);a.select||g.collapse();s=void 0!==s?Math.max(s,A.top+h-k.top):A.top+h-k.top}else if(0<k){h=Math.max(1,Math.min(k,f));u=g._columnX;if(-1===u||a.select&&b.isIE)m=c._getLine(k),u=g._columnX=m.getBoundingClientRect(v).left,m.destroy();m=c._getLine(k-h);g.extend(m.getOffset(u,c._getLineHeight(k-h)-1));m.destroy();a.select||g.collapse();g=Math.max(0,d.y-h*t);s=void 0!==s?Math.max(s,g-d.y):g-d.y}});this._setSelection(g,
!0,!0,function(){},s,!1,!0);return!0},_doPaste:function(a){var c=this;return null!==this._getClipboardText(a,function(a){if(a.length){b.isLinux&&2===c._lastMouseButton&&(new Date).getTime()-c._lastMouseTime<=c._clickTime&&c._setSelectionTo(c._lastMouseX,c._lastMouseY,!0);var e=c._getSelections(),g=c._singleMode?"":c._model.getLineDelimiter();c._doContent(1<e.length&&e.length===a.length?a:a.join(g))}})},_doScroll:function(a){var c=a.type,e=this._model,b=e.getLineCount();a=this._getClientHeight();var g=
this._getLineHeight(),b=this._lineHeight?this._scrollHeight:b*g,d=this._getScroll().y,n;switch(c){case "textStart":n=0;break;case "textEnd":n=b-a;break;case "pageDown":n=d+a;break;case "pageUp":n=d-a;break;case "lineDown":n=d+g;break;case "lineUp":n=d-g;break;case "centerLine":c=this._getSelections()[0],n=e.getLineAtOffset(c.start),e=(e.getLineAtOffset(c.end)-n+1)*g,n=n*g-a/2+e/2}void 0!==n&&(n=Math.min(Math.max(0,n),b-a),this._scrollViewAnimated(0,n-d,function(){}));return!0},_doSelectAll:function(){this._setSelection(new t(0,
this._model.getCharCount()),!1);return!0},_doTab:function(){if(this._tabMode&&!this._readonly){var a="\t",c=this._getSelections();if(this._expandTab){var a=[],e=this._model,b=this._tabSize;c.forEach(function(c){c=c.getCaret();var g=e.getLineAtOffset(c),g=e.getLineStart(g);a.push(Array(b-(c-g)%b+1).join(" "))})}return this._modifyContent({text:a,selection:c,_ignoreDOMSelection:!0},!0)}},_doShiftTab:function(){if(this._tabMode&&!this._readonly)return!0},_doOverwriteMode:function(){if(!this._readonly)return this.setOptions({overwriteMode:!this.getOptions("overwriteMode")}),
!0},_doTabMode:function(){this._tabMode=!this._tabMode;return!0},_doWrapMode:function(){this.setOptions({wrapMode:!this.getOptions("wrapMode")});return!0},_autoScroll:function(){var a=this._model,c=this._getSelections(),e=t.editing(c,"down"===this._autoScrollDir),g=this.convert({x:this._autoScrollX,y:this._autoScrollY},"page","document"),d=e.getCaret(),n=a.getLineCount(),f=a.getLineAtOffset(d),u;if("up"===this._autoScrollDir||"down"===this._autoScrollDir)d=this._autoScrollY/this._getLineHeight(),
d=0>d?Math.floor(d):Math.ceil(d),u=Math.max(0,Math.min(n-1,f+d));else if("left"===this._autoScrollDir||"right"===this._autoScrollDir)u=this._getLineIndex(g.y),f=this._getLine(f),g.x+=f.getBoundingClientRect(d,!1).left,f.destroy();this._blockSelection?c=this._getBlockSelections(c,u,g):0===u&&(b.isMac||b.isLinux)?e.extend(0):u===n-1&&(b.isMac||b.isLinux)?e.extend(a.getCharCount()):(f=this._getLine(u),e.extend(f.getOffset(g.x,g.y-this._getLinePixel(u))),f.destroy());this._setSelection(c,!0)},_autoScrollTimer:function(){this._autoScroll();
var a=this;this._autoScrollTimerID=this._getWindow().setTimeout(function(){a._autoScrollTimer()},this._AUTO_SCROLL_RATE)},_calculateLineHeightTimer:function(a){if(this._lineHeight&&!this._calculateLHTimer){var c=this._model.getLineCount(),e=0;if(a){a=0;for(var b=(new Date).getTime(),g=0;e<c&&!(this._lineHeight[e]||(a++,g||(g=e),this._lineHeight[e]=this._calculateLineHeight(e)),e++,100<(new Date).getTime()-b););this.redrawRulers(0,c);this._queueUpdate()}a=this._getWindow();if(e!==c){var d=this;this._calculateLHTimer=
a.setTimeout(function(){d._calculateLHTimer=null;d._calculateLineHeightTimer(!0)},0)}else this._calculateLHTimer&&(a.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=void 0)}},_calculateLineHeight:function(a){a=this._getLine(a);var c=a.getBoundingClientRect();a.destroy();return Math.max(1,c.bottom-c.top)},_calculateMetrics:function(){var a=this._clientDiv,e=a.ownerDocument,g=b.createElement(e,"div");g.style.lineHeight="normal";var d={type:"LineStyle",textView:this,0:0,lineText:this._model.getLine(0),
lineStart:0};this.onLineStyle(d);m(d.style,g);g.style.position="fixed";g.style.left="-1000px";var t=b.createElement(e,"span");t.appendChild(e.createTextNode(" "));g.appendChild(t);var f=b.createElement(e,"span");f.style.fontStyle="italic";f.appendChild(e.createTextNode(" "));g.appendChild(f);var u=b.createElement(e,"span");u.style.fontWeight="bold";u.appendChild(e.createTextNode(" "));g.appendChild(u);d=b.createElement(e,"span");d.style.fontWeight="bold";d.style.fontStyle="italic";d.appendChild(e.createTextNode(" "));
g.appendChild(d);a.appendChild(g);var s=g.getBoundingClientRect(),t=t.getBoundingClientRect(),f=f.getBoundingClientRect(),u=u.getBoundingClientRect(),d=d.getBoundingClientRect(),t=t.bottom-t.top,f=f.bottom-f.top,u=u.bottom-u.top,k=d.bottom-d.top,v=0,d=0>=s.bottom-s.top,s=Math.max(1,s.bottom-s.top);f>t&&(v=1);u>f&&(v=2);k>u&&(v=3);var h;0!==v&&(h={style:{}},0!==(v&1)&&(h.style.fontStyle="italic"),0!==(v&2)&&(h.style.fontWeight="bold"));t=c(g);a.removeChild(g);v=n(this._viewDiv);g=b.createElement(e,
"div");g.style.position="fixed";g.style.left="-1000px";g.style.paddingLeft=v.left+"px";g.style.paddingTop=v.top+"px";g.style.paddingRight=v.right+"px";g.style.paddingBottom=v.bottom+"px";g.style.width="100px";g.style.height="100px";v=b.createElement(e,"div");v.style.width="100%";v.style.height="100%";g.appendChild(v);a.appendChild(g);f=g.getBoundingClientRect();u=v.getBoundingClientRect();k=0;!this._singleMode&&!this._noScroll&&(g.style.overflow="hidden",v.style.height="200px",k=g.clientWidth,g.style.overflow=
"scroll",k-=g.clientWidth);a.removeChild(g);var v={left:u.left-f.left,top:u.top-f.top,right:f.right-u.right,bottom:f.bottom-u.bottom},A=0,l=u=0;if(!d){g=b.createElement(e,"div");g.style.position="fixed";g.style.left="-1000px";a.appendChild(g);g.innerHTML=Array(2).join("a");f=g.getBoundingClientRect();l=Math.ceil(f.right-f.left);if(this._wrapOffset||this._marginOffset)g.innerHTML=Array(this._wrapOffset+1+(b.isWebkit?0:1)).join(" "),f=g.getBoundingClientRect(),A=Math.ceil(f.right-f.left),g.innerHTML=
Array(this._marginOffset+1).join(" "),u=g.getBoundingClientRect(),u=Math.ceil(u.right-u.left);a.removeChild(g)}return{lineHeight:s,largestFontStyle:h,lineTrim:t,viewPadding:v,scrollWidth:k,wrapWidth:A,marginWidth:u,charWidth:l,invalid:d}},_cancelAnimation:function(){this._animation&&(this._animation.stop(),this._animation=null)},_clearSelection:function(a){var c=this._getSelections();c.forEach(function(c){"next"===a?c.start=c.end:c.end=c.start});this._setSelection(c,!0);return!0},_commitIME:function(a){if(-1!==
this._imeOffset){var c=this._model,e=c.getLineAtOffset(this._imeOffset),g=c.getLineStart(e),d=this._getLineNode(e);if(!a){this._scrollDiv.focus();this._clientDiv.focus();var n=this._getDOMText(d).text,c=c.getLine(e),g=this._imeOffset-g,c=g+n.length-c.length;g!==c&&(a=n.substring(g,c))}this._imeOffset=-1;a&&(!this._doContent(a)&&!b.isWebkit)&&(d.lineRemoved=!0,this._queueUpdate())}},_createActions:function(){this.addKeyMode(new p.DefaultKeyMode(this));var c=this;this._actions={noop:{defaultHandler:function(){return c._doNoop()}},
lineUp:{defaultHandler:function(e){return c._doLineUp(a(e,{select:!1}))},actionDescription:{name:l.lineUp}},lineDown:{defaultHandler:function(e){return c._doLineDown(a(e,{select:!1}))},actionDescription:{name:l.lineDown}},lineStart:{defaultHandler:function(e){return c._doHome(a(e,{select:!1,ctrl:!1}))},actionDescription:{name:l.lineStart}},lineEnd:{defaultHandler:function(e){return c._doEnd(a(e,{select:!1,ctrl:!1}))},actionDescription:{name:l.lineEnd}},charPrevious:{defaultHandler:function(e){return c._doCursorPrevious(a(e,
{select:!1,unit:"character"}))},actionDescription:{name:l.charPrevious}},charNext:{defaultHandler:function(e){return c._doCursorNext(a(e,{select:!1,unit:"character"}))},actionDescription:{name:l.charNext}},pageUp:{defaultHandler:function(e){return c._doPageUp(a(e,{select:!1}))},actionDescription:{name:l.pageUp}},pageDown:{defaultHandler:function(e){return c._doPageDown(a(e,{select:!1}))},actionDescription:{name:l.pageDown}},scrollPageUp:{defaultHandler:function(e){return c._doScroll(a(e,{type:"pageUp"}))},
actionDescription:{name:l.scrollPageUp}},scrollPageDown:{defaultHandler:function(e){return c._doScroll(a(e,{type:"pageDown"}))},actionDescription:{name:l.scrollPageDown}},scrollLineUp:{defaultHandler:function(e){return c._doScroll(a(e,{type:"lineUp"}))},actionDescription:{name:l.scrollLineUp}},scrollLineDown:{defaultHandler:function(e){return c._doScroll(a(e,{type:"lineDown"}))},actionDescription:{name:l.scrollLineDown}},wordPrevious:{defaultHandler:function(e){return c._doCursorPrevious(a(e,{select:!1,
unit:"word"}))},actionDescription:{name:l.wordPrevious}},wordNext:{defaultHandler:function(e){return c._doCursorNext(a(e,{select:!1,unit:"word"}))},actionDescription:{name:l.wordNext}},textStart:{defaultHandler:function(e){return c._doHome(a(e,{select:!1,ctrl:!0}))},actionDescription:{name:l.textStart}},textEnd:{defaultHandler:function(e){return c._doEnd(a(e,{select:!1,ctrl:!0}))},actionDescription:{name:l.textEnd}},scrollTextStart:{defaultHandler:function(e){return c._doScroll(a(e,{type:"textStart"}))},
actionDescription:{name:l.scrollTextStart}},scrollTextEnd:{defaultHandler:function(e){return c._doScroll(a(e,{type:"textEnd"}))},actionDescription:{name:l.scrollTextEnd}},centerLine:{defaultHandler:function(e){return c._doScroll(a(e,{type:"centerLine"}))},actionDescription:{name:l.centerLine}},selectLineUp:{defaultHandler:function(e){return c._doLineUp(a(e,{select:!0}))},actionDescription:{name:l.selectLineUp}},selectLineDown:{defaultHandler:function(e){return c._doLineDown(a(e,{select:!0}))},actionDescription:{name:l.selectLineDown}},
selectWholeLineUp:{defaultHandler:function(e){return c._doLineUp(a(e,{select:!0,wholeLine:!0}))},actionDescription:{name:l.selectWholeLineUp}},selectWholeLineDown:{defaultHandler:function(e){return c._doLineDown(a(e,{select:!0,wholeLine:!0}))},actionDescription:{name:l.selectWholeLineDown}},selectLineStart:{defaultHandler:function(e){return c._doHome(a(e,{select:!0,ctrl:!1}))},actionDescription:{name:l.selectLineStart}},selectLineEnd:{defaultHandler:function(e){return c._doEnd(a(e,{select:!0,ctrl:!1}))},
actionDescription:{name:l.selectLineEnd}},selectCharPrevious:{defaultHandler:function(e){return c._doCursorPrevious(a(e,{select:!0,unit:"character"}))},actionDescription:{name:l.selectCharPrevious}},selectCharNext:{defaultHandler:function(e){return c._doCursorNext(a(e,{select:!0,unit:"character"}))},actionDescription:{name:l.selectCharNext}},selectPageUp:{defaultHandler:function(e){return c._doPageUp(a(e,{select:!0}))},actionDescription:{name:l.selectPageUp}},selectPageDown:{defaultHandler:function(e){return c._doPageDown(a(e,
{select:!0}))},actionDescription:{name:l.selectPageDown}},selectWordPrevious:{defaultHandler:function(e){return c._doCursorPrevious(a(e,{select:!0,unit:"word"}))},actionDescription:{name:l.selectWordPrevious}},selectWordNext:{defaultHandler:function(e){return c._doCursorNext(a(e,{select:!0,unit:"word"}))},actionDescription:{name:l.selectWordNext}},selectTextStart:{defaultHandler:function(e){return c._doHome(a(e,{select:!0,ctrl:!0}))},actionDescription:{name:l.selectTextStart}},selectTextEnd:{defaultHandler:function(e){return c._doEnd(a(e,
{select:!0,ctrl:!0}))},actionDescription:{name:l.selectTextEnd}},deletePrevious:{defaultHandler:function(e){return c._doBackspace(a(e,{unit:"character"}))},actionDescription:{name:l.deletePrevious}},deleteNext:{defaultHandler:function(e){return c._doDelete(a(e,{unit:"character"}))},actionDescription:{name:l.deleteNext}},deleteWordPrevious:{defaultHandler:function(e){return c._doBackspace(a(e,{unit:"word"}))},actionDescription:{name:l.deleteWordPrevious}},deleteWordNext:{defaultHandler:function(e){return c._doDelete(a(e,
{unit:"word"}))},actionDescription:{name:l.deleteWordNext}},deleteLineStart:{defaultHandler:function(e){return c._doBackspace(a(e,{unit:"line"}))},actionDescription:{name:l.deleteLineStart}},deleteLineEnd:{defaultHandler:function(e){return c._doDelete(a(e,{unit:"line"}))},actionDescription:{name:l.deleteLineEnd}},tab:{defaultHandler:function(e){return c._doTab(a(e,{}))},actionDescription:{name:l.tab}},shiftTab:{defaultHandler:function(e){return c._doShiftTab(a(e,{}))},actionDescription:{name:l.shiftTab}},
enter:{defaultHandler:function(e){return c._doEnter(a(e,{}))},actionDescription:{name:l.enter}},enterNoCursor:{defaultHandler:function(e){return c._doEnter(a(e,{noCursor:!0}))},actionDescription:{name:l.enterNoCursor}},escape:{defaultHandler:function(e){return c._doEscape(a(e,{}))},actionDescription:{name:l.escape}},selectAll:{defaultHandler:function(e){return c._doSelectAll(a(e,{}))},actionDescription:{name:l.selectAll}},copy:{defaultHandler:function(e){return c._doCopy(a(e,{}))},actionDescription:{name:l.copy}},
cut:{defaultHandler:function(e){return c._doCut(a(e,{}))},actionDescription:{name:l.cut}},paste:{defaultHandler:function(e){return c._doPaste(a(e,{}))},actionDescription:{name:l.paste}},uppercase:{defaultHandler:function(e){return c._doCase(a(e,{type:"upper"}))},actionDescription:{name:l.uppercase}},lowercase:{defaultHandler:function(e){return c._doCase(a(e,{type:"lower"}))},actionDescription:{name:l.lowercase}},capitalize:{defaultHandler:function(e){return c._doCase(a(e,{unit:"word",type:"capitalize"}))},
actionDescription:{name:l.capitalize}},reversecase:{defaultHandler:function(e){return c._doCase(a(e,{type:"reverse"}))},actionDescription:{name:l.reversecase}},toggleOverwriteMode:{defaultHandler:function(e){return c._doOverwriteMode(a(e,{}))},actionDescription:{name:l.toggleOverwriteMode}},toggleTabMode:{defaultHandler:function(e){return c._doTabMode(a(e,{}))},actionDescription:{name:l.toggleTabMode}},toggleWrapMode:{defaultHandler:function(e){return c._doWrapMode(a(e,{}))},actionDescription:{name:l.toggleWrapMode}}}},
_createRulerParent:function(a,c){var e=b.createElement(a,"div");e.className=c;e.tabIndex=-1;e.style.overflow="hidden";e.style.MozUserSelect="none";e.style.WebkitUserSelect="none";e.style.position="absolute";e.style.top="0px";e.style.bottom="0px";e.style.cursor="default";e.style.display="none";e.setAttribute("aria-hidden","true");this._rootDiv.appendChild(e);return e},_createRuler:function(a,c){if(this._clientDiv){var e=this._getRulerParent(a);if(e){if(e!==this._marginDiv||this._marginOffset)e.style.display=
"block";e.rulerWidth=void 0;var g=b.createElement(e.ownerDocument,"div");g._ruler=a;a.node=g;g.rulerChanged=!0;g.style.position="relative";g.style.cssFloat="left";g.style.styleFloat="left";g.style.outline="none";if(void 0===c||0>c||c>=e.children.length)e.appendChild(g);else{for(var d=e.firstChild;d&&0<c--;)d=d.nextSibling;e.insertBefore(g,d)}}}},_createSelectionDiv:function(){var a=b.createElement(this._parent.ownerDocument,"div");a.className="textviewSelection";a.style.position="absolute";a.style.borderWidth=
"0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";a.style.width="0px";a.style.height="0px";a.style.zIndex="0";return a},_createView:function(){function a(){n._rootDiv&&(n.update(!0),n._metrics.invalid&&n._getWindow().setTimeout(function(){a()},100))}if(!this._clientDiv){for(var c=this._parent;c.hasChildNodes();)c.removeChild(c.lastChild);var e=c.ownerDocument,g=b.createElement(e,"div");this._rootDiv=g;g.tabIndex=-1;g.style.position="relative";g.style.overflow="hidden";g.style.width=
"100%";g.style.height="100%";g.style.overflow="hidden";g.style.WebkitTextSizeAdjust="100%";g.setAttribute("role","application");c.appendChild(g);this._leftDiv=this._createRulerParent(e,"textviewLeftRuler");c=b.createElement(e,"div");c.className="textviewScroll";this._viewDiv=c;c.tabIndex=-1;c.style.position="absolute";c.style.top="0px";c.style.bottom="0px";c.style.borderWidth="0px";c.style.margin="0px";c.style.outline="none";c.style.background="transparent";g.appendChild(c);var d=this._createRulerParent(e,
"textviewRightRuler");this._rightDiv=d;d.style.right="0px";this._innerRightDiv=d=this._createRulerParent(e,"textviewInnerRightRuler");d.style.zIndex="1";this._scrollDiv=d=b.createElement(e,"div");d.style.margin="0px";d.style.borderWidth="0px";d.style.padding="0px";c.appendChild(d);(this._marginDiv=this._createRulerParent(e,"textviewMarginRuler")).style.zIndex="4";!b.isIE&&!b.isIOS&&(this._clipDiv=c=b.createElement(e,"div"),c.style.position="absolute",c.style.overflow="hidden",c.style.margin="0px",
c.style.borderWidth="0px",c.style.padding="0px",c.style.background="transparent",g.appendChild(c),this._clipScrollDiv=d=b.createElement(e,"div"),d.style.position="absolute",d.style.height="1px",d.style.top="-1000px",d.style.background="transparent",c.appendChild(d));c=b.createElement(e,"div");c.className="textviewContent";this._clientDiv=c;c.tabIndex=0;c.style.position="absolute";c.style.borderWidth="0px";c.style.margin="0px";c.style.padding="0px";c.style.outline="none";c.style.zIndex="1";c.style.WebkitUserSelect=
"text";c.setAttribute("spellcheck","false");if(b.isIOS||b.isAndroid)c.style.WebkitTapHighlightColor="transparent";(this._clipDiv||g).appendChild(c);this._setFullSelection(this._fullSelection,!0);if(b.isIOS||b.isAndroid)this._vScrollDiv=d=b.createElement(e,"div"),d.style.position="absolute",d.style.borderWidth="1px",d.style.borderColor="white",d.style.borderStyle="solid",d.style.borderRadius="4px",d.style.backgroundColor="black",d.style.opacity="0.5",d.style.margin="0px",d.style.padding="0px",d.style.outline=
"none",d.style.zIndex="3",d.style.width="8px",d.style.display="none",g.appendChild(d),this._hScrollDiv=d=b.createElement(e,"div"),d.style.position="absolute",d.style.borderWidth="1px",d.style.borderColor="white",d.style.borderStyle="solid",d.style.borderRadius="4px",d.style.backgroundColor="black",d.style.opacity="0.5",d.style.margin="0px",d.style.padding="0px",d.style.outline="none",d.style.zIndex="3",d.style.height="8px",d.style.display="none",g.appendChild(d);b.isFirefox&&!c.setCapture&&(this._overlayDiv=
d=b.createElement(e,"div"),d.style.position=c.style.position,d.style.borderWidth=c.style.borderWidth,d.style.margin=c.style.margin,d.style.padding=c.style.padding,d.style.cursor="text",d.style.zIndex="2",(this._clipDiv||g).appendChild(d));c.contentEditable="true";c.setAttribute("role","textbox");c.setAttribute("aria-multiline","true");this._setWrapMode(this._wrapMode,!0);this._setReadOnly(this._readonly);this._setThemeClass(this._themeClass,!0);this._setTabSize(this._tabSize,!0);this._setMarginOffset(this._marginOffset,
!0);this._hookEvents();c=this._rulers;for(d=0;d<c.length;d++)this._createRuler(c[d]);this._update();var n=this;u(e,g,"textview",a)}},_defaultOptions:function(){return{parent:{value:void 0,update:null},model:{value:void 0,update:this.setModel},scrollAnimation:{value:0,update:null},readonly:{value:!1,update:this._setReadOnly},fullSelection:{value:!0,update:this._setFullSelection},tabMode:{value:!0,update:null},tabSize:{value:8,update:this._setTabSize},expandTab:{value:!1,update:null},singleMode:{value:!1,
update:this._setSingleMode},noScroll:{value:!1,update:this._setNoScroll},overwriteMode:{value:!1,update:this._setOverwriteMode},blockCursorVisible:{value:!1,update:this._setBlockCursor},marginOffset:{value:0,update:this._setMarginOffset},wrapOffset:{value:0,update:this._setWrapOffset},wrapMode:{value:!1,update:this._setWrapMode},wrappable:{value:!1,update:null},undoStack:{value:null,update:this._setUndoStack},theme:{value:f.TextTheme.getTheme(),update:this._setTheme},themeClass:{value:void 0,update:this._setThemeClass}}},
_destroyRuler:function(a){var c=this._getRulerParent(a);if(c)for(var e=c.firstChild;e;){if(e._ruler===a){e._ruler=void 0;c.removeChild(e);if(0===c.children.length&&(c!==this._marginDiv||!this._marginOffset))c.style.display="none";c.rulerWidth=void 0;break}e=e.nextSibling}},_destroyView:function(){if(this._clientDiv){this._setGrab(null);this._unhookEvents();var a=this._getWindow();this._autoScrollTimerID&&(a.clearTimeout(this._autoScrollTimerID),this._autoScrollTimerID=null);this._updateTimer&&(a.clearTimeout(this._updateTimer),
this._updateTimer=null);this._calculateLHTimer&&(a.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=null);this._cursorTimer&&(a.clearInterval(this._cursorTimer),this._cursorTimer=null);this._imeTimeout&&(a.clearInterval(this._imeTimeout),this._imeTimeout=null);a=this._rootDiv;a.parentNode.removeChild(a);this._hScrollDiv=this._vScrollDiv=this._cursorDiv=this._marginDiv=this._innerRightDiv=this._rightDiv=this._leftDiv=this._overlayDiv=this._clientDiv=this._clipScrollDiv=this._clipDiv=this._viewDiv=
this._scrollDiv=this._rootDiv=this._clipboardDiv=this._domSelection=null}},_doAutoScroll:function(a,c,e){this._autoScrollDir=a;this._autoScrollX=c;this._autoScrollY=e;this._autoScrollTimerID||this._autoScrollTimer()},_endAutoScroll:function(){this._autoScrollTimerID&&this._getWindow().clearTimeout(this._autoScrollTimerID);this._autoScrollTimerID=this._autoScrollDir=void 0},_fixCaret:function(){var a=this._clientDiv;if(a){var c=this._hasFocus;this._ignoreFocus=!0;c&&a.blur();a.contentEditable=!1;a.contentEditable=
!0;c&&a.focus();this._ignoreFocus=!1}},_getBaseText:function(a,c){var e=this._model;e.getBaseModel&&(a=e.mapOffset(a),c=e.mapOffset(c),e=e.getBaseModel());return e.getText(a,c)},_getBottomIndex:function(a){var c=this._bottomChild;if(a&&this._getClientHeight()>this._getLineHeight()){a=c.getBoundingClientRect();var e=this._clientDiv.getBoundingClientRect();a.bottom>e.bottom&&(c=this._getLinePrevious(c)||c)}return c.lineIndex},_getBlockSelections:function(a,c,e){var b=this._model;a=a.filter(function(a){return!a._editing});
var g=b.getLineAtOffset(this._blockSelection.getAnchor()),d;c>g?d=c:(d=g,g=c);for(c=g;c<=d;c++){var n=this._getLine(c),g=n.getOffset(e.x,1),f=n.getOffset(this._blockSelection._docX,1);n.destroy();g===f&&g===b.getLineEnd(c)||(n=g<f,g=new t(n?g:f,n?f:g,n),g._editing=!0,a.push(g))}return a},_getBoundsAtOffset:function(a){var c=this._getLine(this._model.getLineAtOffset(a));a=c.getBoundingClientRect(a);var e=this._getLinePixel(c.lineIndex);a.top+=e;a.bottom+=e;c.destroy();return a},_getClientHeight:function(){var a=
this._getViewPadding();return Math.max(0,this._viewDiv.clientHeight-a.top-a.bottom)},_getInnerRightWidth:function(){var a=this._innerRightDiv.rulerWidth;void 0===a&&(a=this._innerRightDiv.getBoundingClientRect(),this._innerRightDiv.rulerWidth=a=a.right-a.left);return a},_getClientWidth:function(){var a=this._getViewPadding(),c=this._getInnerRightWidth();return Math.max(0,this._viewDiv.clientWidth-a.left-a.right-c)},_getClipboardText:function(a,c){function g(a){var b=[];e(a,function(a){b.push(a)},
null);c&&c(b);return b}var d=this._getWindow(),n=d.clipboardData;!n&&a&&(n=a.clipboardData);if(n)return g(n.getData(b.isIE?"Text":"text/plain"));if(b.isFirefox){this._ignoreFocus=!0;var t=this._clipboardDiv,n=this._rootDiv.ownerDocument;t||(this._clipboardDiv=t=b.createElement(n,"div"),t.style.position="fixed",t.style.whiteSpace="pre",t.style.left="-1000px",this._rootDiv.appendChild(t));t.innerHTML="\x3cpre contenteditable\x3d''\x3e\x3c/pre\x3e";t.firstChild.focus();var f=this,u=function(){var a=
f._getTextFromElement(t);t.innerHTML="";return g(a)},m=!1;this._ignorePaste=!0;if(!b.isLinux||2!==this._lastMouseButton)try{m=n.execCommand("paste",!1,null)}catch(s){m=1<t.childNodes.length||t.firstChild&&0<t.firstChild.childNodes.length}this._ignorePaste=!1;if(!m){if(a)return d.setTimeout(function(){f.focus();u();f._ignoreFocus=!1},0),null;this.focus();this._ignoreFocus=!1;return""}this.focus();this._ignoreFocus=!1;return u()}return""},_getDOMText:function(a,c){return a._line.getText(c)},_getTextFromElement:function(a){var c=
a.ownerDocument,e=c.defaultView;if(!e.getSelection)return a.innerText||a.textContent;c=c.createRange();c.selectNode(a);a=e.getSelection();var e=[],b;for(b=0;b<a.rangeCount;b++)e.push(a.getRangeAt(b));this._ignoreSelect=!0;a.removeAllRanges();a.addRange(c);c=a.toString();a.removeAllRanges();for(b=0;b<e.length;b++)a.addRange(e[b]);this._ignoreSelect=!1;return c},_getViewPadding:function(){return this._metrics.viewPadding},_getLine:function(a){var c=this._getLineNode(a);return c&&!c.lineChanged&&!c.lineRemoved?
c._line:new E(this,a)},_getLineHeight:function(a,c){if(void 0!==a&&this._lineHeight){var e=this._lineHeight[a];if(e)return e;if(c||void 0===c)return this._lineHeight[a]=this._calculateLineHeight(a)}return this._metrics.lineHeight},_getLineNode:function(a){for(var c=this._clientDiv.firstChild;c;){if(a===c.lineIndex)return c;c=c.nextSibling}},_getLineNext:function(a){for(a=a?a.nextSibling:this._clientDiv.firstChild;a&&(-1===a.lineIndex||!a._line);)a=a.nextSibling;return a},_getLinePrevious:function(a){for(a=
a?a.previousSibling:this._clientDiv.lastChild;a&&(-1===a.lineIndex||!a._line);)a=a.previousSibling;return a},_getLinePixel:function(a){a=Math.min(Math.max(0,a),this._model.getLineCount());if(this._lineHeight){var c=this._getTopIndex(),e=-this._topIndexY+this._getScroll().y;if(a>c)for(;c<a;c++)e+=this._getLineHeight(c);else for(c-=1;c>=a;c--)e-=this._getLineHeight(c);return e}return this._getLineHeight()*a},_getLineIndex:function(a,c){var e,b=0,g=this._model.getLineCount();if(this._lineHeight){var b=
this._getTopIndex(),d=-this._topIndexY+this._getScroll().y;if(a!==d)if(a<d)for(;a<d&&0<b;)a+=this._getLineHeight(--b);else for(e=this._getLineHeight(b);a-e>=d&&b<g-1;)a-=e,e=this._getLineHeight(++b)}else e=this._getLineHeight(),b=Math.floor(a/e);return c&&(0===g||0>b||b>g-1)?-1:Math.max(0,Math.min(g-1,b))},_getRulerParent:function(a){switch(a.getLocation()){case "left":return this._leftDiv;case "right":return this._rightDiv;case "innerRight":return this._innerRightDiv;case "margin":return this._marginDiv}return null},
_getScroll:function(a){(void 0===a||a)&&this._cancelAnimation();a=this._viewDiv;return{x:a.scrollLeft,y:a.scrollTop}},_getSelection:function(){return(Array.isArray(this._selection)?this._selection[0]:this._selection).clone()},_getSelections:function(){return(Array.isArray(this._selection)?this._selection:[this._selection]).map(function(a){return a.clone()})},_getTopIndex:function(a){var c=this._topChild;if(a&&this._getClientHeight()>this._getLineHeight()){a=c.getBoundingClientRect();var e=this._getViewPadding(),
b=this._viewDiv.getBoundingClientRect();a.top<b.top+e.top&&(c=this._getLineNext(c)||c)}return c.lineIndex},_hookEvents:function(){var a=this;this._modelListener={onChanging:function(c){a._onModelChanging(c)},onChanged:function(c){a._onModelChanged(c)}};this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._themeListener={onChanged:function(){a._setThemeClass(a._themeClass)}};this._theme.addEventListener("ThemeChanged",
this._themeListener.onChanged);var c=this._handlers=[],e=this._clientDiv,g=this._viewDiv,d=this._rootDiv,n=this._overlayDiv||e,t=e.ownerDocument,f=this._getWindow(),u=b.isIE?t:f;c.push({target:f,type:"resize",handler:function(c){return a._handleResize(c?c:f.event)}});c.push({target:e,type:"blur",handler:function(c){return a._handleBlur(c?c:f.event)}});c.push({target:e,type:"focus",handler:function(c){return a._handleFocus(c?c:f.event)}});c.push({target:g,type:"focus",handler:function(){e.focus()}});
c.push({target:g,type:"scroll",handler:function(c){return a._handleScroll(c?c:f.event)}});c.push({target:e,type:"textInput",handler:function(c){return a._handleTextInput(c?c:f.event)}});c.push({target:e,type:"keydown",handler:function(c){return a._handleKeyDown(c?c:f.event)}});c.push({target:e,type:"keypress",handler:function(c){return a._handleKeyPress(c?c:f.event)}});c.push({target:e,type:"keyup",handler:function(c){return a._handleKeyUp(c?c:f.event)}});b.isIE&&c.push({target:t,type:"keyup",handler:function(c){return a._handleDocKeyUp(c?
c:f.event)}});c.push({target:e,type:"contextmenu",handler:function(c){return a._handleContextMenu(c?c:f.event)}});c.push({target:e,type:"copy",handler:function(c){return a._handleCopy(c?c:f.event)}});c.push({target:e,type:"cut",handler:function(c){return a._handleCut(c?c:f.event)}});c.push({target:e,type:"paste",handler:function(c){return a._handlePaste(c?c:f.event)}});c.push({target:t,type:"selectionchange",handler:function(c){return a._handleSelectionChange(c?c:f.event)}});if(b.isIOS||b.isAndroid)c.push({target:e,
type:"touchstart",handler:function(c){return a._handleTouchStart(c?c:f.event)}}),c.push({target:e,type:"touchmove",handler:function(c){return a._handleTouchMove(c?c:f.event)}}),c.push({target:e,type:"touchend",handler:function(c){return a._handleTouchEnd(c?c:f.event)}});else{c.push({target:e,type:"selectstart",handler:function(c){return a._handleSelectStart(c?c:f.event)}});c.push({target:e,type:"mousedown",handler:function(c){return a._handleMouseDown(c?c:f.event)}});c.push({target:e,type:"mouseover",
handler:function(c){return a._handleMouseOver(c?c:f.event)}});c.push({target:e,type:"mouseout",handler:function(c){return a._handleMouseOut(c?c:f.event)}});c.push({target:u,type:"mouseup",handler:function(c){return a._handleMouseUp(c?c:f.event)}});c.push({target:u,type:"mousemove",handler:function(c){return a._handleMouseMove(c?c:f.event)}});c.push({target:d,type:"mousedown",handler:function(c){return a._handleRootMouseDown(c?c:f.event)}});c.push({target:d,type:"mouseup",handler:function(c){return a._handleRootMouseUp(c?
c:f.event)}});c.push({target:n,type:"dragstart",handler:function(c){return a._handleDragStart(c?c:f.event)}});c.push({target:n,type:"drag",handler:function(c){return a._handleDrag(c?c:f.event)}});c.push({target:n,type:"dragend",handler:function(c){return a._handleDragEnd(c?c:f.event)}});c.push({target:n,type:"dragenter",handler:function(c){return a._handleDragEnter(c?c:f.event)}});c.push({target:n,type:"dragover",handler:function(c){return a._handleDragOver(c?c:f.event)}});c.push({target:n,type:"dragleave",
handler:function(c){return a._handleDragLeave(c?c:f.event)}});c.push({target:n,type:"drop",handler:function(c){return a._handleDrop(c?c:f.event)}});c.push({target:this._clientDiv,type:26<b.isFirefox?"wheel":b.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(c){return a._handleMouseWheel(c?c:f.event)}});this._clipDiv&&c.push({target:this._clipDiv,type:26<b.isFirefox?"wheel":b.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(c){return a._handleMouseWheel(c?c:f.event)}});if(b.isFirefox&&
(!b.isWindows||15<=b.isFirefox))(g=f.MutationObserver||f.MozMutationObserver)?(this._mutationObserver=new g(function(c){a._handleDataModified(c)}),this._mutationObserver.observe(e,{subtree:!0,characterData:!0})):c.push({target:this._clientDiv,type:"DOMCharacterDataModified",handler:function(c){return a._handleDataModified(c?c:f.event)}});if(b.isFirefox&&(!b.isWindows||15<=b.isFirefox)||b.isIE||b.isWebkit)c.push({target:this._clientDiv,type:"compositionstart",handler:function(c){return a._handleCompositionStart(c?
c:f.event)}}),c.push({target:this._clientDiv,type:"compositionend",handler:function(c){return a._handleCompositionEnd(c?c:f.event)}}),c.push({target:this._clientDiv,type:"compositionupdate",handler:function(c){return a._handleCompositionUpdate(c?c:f.event)}});this._overlayDiv&&(c.push({target:this._overlayDiv,type:"mousedown",handler:function(c){return a._handleMouseDown(c?c:f.event)}}),c.push({target:this._overlayDiv,type:"mouseover",handler:function(c){return a._handleMouseOver(c?c:f.event)}}),
c.push({target:this._overlayDiv,type:"mouseout",handler:function(c){return a._handleMouseOut(c?c:f.event)}}),c.push({target:this._overlayDiv,type:"contextmenu",handler:function(c){return a._handleContextMenu(c?c:f.event)}}));this._isW3CEvents||c.push({target:this._clientDiv,type:"dblclick",handler:function(c){return a._handleDblclick(c?c:f.event)}})}this._hookRulerEvents(this._leftDiv,c);this._hookRulerEvents(this._rightDiv,c);this._hookRulerEvents(this._innerRightDiv,c);this._hookRulerEvents(this._marginDiv,
c);for(g=0;g<c.length;g++)d=c[g],D(d.target,d.type,d.handler,d.capture)},_hookRulerEvents:function(a,c){if(a){var e=this,g=this._getWindow();b.isIE&&c.push({target:a,type:"selectstart",handler:function(){return!1}});c.push({target:a,type:26<b.isFirefox?"wheel":b.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(a){return e._handleMouseWheel(a?a:g.event)}});c.push({target:a,type:"click",handler:function(a){e._handleRulerEvent(a?a:g.event)}});c.push({target:a,type:"dblclick",handler:function(a){e._handleRulerEvent(a?
a:g.event)}});c.push({target:a,type:"mousemove",handler:function(a){e._handleRulerEvent(a?a:g.event)}});c.push({target:a,type:"mouseover",handler:function(a){e._handleRulerEvent(a?a:g.event)}});c.push({target:a,type:"mouseout",handler:function(a){e._handleRulerEvent(a?a:g.event)}})}},_getWindow:function(){return this._parent.ownerDocument.defaultView||this._parent.ownerDocument.parentWindow},_ignoreEvent:function(a){for(a=a.target;a&&a!==this._clientDiv;){if(a.ignore)return!0;a=a.parentNode}return!1},
_init:function(a){var c=a.parent;"string"===typeof c&&(c=(a.document||document).getElementById(c));if(!c)throw Error("no parent");a.parent=c;a.model=a.model||new r.TextModel;var e=this._defaultOptions(),g;for(g in e)e.hasOwnProperty(g)&&(this["_"+g]=void 0!==a[g]?a[g]:e[g].value);this._keyModes=[];this._rulers=[];this._selection=[new t(0,0,!1)];this._linksVisible=!1;this._maxLineWidth=this._redrawCount=0;this._maxLineIndex=-1;this._ignoreSelect=!0;this._hasFocus=this._ignoreFocus=!1;this._dragOffset=
-1;this._isRangeRects=(!b.isIE||9<=b.isIE)&&"function"===typeof c.ownerDocument.createRange().getBoundingClientRect;this._isW3CEvents=c.addEventListener;this._autoScrollTimerID=this._autoScrollY=this._autoScrollX=null;this._AUTO_SCROLL_RATE=50;this._mouseUpClosure=this._moseMoveClosure=this._grabControl=null;this._clickCount=this._lastMouseTime=this._lastMouseY=this._lastMouseX=0;this._clickTime=250;this._clickDist=5;this._isMouseDown=!1;this._doubleClickSelection=null;this._vScroll=this._hScroll=
0;this._imeOffset=-1;this._createActions();this._createView()},_checkOverlayScroll:function(){if(b.isMac&&b.isWebkit&&!this._metrics.invalid&&0===this._metrics.scrollWidth){var a=this._viewDiv,c=this._isOverOverlayScroll();a.style.pointerEvents=c.vertical||c.horizontal?"":"none"}},_isOverOverlayScroll:function(){if(!(200>(new Date).getTime()-this._lastScrollTime))return{};var a=this._viewDiv.getBoundingClientRect(),c=this._lastMouseMoveX,e=this._lastMouseMoveY;return{vertical:a.top<=e&&e<a.bottom&&
a.right-15<=c&&c<a.right,horizontal:a.bottom-15<=e&&e<a.bottom&&a.left<=c&&c<a.right}},_startUndo:function(){if(this._undoStack){var a=this;this._compoundChange=this._undoStack.startCompoundChange({end:function(){a._compoundChange=null}})}},_endUndo:function(){this._undoStack&&this._undoStack.endCompoundChange()},_modifyContent:function(a,c,e,b){if(this._readonly&&!a._code)return!1;a.type="Verify";var g=a.start=a.selection[0].start,d=a.end=a.selection[0].end;this.onVerify(a);g!==a.start&&(a.selection[0].start=
a.start);d!==a.end&&(a.selection[0].end=a.end);if(null===a.text||void 0===a.text)return!1;1<a.selection.length&&this.setRedraw(!1);(g=this._compoundChange)?t.compare(this._getSelections(),g.owner.selection)||(this._endUndo(),1<a.selection.length&&this._startUndo()):1<a.selection.length&&this._startUndo();var n=this._model;try{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!0);var f=0,u=0;a.selection.forEach(function(e){e.start+=f;e.end+=f;var b=Array.isArray(a.text)?a.text[u]:a.text;n.setText(b,
e.start,e.end);f+=e.start-e.end+b.length;e.setCaret(c?e.start+b.length:e.start);u++})}finally{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!1)}this._setSelection(a.selection,e,!0,b);if(g=this._compoundChange)g.owner.selection=a.selection;1<a.selection.length&&this.setRedraw(!0);this.onModify({type:"Modify"});return!0},_onModelChanged:function(a){a.type="ModelChanged";this.onModelChanged(a);a.type="Changed";var c=a.start,e=a.addedCharCount,b=a.removedCharCount,g=a.addedLineCount,d=a.removedLineCount,
n=this._getSelections();n.forEach(function(a){a.end>c&&(a.end>c&&a.start<c+b?a.setCaret(c+e):(a.start+=e-b,a.end+=e-b))});this._setSelection(n,!1,!1);for(var n=this._model.getLineAtOffset(c),f=this._getLineNext();f;){var t=f.lineIndex;n<=t&&t<=n+d&&(n===t&&!f.modelChangedEvent&&!f.lineRemoved?(f.modelChangedEvent=a,f.lineChanged=!0):(f.lineRemoved=!0,f.lineChanged=!1,f.modelChangedEvent=null));t>n+d&&(f.lineIndex=t+g-d,f._line.lineIndex=f.lineIndex);f=this._getLineNext(f)}this._lineHeight&&(a=[n,
d].concat(Array(g)),Array.prototype.splice.apply(this._lineHeight,a));!this._wrapMode&&(n<=this._maxLineIndex&&this._maxLineIndex<=n+d)&&(this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0);this._update()},_onModelChanging:function(a){a.type="ModelChanging";this.onModelChanging(a);a.type="Changing"},_queueUpdate:function(){if(!this._updateTimer&&!this._ignoreQueueUpdate){var a=this;this._updateTimer=this._getWindow().setTimeout(function(){a._updateTimer=null;a._update()},
0)}},_rangesToSelections:function(a){var c=[],e=this._model.getCharCount();a.forEach(function(a){var b;if(a instanceof t)b=a.clone();else{b=a.start;a=a.end;var g=b>a;if(g){var d=b;b=a;a=d}b=Math.max(0,Math.min(b,e));a=Math.max(0,Math.min(a,e));b=new t(b,a,g)}c.push(b)});return c},_resetLineHeight:function(a,c){if(this._wrapMode||this._variableLineHeight){if(void 0!==a&&void 0!==c)for(var e=a;e<c;e++)this._lineHeight[e]=void 0;else e=this._model.getLineCount(),this._lineHeight=Array(e);this._calculateLineHeightTimer()}else this._lineHeight=
null},_resetLineWidth:function(){var a=this._clientDiv;if(a)for(a=a.firstChild;a;)a.lineWidth=void 0,a=a.nextSibling},_reset:function(){this._maxLineIndex=-1;this._maxLineWidth=0;this._bottomChild=this._topChild=null;this._topIndexY=0;this._variableLineHeight=!1;this._resetLineHeight();this._setSelection(new t(0,0,!1),!1,!1);this._viewDiv&&(this._viewDiv.scrollLeft=0,this._viewDiv.scrollTop=0);var a=this._clientDiv;if(a){for(a=a.firstChild;a;)a.lineRemoved=!0,a=a.nextSibling;13>b.isFirefox&&this._fixCaret()}},
_scrollViewAnimated:function(a,c,e){var b=this._getWindow();if(e&&this._scrollAnimation){var g=this;this._animation=new C({window:b,duration:this._scrollAnimation,curve:[c,0],onAnimate:function(a){a=c-Math.floor(a);g._scrollView(0,a);c-=a},onEnd:function(){g._animation=null;g._scrollView(a,c);e&&b.setTimeout(e,0)}});this._animation.play()}else this._scrollView(a,c),e&&b.setTimeout(e,0)},_scrollView:function(a,c){this._ensureCaretVisible=!1;var e=this._viewDiv;a&&(e.scrollLeft+=a);c&&(e.scrollTop+=
c)},_setClipboardText:function(a,c){var g,d=this._getWindow(),n=d.clipboardData;!n&&c&&(n=c.clipboardData);if(n&&(g=[],e(a,function(a){g.push(a)},function(){g.push(b.platformDelimiter)}),n.setData(b.isIE?"Text":"text/plain",g.join(""))||21<b.isFirefox))return!0;var f=this._parent.ownerDocument,t=b.createElement(f,"pre");t.style.position="fixed";t.style.left="-1000px";e(a,function(a){t.appendChild(f.createTextNode(a))},function(){t.appendChild(b.createElement(f,"br"))});t.appendChild(f.createTextNode(" "));
this._clientDiv.appendChild(t);n=f.createRange();n.setStart(t.firstChild,0);n.setEndBefore(t.lastChild);var u=d.getSelection();0<u.rangeCount&&u.removeAllRanges();u.addRange(n);var m=this,n=function(){t&&t.parentNode===m._clientDiv&&m._clientDiv.removeChild(t);m._updateDOMSelection()},u=!1;this._ignoreCopy=!0;try{u=f.execCommand("copy",!1,null)}catch(s){}this._ignoreCopy=!1;if(!u&&c)return d.setTimeout(n,0),!1;n();return!0},_setGrab:function(a){a!==this._grabControl&&(a?(a.setCapture&&a.setCapture(),
this._grabControl=a):(this._grabControl.releaseCapture&&this._grabControl.releaseCapture(),this._grabControl=null))},_setLinksVisible:function(a){if(this._linksVisible!==a){this._linksVisible=a;b.isIE&&a&&(this._hadFocus=this._hasFocus);var c=this._clientDiv;c.contentEditable=!a;this._hadFocus&&!a&&c.focus();this._overlayDiv&&(this._overlayDiv.style.zIndex=a?"-1":"1");for(a=this._getLineNext();a;)a._line.updateLinks(),a=this._getLineNext(a);this._updateDOMSelection()}},_setSelection:function(a,c,
e,b,g,d,n){if(a){void 0===e&&(e=!0);var f=this._getSelections();a=Array.isArray(a)?a:d?f.concat([a]):[a];this._selection=t.merge(a);n||a.forEach(function(a){a._columnX=-1});!1!==c&&this._showCaret(!1,b,c,g);e&&this._updateDOMSelection();t.compare(f,a)||(c={type:"Selection",oldValue:t.convert(f),newValue:t.convert(a)},this.onSelection(c))}},_setSelectionTo:function(a,c,e,b,g,d){var n=this._model,f=this._getSelections(),u=this.convert({x:a,y:c},"page","document");c=this._getLineIndex(u.y);a=this._getLine(c);
var m=a.getOffset(u.x,u.y-this._getLinePixel(c));if(d&&!b&&t.contains(f,m))return this._dragOffset=m,a.destroy(),!1;this._blockSelection?f=this._getBlockSelections(f,c,u):(e?b?(e=f[f.length-1],e._editing=!0):(e=new t(0,0),e._editing=!0,g?f.push(e):f=[e],e._docX=u.x):e=t.editing(f),1===this._clickCount?(e.extend(m),b||e.collapse()):(0===(this._clickCount&1)?this._doubleClickSelection?m>=this._doubleClickSelection.start?(b=this._doubleClickSelection.start,n=a.getNextOffset(m,{unit:"wordend",count:1})):
(b=a.getNextOffset(m,{unit:"word",count:-1}),n=this._doubleClickSelection.end):(b=a.getNextOffset(m,{unit:"word",count:-1}),n=a.getNextOffset(b,{unit:"wordend",count:1})):this._doubleClickSelection?(g=n.getLineAtOffset(this._doubleClickSelection.start),c>=g?(b=n.getLineStart(g),n=n.getLineEnd(c)):(b=n.getLineStart(c),n=n.getLineEnd(g))):(b=n.getLineStart(c),n=n.getLineEnd(c)),e.setCaret(b),e.extend(n)));this._setSelection(f,!0,!0,null,!1);a.destroy();return!0},_setFullSelection:function(a,c){this._fullSelection=
a;b.isWebkit&&(this._fullSelection=!0);this._domSelection||(this._domSelection=[],this._cursorVisible=!0);c||this._updateDOMSelection()},_setBlockCursor:function(a){this._blockCursorVisible=a;this._updateBlockCursorVisible()},_setOverwriteMode:function(a){this._overwriteMode=a;this._updateBlockCursorVisible()},_updateBlockCursorVisible:function(){if(this._blockCursorVisible||this._overwriteMode){if(!this._cursorDiv){var a=this._viewDiv,c=b.createElement(a.ownerDocument,"div");c.className="textviewBlockCursor";
this._cursorDiv=c;c.tabIndex=-1;c.style.zIndex="2";c.style.color="transparent";c.style.position="absolute";c.style.pointerEvents="none";c.innerHTML="\x26nbsp;";a.appendChild(c);this._updateDOMSelection()}}else this._cursorDiv&&(this._cursorDiv.parentNode.removeChild(this._cursorDiv),this._cursorDiv=null)},_setMarginOffset:function(a,c){this._marginOffset=a;this._marginDiv.style.display=a?"block":"none";c||(this._metrics=this._calculateMetrics(),this._queueUpdate())},_setWrapOffset:function(a,c){this._wrapOffset=
a;c||(this._metrics=this._calculateMetrics(),this._queueUpdate())},_setReadOnly:function(a){this._readonly=a;this._clientDiv.setAttribute("aria-readonly",a?"true":"false")},_setSingleMode:function(a,c){this._singleMode=a;this._updateOverflow();this._updateStyle(c)},_setNoScroll:function(a,c){this._noScroll=a;this._updateOverflow();this._updateStyle(c)},_setTabSize:function(a,c){this._tabSize=a;this._customTabSize=void 0;var e=this._clientDiv;b.isOpera?e&&(e.style.OTabSize=this._tabSize+""):537.1<=
b.isWebkit?e&&(e.style.tabSize=this._tabSize+""):4<=b.isFirefox?e&&(e.style.MozTabSize=this._tabSize+""):8!==this._tabSize&&(this._customTabSize=this._tabSize);c||(this.redrawLines(),this._resetLineWidth())},_setTheme:function(a){this._theme&&this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);(this._theme=a)&&this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);this._setThemeClass(this._themeClass)},_setThemeClass:function(a,c){this._themeClass=a;var e=
"textview",b=this._theme.getThemeClass();b&&(e+=" "+b);this._themeClass&&b!==this._themeClass&&(e+=" "+this._themeClass);this._rootDiv.className=e;this._updateStyle(c)},_setUndoStack:function(a){this._undoStack=a},_setWrapMode:function(a,c){this._wrapMode=a&&this._wrappable;var e=this._clientDiv;this._wrapMode?(e.style.whiteSpace="pre-wrap",e.style.wordWrap="break-word"):(e.style.whiteSpace="pre",e.style.wordWrap="normal");this._updateOverflow();c||(this.redraw(),this._resetLineWidth());this._resetLineHeight()},
_showCaret:function(a,c,e,b){if(this._clientDiv&&!(0<this._redrawCount)&&!this._ignoreDOMSelection&&-1===this._imeOffset){var g=this._model,d=this._getSelections(),n=t.editing(d,"down"===this._autoScrollDir),f=this._getScroll(),d=n.getCaret(),u=n.start,m=n.end,s=g.getLineAtOffset(u),v=g.getLineAtOffset(m),k=Math.max(Math.max(u,g.getLineStart(v)),m-1),g=this._getClientWidth(),h=this._getClientHeight(),A=g/4,l=this._getBoundsAtOffset(d===u?u:k),E=l.left,z=l.right,p=l.top,r=l.bottom,D=0,B="object"===
typeof e;if((a||B)&&!n.isEmpty())l=this._getBoundsAtOffset(d===m?u:k),D=(l.bottom>r?l.bottom:r)-(l.top<p?l.top:p),a&&(l.top===p?d===u?z=E+Math.min(l.right-E,g):E=z-Math.min(z-l.left,g):d===u?r=p+Math.min(l.bottom-p,h):p=r-Math.min(r-l.top,h));a=0;E<f.x&&(a=Math.min(E-f.x,-A));z>f.x+g&&(a=Math.max(z-f.x-g,A));n=0;p<f.y?n=p-f.y:r>f.y+h&&(n=r-f.y-h);b&&(0<b?0<n&&(n=Math.max(n,b)):0>n&&(n=Math.min(n,b)));b=B&&"always"===e.scrollPolicy;if(0!==a||0!==n||b)return B?(b=0<n,0===n&&(n=p-f.y),f=e.viewAnchor,
p=e.selectionAnchor,e=Math.min(Math.max(0,e.viewAnchorOffset||0)),n="top"===f?n+Math.floor(b?(1-e)*h:-e*h):"bottom"===f?n+Math.floor(b?e*h:-(1-e)*h):"center"===f?n+Math.floor(b?h/2+e*h:h/2-(1-e)*h):n+Math.floor(b?e*h:-e*h),s!==v&&("top"===p&&d!==u?n+=Math.floor(-D):"bottom"===p&&d!==m?n+=Math.floor(D):"center"===p&&(n+=Math.floor(D/2)))):0!==n&&"number"===typeof e&&(0>e&&(e=0),1<e&&(e=1),n+=Math.floor(0<n?e*h:-e*h)),this._scrollViewAnimated(a,n,c),h!==this._getClientHeight()||g!==this._getClientWidth()?
this._showCaret():this._ensureCaretVisible=!0,!0;c&&c();return!1}},_startIME:function(){if(-1===this._imeOffset){for(var a=!1,c=this._getSelections(),e=0;e<c.length&&!a;e++)a=!c[e].isEmpty();a&&this._modifyContent({text:"",selection:c},!0);this._imeOffset=c[0].start}},_unhookEvents:function(){this._model.removeEventListener("preChanging",this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);
this._modelListener=null;for(var a=0;a<this._handlers.length;a++){var c=this._handlers[a];B(c.target,c.type,c.handler)}this._handlers=null;this._mutationObserver&&this._mutationObserver.disconnect()},_updateDOMSelection:function(){if(!(0<this._redrawCount)&&!this._ignoreDOMSelection&&-1===this._imeOffset&&this._clientDiv){var a=this._getSelections(),c=this._domSelection,e;if(c.length<a.length)for(e=c.length;e<a.length;e++)c.push(new v(this));else c.length>a.length&&c.splice(a.length).forEach(function(a){a.destroy()});
for(e=0;e<c.length;e++)c[e].setPrimary(0===e),c[e].setSelection(a[e]);var a=this._getWindow(),b=this;1<c.length?this._cursorTimer||(this._cursorTimer=a.setInterval(function(){b._cursorVisible=!b._cursorVisible;b._domSelection.forEach(function(a){a.update()})},500)):this._cursorTimer&&(a.clearInterval(this._cursorTimer),this._cursorTimer=null)}},_update:function(a){if(!(0<this._redrawCount)){this._updateTimer&&(this._getWindow().clearTimeout(this._updateTimer),this._updateTimer=null,a=!1);var c=this._clientDiv,
e=this._viewDiv;if(c){this._metrics.invalid&&(this._ignoreQueueUpdate=!0,this._updateStyle(),this._ignoreQueueUpdate=!1);var g=this._model,d=this._getScroll(!1),n=this._getViewPadding(),f=g.getLineCount(),t=this._getLineHeight(),u=!1,m=!1,s=!1,v=this._metrics.scrollWidth;this._wrapMode&&(c.style.width=(this._metrics.wrapWidth||this._getClientWidth())+"px");var k,h,A,l,z=0,p=0,r;if(this._lineHeight){for(;p<f;){r=this._getLineHeight(p);if(z+r>d.y)break;z+=r;p++}k=p;h=Math.max(0,k-1);A=g=d.y-z;0<k&&
(g+=this._getLineHeight(k-1))}else l=Math.max(0,d.y)/t,k=Math.floor(l),h=Math.max(0,k-1),g=Math.round((l-h)*t),A=Math.round((l-k)*t);this._topIndexY=A;l=this._rootDiv;var D=l.clientWidth,B=l.clientHeight;if(a){t=0;this._leftDiv&&(k=this._leftDiv.getBoundingClientRect(),t=k.right-k.left);k=this._getClientWidth();l=this._getClientHeight();m=k;this._wrapMode?this._metrics.wrapWidth&&(m=this._metrics.wrapWidth):m=Math.max(this._maxLineWidth,m);for(;p<f;)r=this._getLineHeight(p,!1),z+=r,p++;f=z}else{l=
this._getClientHeight();A=Math.min(k+Math.floor((l+A)/t),f-1);var d=Math.min(A+1,f-1),C;for(r=c.firstChild;r;){C=r.lineIndex;var y=r.nextSibling;if(!(h<=C&&C<=d)||r.lineRemoved||-1===r.lineIndex)this._mouseWheelLine===r?(r.style.display="none",r.lineIndex=-1):c.removeChild(r);r=y}r=this._getLineNext();var y=e.ownerDocument,R=y.createDocumentFragment();for(C=h;C<=d;C++)!r||r.lineIndex>C?(new E(this,C)).create(R,null):(R.firstChild&&(c.insertBefore(R,r),R=y.createDocumentFragment()),r&&r.lineChanged&&
(r=(new E(this,C)).create(R,r),r.lineChanged=!1),r=this._getLineNext(r));R.firstChild&&c.insertBefore(R,r);b.isWebkit&&!this._wrapMode&&(c.style.width="0x7fffffffpx");r=this._getLineNext();C=l+g;for(R=!1;r;)h=r.lineWidth,void 0===h&&(y=r._line.getBoundingClientRect(),h=r.lineWidth=Math.ceil(y.right-y.left),y=y.bottom-y.top,this._lineHeight?this._lineHeight[r.lineIndex]=y:0!==t&&(0!==y&&Math.ceil(t)!==Math.ceil(y))&&(this._variableLineHeight=!0,this._lineHeight=[],this._lineHeight[r.lineIndex]=y)),
this._lineHeight&&!R&&(C-=this._lineHeight[r.lineIndex],0>C&&(A=r.lineIndex,R=!0)),this._wrapMode||(h>=this._maxLineWidth&&(this._maxLineWidth=h,this._maxLineIndex=r.lineIndex),this._checkMaxLineIndex===r.lineIndex&&(this._checkMaxLineIndex=-1)),r.lineIndex===k&&(this._topChild=r),r.lineIndex===A&&(this._bottomChild=r),r=this._getLineNext(r);-1!==this._checkMaxLineIndex&&(C=this._checkMaxLineIndex,this._checkMaxLineIndex=-1,0<=C&&C<f&&(t=new E(this,C),y=t.getBoundingClientRect(),h=y.right-y.left,
h>=this._maxLineWidth&&(this._maxLineWidth=h,this._maxLineIndex=C),t.destroy()));for(;p<f;)r=this._getLineHeight(p,p<=A),z+=r,p++;f=z;this._updateRuler(this._leftDiv,k,d,B);this._updateRuler(this._rightDiv,k,d,B);this._updateRuler(this._innerRightDiv,k,d,B);this._updateRuler(this._marginDiv,k,d,B);t=0;this._leftDiv&&(k=this._leftDiv.getBoundingClientRect(),t=k.right-k.left);z=0;this._rightDiv&&(d=this._rightDiv.getBoundingClientRect(),z=d.right-d.left);e.style.left=t+"px";e.style.right=z+"px";d=this._scrollDiv;
d.style.height=f+(b.isWebkit?0:n.bottom)+"px";k=this._getClientWidth();!this._singleMode&&(!this._wrapMode&&!this._noScroll)&&(p=u=l,(A="scroll"===e.style.overflowX)?u+=v:p-=v,h=r=k,(C="scroll"===e.style.overflowY)?r+=v:h-=v,l=u,k=r,f>l&&(s=!0,k=h),this._maxLineWidth>k&&(m=!0,l=p,f>l&&(s=!0,k=h)),A!==m&&(e.style.overflowX=m?"scroll":"hidden"),C!==s&&(e.style.overflowY=s?"scroll":"hidden"),u=A!==m||C!==s);s=k;this._wrapMode?this._metrics.wrapWidth&&(s=this._metrics.wrapWidth):s=Math.max(this._maxLineWidth+
this._getInnerRightWidth(),s);m=s;if((!b.isIE||9<=b.isIE)&&this._maxLineWidth>k)s+=n.right+n.left;d.style.width=s+"px";this._clipScrollDiv&&(this._clipScrollDiv.style.width=s+"px");d=this._getScroll(!1);if(s=this._innerRightDiv)s.style.right=z+("scroll"===e.style.overflowY?this._metrics.scrollWidth:0)+"px",s.style.bottom=("scroll"===e.style.overflowX?v:0)+"px"}this._scrollHeight=f;this._vScrollDiv&&(s=l-8,z=Math.max(15,Math.ceil(Math.min(1,s/(f+n.top+n.bottom))*s)),this._vScrollDiv.style.left=t+k-
8+"px",this._vScrollDiv.style.top=Math.floor(Math.max(0,d.y*s/f))+"px",this._vScrollDiv.style.height=z+"px");!this._wrapMode&&this._hScrollDiv&&(s=k-8,z=Math.max(15,Math.ceil(Math.min(1,s/(this._maxLineWidth+n.left+n.right))*s)),this._hScrollDiv.style.left=t+Math.floor(Math.max(0,Math.floor(d.x*s/this._maxLineWidth)))+"px",this._hScrollDiv.style.top=l-9+"px",this._hScrollDiv.style.width=z+"px");p=d.x;z=this._clipDiv;s=this._overlayDiv;if(A=this._marginDiv)A.style.left=-p+t+this._metrics.marginWidth+
n.left+"px",A.style.bottom=("scroll"===e.style.overflowX?v:0)+"px";z?(z.scrollLeft=p,z.scrollTop=0,e=t+n.left,v=n.top,a=k,t=l,p=0,A=-g,0===d.x&&(e-=n.left,a+=n.left,p=n.left),d.x+k===m&&(a+=n.right),0===d.y&&(v-=n.top,t+=n.top,A+=n.top),d.y+l===f&&(t+=n.bottom),z.style.left=e+"px",z.style.top=v+"px",z.style.right=D-a-e+"px",z.style.bottom=B-t-v+"px",c.style.left=p+"px",c.style.top=A+"px",c.style.width=m+"px",c.style.height=l+g+"px",s&&(s.style.left=c.style.left,s.style.top=c.style.top,s.style.width=
c.style.width,s.style.height=c.style.height)):(e=p,v=g,D=p+k,B=g+l,0===e&&(e-=n.left),0===v&&(v-=n.top),D===m&&(D+=n.right),d.y+l===f&&(B+=n.bottom),c.style.clip="rect("+v+"px,"+D+"px,"+B+"px,"+e+"px)",c.style.left=-p+t+n.left+"px",c.style.width=(this._wrapMode||b.isWebkit?m:k+p)+"px",a||(c.style.top=-g+n.top+"px",c.style.height=l+g+"px"),s&&(s.style.clip=c.style.clip,s.style.left=c.style.left,s.style.width=c.style.width,a||(s.style.top=c.style.top,s.style.height=c.style.height)));this._updateDOMSelection();
u&&(c=this._ensureCaretVisible,this._ensureCaretVisible=!1,c&&this._showCaret(),this._queueUpdate())}}},_updateOverflow:function(){var a=this._viewDiv;this._noScroll?a.style.overflow="hidden":this._wrapMode?(a.style.overflowX="hidden",a.style.overflowY="scroll"):a.style.overflow="hidden"},_updateRuler:function(a,c,e,g){if(a)for(var d=this._parent.ownerDocument,n=this._getLineHeight(),f=this._getViewPadding(),t=a.firstChild;t;){var u=t._ruler,s=u.getOverview();t.rulerChanged&&(m(u.getRulerStyle(),
t),a.rulerWidth=void 0);if("fixed"!==s){var k=n;"page"===s&&(k+=this._topIndexY);t.style.top=-k+"px";t.style.height=g+k+"px";var v,h=t.firstChild;h?(v=h,h=h.nextSibling):(v=b.createElement(d,"div"),v.style.visibility="hidden",t.appendChild(v));var A;if(t.rulerChanged&&v){k=-1;if(A=u.getWidestAnnotation())m(A.style,v),A.html&&(v.innerHTML=A.html);v.lineIndex=k;v.style.height=n+f.top+"px"}var l,z;if("page"===s){for(u=u.getAnnotations(c,e+1);h;)k=h.lineIndex,A=h.nextSibling,(!(c<=k&&k<=e)||h.lineChanged)&&
t.removeChild(h),h=A;h=t.firstChild.nextSibling;z=d.createDocumentFragment();for(k=c;k<=e;k++)if(!h||h.lineIndex>k){l=b.createElement(d,"div");if(A=u[k])m(A.style,l),A.html&&(l.innerHTML=A.html),l.annotation=A;l.lineIndex=k;l.style.height=this._getLineHeight(k)+"px";z.appendChild(l)}else z.firstChild&&(t.insertBefore(z,h),z=d.createDocumentFragment()),h&&(h=h.nextSibling);z.firstChild&&t.insertBefore(z,h)}else{A=this._getClientHeight();k=this._model.getLineCount();h=A+f.top+f.bottom-2*this._metrics.scrollWidth;
n*k<h?(s=n,v=f.top):(s=h/k,v=this._metrics.scrollWidth);if(t.rulerChanged){for(A=t.childNodes.length;1<A;)t.removeChild(t.lastChild),A--;u=u.getAnnotations(0,k);z=d.createDocumentFragment();for(var E in u)k=E>>>0,0>k||(l=b.createElement(d,"div"),A=u[E],m(A.style,l),l.style.position="absolute",l.style.top=v+n+Math.floor(k*s)+"px",A.html&&(l.innerHTML=A.html),l.annotation=A,l.lineIndex=k,z.appendChild(l));t.appendChild(z)}else if(t._oldTrackHeight!==h)for(l=t.firstChild?t.firstChild.nextSibling:null;l;)l.style.top=
this._metrics.scrollWidth+n+Math.floor(l.lineIndex*s)+"px",l=l.nextSibling;t._oldTrackHeight=h}}t.rulerChanged=!1;t=t.nextSibling}},_updateStyleSheet:function(){var a="";b.isWebkit&&0<this._metrics.scrollWidth&&(a+="\n.textview ::-webkit-scrollbar-corner {background: #eeeeee;}");if(a){var c=this._clientDiv.ownerDocument,e=c.getElementById("_textviewStyle");if(e)e.removeChild(e.firstChild),e.appendChild(c.createTextNode(a));else{e=b.createElement(c,"style");e.id="_textviewStyle";var g=c.getElementsByTagName("head")[0]||
c.documentElement;e.appendChild(c.createTextNode(a));g.insertBefore(e,g.firstChild)}}},_updateStyle:function(a,c){!a&&b.isIE&&(this._rootDiv.style.lineHeight="normal");c=this._metrics=c||this._calculateMetrics();this._variableLineHeight&&(this._variableLineHeight=!1,this._resetLineHeight());this._rootDiv.style.lineHeight=b.isIE?c.lineHeight-(c.lineTrim.top+c.lineTrim.bottom)+"px":"normal";this._updateStyleSheet();if(b.isMac&&b.isWebkit){var e=this._viewDiv;!c.invalid&&0===c.scrollWidth?(e.style.pointerEvents=
"none",e.style.zIndex="2"):(e.style.pointerEvents="",e.style.zIndex="")}a||(this.redraw(),this._resetLineWidth())}};h.EventTarget.addMixin(z.prototype);return{TextView:z}});y("orion/editor/projectionTextModel",["orion/editor/textModel","orion/editor/eventTarget"],function(l,r){function p(h){this._model=h;this._projections=[];var f=this;this._listener={onChanged:function(d){f._onChanged(d)},onChanging:function(d){f._onChanging(d)}};h.addEventListener("postChanged",this._listener.onChanged);h.addEventListener("preChanging",
this._listener.onChanging)}p.prototype={destroy:function(){this._model&&(this._model.removeEventListener("postChanged",this._listener.onChanged),this._model.removeEventListener("preChanging",this._listener.onChanging),this._model=null)},addProjection:function(h){if(h){var f=this._model,d=this._projections;h._lineIndex=f.getLineAtOffset(h.start);h._lineCount=f.getLineAtOffset(h.end)-h._lineIndex;var b=h.text;b||(b="");h._model="string"===typeof b?new l.TextModel(b,f.getLineDelimiter()):b;var f=this.mapOffset(h.start,
!0),b=h.end-h.start,k=h._lineCount,m=h._model.getCharCount(),g=h._model.getLineCount()-1,a={type:"Changing",text:h._model.getText(),start:f,removedCharCount:b,addedCharCount:m,removedLineCount:k,addedLineCount:g};this.onChanging(a);a=this._binarySearch(d,h.start);d.splice(a,0,h);this.onChanged({type:"Changed",start:f,removedCharCount:b,addedCharCount:m,removedLineCount:k,addedLineCount:g})}},getProjections:function(){return this._projections.slice(0)},getBaseModel:function(){return this._model},mapOffset:function(h,
f){var d=this._projections,b=0,k,m;if(f){for(k=0;k<d.length;k++){m=d[k];if(m.start>h)break;if(m.end>h)return-1;b+=m._model.getCharCount()-(m.end-m.start)}return h+b}for(k=0;k<d.length;k++){m=d[k];if(m.start>h-b)break;var g=m._model.getCharCount();if(m.start+g>h-b)return-1;b+=g-(m.end-m.start)}return h-b},removeProjection:function(h){this._removeProjection(h)},_removeProjection:function(h,f){var d,b=0;for(d=0;d<this._projections.length;d++){var k=this._projections[d];if(k===h){h=k;break}b+=k._model.getCharCount()-
(k.end-k.start)}if(d<this._projections.length){var k=this._model,b=h.start+b,m=h.end-h.start,g=h._lineCount,a=h._model.getCharCount(),s=h._model.getLineCount()-1;f||(k={type:"Changing",text:k.getText(h.start,h.end),start:b,removedCharCount:a,addedCharCount:m,removedLineCount:s,addedLineCount:g},this.onChanging(k));this._projections.splice(d,1);if(!f)this.onChanged({type:"Changed",start:b,removedCharCount:a,addedCharCount:m,removedLineCount:s,addedLineCount:g})}},_binarySearch:function(h,f){for(var d=
h.length,b=-1,k;1<d-b;)k=Math.floor((d+b)/2),f<=h[k].start?d=k:b=k;return d},getCharCount:function(){for(var h=this._model.getCharCount(),f=this._projections,d=0;d<f.length;d++)var b=f[d],h=h+(b._model.getCharCount()-(b.end-b.start));return h},getLine:function(h,f){if(0>h)return null;var d=this._model,b=this._projections,k=0,m=[],g=0,a,s,e;for(a=0;a<b.length;a++){e=b[a];if(e._lineIndex>=h-k)break;s=e._model.getLineCount()-1;if(e._lineIndex+s>=h-k){g=h-(e._lineIndex+k);if(g<s)return e._model.getLine(g,
f);m.push(e._model.getLine(s))}g=e.end;k+=s-e._lineCount}for(g=Math.max(g,d.getLineStart(h-k));a<b.length;a++){e=b[a];if(e._lineIndex>h-k)break;m.push(d.getText(g,e.start));s=e._model.getLineCount()-1;if(e._lineIndex+s>h-k)return m.push(e._model.getLine(0,f)),m.join("");m.push(e._model.getText());g=e.end;k+=s-e._lineCount}b=d.getLineEnd(h-k,f);g<b&&m.push(d.getText(g,b));return m.join("")},getLineAtOffset:function(h){for(var f=this._model,d=this._projections,b=0,k=0,m=0;m<d.length;m++){var g=d[m];
if(g.start>h-b)break;var a=g._model.getCharCount();if(g.start+a>h-b){d=h-(g.start+b);k+=g._model.getLineAtOffset(d);b+=d;break}k+=g._model.getLineCount()-1-g._lineCount;b+=a-(g.end-g.start)}return f.getLineAtOffset(h-b)+k},getLineCount:function(){for(var h=this._projections,f=this._model.getLineCount(),d=0;d<h.length;d++)var b=h[d],f=f+(b._model.getLineCount()-1-b._lineCount);return f},getLineDelimiter:function(){return this._model.getLineDelimiter()},getLineEnd:function(h,f){if(0>h)return-1;for(var d=
this._model,b=this._projections,k=0,m=0,g=0;g<b.length;g++){var a=b[g];if(a._lineIndex>h-k)break;var s=a._model.getLineCount()-1;if(a._lineIndex+s>h-k)return a._model.getLineEnd(h-(a._lineIndex+k),f)+a.start+m;m+=a._model.getCharCount()-(a.end-a.start);k+=s-a._lineCount}return d.getLineEnd(h-k,f)+m},getLineStart:function(h){if(0>h)return-1;for(var f=this._model,d=this._projections,b=0,k=0,m=0;m<d.length;m++){var g=d[m];if(g._lineIndex>=h-b)break;var a=g._model.getLineCount()-1;if(g._lineIndex+a>=
h-b)return g._model.getLineStart(h-(g._lineIndex+b))+g.start+k;k+=g._model.getCharCount()-(g.end-g.start);b+=a-g._lineCount}return f.getLineStart(h-b)+k},getText:function(h,f){void 0===h&&(h=0);var d=this._model,b=this._projections,k=0,m=[],g,a,s;for(g=0;g<b.length;g++){a=b[g];if(a.start>h-k)break;s=a._model.getCharCount();if(a.start+s>h-k){if(void 0!==f&&a.start+s>f-k)return a._model.getText(h-(a.start+k),f-(a.start+k));m.push(a._model.getText(h-(a.start+k)));h=a.end+k+s-(a.end-a.start)}k+=s-(a.end-
a.start)}var e=h-k;if(void 0!==f){for(;g<b.length;g++){a=b[g];if(a.start>f-k)break;m.push(d.getText(e,a.start));s=a._model.getCharCount();if(a.start+s>f-k)return m.push(a._model.getText(0,f-(a.start+k))),m.join("");m.push(a._model.getText());e=a.end;k+=s-(a.end-a.start)}m.push(d.getText(e,f-k))}else{for(;g<b.length;g++)a=b[g],m.push(d.getText(e,a.start)),m.push(a._model.getText()),e=a.end;m.push(d.getText(e))}return m.join("")},_onChanged:function(h){h=this._change;var f=h.baseStart,d=h.baseEnd,b,
k,m=this._projections;for(b=0;b<m.length&&!(k=m[b],k.end>f);b++);var g=b;for(b=0;b<m.length&&!(k=m[b],k.start>=d);b++);var a=b,s=this._model,f=h.baseText.length-(d-f);for(b=a;b<m.length;b++)k=m[b],k.start+=f,k.end+=f,k._lineIndex=s.getLineAtOffset(k.start);k=m.splice(g,a-g);for(b=0;b<k.length;b++)k[b].annotation&&k[b].annotation._expand();this.onChanged({type:"Changed",start:h.start,removedCharCount:h.removedCharCount,addedCharCount:h.addedCharCount,removedLineCount:h.removedLineCount,addedLineCount:h.addedLineCount});
this._change=void 0},_onChanging:function(h){var f=!!this._change,d=this._change||{},b=h.start,k=b+h.removedCharCount;d.baseStart=b;d.baseEnd=k;d.baseText=h.text;d.addedLineCount=h.addedLineCount;if(!f){this._change=d;d.text=h.text;var m=this._projections,g,a,s;h=function(e){for(g=a=0;a<m.length;a++){s=m[a];if(s.start>e)break;if(s.end>e)return-1;g+=s._model.getCharCount()-(s.end-s.start)}return e+g};d.start=h(b);-1===d.start&&(d.text=this._model.getText(s.start,b)+d.text,d.addedLineCount+=this._model.getLineAtOffset(b)-
this._model.getLineAtOffset(s.start),d.start=s.start+g);d.end=h(k);-1===d.end&&(d.text+=this._model.getText(k,s.end),d.addedLineCount+=this._model.getLineAtOffset(s.end)-this._model.getLineAtOffset(k),d.end=s.start+g)}d.addedCharCount=d.text.length;d.removedCharCount=d.end-d.start;d.removedLineCount=this.getLineAtOffset(d.end)-this.getLineAtOffset(d.start);this.onChanging({type:"Changing",text:d.text,start:d.start,removedCharCount:d.removedCharCount,addedCharCount:d.addedCharCount,removedLineCount:d.removedLineCount,
addedLineCount:d.addedLineCount})},onChanging:function(h){return this.dispatchEvent(h)},onChanged:function(h){return this.dispatchEvent(h)},setLineDelimiter:function(h){this._model.setLineDelimiter(h)},setText:function(h,f,d){function b(e){for(m=g=0;g<k.length;g++){a=k[g];if(a.start>e-m)break;var c=a._model.getCharCount();if(a.start+c>e-m)return-1;m+=c-(a.end-a.start)}return e-m}this._change={text:h||"",start:f||0,end:void 0===d?this.getCharCount():d};var k=this._projections,m,g,a,s,e;h=b(this._change.start);
-1===h&&(s={projection:a,start:this._change.start-(a.start+m)},h=a.end);f=b(this._change.end);-1===f&&(e={projection:a,end:this._change.end-(a.start+m)},f=a.start);s&&e&&s.projection===e.projection?a._model.setText(this._change.text,s.start,e.end):(this._model.setText(this._change.text,h,f),s&&(a=s.projection,a._model.setText("",s.start)),e&&(a=e.projection,a._model.setText("",0,e.end),a.start=a.end,a._lineCount=0));this._change=void 0}};r.EventTarget.addMixin(p.prototype);return{ProjectionTextModel:p}});
y("orion/editor/tooltip","i18n!orion/editor/nls/messages orion/editor/textView orion/editor/projectionTextModel orion/Deferred orion/editor/util orion/webui/littlelib orion/util".split(" "),function(l,r,p,h,f,d,b){function k(b){this._view=b;b=b.getOptions("parent");this._create(b?b.ownerDocument:document)}k.getTooltip=function(b){b._tooltip||(b._tooltip=new k(b));return b._tooltip};k.prototype={_create:function(d){if(!this._tooltipDiv){var g=this._tooltipDiv=b.createElement(d,"div");g.tabIndex=0;
g.className="textviewTooltip";g.setAttribute("aria-live","assertive");g.setAttribute("aria-atomic","true");this._tooltipDiv.style.visibility="hidden";d.body.appendChild(g);var a=this;f.addEventListener(d,"mousedown",this._mouseDownHandler=function(b){a.isVisible()&&(f.contains(g,b.target||b.srcElement)||a._locked||a.hide())},!0);f.addEventListener(d,"mousemove",this._mouseMoveHandler=function(b){a.isVisible()&&(!a._locked&&!a._hasFocus())&&(a._isInRect(a._outerArea,b.clientX,b.clientY)||a.hide())},
!0);f.addEventListener(g,"focus",function(b){a._locked||a._tooltipDiv.classList.add("textViewTooltipOnFocus")},!1);f.addEventListener(g,"blur",function(b){a._tooltipDiv.classList.remove("textViewTooltipOnFocus")},!1);f.addEventListener(g,"mouseenter",function(b){a._locked||a._tooltipDiv.classList.add("textViewTooltipOnHover")},!1);f.addEventListener(g,"mouseleave",function(b){a._hasFocus()||a._tooltipDiv.classList.remove("textViewTooltipOnHover")},!1);f.addEventListener(g,"keydown",function(b){27===
b.keyCode&&(a._locked||a.hide())},!1);this._view.addEventListener("Destroy",function(){a.destroy()})}},destroy:function(){if(this._tooltipDiv){this.hide();var b=this._tooltipDiv.parentNode;b&&b.removeChild(this._tooltipDiv);b=this._tooltipDiv.ownerDocument;f.removeEventListener(b,"mousedown",this._mouseDownHandler,!0);f.removeEventListener(b,"mousemove",this._mouseMoveHandler,!0);this._tooltipDiv=null}},show:function(b,g,a){this._locked=g;this._giveFocus=a;this._processInfo(b.getTooltipInfo())},update:function(b){b&&
this._processInfo(b.getTooltipInfo(),!0)},onHover:function(b,g,a){b&&!this._isInRect(this._anchorArea,g,a)&&(!this._isInRect(this._tooltipArea,g,a)&&!this._locked&&!this._hasFocus())&&this._processInfo(b.getTooltipInfo())},hide:function(){this.isVisible()&&(this.hover&&this.hover.clearQuickFixes(),this._hasFocus()&&this._view.focus(),this._contentsView&&(this._contentsView.destroy(),this._contentsView=null),this._tooltipContents&&(this._tooltipDiv.removeChild(this._tooltipContents),this._tooltipContents=
null),this._tooltipDiv.classList.remove("textviewTooltipCodeProjection"),this._tooltipDiv.classList.remove("textviewTooltipOnHover"),this._tooltipDiv.classList.remove("textviewTooltipOnFocus"),this._tooltipDiv.style.visibility="hidden",this._tooltipDiv.style.left="",this._tooltipDiv.style.right="",this._tooltipDiv.style.top="",this._tooltipDiv.style.bottom="",this._tooltipDiv.style.width="auto",this._tooltipDiv.style.maxWidth="",this._tooltipDiv.style.height="auto",this._tooltipDiv.style.maxHeight=
"",this._tooltipDiv.style.overflowX="",this._tooltipDiv.style.overflowY="",this._outerArea=this._tooltipArea=this._anchorArea=this._locked=this._giveFocus=void 0,this._hoverPromises&&this._hoverPromises.forEach(function(b){b.resolved||b.cancel()}),this._tipRect=this._hoverPromises=void 0)},isVisible:function(){return this._tooltipDiv&&"visible"===this._tooltipDiv.style.visibility},_processInfo:function(d,g){if(this._tooltipDiv){var a;g&&this._tooltipContents?(this._tooltipContents.innerHTML="",a=
this._tooltipContents):a=b.createElement(this._tooltipDiv.ownerDocument,"div");if(d){if(d.contents&&this._renderImmediateInfo(a,d.contents,d.context))return this._showContents(a,d,g),!0;if(this.hover&&d.context&&(this._hoverPromises=this.hover.computeHoverInfo(d.context))){var f=this;this._hoverPromises.slice(0).forEach(function(e){h.when(e,function(b){if(f._hoverPromises){var c=f._hoverPromises.indexOf(e);0<=c&&f._hoverPromises.splice(c,1)}b&&f._renderPluginContent(a,b)&&(b.offsetStart&&(d.context.offsetStart=
b.offsetStart),b.offsetEnd&&(d.context.offsetEnd=b.offsetEnd),b.allowFullWidth&&(d.allowFullWidth=b.allowFullWidth),f._showContents(a,d,g))},function(a){console&&(a&&"Cancel"!==a.name)&&(console.log("Error computing hover tooltip"),console.log(a&&a.stack))})});return!0}}}},_showContents:function(b,g,a){if(a){if(this._tooltipArea&&g.tooltipArea&&(this._tooltipArea.left!==g.tooltipArea.left||this._tooltipArea.top!==g.tooltipArea.top||this._tooltipArea.width!==g.tooltipArea.width||this._tooltipArea.height!==
g.tooltipArea.height))this._outerArea=this._tooltipArea=this._anchorArea=null}else this.hide();this._tooltipContents=b;this._tooltipDiv.appendChild(b);this._anchorArea||(this._anchorArea=this._computeAnchorArea(g));this._tooltipArea||(this._tooltipArea=this._computeTooltipArea(g,this._anchorArea,this._tooltipDiv));this._outerArea||(this._outerArea=this._computeOuterArea(this._anchorArea,this._tooltipArea));this._tooltipDiv.style.visibility="visible";this._giveFocus&&(this._setInitialFocus(this._tooltipDiv),
this._giveFocus=void 0)},_computeAnchorArea:function(b){if(b.anchorArea&&b.anchorArea.top&&b.anchorArea.left&&b.anchorArea.height&&b.anchorArea.width)return b.anchorArea;if(b.context){if(b.context.offsetStart&&b.context.offsetEnd)return this._computeRectangleFromOffset(b.context.offsetStart,b.context.offsetEnd);if(0<=b.context.offset){var g=this._view.getNextOffset(b.context.offset,{unit:"word",count:-1});b=this._view.getNextOffset(b.context.offset,{unit:"word",count:0});return this._computeRectangleFromOffset(g,
b)}}return{top:0,left:0,height:0,width:0}},_computeTooltipArea:function(b,g,a){var d=a.ownerDocument.documentElement;if(b.tooltipArea&&b.tooltipArea.top&&b.tooltipArea.left&&b.tooltipArea.height&&b.tooltipArea.width)return a.style.overflowY="auto",a.style.resize="none",a.style.top=b.tooltipArea.top+"px",a.style.left=b.tooltipArea.left+"px",a.style.height=b.tooltipArea.height-16+"px",a.style.width=b.tooltipArea.width-16+"px",b.tooltipArea;var e=a.getBoundingClientRect(),e={width:e.width,height:e.height},
n=b.position?b.position:"below",c=(this._view._rootDiv?this._view._rootDiv:d).getBoundingClientRect(),d=c.left,f=c.top,t=c.width,c=c.height,k=t;if(!b.allowFullWidth){var k=Math.min(t/2,600),h=Math.min(c/2,400);e.width=Math.min(e.width,k);e.height=Math.min(e.height,h)}41>e.height&&e.width>k-16&&(e.height=56);var k=c-(g.top+g.height-f),l=g.top-f,h=t-(g.left+g.width-d);"above"===n&&e.height>l&&e.height<=k?n="below":"below"===n&&(e.height>k&&e.height<=l)&&(n="above");l=b.tooltipOffsetX?b.tooltipOffsetX:
0;b=b.tooltipOffsetY?b.tooltipOffsetY:0;switch(n){case "left":e.top=e.height+b>k+g.height?c+f-e.height:g.top+b;e.top=Math.max(e.top,f);e.left=Math.max(g.left-e.width+l,d);break;case "right":e.top=e.height+b>k+g.height?c+f-e.height:g.top+b;e.top=Math.max(e.top,f);e.left=Math.max(g.left+g.width+l,d);break;case "above":e.left=e.width+l>h+g.width?t+d-e.width:g.left+l;e.left=Math.max(e.left,d);e.top=Math.max(g.top-e.height+b,f);break;case "below":e.left=e.width+l>h+g.width?t+d-e.width:g.left+l,e.left=
Math.max(e.left,d),e.top=Math.max(g.top+g.height+b,f)}e.maxWidth=Math.min(t+d-e.left,t);e.maxHeight=Math.min(c+f-e.top,c);a.style.maxWidth=e.maxWidth-16+"px";a.style.maxHeight=e.maxHeight-16+"px";a.style.width=e.width-16+"px";a.style.height=e.height-16+"px";a.style.left=e.left+"px";a.style.top=e.top+"px";return e},_computeOuterArea:function(b,g){var a=Math.min(b.left,g.left),d=Math.min(b.top,g.top),e=Math.max(b.left+b.width,g.left+g.width),n=Math.max(b.top+b.height,g.top+g.height);return{left:a,top:d,
width:e-a,height:n-d}},_hasFocus:function(){var b=this._tooltipDiv;return!b?!1:f.contains(b,b.ownerDocument.activeElement)},_isNode:function(b){return"object"===typeof Node?b instanceof Node:b&&"object"===typeof b&&"number"===typeof b.nodeType&&"string"===typeof b.nodeName},_setInitialFocus:function(b){var g=d.$("button",b);if(g)g.focus();else if(g=d.$("a",b)){g.focus();var a=this;g.addEventListener("click",function(){a.hide()})}else(b=d.firstTabbable(b))&&b.focus()},_isInRect:function(b,g,a){if(!b)return!1;
a=a>=b.top&&a<=b.top+b.height;return g>=b.left&&g<=b.left+b.width&&a},mapOffset:function(b,g){var a=this._view.getModel();a.getBaseModel&&(b=a.mapOffset(b,g));return b},_computeRectangleFromOffset:function(b,g){b=this.mapOffset(b);g=this.mapOffset(g);var a=this._view,d=a.getLineAtOffset(b),e=a.getLineAtOffset(g);d!==e&&(g=a.getModel().getLineEnd(d));d=a.getLineHeight(d);e=a.getLocationAtOffset(b);a=a.getLocationAtOffset(g);a={x:e.x,y:e.y,width:a.x-e.x,height:d};a=this._view.convert(a,"document","page");
return{left:a.x,top:a.y,width:a.width,height:a.height}},_renderPluginContent:function(d,g){var a=this._tooltipDiv.ownerDocument;if("string"!==typeof g&&"undefined"===typeof g.content)return!1;var f=b.createElement(a,"div");if(g.title){var e=b.createElement(a,"div");e.innerHTML=this.hover.renderMarkDown?this.hover.renderMarkDown(g.title):g.title;f.appendChild(e)}e=b.createElement(a,"div");if("string"===typeof g)e.appendChild(a.createTextNode(g));else switch(g.type){case "delegatedUI":case "html":g.content&&
(a=a.createElement("iframe"),a.id="HtmlHover",a.name="HTML Hover",a.type="text/html",a.sandbox="allow-scripts allow-same-origin allow-forms",a.style.border="none",a.style.width="100%",a.style.height="100%",this._tooltipDiv.style.paddingBottom="5px",a.srcdoc=g.content,g.width&&(a.style.width=g.width),g.height&&(a.style.height=g.height),f.style.height="100%",d.style.height="100%",f.appendChild(a));break;case "markdown":this.hover.renderMarkDown&&(e.innerHTML=this.hover.renderMarkDown(g.content));break;
default:e.appendChild(a.createTextNode(g.content))}f.appendChild(e);d.appendChild(f);return!0},_renderImmediateInfo:function(b,g,a){if(g instanceof Array&&(g=this._getAnnotationContents(g,a),!g))return!1;if("string"===typeof g)return b.innerHTML=g,!0;if(this._isNode(g))return b.appendChild(g),!0;if(g instanceof p.ProjectionTextModel){var d=this._view;a=d.getOptions();a.wrapMode=!1;a.parent=b;var e=a.themeClass;e?((e=e.replace("tooltipTheme",""))&&(e=" "+e),e="tooltipTheme"+e):e="tooltipTheme";a.themeClass=
e;a=this._contentsView=new r.TextView(a);a.addEventListener("LineStyle",function(a){d.onLineStyle(a)});a.setModel(g);this._tooltipDiv.appendChild(b);this._tooltipDiv.classList.add("textviewTooltipCodeProjection");g=a.computeSize();b.style.width=g.width+8+"px";b.style.height=g.height+8+"px";a.resize();this._tooltipDiv.removeChild(b);return!0}return!1},_getAnnotationContents:function(d,g){function a(a,c){var e=a.title,d=b.createElement(t,"div");d.className="tooltipRow";if(a.html){var n=b.createElement(t,
"div");n.className="tooltipImage";n.innerHTML=a.html;n.lastChild&&f.addEventListener(n.lastChild,"click",function(){var c=a.start,e=a.end;h.getBaseModel&&(c=h.mapOffset(c,!0),e=h.mapOffset(e,!0));k.setSelection(c,e,1/3,function(){s.hide()})},!1);d.appendChild(n)}e||(e=E.getLineStart(E.getLineAtOffset(a.start)),n=E.getLineEnd(E.getLineAtOffset(a.end),!0),e=E.getText(e,n));"function"===typeof e&&(e=a.title());"string"===typeof e&&(n=b.createElement(t,"span"),n.className="tooltipTitle",n.appendChild(t.createTextNode(e)),
e=n);d.appendChild(e);c&&s.hover.renderQuickFixes(a,d);g&&(g.offsetStart=a.start,g.offsetEnd=a.end);return d}var s=this,e=s.hover?!0:!1;e&&(g&&g.source&&0<=g.source.indexOf("ruler"))&&(e=!1);for(var n,c=[],u=0;u<d.length;u++)n=d[u],""!==n.title&&!n.groupAnnotation&&(!e||n.title)&&c.push(n);d=c;if(0===d.length)return null;var t=this._tooltipDiv.ownerDocument,k=this._view,h=k.getModel(),E=h.getBaseModel?h.getBaseModel():h;if(1===d.length&&"orion.annotation.folding"===d[0].type)return e=new p.ProjectionTextModel(E),
n=E.getLineStart(E.getLineAtOffset(d[0].start)),c=E.getCharCount(),d[0].end!==c&&e.addProjection({start:d[0].end,end:c}),0<n&&e.addProjection({start:0,end:n}),e;if(1===d.length){if((n=a(d[0],e))&&n.firstChild)(e=n.firstChild.className)&&(e+=" "),n.firstChild.className=e+"single";return n}c=b.createElement(t,"div");n=b.createElement(t,"em");n.appendChild(t.createTextNode(l.multipleAnnotations));c.appendChild(n);for(u=0;u<d.length;u++)(n=a(d[u],e))&&c.appendChild(n);return c}};return{Tooltip:k}});y("orion/editor/annotations",
["i18n!orion/editor/nls/messages","orion/editor/eventTarget"],function(l,r){function p(){}function h(a,b,e){this.start=a;this.end=b;this._projectionModel=e;this.html=this._expandedHTML;this.style=this._expandedStyle;this.expanded=!0}function f(a,b){var e=a.lastIndexOf("."),e=a.substring(e+1),g={title:l[e],style:{styleClass:"annotation "+e},html:"\x3cdiv class\x3d'annotationHTML "+e+"'\x3e\x3c/div\x3e",overviewStyle:{styleClass:"annotationOverview "+e}};b?g.lineStyle={styleClass:"annotationLine "+
e}:g.rangeStyle={styleClass:"annotationRange "+e};p.registerType(a,g)}function d(){}function b(a,b,e,g,c){var d;void 0===g&&(g=-1);void 0===c&&(c=a.length);for(;1<c-g;)if(d=Math.floor((c+g)/2),b<=a[d].start)c=d;else if(e&&b<a[d].end){c=d;break}else g=d;return c}function k(a){this._annotations=[];var b=this;this._listener={onChanged:function(a){b._onChanged(a)}};this.setTextModel(a)}function m(a,b){this._view=a;this._annotationModel=b;var e=this;this._listener={onDestroy:function(a){e._onDestroy(a)},
onLineStyle:function(a){e._onLineStyle(a)},onChanged:function(a){e._onAnnotationModelChanged(a)}};a.addEventListener("Destroy",this._listener.onDestroy);a.addEventListener("postLineStyle",this._listener.onLineStyle);b.addEventListener("Changed",this._listener.onChanged)}h.prototype={_expandedHTML:"\x3cdiv class\x3d'annotationHTML expanded'\x3e\x3c/div\x3e",_expandedStyle:{styleClass:"annotation expanded"},_collapsedHTML:"\x3cdiv class\x3d'annotationHTML collapsed'\x3e\x3c/div\x3e",_collapsedStyle:{styleClass:"annotation collapsed"},
_collapse:function(){if(!this.expanded)return!1;this.expanded=!1;this.html=this._collapsedHTML;this.style=this._collapsedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);return!0},_expand:function(){if(this.expanded)return!1;this.expanded=!0;this.html=this._expandedHTML;this.style=this._expandedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);return!0},_collapseImpl:function(a){if(this._collapse()){a&&this._forEachOverlaping(function(a){a.expanded||
(a._expandImpl(!1),a._recollapse=!0)});a=this._projectionModel;var b=a.getBaseModel();this._projection={annotation:this,start:b.getLineStart(b.getLineAtOffset(this.start)+1),end:b.getLineEnd(b.getLineAtOffset(this.end),!0)};a.addProjection(this._projection)}},_expandImpl:function(a){this._expand()&&(this._projectionModel._removeProjection(this._projection,!this._annotationModel),a&&this._forEachOverlaping(function(a){a._recollapse&&(a._collapseImpl(!1),a._recollapse=!1)}))},_forEachOverlaping:function(a){if(this._annotationModel)for(var b=
this._annotationModel.getAnnotations(this.start,this.end);b.hasNext();){var e=b.next();e!==this&&e.type===p.ANNOTATION_FOLDING&&a.call(this,e)}},collapse:function(){this._recollapse=!1;this._collapseImpl(!0)},expand:function(){this._recollapse=!1;this._expandImpl(!0)}};p.ANNOTATION_ERROR="orion.annotation.error";p.ANNOTATION_WARNING="orion.annotation.warning";p.ANNOTATION_TASK="orion.annotation.task";p.ANNOTATION_BREAKPOINT="orion.annotation.breakpoint";p.ANNOTATION_BOOKMARK="orion.annotation.bookmark";
p.ANNOTATION_FOLDING="orion.annotation.folding";p.ANNOTATION_CURRENT_BRACKET="orion.annotation.currentBracket";p.ANNOTATION_MATCHING_BRACKET="orion.annotation.matchingBracket";p.ANNOTATION_CURRENT_LINE="orion.annotation.currentLine";p.ANNOTATION_CURRENT_SEARCH="orion.annotation.currentSearch";p.ANNOTATION_MATCHING_SEARCH="orion.annotation.matchingSearch";p.ANNOTATION_READ_OCCURRENCE="orion.annotation.readOccurrence";p.ANNOTATION_WRITE_OCCURRENCE="orion.annotation.writeOccurrence";p.ANNOTATION_SELECTED_LINKED_GROUP=
"orion.annotation.selectedLinkedGroup";p.ANNOTATION_CURRENT_LINKED_GROUP="orion.annotation.currentLinkedGroup";p.ANNOTATION_LINKED_GROUP="orion.annotation.linkedGroup";p.ANNOTATION_BLAME="orion.annotation.blame";p.ANNOTATION_CURRENT_BLAME="orion.annotation.currentBlame";p.ANNOTATION_DIFF_ADDED="orion.annotation.diffAdded";p.ANNOTATION_DIFF_DELETED="orion.annotation.diffDeleted";p.ANNOTATION_DIFF_MODIFIED="orion.annotation.diffModified";var g={};p.registerType=function(a,b){var e=b;"function"!==typeof e&&
(e=function(a,c,e){this.start=a;this.end=c;void 0!==e&&(this.title=e)},e.prototype=b);e.prototype.type=a;g[a]=e;return a};p.createAnnotation=function(a,b,e,g){return new (this.getType(a))(b,e,g)};p.getType=function(a){return g[a]};f(p.ANNOTATION_ERROR);f(p.ANNOTATION_WARNING);f(p.ANNOTATION_TASK);f(p.ANNOTATION_BREAKPOINT);f(p.ANNOTATION_BOOKMARK);f(p.ANNOTATION_CURRENT_BRACKET);f(p.ANNOTATION_MATCHING_BRACKET);f(p.ANNOTATION_CURRENT_SEARCH);f(p.ANNOTATION_MATCHING_SEARCH);f(p.ANNOTATION_READ_OCCURRENCE);
f(p.ANNOTATION_WRITE_OCCURRENCE);f(p.ANNOTATION_SELECTED_LINKED_GROUP);f(p.ANNOTATION_CURRENT_LINKED_GROUP);f(p.ANNOTATION_LINKED_GROUP);f(p.ANNOTATION_CURRENT_LINE,!0);f(p.ANNOTATION_BLAME,!0);f(p.ANNOTATION_CURRENT_BLAME,!0);f(p.ANNOTATION_DIFF_ADDED);f(p.ANNOTATION_DIFF_DELETED);f(p.ANNOTATION_DIFF_MODIFIED);p.registerType(p.ANNOTATION_FOLDING,h);d.addMixin=function(a){var b=d.prototype,e;for(e in b)b.hasOwnProperty(e)&&(a[e]=b[e])};d.prototype={addAnnotationType:function(a,b){this._annotationTypes||
(this._annotationTypes=[]);var e=b-1;void 0==b||!(0<=e&&e<this._annotationTypes.length)?this._annotationTypes.push(a):this._annotationTypes.splice(e,0,a)},getAnnotationTypePriority:function(a){if(this._annotationTypes)for(var b=0;b<this._annotationTypes.length;b++)if(this._annotationTypes[b]===a)return b+1;return 0},getAnnotationsByType:function(a,b,e){a=a.getAnnotations(b,e);for(e=[];a.hasNext();)b=a.next(),0!==this.getAnnotationTypePriority(b.type)&&e.push(b);var g=this;e.sort(function(a,e){return g.getAnnotationTypePriority(a.type)-
g.getAnnotationTypePriority(e.type)});return e},isAnnotationTypeVisible:function(a){return 0!==this.getAnnotationTypePriority(a)},removeAnnotationType:function(a){if(this._annotationTypes)for(var b=0;b<this._annotationTypes.length;b++)if(this._annotationTypes[b]===a){this._annotationTypes.splice(b,1);break}}};k.prototype={addAnnotation:function(a){if(a){var g=this._annotations,e=b(g,a.start);g.splice(e,0,a);a._annotationModel=this;this.onChanged({type:"Changed",added:[a],removed:[],changed:[]})}},
getTextModel:function(){return this._model},getAnnotations:function(a,b){var e=this._annotations,g,c=0,d;d=void 0===a&&void 0===b?function(){return c<e.length?e[c++]:null}:function(){for(;c<e.length;){var g=e[c++];if(a===g.start||(a>g.start?a<g.end:g.start<b))return g;if(g.start>=b)break}return null};g=d();return{next:function(){var a=g;a&&(g=d());return a},hasNext:function(){return null!==g}}},modifyAnnotation:function(a){if(a&&!(0>this._getAnnotationIndex(a)))this.onChanged({type:"Changed",added:[],
removed:[],changed:[a]})},onChanged:function(a){return this.dispatchEvent(a)},removeAnnotations:function(a){var b=this._annotations,e,g;if(a){e=[];for(g=b.length-1;0<=g;g--){var c=b[g];c.type===a&&(b.splice(g,1),e.splice(0,0,c),c._annotationModel=null)}}else e=b;this.onChanged({type:"Changed",removed:e,added:[],changed:[]})},removeAnnotation:function(a){if(a){var b=this._getAnnotationIndex(a);0>b||(a._annotationModel=null,a={type:"Changed",removed:this._annotations.splice(b,1),added:[],changed:[]},
this.onChanged(a))}},replaceAnnotations:function(a,g){var e=this._annotations,d,c,f,t=[];if(a)for(d=a.length-1;0<=d;d--)f=a[d],c=this._getAnnotationIndex(f),0>c||(f._annotationModel=null,e.splice(c,1),t.splice(0,0,f));g||(g=[]);for(d=0;d<g.length;d++)f=g[d],c=b(e,f.start),f._annotationModel=this,e.splice(c,0,f);this.onChanged({type:"Changed",removed:t,added:g,changed:[]})},setTextModel:function(a){this._model&&this._model.removeEventListener("Changed",this._listener.onChanged);(this._model=a)&&this._model.addEventListener("Changed",
this._listener.onChanged)},_getAnnotationIndex:function(a){for(var g=this._annotations,e=b(g,a.start);e<g.length&&g[e].start===a.start;){if(g[e]===a)return e;e++}return-1},_onChanged:function(a){var b=a.start,e=a.addedCharCount,g=a.removedCharCount,c=this._annotations,d=b+g;if(0<c.length){a={type:"Changed",added:[],removed:[],changed:[],textModelChangedEvent:a};e-=g;for(g=0;g<c.length;g++){var f=c[g];f.start>=d?(f._oldStart=f.start,f._oldEnd=f.end,f.start+=e,f.end+=e,a.changed.push(f)):f.end<=b||
(f.start<b&&d<f.end?(f._oldStart=f.start,f._oldEnd=f.end,f.end+=e,a.changed.push(f)):(c.splice(g,1),a.removed.push(f),f._annotationModel=null,f.expand&&f.expand(),g--))}if(0<a.added.length||0<a.removed.length||0<a.changed.length)this.onChanged(a)}}};r.EventTarget.addMixin(k.prototype);m.prototype={destroy:function(){var a=this._view;a&&(a.removeEventListener("Destroy",this._listener.onDestroy),a.removeEventListener("LineStyle",this._listener.onLineStyle),this.view=null);(a=this._annotationModel)&&
a.removeEventListener("Changed",this._listener.onChanged)},_mergeStyle:function(a,b){if(b){a||(a={});a.styleClass=a.styleClass&&b.styleClass&&a.styleClass!==b.styleClass?a.styleClass+(" "+b.styleClass):b.styleClass;var e;b.tagName&&!a.tagName&&(a.tagName=b.tagName);if(b.style)for(e in a.style||(a.style={}),b.style)a.style[e]||(a.style[e]=b.style[e]);if(b.attributes)for(e in a.attributes||(a.attributes={}),b.attributes)a.attributes[e]||(a.attributes[e]=b.attributes[e])}return a},_mergeStyleRanges:function(a,
g){a||(a=[]);for(var e,d=b(a,g.start,!0);d<a.length&&g;d++){var c=a[d];if(g.end<=c.start)break;if(!(g.start>=c.end)){e=this._mergeStyle({},c.style);e=this._mergeStyle(e,g.style);var f=[];f.push(d,1);g.start<c.start&&f.push({start:g.start,end:c.start,style:g.style});g.start>c.start&&f.push({start:c.start,end:g.start,style:c.style});f.push({start:Math.max(c.start,g.start),end:Math.min(c.end,g.end),style:e});g.end<c.end&&f.push({start:g.end,end:c.end,style:c.style});g=g.end>c.end?{start:c.end,end:g.end,
style:g.style}:null;Array.prototype.splice.apply(a,f)}}g&&(e=this._mergeStyle({},g.style),a.splice(d,0,{start:g.start,end:g.end,style:e}));return a},_onAnnotationModelChanged:function(a){function b(a,c){d.getBaseModel&&(a=d.mapOffset(a,!0),c=d.mapOffset(c,!0));-1!==a&&-1!==c&&g.redrawRange(a,c)}function e(a,e){for(var g=0;g<a.length;g++)if(c.isAnnotationTypeVisible(a[g].type)){var d=a[g];b(d.start,d.end);e&&(void 0!==d._oldStart&&d._oldEnd)&&b(d._oldStart,d._oldEnd)}}var g=this._view;if(g){var c=
this,d=g.getModel();e(a.added);e(a.removed);e(a.changed,!0)}},_onDestroy:function(a){this.destroy()},_onLineStyle:function(a){var b=this._annotationModel,e=a.textView.getModel(),g=b.getTextModel(),c=a.lineStart,d=a.lineStart+a.lineText.length;g!==e&&(c=e.mapOffset(c),d=e.mapOffset(d));for(b=b.getAnnotations(c,d);b.hasNext();)if(c=b.next(),this.isAnnotationTypeVisible(c.type)){if(c.rangeStyle){var d=c.start,f=c.end;g!==e&&(d=e.mapOffset(d,!0),f=e.mapOffset(f,!0));a.ranges=this._mergeStyleRanges(a.ranges,
{start:d,end:f,style:c.rangeStyle})}c.lineStyle&&(a.style=this._mergeStyle({},a.style),a.style=this._mergeStyle(a.style,c.lineStyle))}}};d.addMixin(m.prototype);return{FoldingAnnotation:h,AnnotationType:p,AnnotationTypeList:d,AnnotationModel:k,AnnotationStyler:m}});y("orion/editor/editor","i18n!orion/editor/nls/messages orion/editor/eventTarget orion/editor/tooltip orion/editor/annotations orion/objects orion/util".split(" "),function(l,r,p,h,f,d){function b(b){b=b||{};this._domNode=b.domNode;this._model=
b.model;this._undoStack=b.undoStack;this._statusReporter=b.statusReporter;this._title=null;var a=this;this._listener={onChanged:function(b){a.onChanged(b)}};this._model&&this._model.addEventListener("Changed",this._listener.onChanged);this.checkDirty()}function k(g){g=g||{};b.call(this,g);this._textViewFactory=g.textViewFactory;this._undoStackFactory=g.undoStackFactory;this._textDNDFactory=g.textDNDFactory;this._annotationFactory=g.annotationFactory;this._zoomRulerFactory=g.zoomRulerFactory;this._foldingRulerFactory=
g.foldingRulerFactory;this._lineNumberRulerFactory=g.lineNumberRulerFactory;this._contentAssistFactory=g.contentAssistFactory;this._keyBindingFactory=g.keyBindingFactory;this._hoverFactory=g.hoverFactory;this._contentAssist=this._foldingRuler=this._zoomRuler=this._overviewRuler=this._lineNumberRuler=this._annotationRuler=this._annotationModel=this._annotationStyler=null}var m=h.AnnotationType;b.prototype={destroy:function(){this.uninstall();this._statusReporter=this._domNode=null;this._model&&this._model.removeEventListener("Changed",
this._listener.onChanged)},checkDirty:function(){this.setDirty(this._undoStack&&!this._undoStack.isClean())},focus:function(){},getModel:function(){return this._model},getText:function(b,a){return this.getModel().getText(b,a)},getTitle:function(){return this._title},getUndoStack:function(){return this._undoStack},install:function(){this.installed=!0},isDirty:function(){return this._undoStack?!this._undoStack.isClean():this._dirty},markClean:function(){this.getUndoStack().markClean();this.setDirty(!1)},
onDirtyChanged:function(b){return this.dispatchEvent(b)},onInputChanged:function(b){return this.dispatchEvent(b)},onChanged:function(b){this.checkDirty()},reportStatus:function(b,a,d){this._statusReporter&&this._statusReporter(b,a,d)},resize:function(){},setDirty:function(b){this._dirty!==b&&(this._dirty=b,this.onDirtyChanged({type:"DirtyChanged"}))},_setModelText:function(b){this._model&&this._model.setText(b)},setInput:function(b,a,d,e){this._title=b;e||(a?this.reportStatus(a,"error"):null!==d&&
void 0!==d&&("string"===typeof d&&this._setModelText(d),this._undoStack&&this._undoStack.reset()));this.checkDirty();this.onInputChanged({type:"InputChanged",title:b,message:a,contents:d,contentsSaved:e})},setText:function(b,a,d){this.getModel().setText(b,a,d)},uninstall:function(){this.installed=!1}};r.EventTarget.addMixin(b.prototype);k.prototype=new b;f.mixin(k.prototype,{destroy:function(){b.prototype.destroy.call(this);this._textViewFactory=this._undoStackFactory=this._textDNDFactory=this._annotationFactory=
this._foldingRulerFactory=this._lineNumberRulerFactory=this._contentAssistFactory=this._keyBindingFactory=this._hoverFactory=this._zoomRulerFactory=null},getAnnotationModel:function(){return this._annotationModel},getAnnotationRuler:function(){return this._annotationRuler},getAnnotationStyler:function(){return this._annotationStyler},getContentAssist:function(){return this._contentAssist},getFoldingRuler:function(){return this._foldingRuler},getLineNumberRuler:function(){return this._lineNumberRuler},
getTooltip:function(){return p.Tooltip.getTooltip(this._textView)},getZoomRuler:function(){return this._zoomRuler},getModel:function(){if(!this._textView)return null;var b=this._textView.getModel();b.getBaseModel&&(b=b.getBaseModel());return b},getOverviewRuler:function(){return this._overviewRuler},getTextView:function(){return this._textView},getKeyModes:function(){return this._textView.getKeyModes()},getSourceCodeActions:function(){return this._sourceCodeActions},getLinkedMode:function(){return this._linkedMode},
getTextActions:function(){return this._textActions},focus:function(){this._textView&&this._textView.focus()},resize:function(){this._textView&&this._textView.resize()},setAnnotationRulerVisible:function(b,a){if(this._annotationRulerVisible!==b||a)if(this._annotationRulerVisible=b,this._annotationRuler){var d=this._textView;b?d.addRuler(this._annotationRuler,0):d.removeRuler(this._annotationRuler)}},setFoldingRulerVisible:function(b,a){if(this._foldingRulerVisible!==b||a)if(this._foldingRulerVisible=
b,this._foldingRuler){var d=this._textView;d.getModel().getBaseModel&&(b?d.addRuler(this._foldingRuler):d.removeRuler(this._foldingRuler))}},setLineNumberRulerVisible:function(b,a){if(this._lineNumberRulerVisible!==b||a)if(this._lineNumberRulerVisible=b,this._lineNumberRuler){var d=this._textView;b?d.addRuler(this._lineNumberRuler,!this._annotationRulerVisible?0:1):d.removeRuler(this._lineNumberRuler)}},setOverviewRulerVisible:function(b,a){if(this._overviewRulerVisible!==b||a)if(this._overviewRulerVisible=
b,this._overviewRuler){var d=this._textView;b?d.addRuler(this._overviewRuler):d.removeRuler(this._overviewRuler)}},setZoomRulerVisible:function(b,a){if(this._zoomRulerVisible!==b||a)if(this._zoomRulerVisible=b,this._zoomRuler){var d=this._textView;b?d.addRuler(this._zoomRuler):d.removeRuler(this._zoomRuler)}},mapOffset:function(b,a){var d=this._textView.getModel();d.getBaseModel&&(b=d.mapOffset(b,a));return b},getLineAtOffset:function(b){return this.getModel().getLineAtOffset(this.mapOffset(b))},
getLineStart:function(b){return this.getModel().getLineStart(b)},getCaretOffset:function(){return this.mapOffset(this._textView.getCaretOffset())},getSelection:function(){var b=this._textView,a=b.getSelection(),b=b.getModel();b.getBaseModel&&(a.start=b.mapOffset(a.start),a.end=b.mapOffset(a.end));return a},getSelections:function(){var b=this._textView,a=b.getModel(),b=b.getSelections();b.forEach(function(b){a.getBaseModel&&(b.start=a.mapOffset(b.start),b.end=a.mapOffset(b.end))});return b},_expandOffset:function(b){var a=
this._textView.getModel(),d=this._annotationModel;if(d&&a.getBaseModel)for(b=d.getAnnotations(b,b+1);b.hasNext();)a=b.next(),a.type===m.ANNOTATION_FOLDING&&a.expand&&a.expand()},setCaretOffset:function(b,a,d){var e=this._textView,n=e.getModel();n.getBaseModel&&(this._expandOffset(b),b=n.mapOffset(b,!0));e.setCaretOffset(b,a,d)},setText:function(b,a,d,e,n){var c=this._textView,f=c.getModel();f.getBaseModel&&(void 0!==a&&(this._expandOffset(a),a=f.mapOffset(a,!0)),void 0!==d&&(this._expandOffset(d),
d=f.mapOffset(d,!0)));c.setText(b,a,d,e,n)},setSelection:function(b,a,d,e){var n=this._textView,c=n.getModel();c.getBaseModel&&(this._expandOffset(b),this._expandOffset(a),b=c.mapOffset(b,!0),a=c.mapOffset(a,!0));n.setSelection(b,a,d,e)},setSelections:function(b,a,d){var e=this,n=this._textView,c=n.getModel();b.forEach(function(a){var b=a.start,g=a.end;c.getBaseModel&&(e._expandOffset(b),e._expandOffset(g),b=c.mapOffset(b,!0),g=c.mapOffset(g,!0));a.start=b;a.end=g});n.setSelections(b,a,d)},moveSelection:function(b,
a,d,e){var n=this._textView;this.setSelection(b,a||b,1/3,function(){(void 0===e||e)&&n.focus();d&&d()})},_getTooltipInfo:function(b,a){var d=this._textView,e=this.getAnnotationModel();if(!e)return null;var n=this._annotationStyler;if(!n||!d.isValidTextPosition(b,a))return null;d=d.getOffsetAtLocation(b,a);if(-1===d)return null;for(var d=this.mapOffset(d),e=n.getAnnotationsByType(e,d,d+1),n=[],c=0;c<e.length;c++)e[c].rangeStyle&&n.push(e[c]);return{contents:n,position:"below",context:{source:"editor",
offset:d}}},_highlightCurrentLine:function(b,a){function d(a){var c={};return a&&a.some(function(a){if(a&&a.isEmpty())c[f.getLineAtOffset(a.start).toString()]=!0;else return!0;return!1})?{}:c}function e(a,c){for(var e in a)if(!c[e])return!0;return!1}var n=this._annotationModel;if(n){var c=this._textView;if(!c.getOptions("singleMode")){a=Array.isArray(a)?a:[a];b=Array.isArray(b)?b:[b];var f=c.getModel(),c=d(a),t=d(b);if(e(c,t)||e(t,c)){var c=this._currentLineAnnotations,k=[],h;for(h in t){var l=h>>
0,t=f.getLineStart(l),l=f.getLineEnd(l);f.getBaseModel&&(t=f.mapOffset(t),l=f.mapOffset(l));t=m.createAnnotation(m.ANNOTATION_CURRENT_LINE,t,l);k.push(t)}this._currentLineAnnotations=k;n.replaceAnnotations(c,k)}}}},installTextView:function(){this.install()},install:function(){if(!this._textView){this._textView=this._textViewFactory();this._undoStackFactory&&(this._undoStack=this._undoStackFactory.createUndoStack(this),this._textView.setOptions({undoStack:this._undoStack}),this.checkDirty());this._textDNDFactory&&
(this._textDND=this._textDNDFactory.createTextDND(this,this._undoStack));this._contentAssistFactory&&(this._contentAssist=this._contentAssistFactory.createContentAssistMode(this).getContentAssist());var g=p.Tooltip.getTooltip(this._textView);this._hoverFactory&&(this._hover=this._hoverFactory.createHover(this),g.hover=this._hover);var a=this,d=this._textView,e=this;this._listener={onModelChanged:function(a){e.checkDirty()},onMouseOver:function(a){e._listener.onMouseMove(a)},onMouseDown:function(a){e._listener.mouseDown=
!0},onMouseUp:function(a){e._listener.mouseDown=!1},onMouseMove:function(a){g&&!e._listener.mouseDown&&!(a.event.clientX===e._listener.lastMouseX&&a.event.clientY===e._listener.lastMouseY)&&(e._listener.lastMouseX=a.event.clientX,e._listener.lastMouseY=a.event.clientY,e._hoverTimeout&&(window.clearTimeout(e._hoverTimeout),e._hoverTimeout=null),e._hoverTimeout=window.setTimeout(function(){e._hoverTimeout=null;if(e._listener)g.onHover({y:a.y,x:a.x,getTooltipInfo:function(){return e._getTooltipInfo(this.x,
this.y)}},a.x,a.y)},175))},onMouseOut:function(a){e._hoverTimeout&&(window.clearTimeout(e._hoverTimeout),e._hoverTimeout=null)},onScroll:function(a){g&&g.hide()},onSelection:function(a){g&&g.hide();e._updateCursorStatus();e._highlightCurrentLine(a.newValue,a.oldValue)}};d.addEventListener("ModelChanged",this._listener.onModelChanged);d.addEventListener("Selection",this._listener.onSelection);d.addEventListener("MouseOver",this._listener.onMouseOver);d.addEventListener("MouseOut",this._listener.onMouseOut);
d.addEventListener("MouseDown",this._listener.onMouseDown);d.addEventListener("MouseUp",this._listener.onMouseUp);d.addEventListener("MouseMove",this._listener.onMouseMove);d.addEventListener("Scroll",this._listener.onScroll);if(this._keyBindingFactory){var n;if(n="function"===typeof this._keyBindingFactory?this._keyBindingFactory(this,this.getKeyModes(),this._undoStack,this._contentAssist):this._keyBindingFactory.createKeyBindings(a,this._undoStack,this._contentAssist))this._textActions=n.textActions,
this._linkedMode=n.linkedMode,this._sourceCodeActions=n.sourceCodeActions}n=function(c,e){if(void 0!==c&&-1!==c){for(var b=this.getView().getModel(),g=this.getAnnotationModel(),d=a.mapOffset(b.getLineStart(c)),b=a.mapOffset(b.getLineEnd(c)),n=g.getAnnotations(d,b),f=null;n.hasNext();){var u=n.next();if(u.type===m.ANNOTATION_BOOKMARK){f=u;break}}f?g.removeAnnotation(f):(f=m.createAnnotation(m.ANNOTATION_BOOKMARK,d,b,a.getText(d,b)),g.addAnnotation(f))}};if(this._annotationFactory){var c=d.getModel();
c.getBaseModel&&(c=c.getBaseModel());if(this._annotationModel=this._annotationFactory.createAnnotationModel(c))if(c=this._annotationStyler=this._annotationFactory.createAnnotationStyler(d,this._annotationModel))c.addAnnotationType(m.ANNOTATION_CURRENT_SEARCH),c.addAnnotationType(m.ANNOTATION_MATCHING_SEARCH),c.addAnnotationType(m.ANNOTATION_ERROR),c.addAnnotationType(m.ANNOTATION_WARNING),c.addAnnotationType(m.ANNOTATION_MATCHING_BRACKET),c.addAnnotationType(m.ANNOTATION_CURRENT_BRACKET),c.addAnnotationType(m.ANNOTATION_CURRENT_LINE),
c.addAnnotationType(m.ANNOTATION_READ_OCCURRENCE),c.addAnnotationType(m.ANNOTATION_WRITE_OCCURRENCE),c.addAnnotationType(m.ANNOTATION_SELECTED_LINKED_GROUP),c.addAnnotationType(m.ANNOTATION_CURRENT_LINKED_GROUP),c.addAnnotationType(m.ANNOTATION_LINKED_GROUP),c.addAnnotationType("orion.annotation.highlightError");var c=this._annotationFactory.createAnnotationRulers(this._annotationModel),f=this._annotationRuler=c.annotationRuler;f&&(f.onDblClick=n,f.setMultiAnnotationOverlay({html:"\x3cdiv class\x3d'annotationHTML overlay'\x3e\x3c/div\x3e"}),
f.addAnnotationType(m.ANNOTATION_ERROR),f.addAnnotationType(m.ANNOTATION_WARNING),f.addAnnotationType(m.ANNOTATION_TASK),f.addAnnotationType(m.ANNOTATION_BOOKMARK),f.addAnnotationType(m.ANNOTATION_DIFF_ADDED),f.addAnnotationType(m.ANNOTATION_DIFF_DELETED),f.addAnnotationType(m.ANNOTATION_DIFF_MODIFIED));this.setAnnotationRulerVisible(this._annotationRulerVisible||void 0===this._annotationRulerVisible,!0);if(f=this._overviewRuler=c.overviewRuler)f.addAnnotationType(m.ANNOTATION_CURRENT_SEARCH),f.addAnnotationType(m.ANNOTATION_MATCHING_SEARCH),
f.addAnnotationType(m.ANNOTATION_READ_OCCURRENCE),f.addAnnotationType(m.ANNOTATION_WRITE_OCCURRENCE),f.addAnnotationType(m.ANNOTATION_CURRENT_BLAME),f.addAnnotationType(m.ANNOTATION_ERROR),f.addAnnotationType(m.ANNOTATION_WARNING),f.addAnnotationType(m.ANNOTATION_TASK),f.addAnnotationType(m.ANNOTATION_BOOKMARK),f.addAnnotationType(m.ANNOTATION_MATCHING_BRACKET),f.addAnnotationType(m.ANNOTATION_CURRENT_BRACKET),f.addAnnotationType(m.ANNOTATION_CURRENT_LINE),f.addAnnotationType(m.ANNOTATION_DIFF_ADDED),
f.addAnnotationType(m.ANNOTATION_DIFF_DELETED),f.addAnnotationType(m.ANNOTATION_DIFF_MODIFIED);this.setOverviewRulerVisible(this._overviewRulerVisible||void 0===this._overviewRulerVisible,!0)}this._zoomRulerFactory&&(this._zoomRuler=this._zoomRulerFactory.createZoomRuler(this._annotationModel),this.setZoomRulerVisible(this._zoomRulerVisible,!0));this._lineNumberRulerFactory&&(this._lineNumberRuler=this._lineNumberRulerFactory.createLineNumberRuler(this._annotationModel),this._lineNumberRuler.addAnnotationType(m.ANNOTATION_CURRENT_BLAME),
this._lineNumberRuler.addAnnotationType(m.ANNOTATION_BLAME),this._lineNumberRuler.addAnnotationType(m.ANNOTATION_DIFF_ADDED),this._lineNumberRuler.addAnnotationType(m.ANNOTATION_DIFF_MODIFIED),this._lineNumberRuler.addAnnotationType(m.ANNOTATION_DIFF_DELETED),this._lineNumberRuler.onDblClick=n,this.setLineNumberRulerVisible(this._lineNumberRulerVisible||void 0===this._lineNumberRulerVisible,!0));this._foldingRulerFactory&&(this._foldingRuler=this._foldingRulerFactory.createFoldingRuler(this._annotationModel),
this._foldingRuler.addAnnotationType(m.ANNOTATION_FOLDING),this.setFoldingRulerVisible(this._foldingRulerVisible||void 0===this._foldingRulerVisible,!0));this.dispatchEvent({type:"TextViewInstalled",textView:d});b.prototype.install.call(this)}},uninstallTextView:function(){this.uninstall()},uninstall:function(){var g=this._textView;g&&(g.destroy(),this._annotationModel&&this._annotationModel.setTextModel(null),this._textView=this._undoStack=this._textDND=this._contentAssist=this._listener=this._annotationModel=
this._annotationStyler=this._annotationRuler=this._overviewRuler=this._zoomRuler=this._lineNumberRuler=this._foldingRuler=this._currentLineAnnotations=this._title=null,this._dirty=!1,this._foldingRulerVisible=this._overviewRulerVisible=this._zoomRulerVisible=this._lineNumberRulerVisible=this._annotationRulerVisible=void 0,this.dispatchEvent({type:"TextViewUninstalled",textView:g}),b.prototype.uninstall.call(this))},_updateCursorStatus:function(){for(var b=this.getKeyModes(),a=0;a<b.length;a++){var f=
b[a];if(f.isActive()&&f.isStatusActive&&f.isStatusActive())return}b=this.getModel();a=this.getSelections();1<a.length?b=d.formatMessage(l.multiSelections,a.length):(a=a[0].getCaret(),f=b.getLineAtOffset(a),b=b.getLineStart(f),b=d.formatMessage(l.lineColumn,f+1,a-b+1));this.reportStatus(b)},showAnnotations:function(b,a,d,e){var n=this._annotationModel;if(n){for(var c=[],f=[],t=n.getTextModel(),k=n.getAnnotations(),h;k.hasNext();)h=k.next(),-1!==a.indexOf(h.type)&&h.creatorID===this&&c.push(h);if(b)for(a=
0;a<b.length;a++)if(h=b[a]){if(d)h=d(h);else{var l;h.lineStart&&h.lineEnd?(k=t.getLineStart(h.lineStart),l=t.getLineCount()===h.lineEnd?t.getLineEnd(h.lineEnd-1):t.getLineStart(h.lineEnd)):"number"===typeof h.line?(l=t.getLineStart(h.line-1),k=l+h.start-1,l=l+h.end-1):(k=h.start,l=h.end);var z=e(h);if(!z)continue;h=m.createAnnotation(z,k,l,h.description)}h.id=b[a].id;b[a].data&&(h.data=b[a].data);h.creatorID=this;f.push(h)}n.replaceAnnotations(c,f)}},showProblems:function(b){this.showAnnotations(b,
[m.ANNOTATION_ERROR,m.ANNOTATION_WARNING,m.ANNOTATION_TASK],null,function(a){switch(a.severity){case "error":return m.ANNOTATION_ERROR;case "warning":return m.ANNOTATION_WARNING;case "task":return m.ANNOTATION_TASK}return null})},showOccurrences:function(b){this.showAnnotations(b,[m.ANNOTATION_READ_OCCURRENCE,m.ANNOTATION_WRITE_OCCURRENCE],null,function(a){return a.readAccess?m.ANNOTATION_READ_OCCURRENCE:m.ANNOTATION_WRITE_OCCURRENCE})},showBlame:function(b){var a=this._blameRGB,k=this.getTextView().getOptions("parent").ownerDocument;
if(!a){var e=d.createElement(k,"div");e.className="annotation blame";k.body.appendChild(e);var n=(k.defaultView||k.parentWindow).getComputedStyle(e).getPropertyValue("background-color");e.parentNode.removeChild(e);var e=n.indexOf("("),c=n.indexOf(")"),n=n.substring(e+1,c);this._blameRGB=a=n.split(",").slice(0,3)}var u=function(){var a=h.AnnotationType.createAnnotation(this.groupType,this.start,this.end,this.title);a.style=f.mixin({},a.style);a.style.style=f.mixin({},a.style.style);a.style.style.backgroundColor=
"";this.groupAnnotation=a;a.blame=this.blame;a.html=this.html;a.creatorID=this.creatorID;return a},t=function(){var a=d.createElement(k,"div");a.className="tooltipTitle";var c=this.blame.Message.indexOf("\n");-1===c&&(c=this.blame.Message.length);var e=d.createElement(k,"a");e.href=this.blame.CommitLink;e.appendChild(k.createTextNode(this.blame.Message.substring(0,c)));a.appendChild(e);a.appendChild(d.createElement(k,"br"));a.appendChild(k.createTextNode(d.formatMessage(l.committerOnTime,this.blame.AuthorName,
this.blame.Time)));return a},v=this.getModel();this.showAnnotations(b,[m.ANNOTATION_BLAME,m.ANNOTATION_CURRENT_BLAME],function(c){var e=v.getLineStart(c.Start-1),b=v.getLineEnd(c.End-1,!0),e=h.AnnotationType.createAnnotation(m.ANNOTATION_BLAME,e,b,t),b=a.slice(0);b.push(c.Shade);e.style=f.mixin({},e.style);e.style.style=f.mixin({},e.style.style);e.style.style.backgroundColor="rgba("+b.join()+")";e.groupId=c.Name;e.groupType=m.ANNOTATION_CURRENT_BLAME;e.createGroupAnnotation=u;e.html='\x3cimg class\x3d"annotationHTML blame" src\x3d"'+
c.AuthorImage+'"/\x3e';e.blame=c;return e})},showDiffAnnotations:function(b){this.showAnnotations(b,[m.ANNOTATION_DIFF_ADDED,m.ANNOTATION_DIFF_MODIFIED,m.ANNOTATION_DIFF_DELETED],null,function(a){return"added"===a.type?m.ANNOTATION_DIFF_ADDED:"modified"===a.type?m.ANNOTATION_DIFF_MODIFIED:m.ANNOTATION_DIFF_DELETED})},showSelection:function(b,a,d,e,n){return"number"===typeof b?("number"!==typeof a&&(a=b),this.moveSelection(b,a),!0):"number"===typeof d?(b=this.getModel().getLineStart(d-1),"number"===
typeof e&&(b+=e),"number"!==typeof n&&(n=0),this.moveSelection(b,b+n),!0):!1},_setModelText:function(b){this._textView&&(this._textView.setText(b),this._textView.getModel().setLineDelimiter("auto"),this._highlightCurrentLine(this._textView.getSelections()))},setInput:function(d,a,f,e,n){b.prototype.setInput.call(this,d,a,f,e);this._textView&&(!e&&!n)&&this._textView.focus()},onGotoLine:function(b,a,d,e){if(this._textView){var n=this.getModel();b=Math.max(0,Math.min(b,n.getLineCount()-1));var c=n.getLineStart(b),
f=0;void 0===d&&(d=0);"string"===typeof a?(b=n.getLine(b).indexOf(a),-1!==b&&(f=b,d=f+a.length)):(f=a,a=n.getLineEnd(b)-c,f=Math.min(f,a),d=Math.min(d,a));this.moveSelection(c+f,c+d,e)}}});return{BaseEditor:b,Editor:k}});y("orion/editor/find","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/regex orion/objects orion/util".split(" "),function(l,r,p,h,f,d,b){function k(a){var b=a.getTextView();p.KeyMode.call(this,b);this.editor=a;this._active=!1;
this._success=!0;this._ignoreSelection=!1;this._prefix="";b.setAction("incrementalFindCancel",function(){this.setActive(!1);return!0}.bind(this));b.setAction("incrementalFindBackspace",function(){return this._backspace()}.bind(this));var e=this;this._listener={onVerify:function(a){var c=e.editor,b=c.getModel(),d=c.mapOffset(a.start),c=c.mapOffset(a.end),b=b.getText(d,c);if((b=e._prefix.match(RegExp("^"+f.escape(b),"i")))&&0<b.length)e._prefix+=a.text,e._success=!0,e._status(),e.find(e._forward,!0),
a.text=null},onSelection:function(){e._ignoreSelection||e.setActive(!1)}}}function m(a,b,e){if(a){this._editor=a;this._undoStack=b;this._showAll=!0;this._visible=!1;this._wrap=this._caseInsensitive=!0;this._wholeWord=!1;this._incremental=!0;this._regex=!1;this._findAfterReplace=!0;this._reverse=this._hideAfterFind=!1;this._timer=this._end=this._start=void 0;this._lastString="";var d=this;this._listeners={onEditorFocus:function(a){d._removeCurrentAnnotation(a)}};this.setOptions(e)}}var g={};k.prototype=
new p.KeyMode;d.mixin(k.prototype,{createKeyBindings:function(){var a=r.KeyBinding,b=[];b.push({actionID:"incrementalFindBackspace",keyBinding:new a(8)});b.push({actionID:"incrementalFindCancel",keyBinding:new a(13)});b.push({actionID:"incrementalFindCancel",keyBinding:new a(27)});b.push({actionID:"incrementalFindReverse",keyBinding:new a(38)});b.push({actionID:"incrementalFind",keyBinding:new a(40)});b.push({actionID:"incrementalFindReverse",keyBinding:new a("k",!0,!0)});b.push({actionID:"incrementalFind",
keyBinding:new a("k",!0)});return b},find:function(a,b){this._forward=a;if(!this.isActive())return this.setActive(!0),!1;var e=this._prefix;if(0===e.length)return!1;var d=this.editor,c=d.getModel(),c=a?this._success?b?this._start:d.getCaretOffset()+1:0:this._success?b?this._start:d.getCaretOffset():c.getCharCount()-1;(e=d.getModel().find({string:e,start:c,reverse:!a,caseInsensitive:e.toLowerCase()===e}).next())?(b||(this._start=c),this._ignoreSelection=this._success=!0,d.moveSelection(a?e.start:e.end,
a?e.end:e.start),this._ignoreSelection=!1):this._success=!1;this._status();return!0},isActive:function(){return this._active},isStatusActive:function(){return this.isActive()},setActive:function(a){this._active!==a&&(this._active=a,this._prefix="",this._success=!0,a=this.editor.getTextView(),this._start=this.editor.getCaretOffset(),this.editor.setCaretOffset(this._start),this._active?(a.addEventListener("Verify",this._listener.onVerify),a.addEventListener("Selection",this._listener.onSelection),a.addKeyMode(this)):
(a.removeEventListener("Verify",this._listener.onVerify),a.removeEventListener("Selection",this._listener.onSelection),a.removeKeyMode(this)),this._status())},_backspace:function(){var a=this._prefix,a=this._prefix=a.substring(0,a.length-1);return 0===a.length?(this._ignoreSelection=this._success=!0,this.editor.setCaretOffset(this.editor.getSelection().start),this._ignoreSelection=!1,this._status(),!0):this.find(this._forward,!0)},_status:function(){if(this.isActive()){var a;a=this._forward?this._success?
l.incrementalFindStr:l.incrementalFindStrNotFound:this._success?l.incrementalFindReverseStr:l.incrementalFindReverseStrNotFound;a=b.formatMessage(a,this._prefix);this.editor.reportStatus(a,this._success?"":"error")}else this.editor.reportStatus("")}});g.IncrementalFind=k;m.prototype={find:function(a,b,e){this.setOptions({reverse:!a});var d=this.getFindString(),c;b&&(d=b.findString||d,c=b.count);a=this.getOptions();this.setOptions(b);b=e?this._startOffset:this.getStartOffset();if((c=this._doFind(d,
b,c))&&!e)this._startOffset=c.start;this.setOptions(a);this._hideAfterFind&&this.hide();return c},getStartOffset:function(){return void 0!==this._start?this._start:this._reverse?this._editor.getSelection().start-1:this._editor.getCaretOffset()},getFindString:function(){var a=this._editor.getSelection(),a=this._editor.getText(a.start,a.end);this._regex&&(a=f.escape(a));return a||this._lastString},getOptions:function(){return{showAll:this._showAll,caseInsensitive:this._caseInsensitive,wrap:this._wrap,
wholeWord:this._wholeWord,incremental:this._incremental,regex:this._regex,findAfterReplace:this._findAfterReplace,hideAfterFind:this._hideAfterFind,reverse:this._reverse,findCallback:this._findCallback,start:this._start,end:this._end}},getReplaceString:function(){return""},hide:function(){this._visible=!1;this._savedOptions&&(this.setOptions(this._savedOptions.pop()),0===this._savedOptions.length&&(this._savedOptions=null));this._removeAllAnnotations();var a=this._editor.getTextView();a&&(a.removeEventListener("Focus",
this._listeners.onEditorFocus),a.focus())},_processReplaceString:function(a){var b=a;if(this._regex){for(var b="",e=!1,d=this._editor.getModel().getLineDelimiter(),c=0;c<a.length;c++){var g=a.substring(c,c+1);if(e){switch(g){case "R":b+=d;break;case "r":b+="\r";break;case "n":b+="\n";break;case "t":b+="\t";break;case "\\":b+="\\";break;default:b+="\\"+g}e=!1}else"\\"===g?e=!0:b+=g}e&&(b+="\\")}return b},isVisible:function(){return this._visible},replace:function(){var a=this.getFindString();if(a){var b=
this._editor,e=this._processReplaceString(this.getReplaceString()),d=b.getSelection().start;if(b=b.getModel().find({string:a,start:d,reverse:!1,wrap:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive}).next())this.startUndo(),this._doReplace(b.start,b.end,a,e),this.endUndo()}this._findAfterReplace&&a&&this._doFind(a,this.getStartOffset())},replaceAll:function(){var a=this.getFindString();if(a){this._replacingAll=!0;var d=this._editor,e=d.getTextView();d.reportStatus(l.replacingAll);
var g=this._processReplaceString(this.getReplaceString()),c=this;window.setTimeout(function(){for(var f=0,t=0;;){var k=c._doFind(a,f,null,!0);if(!k)break;t++;1===t&&(e.setRedraw(!1),c.startUndo());c._doReplace(k.start,k.end,a,g);f=c.getStartOffset()}0<t&&(c.endUndo(),e.setRedraw(!0));0<f?d.reportStatus(b.formatMessage(l.replacedMatches,t)):d.reportStatus(l.nothingReplaced,"error");c._replacingAll=!1},100)}},setOptions:function(a){if(a){if((!0===a.showAll||!1===a.showAll)&&this._showAll!==a.showAll)if(this._showAll=
a.showAll,this.isVisible())if(this._showAll)this._markAllOccurrences();else{var b=this._editor.getAnnotationModel();b&&b.removeAnnotations(h.AnnotationType.ANNOTATION_MATCHING_SEARCH)}if(!0===a.caseInsensitive||!1===a.caseInsensitive)this._caseInsensitive=a.caseInsensitive;if(!0===a.wrap||!1===a.wrap)this._wrap=a.wrap;if(!0===a.wholeWord||!1===a.wholeWord)this._wholeWord=a.wholeWord;if(!0===a.incremental||!1===a.incremental)this._incremental=a.incremental;if(!0===a.regex||!1===a.regex)this._regex=
a.regex;if(!0===a.findAfterReplace||!1===a.findAfterReplace)this._findAfterReplace=a.findAfterReplace;if(!0===a.hideAfterFind||!1===a.hideAfterFind)this._hideAfterFind=a.hideAfterFind;if(!0===a.reverse||!1===a.reverse)this._reverse=a.reverse;a.hasOwnProperty("findCallback")&&(this._findCallback=a.findCallback);a.hasOwnProperty("start")&&(this._start=a.start);a.hasOwnProperty("end")&&(this._end=a.end)}},show:function(a){this._visible=!0;a&&(this._savedOptions||(this._savedOptions=[]),this._savedOptions.push(this.getOptions()),
this.setOptions(a));this._startOffset=this._editor.getSelection().start;this._editor.getTextView().addEventListener("Focus",this._listeners.onEditorFocus);var b=this;window.setTimeout(function(){b._incremental&&b.find(!0,null,!0)},0)},startUndo:function(){this._undoStack&&this._undoStack.startCompoundChange()},endUndo:function(){this._undoStack&&this._undoStack.endCompoundChange()},_find:function(a,b,e){return this._editor.getModel().find({string:a,start:b,end:this._end,reverse:this._reverse,wrap:e?
!1:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive})},_doFind:function(a,b,e,d){e=e||1;var c=this._editor;if(!a)return this._removeAllAnnotations(),null;this._lastString=a;var g,f;if(this._regex)try{f=this._find(a,b,d)}catch(k){c.reportStatus(k.message,"error");return}else f=this._find(a,b,d);for(a=0;a<e&&f.hasNext();a++)g=f.next();if(!this._replacingAll){g?this._editor.reportStatus(""):this._editor.reportStatus(l.notFound,"error");if(this.isVisible()){e=
h.AnnotationType.ANNOTATION_CURRENT_SEARCH;if(f=c.getAnnotationModel())f.removeAnnotations(e),g&&f.addAnnotation(h.AnnotationType.createAnnotation(e,g.start,g.end));if(this._showAll){this._timer&&window.clearTimeout(this._timer);var m=this;this._timer=window.setTimeout(function(){m._markAllOccurrences();m._timer=null},500)}}this._findCallback?this._findCallback(g):g&&c.moveSelection(g.start,g.end,null,!1)}return g},_doReplace:function(a,b,e,d){var c=this._editor;this._regex&&(d=c.getText(a,b).replace(RegExp(e,
this._caseInsensitive?"i":""),d));c.setText(d,a,b);c.setSelection(a,a+d.length,!0)},_markAllOccurrences:function(){var a=this._editor.getAnnotationModel();if(a){for(var b=h.AnnotationType.ANNOTATION_MATCHING_SEARCH,e=a.getAnnotations(),d=[],c;e.hasNext();){var g=e.next();g.type===b&&d.push(g)}if(this.isVisible()){e=this.getFindString();e=this._editor.getModel().find({string:e,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive});for(c=[];e.hasNext();)g=e.next(),c.push(h.AnnotationType.createAnnotation(b,
g.start,g.end))}a.replaceAnnotations(d,c)}},_removeAllAnnotations:function(){var a=this._editor.getAnnotationModel();a&&(a.removeAnnotations(h.AnnotationType.ANNOTATION_CURRENT_SEARCH),a.removeAnnotations(h.AnnotationType.ANNOTATION_MATCHING_SEARCH))},_removeCurrentAnnotation:function(a){(a=this._editor.getAnnotationModel())&&a.removeAnnotations(h.AnnotationType.ANNOTATION_CURRENT_SEARCH)}};g.Find=m;return g});y("orion/editor/findUI",["i18n!orion/editor/nls/messages","orion/editor/find","orion/objects",
"orion/editor/util","orion/util"],function(l,r,p,h,f){function d(b,d,f){r.Find.call(this,b,d,f)}d.prototype=new r.Find;p.mixin(d.prototype,{getFindString:function(){var b=this._findInput;return!b?r.Find.prototype.getFindString.call(this):b.value},getReplaceString:function(){var b=this._replaceInput;return!b?r.Find.prototype.getReplaceString(this):b.value},hide:function(){var b=this.isVisible();r.Find.prototype.hide.call(this);b&&(this._rootDiv.className="textViewFind")},show:function(b){r.Find.prototype.show.call(this,
b);var d=b.findString;b=b.replaceString;var f=this._findInput;f||(this._create(),f=this._findInput);d&&(f.value=d);b&&(this._replaceInput.value=b);var g=this;window.setTimeout(function(){g._rootDiv.className="textViewFind show";f.select();f.focus()},0)},_create:function(){var b=this,d=this._editor.getTextView(),m=d.getOptions("parent").ownerDocument,g=f.createElement(m,"div");g.className="textViewFind";h.addEventListener(g,"keydown",function(a){b._handleKeyDown(a)});this._rootDiv=g;this._createContents(m,
g);d._rootDiv.insertBefore(g,d._rootDiv.firstChild)},_createContents:function(b,d){var m=this,g=f.createElement(b,"input");g.className="textViewFindInput";this._findInput=g;g.type="text";g.placeholder=l.findWith;h.addEventListener(g,"input",function(a){return m._handleInput(a)});d.appendChild(g);g=f.createElement(b,"span");m._createButton(b,g,l.next,function(){m.find(!0)});m._createButton(b,g,l.previous,function(){m.find(!1)});d.appendChild(g);m._editor.getTextView().getOptions("readonly")||(g=f.createElement(b,
"input"),g.className="textViewReplaceInput",this._replaceInput=g,g.type="text",g.placeholder=l.replaceWith,d.appendChild(g),g=f.createElement(b,"span"),m._createButton(b,g,l.replace,function(){m.replace()}),m._createButton(b,g,l.replaceAll,function(){m.replaceAll()}),d.appendChild(g));g=f.createElement(b,"span");m._createButton(b,g,l.regex,function(a){m._toggle("regex",a.target)},this._regex,l.regexTooltip);m._createButton(b,g,l.caseInsensitive,function(a){m._toggle("caseInsensitive",a.target)},this._caseInsensitive,
l.caseInsensitiveTooltip);m._createButton(b,g,l.wholeWord,function(a){m._toggle("wholeWord",a.target)},this._wholeWord,l.wholeWordTooltip);d.appendChild(g);g=m._createButton(b,d,"",function(){m.hide()});g.className="textViewFindCloseButton";g.title=l.closeTooltip},_createButton:function(b,d,f,g,a,l){var e=b.createElement("button");this._checked(a,e);l&&(e.title=l);h.addEventListener(e,"click",function(a){g.call(this,a)},!1);f&&e.appendChild(b.createTextNode(f));d.appendChild(e);return e},_toggle:function(b,
d){var f={};f[b]=!this["_"+b];this.setOptions(f);this._checked(f[b],d)},_checked:function(b,d){d.className="textViewFindButton";b&&(d.className+=" checked")},_handleInput:function(){this._incremental&&this.find(!0,null,!0);return!0},_handleKeyDown:function(b){var d,h=(f.isMac?b.metaKey:b.ctrlKey)&&!b.altKey&&!b.shiftKey;h&&70===b.keyCode&&(d=!0);if((f.isMac?b.metaKey:b.ctrlKey)&&!b.altKey&&75===b.keyCode||13===b.keyCode)13===b.keyCode?this.find(this._reverse?b.shiftKey:!b.shiftKey):this.find(!b.shiftKey),
d=!0;h&&82===b.keyCode&&(this.replace(),d=!0);27===b.keyCode&&(this.hide(),d=!0);return d?(b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,!1):!0}});return{FindUI:d}});y("orion/editor/actions","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/annotations orion/editor/tooltip orion/editor/find orion/editor/findUI orion/util".split(" "),function(l,r,p,h,f,d,b){function k(a,b,c,d){function g(a,c,e){k.setText(a,c,e);f+=c-e+a.length}var f=0,k=a.editor,
h=k.getSelections();!d&&(b||1<h.length)&&a.startUndo();h.forEach(function(a){a.start+=f;a.end+=f;c(a,g)});k.setSelections(h);!d&&(b||1<h.length)&&a.endUndo()}function m(a,b,c){this.editor=a;this.undoStack=b;this._incrementalFind=new f.IncrementalFind(a);this._find=c?c:new d.FindUI(a,b);this._lastEditLocation=null;this.init()}function g(a,b,c,d){this.editor=a;this.undoStack=b;this.contentAssist=c;this.linkedMode=d;this.contentAssist&&this.contentAssist.addEventListener("ProposalApplied",this.contentAssistProposalApplied.bind(this));
this.init()}var a=p.AnnotationType,s={};m.prototype={init:function(){var a=this.editor.getTextView();this._lastEditListener={onModelChanged:function(a){this.editor.isDirty()&&(this._lastEditLocation=a.start+a.addedCharCount)}.bind(this)};a.addEventListener("ModelChanged",this._lastEditListener.onModelChanged);a.setAction("undo",function(a){if(this.undoStack){var c=1;a&&a.count&&(c=a.count);for(;0<c;)this.undoStack.undo(),--c;return!0}return!1}.bind(this),{name:l.undo});a.setAction("redo",function(a){if(this.undoStack){var c=
1;a&&a.count&&(c=a.count);for(;0<c;)this.undoStack.redo(),--c;return!0}return!1}.bind(this),{name:l.redo});a.setKeyBinding(new r.KeyBinding("f",!0),"find");a.setAction("find",function(){if(this._find){var a=this.editor.getSelection();this._find.show({findString:this.editor.getText(a.start,a.end)});return!0}return!1}.bind(this),{name:l.find});a.setKeyBinding(new r.KeyBinding("k",!0),"findNext");a.setAction("findNext",function(a){return this._find?(this._find.find(!0,a),!0):!1}.bind(this),{name:l.findNext});
a.setKeyBinding(new r.KeyBinding("k",!0,!0),"findPrevious");a.setAction("findPrevious",function(a){return this._find?(this._find.find(!1,a),!0):!1}.bind(this),{name:l.findPrevious});a.setKeyBinding(new r.KeyBinding("j",!0),"incrementalFind");a.setAction("incrementalFind",function(){this._incrementalFind&&this._incrementalFind.find(!0);return!0}.bind(this),{name:l.incrementalFind});a.setKeyBinding(new r.KeyBinding("j",!0,!0),"incrementalFindReverse");a.setAction("incrementalFindReverse",function(){this._incrementalFind&&
this._incrementalFind.find(!1);return!0}.bind(this),{name:l.incrementalFindReverse});a.setAction("tab",function(){return this.indentLines()}.bind(this));a.setAction("shiftTab",function(){return this.unindentLines()}.bind(this),{name:l.unindentLines});a.setKeyBinding(new r.KeyBinding(38,!1,!1,!0),"moveLinesUp");a.setAction("moveLinesUp",function(){return this.moveLinesUp()}.bind(this),{name:l.moveLinesUp});a.setKeyBinding(new r.KeyBinding(40,!1,!1,!0),"moveLinesDown");a.setAction("moveLinesDown",function(){return this.moveLinesDown()}.bind(this),
{name:l.moveLinesDown});a.setKeyBinding(new r.KeyBinding(38,!0,!1,!0),"copyLinesUp");a.setAction("copyLinesUp",function(){return this.copyLinesUp()}.bind(this),{name:l.copyLinesUp});a.setKeyBinding(new r.KeyBinding(40,!0,!1,!0),"copyLinesDown");a.setAction("copyLinesDown",function(){return this.copyLinesDown()}.bind(this),{name:l.copyLinesDown});a.setKeyBinding(new r.KeyBinding("d",!0,!1,!1),"deleteLines");a.setAction("deleteLines",function(a){return this.deleteLines(a)}.bind(this),{name:l.deleteLines});
a.setKeyBinding(new r.KeyBinding("l",!b.isMac,!1,!1,b.isMac),"gotoLine");a.setAction("gotoLine",function(){return this.gotoLine()}.bind(this),{name:l.gotoLine});a.setKeyBinding(new r.KeyBinding(190,!0),"nextAnnotation");a.setAction("nextAnnotation",function(){return this.nextAnnotation(!0)}.bind(this),{name:l.nextAnnotation});a.setKeyBinding(new r.KeyBinding(188,!0),"previousAnnotation");a.setAction("previousAnnotation",function(){return this.nextAnnotation(!1)}.bind(this),{name:l.prevAnnotation});
a.setKeyBinding(new r.KeyBinding("e",!0,!1,!0,!1),"expand");a.setAction("expand",function(){return this.expandAnnotation(!0)}.bind(this),{name:l.expand});a.setKeyBinding(new r.KeyBinding("c",!0,!1,!0,!1),"collapse");a.setAction("collapse",function(){return this.expandAnnotation(!1)}.bind(this),{name:l.collapse});a.setKeyBinding(new r.KeyBinding("e",!0,!0,!0,!1),"expandAll");a.setAction("expandAll",function(){return this.expandAnnotations(!0)}.bind(this),{name:l.expandAll});a.setKeyBinding(new r.KeyBinding("c",
!0,!0,!0,!1),"collapseAll");a.setAction("collapseAll",function(){return this.expandAnnotations(!1)}.bind(this),{name:l.collapseAll});a.setKeyBinding(new r.KeyBinding("q",!b.isMac,!1,!1,b.isMac),"lastEdit");a.setAction("lastEdit",function(){return this.gotoLastEdit()}.bind(this),{name:l.lastEdit})},copyLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();k(this,!1,function(a,e){var d=b.getLineAtOffset(a.start),g=b.getLineAtOffset(a.end>a.start?
a.end-1:a.end),f=b.getLineStart(d),d=b.getLineEnd(g,!0),k=b.getLineCount(),h="",f=b.getText(f,d);g===k-1&&(f=(h=b.getLineDelimiter())+f);e(f,d,d);a.start=d+h.length;a.end=d+f.length});return!0},copyLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();k(this,!1,function(a,e){var d=b.getLineAtOffset(a.start),g=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),d=b.getLineStart(d),f=b.getLineEnd(g,!0),k=b.getLineCount(),h="",f=b.getText(d,f);g===k-1&&
(f+=h=b.getLineDelimiter());e(f,d,d);a.start=d;a.end=d+f.length-h.length});return!0},deleteLines:function(a){var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;var c=1;a&&a.count&&(c=a.count);var d=b.getModel();k(this,!1,function(a,e){var b=d.getLineAtOffset(a.start),g=d.getLineStart(b),b=a.start!==a.end||1===c?d.getLineAtOffset(a.end>a.start?a.end-1:a.end):Math.min(b+c-1,d.getLineCount()-1),b=d.getLineEnd(b,!0);e("",g,b);a.start=a.end=g});return!0},expandAnnotation:function(a){var b=
this.editor,c=b.getAnnotationModel();if(!c)return!0;var d=b.getModel(),g=b.getCaretOffset(),f=d.getLineAtOffset(g),g=d.getLineStart(f),f=d.getLineEnd(f,!0);d.getBaseModel&&(g=d.mapOffset(g),f=d.mapOffset(f),d.getBaseModel());for(var k,c=c.getAnnotations(g,f);!k&&c.hasNext();)d=c.next(),d.type===p.AnnotationType.ANNOTATION_FOLDING&&(k=d);k&&a!==k.expanded&&(a?k.expand():(b.setCaretOffset(k.start),k.collapse()));return!0},expandAnnotations:function(a){var b=this.editor,c=b.getTextView(),b=b.getAnnotationModel();
if(!b)return!0;var d=b.getAnnotations();for(c.setRedraw(!1);d.hasNext();)b=d.next(),b.type===p.AnnotationType.ANNOTATION_FOLDING&&a!==b.expanded&&(a?b.expand():b.collapse());c.setRedraw(!0);return!0},indentLines:function(){var a=this.editor,b=a.getTextView();if(b.getOptions("readonly"))return!1;if(b.getOptions("tabMode")){var c=a.getModel(),d=0,g=a.getSelections();1<g.length&&this.startUndo();if(g.some(function(f){f.start+=d;f.end+=d;var k=c.getLineAtOffset(f.start),h=c.getLineAtOffset(f.end>f.start?
f.end-1:f.end);if(k!==h||1<g.length){var m=[];m.push("");for(var l=k;l<=h;l++)m.push(c.getLine(l,!0));var l=c.getLineStart(k),s=c.getLineEnd(h,!0),p=b.getOptions("tabSize","expandTab"),p=p.expandTab?Array(p.tabSize+1).join(" "):"\t",m=m.join(p);a.setText(m,l,s);var q=l===f.start?f.start:f.start+p.length,k=f.end+(h-k+1)*p.length;d+=l-s+m.length;f.start=q;f.end=k}else return!0;return!1}))return!1;a.setSelections(g);1<g.length&&this.endUndo();return!0}},gotoLastEdit:function(){"number"===typeof this._lastEditLocation&&
this.editor.showSelection(this._lastEditLocation);return!0},gotoLine:function(){var a=this.editor,b=a.getModel().getLineAtOffset(a.getCaretOffset());if(b=prompt(l.gotoLinePrompty,b+1))b=parseInt(b,10),a.onGotoLine(b-1,0);return!0},moveLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();k(this,!0,function(a,e){var d=b.getLineAtOffset(a.start),g=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),f=b.getLineCount();if(g!==f-1){var d=b.getLineStart(d),
k=b.getLineEnd(g,!0),h=b.getLineEnd(g+1,!0)-(k-d),m=0;g!==f-2?g=b.getText(d,k):(f=b.getLineEnd(g),g=b.getText(f,k)+b.getText(d,f),m+=k-f);e("",d,k);e(g,h,h);a.start=h+m;a.end=h+m+g.length}});return!0},moveLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();k(this,!0,function(a,e){var d=b.getLineAtOffset(a.start);if(0!==d){var g=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),f=b.getLineCount(),k=b.getLineStart(d-1),h=b.getLineStart(d),m=b.getLineEnd(g,
!0),l=b.getText(h,m),s=0;g===f-1&&(g=b.getLineEnd(d-1),d=b.getLineEnd(d-1,!0),l+=b.getText(g,d),h=g,s=d-g);e("",h,m);e(l,k,k);a.start=k;a.end=k+l.length-s}});return!0},nextAnnotation:function(b){function d(c){return!!c.lineStyle||c.type===a.ANNOTATION_MATCHING_BRACKET||c.type===a.ANNOTATION_CURRENT_BRACKET||!f.isAnnotationTypeVisible(c.type)}var c=this.editor,g=c.getAnnotationModel();if(!g)return!0;var f=c.getOverviewRuler()||c.getAnnotationStyler();if(!f)return!0;for(var k=c.getModel(),m=c.getCaretOffset(),
l=g.getAnnotations(b?m:0,b?k.getCharCount():m),s=null;l.hasNext();){var p=l.next();if(b){if(p.start<=m)continue}else if(p.start>=m)continue;if(!d(p)&&(s=p,b))break}if(s){for(var r=[s],l=g.getAnnotations(s.start,s.start);l.hasNext();)p=l.next(),p!==s&&!d(p)&&r.push(p);var C=c.getTextView(),q=k.getLineAtOffset(s.start),w=h.Tooltip.getTooltip(C);if(!w)return c.moveSelection(s.start),!0;c.moveSelection(s.start,s.start,function(){w.setTarget({getTooltipInfo:function(){var a=C.convert({x:C.getLocationAtOffset(s.start).x,
y:C.getLocationAtOffset(k.getLineStart(q)).y},"document","page");return{contents:r,x:a.x,y:a.y+Math.floor(1.33*C.getLineHeight(q))}}},0)})}return!0},unindentLines:function(){var a=this.editor,b=a.getTextView();if(b.getOptions("readonly"))return!1;if(b.getOptions("tabMode")){var c=a.getModel();k(this,!1,function(a,e){for(var d=c.getLineAtOffset(a.start),g=c.getLineAtOffset(a.end>a.start?a.end-1:a.end),f=b.getOptions("tabSize"),k=Array(f+1).join(" "),h=[],m=0,l=0,s=d;s<=g;s++){var p=c.getLine(s,!0);
if(c.getLineStart(s)!==c.getLineEnd(s))if(0===p.indexOf("\t"))p=p.substring(1),m++;else if(0===p.indexOf(k))p=p.substring(f),m+=f;else return!0;s===d&&(l=m);h.push(p)}d=c.getLineStart(d);f=c.getLineEnd(g,!0);g=c.getLineStart(g);h=h.join("");e(h,d,f);l=d===a.start?a.start:a.start-l;m=Math.max(l,a.end-m+(a.end===g+1&&a.start!==a.end?1:0));a.start=l;a.end=m});return!0}},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()}};
s.TextActions=m;g.prototype={init:function(){var a=this.editor.getTextView();a.setAction("lineStart",function(){return this.lineStart()}.bind(this));a.setAction("enter",function(){return this.autoIndent()}.bind(this));a.setKeyBinding(new r.KeyBinding("t",!0,!1,!0),"trimTrailingWhitespaces");a.setAction("trimTrailingWhitespaces",function(){return this.trimTrailingWhitespaces()}.bind(this),{name:l.trimTrailingWhitespaces});a.setKeyBinding(new r.KeyBinding(191,!0),"toggleLineComment");a.setAction("toggleLineComment",
function(){return this.toggleLineComment()}.bind(this),{name:l.toggleLineComment});a.setKeyBinding(new r.KeyBinding(191,!0,!b.isMac,!1,b.isMac),"addBlockComment");a.setAction("addBlockComment",function(){return this.addBlockComment()}.bind(this),{name:l.addBlockComment});a.setKeyBinding(new r.KeyBinding(220,!0,!b.isMac,!1,b.isMac),"removeBlockComment");a.setAction("removeBlockComment",function(){return this.removeBlockComment()}.bind(this),{name:l.removeBlockComment});a.setKeyBinding(new r.KeyBinding("[",
!1,!1,!1,!1,"keypress"),"autoPairSquareBracket");a.setAction("autoPairSquareBracket",function(){return this.autoPairBrackets("[","]")}.bind(this));a.setKeyBinding(new r.KeyBinding("]",!1,!1,!1,!1,"keypress"),"skipClosingSquareBracket");a.setAction("skipClosingSquareBracket",function(){return this.skipClosingBracket("]")}.bind(this));a.setKeyBinding(new r.KeyBinding("\x3c",!1,!1,!1,!1,"keypress"),"autoPairAngleBracket");a.setAction("autoPairAngleBracket",function(){return this.autoPairBrackets("\x3c",
"\x3e")}.bind(this));a.setKeyBinding(new r.KeyBinding("\x3e",!1,!1,!1,!1,"keypress"),"skipClosingAngleBracket");a.setAction("skipClosingAngleBracket",function(){return this.skipClosingBracket("\x3e")}.bind(this));a.setKeyBinding(new r.KeyBinding("(",!1,!1,!1,!1,"keypress"),"autoPairParentheses");a.setAction("autoPairParentheses",function(){return this.autoPairBrackets("(",")")}.bind(this));a.setKeyBinding(new r.KeyBinding(")",!1,!1,!1,!1,"keypress"),"skipClosingParenthesis");a.setAction("skipClosingParenthesis",
function(){return this.skipClosingBracket(")")}.bind(this));a.setKeyBinding(new r.KeyBinding("{",!1,!1,!1,!1,"keypress"),"autoPairBraces");a.setAction("autoPairBraces",function(){return this.autoPairBrackets("{","}")}.bind(this));a.setKeyBinding(new r.KeyBinding("}",!1,!1,!1,!1,"keypress"),"skipClosingBrace");a.setAction("skipClosingBrace",function(){return this.skipClosingBracket("}")}.bind(this));a.setKeyBinding(new r.KeyBinding("'",!1,!1,!1,!1,"keypress"),"autoPairSingleQuotation");a.setAction("autoPairSingleQuotation",
function(){return this.autoPairQuotations("'")}.bind(this));a.setKeyBinding(new r.KeyBinding('"',!1,!1,!1,!1,"keypress"),"autoPairDblQuotation");a.setAction("autoPairDblQuotation",function(){return this.autoPairQuotations('"')}.bind(this));a.setAction("deletePrevious",function(){return this.deletePrevious()}.bind(this))},autoIndent:function(){function a(c,b){if(c.start===c.end){for(var e=d.getLineAtOffset(c.start),n=d.getLine(e,!1),k=d.getLineStart(e),p=0,r=c.start-k,y;p<r&&(32===(y=n.charCodeAt(p))||
9===y);)p++;var k=n.substring(0,p),G=n.substring(0,r),I=n.substring(r),H;if(s.smartIndentation&&123===n.charCodeAt(H=G.trimRight().length-1))return e=r-H-1,I=I.length-I.trimLeft().length,n=125===n.charCodeAt(r+I)?f+k+g+f+k:f+k+g,b(n,c.start-e,c.end+I),c.start=c.end=c.start+f.length+k.length+g.length-e,!0;if(s.autoCompleteComments&&!l.test(G)&&(h.test(G)||m.test(G))){if(p=h.exec(G)){n=f+k+" * ";n=l.test(I)?n+I.substring(0,I.length-2).trim():n+I.trim();if(d.getLineCount()===e+1||!m.test(d.getLine(e+
1)))n+=f+k+" */";b(n,c.start,c.end+I.length);c.start=c.end=c.start+f.length+k.length+3;return!0}if(p=m.exec(G))for(e-=1;0<=e;e--){p=d.getLine(e,!1);if(h.test(p))return l.test(I)||47===n.charCodeAt(r)?(n=f+k+"*"+I,k=c.start+f.length+k.length+1):(n=f+k+"* "+I,k=c.start+f.length+k.length+2),b(n,c.start,c.end+I.length),c.start=c.end=k,!0;if(!m.test(p))break}}else{if(l.test(G)&&32===k.charCodeAt(k.length-1))return n=f+k.substring(0,k.length-1),b(n,c.start,c.end),c.start=c.end=c.start+n.length,!0;if(0<
p){for(p=r;p<n.length&&(32===(y=n.charCodeAt(p++))||9===y);)c.end++;n=d.getLineDelimiter()+k;b(n,c.start,c.end);c.start=c.end=c.start+n.length;return!0}}}return!1}var b=this.editor,c=b.getTextView();if(c.getOptions("readonly")||c.getOptions("singleMode"))return!1;var d=b.getModel(),b=c.getOptions("tabSize","expandTab"),g=b.expandTab?Array(b.tabSize+1).join(" "):"\t",f=d.getLineDelimiter(),h=/^[\s]*\/\*[\*]*[\s]*$/,m=/^[\s]*\*/,l=/\*\/[\s]*$/,s=this;k(this,!0,function(c,b){a(c,b)||(b(f,c.start,c.end),
c.start=c.end=c.start+f.length)});return!0},addBlockComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel(),c=/\/\*|\*\//g,d=this;k(this,!1,function(a,e){var g=d._findEnclosingComment(b,a.start,a.end);if(!(void 0!==g.commentStart&&void 0!==g.commentEnd)&&(g=b.getText(a.start,a.end),0!==g.length)){var f=g.length,g=g.replace(c,""),k=g.length;e("/*"+g+"*/",a.start,a.end);a.start+=2;a.end+=2+(k-f)}});return!0},autoPairBrackets:function(a,b){if("["===
a&&!this.autoPairSquareBrackets||"{"===a&&!this.autoPairBraces||"("===a&&!this.autoPairParentheses||"\x3c"===a&&!this.autoPairAngleBrackets)return!1;var c=this.editor;if(c.getTextView().getOptions("readonly"))return!1;var d=/^$|[)}\]>]/,g=c.getModel();k(this,!1,function(c,f){var k=c.start===g.getCharCount()?"":g.getText(c.start,c.start+1).trim();c.start===c.end&&d.test(k)?(k=a+b,f(k,c.start,c.start),c.start=c.end=c.start+1):c.start!==c.end?(k=a+g.getText(c.start,c.end)+b,f(k,c.start,c.end),c.start+=
1,c.end+=1):(f(a,c.start,c.end),c.start=c.end=c.start+a.length)});return!0},autoPairQuotations:function(a){if(!this.autoPairQuotation)return!1;var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;var c=/^"$|^'$/,d=/\w/,g=/^$|[)}\]>]/,f=b.getModel();k(this,!1,function(b,n){function k(){n(a,b.start,b.end);b.start=b.end=b.start+a.length}var h=0===b.start?"":f.getText(b.start-1,b.start).trim(),m=b.start===f.getCharCount()?"":f.getText(b.start,b.start+1).trim();b.start!==b.end?(h=f.getText(b.start,
b.end),c.test(h)?k():(n(a+h+a,b.start,b.end),b.start+=1,b.end+=1)):m===a?b.start=b.end=b.start+1:h===a||c.test(m)||d.test(h)||!g.test(m)?k():(n(a+a,b.start,b.end),b.start=b.end=b.start+a.length)});return!0},contentAssistProposalApplied:function(a){function b(){return"number"===typeof c.escapePosition?c.escapePosition:a.data.start+c.proposal.length}var c=a.data.proposal;if(c.positions&&0<c.positions.length&&this.linkedMode){for(var d=[],g=0;g<c.positions.length;++g)d[g]={positions:[{offset:c.positions[g].offset,
length:c.positions[g].length}]};this.linkedMode.enterLinkedMode({groups:d,escapePosition:b()})}else c.groups&&0<c.groups.length&&this.linkedMode?this.linkedMode.enterLinkedMode({groups:c.groups,escapePosition:b()}):"number"===typeof c.escapePosition&&this.editor.getTextView().setCaretOffset(c.escapePosition);return!0},deletePrevious:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();k(this,!1,function(a,e){if(a.start===a.end){var d=0===a.start?"":b.getText(a.start-
1,a.start),g=a.start===b.getCharCount()?"":b.getText(a.start,a.start+1);("("===d&&")"===g||"["===d&&"]"===g||"{"===d&&"}"===g||"\x3c"===d&&"\x3e"===g||'"'===d&&'"'===g||"'"===d&&"'"===g)&&e("",a.start,a.start+1)}},!0);return!1},_findEnclosingComment:function(a,b,c){var d=a.getLineAtOffset(b),g=a.getLineAtOffset(c),f,k,h,m,l,s;for(f=d;0<=f&&!(k=a.getLine(f),h=f===d?b-a.getLineStart(d):k.length,m=k.lastIndexOf("/*",h),k=k.lastIndexOf("*/",h),k>m);f--)if(-1!==m){l=a.getLineStart(f)+m;break}for(f=g;f<
a.getLineCount()&&!(k=a.getLine(f),h=f===g?c-a.getLineStart(g):0,m=k.indexOf("/*",h),k=k.indexOf("*/",h),-1!==m&&m<k);f++)if(-1!==k){s=a.getLineStart(f)+k;break}return{commentStart:l,commentEnd:s}},lineStart:function(){var a=this.editor.getModel();k(this,!1,function(b){var c=b.getCaret(),d=a.getLineAtOffset(c),g=a.getLineStart(d),d=a.getLine(d),f;for(f=0;f<d.length;f++){var k=d.charCodeAt(f);if(!(32===k||9===k))break}f+=g;c!==f?b.setCaret(f):b.setCaret(g)});return!0},removeBlockComment:function(){var a=
this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel(),c=this;k(this,!1,function(a,e){var d=b.getText(a.start,a.end),g,f,k;for(k=0;k<d.length;k++)if("/*"===d.substring(k,k+2)){g=a.start+k;break}for(;k<d.length;k++)if("*/"===d.substring(k,k+2)){f=a.start+k;break}void 0!==g&&void 0!==f?(d=b.getText(g+2,f),e(d,g,f+2),a.start=g,a.end=f):(g=c._findEnclosingComment(b,a.start,a.end),void 0===g.commentStart||void 0===g.commentEnd||(d=b.getText(g.commentStart+2,g.commentEnd),e(d,
g.commentStart,g.commentEnd+2),a.start-=2,a.end-=2))});return!0},toggleLineComment:function(){var a=this.editor,b=a.getTextView();if(b.getOptions("readonly"))return!1;var c=this.lineComment||"//",d=a.getModel();b.setRedraw(!1);k(this,!0,function(a,b){for(var e=d.getLineAtOffset(a.start),g=d.getLineAtOffset(a.end>a.start?a.end-1:a.end),f=!0,n=[],k,h=e;h<=g;h++){var m=d.getLine(h,!0);k=m.indexOf(c);n.push(k);if(!f||-1===k)f=!1;else if(0!==k){for(f=0;f<k;f++){var l=m.charCodeAt(f);if(!(32===l||9===l))break}f=
f===k}}h=c.length;m=d.getLineStart(e);if(f){for(f=n.length-1;0<=f;f--)k=n[f]+d.getLineStart(e+f),b("",k,k+h);k=d.getLineStart(g);n=m===a.start?a.start:a.start-h;e=a.end-h*(g-e+1)+(a.end===k+1?h:0)}else{for(f=n.length-1;0<=f;f--)k=d.getLineStart(e+f),b(c,k,k);n=m===a.start?a.start:a.start+h;e=a.end+h*(g-e+1)}a.start=n;a.end=e});b.setRedraw(!0);return!0},trimTrailingWhitespaces:function(){var a=this.editor,b=a.getModel(),c=a.getSelections();a.getTextView().setRedraw(!1);this.startUndo();for(var d=/(\s+$)/,
g=b.getLineCount(),f=0;f<g;f++){var k=b.getLine(f);if(k=d.exec(k)){var h=b.getLineStart(f),m=k[0].length,l=h+k.index;b.setText("",l,l+m);c.forEach(function(a){a.start>l&&(a.start=Math.max(l,a.start-m));a.start!==a.end&&a.end>l&&(a.end=Math.max(l,a.end-m))})}}this.endUndo();a.setSelections(c,!1);a.getTextView().setRedraw(!0)},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},skipClosingBracket:function(a){var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;
var c=b.getModel(),d=b.getSelections();return 1===d.length&&d[0].start===d[0].end&&(d[0].start===c.getCharCount()?"":c.getText(d[0].start,d[0].start+1))===a?(d[0].start=d[0].end=d[0].start+1,b.setSelections(d),!0):!1},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},setAutoPairParentheses:function(a){this.autoPairParentheses=a},setAutoPairBraces:function(a){this.autoPairBraces=a},setAutoPairSquareBrackets:function(a){this.autoPairSquareBrackets=a},setAutoPairAngleBrackets:function(a){this.autoPairAngleBrackets=
a},setAutoPairQuotations:function(a){this.autoPairQuotation=a},setAutoCompleteComments:function(a){this.autoCompleteComments=a},setLineComment:function(a){this.lineComment=a},setSmartIndentation:function(a){this.smartIndentation=a}};s.SourceCodeActions=g;String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")});String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")});return s});y("orion/editor/rulers","i18n!orion/editor/nls/messages orion/editor/textView orion/editor/annotations orion/editor/tooltip orion/objects orion/editor/util orion/util".split(" "),
function(l,r,p,h,f,d,b){function k(a,c,b){this._location=a||"left";this._overview=c||"page";this._rulerStyle=b;this._view=null}function m(a,c,b,e){k.call(this,c,b,e);var d=this;this._listener={onTextModelChanged:function(a){d._onTextModelChanged(a)},onAnnotationModelChanged:function(a){d._onAnnotationModelChanged(a)}};this.setAnnotationModel(a)}function g(a,c,b,e,d){m.call(this,a,c,"page",b);this._oddStyle=e||{style:{backgroundColor:"white"}};this._evenStyle=d||{style:{backgroundColor:"white"}};this._numOfDigits=
0;this._firstLine=1}function a(a,c,b){m.call(this,a,c,"page",b)}function s(a,c,b){m.call(this,a,c,"document",b)}function e(b,c,e){a.call(this,b,c,e)}k.prototype={getLocation:function(){return this._location},getOverview:function(){return this._overview},getRulerStyle:function(){return this._rulerStyle},getView:function(){return this._view},setView:function(a){this._onTextModelChanged&&this._view&&this._view.removeEventListener("ModelChanged",this._listener.onTextModelChanged);this._view=a;this._onTextModelChanged&&
this._view&&this._view.addEventListener("ModelChanged",this._listener.onTextModelChanged)}};m.prototype=f.mixin(new k,{getAnnotations:function(a,c){var b=this._annotationModel;if(!b)return[];var e=this._view.getModel(),d=e.getLineStart(a),g=e.getLineEnd(c-1),f=e;e.getBaseModel&&(f=e.getBaseModel(),d=e.mapOffset(d),g=e.mapOffset(g));for(var k=[],b=this.getAnnotationsByType(b,d,g),d=0;d<b.length;d++)for(var g=b[d],h=f.getLineAtOffset(g.start),m=f.getLineAtOffset(Math.max(g.start,g.end-1)),l=h;l<=m;l++){var s=
l;if(e!==f){s=f.getLineStart(l);s=e.mapOffset(s,!0);if(-1===s)continue;s=e.getLineAtOffset(s)}if(a<=s&&s<c){var p=this._mergeAnnotation(k[s],g,l-h,m-h+1);p&&(k[s]=p)}}if(!this._multiAnnotation&&this._multiAnnotationOverlay)for(var r in k)k[r]._multiple&&(k[r].html+=this._multiAnnotationOverlay.html);return k},getAnnotationModel:function(){return this._annotationModel},getWidestAnnotation:function(){return null},setAnnotationModel:function(a){this._annotationModel&&this._annotationModel.removEventListener("Changed",
this._listener.onAnnotationModelChanged);(this._annotationModel=a)&&this._annotationModel.addEventListener("Changed",this._listener.onAnnotationModelChanged)},setMultiAnnotation:function(a){this._multiAnnotation=a},setMultiAnnotationOverlay:function(a){this._multiAnnotationOverlay=a},onClick:function(a,c){if(void 0!==a){var b=this._view,e=b.getModel(),d=e.getLineStart(a),g=e.getLineEnd(a,!0),f=b.getSelection().start,b=b.getSelection().end,k=this._annotationModel,m,l,s;if(k){e.getBaseModel&&(d=e.mapOffset(d),
g=e.mapOffset(g),f=e.mapOffset(f),b=e.mapOffset(b));var q=this;l=(m=this._findNextAnnotation(k,d,g,f,b,function(a){return q.isAnnotationTypeVisible(a)}))?m.start:d;s=m?m.end:d;e.getBaseModel&&(l=e.mapOffset(l,!0),s=e.mapOffset(s,!0));m&&void 0!==m.groupId&&(this._currentClickGroup=this._currentClickGroup===m.groupId?null:m.groupId,this._setCurrentGroup(a))}this._view.setSelection(s,l,1/3,function(){});(e=h.Tooltip.getTooltip(this._view))&&(m&&"left"===this.getLocation()?e.show({getTooltipInfo:function(){return q._getTooltipInfo([m])}},
!1,!1):e.hide())}},onDblClick:function(a,c){},onMouseMove:function(a,c){var b=h.Tooltip.getTooltip(this._view);if(b&&!(b.isVisible()&&this._tooltipLineIndex===a)&&(this._tooltipLineIndex=a,!(c.clientX===this._lastMouseX&&c.clientY===this._lastMouseY))){this._lastMouseX=c.clientX;this._lastMouseY=c.clientY;this._hoverTimeout&&(window.clearTimeout(this._hoverTimeout),this._hoverTimeout=null);var e=c.target?c.target:c.srcElement;this._curElementBounds=e.getBoundingClientRect();e._ruler&&(this._curElementBounds.top=
c.clientY,this._curElementBounds.height=1);var d=this;d._hoverTimeout=window.setTimeout(function(){d._hoverTimeout=null;b.onHover({getTooltipInfo:function(){var a=d._getAnnotationsAtLineIndex(d._tooltipLineIndex),a=d._getTooltipContents(d._tooltipLineIndex,a);return d._getTooltipInfo(a,c.clientY,{source:"ruler",rulerLocation:d.getLocation()})}},c.clientX,c.clientY)},175)}},onMouseOver:function(a,c){this.onMouseMove(a,c);this._currentClickGroup||this._setCurrentGroup(a)},onMouseOut:function(a,c){this._currentClickGroup||
this._setCurrentGroup(-1);this._hoverTimeout&&(window.clearTimeout(this._hoverTimeout),this._hoverTimeout=null)},_findNextAnnotation:function(a,c,b,e,d,g){var f=null,k,h=c;if(0<=e&&0<=d&&e>=c&&e<b)for(var h=e,m=a.getAnnotations(e,d);!k&&m.hasNext();)if(c=m.next(),!g||g(c.type))c.start===e&&c.end===d&&(k=c);a=a.getAnnotations(h,b);for(var l;a.hasNext();)if(c=a.next(),!g||g(c.type)){f||(f=c);if(!k){f=c;break}if(l&&(k.start!==c.start||k.end!==c.end)){l=!1;f=c;break}k&&k===c&&(l=!0)}l&&(f=null);return f},
_getAnnotationsAtLineIndex:function(a){if(void 0!==a){var c=this._view.getModel(),b=this._annotationModel,e=[];b&&(e=c.getLineStart(a),a=c.getLineEnd(a),c.getBaseModel&&(e=c.mapOffset(e),a=c.mapOffset(a)),e=this.getAnnotationsByType(b,e,a));return e}},_getTooltipInfo:function(a,c,b){if(!a)return null;var e=Object.create(null);e.top=this._curElementBounds.top;e.left=this._curElementBounds.left;e.height=this._curElementBounds.height;e.width=this._curElementBounds.width;"string"===typeof a&&c&&(e.top=
c,e.height=1);var d=this.getLocation();c=this.getRulerStyle();var d="left"===d?"right":"left",g=0,f=0,g=this._view._clientDiv.getBoundingClientRect().left-(e.left+e.width),f=e.height;"left"===d&&(g=-25,1===e.height&&(g+=2));0<=c.styleClass.indexOf("folding")&&(f-=14);return{contents:a,position:d,tooltipOffsetX:g,tooltipOffsetY:f,anchorArea:e,context:b}},_getTooltipContents:function(a,c){return c},_getOnClickTooltipInfo:function(a){var c=this._view,b=Object.create(null);b.top=this._curElementBounds.top;
b.left=this._curElementBounds.left;b.height=this._curElementBounds.height;b.width=this._curElementBounds.width;var e="left"===this.getLocation()?"right":"left";a={contents:[a],position:e,anchorArea:b};c=c._clientDiv.getBoundingClientRect();a.offsetX=c.left-(b.left+b.width);a.offsetY=b.height;"left"===a.position&&(a.offsetX=20);return a},_onAnnotationModelChanged:function(a){function c(a){for(var c=0;c<a.length;c++)if(d.isAnnotationTypeVisible(a[c].type)){f=a[c].start;var g=a[c].end;e.getBaseModel&&
(f=e.mapOffset(f,!0),g=e.mapOffset(g,!0));-1!==f&&-1!==g&&b.redrawLines(e.getLineAtOffset(f),e.getLineAtOffset(Math.max(f,g-1))+1,d)}}var b=this._view;if(b){var e=b.getModel(),d=this,g=e.getLineCount();if(a.textModelChangedEvent){var f=a.textModelChangedEvent.start;e.getBaseModel&&(f=e.mapOffset(f,!0));a=e.getLineAtOffset(f);b.redrawLines(a,g,d)}else c(a.added),c(a.removed),c(a.changed)}},_mergeAnnotation:function(a,c,b,e){a||(a={});0===b&&(a.html&&c.html?(c.html!==a.html&&(!a._multiple&&this._multiAnnotation)&&
(a.html=this._multiAnnotation.html),a._multiple=!0):a.html=c.html);a.style=this._mergeStyle(a.style,c.style);return a},_mergeStyle:function(a,c){if(c){a||(a={});a.styleClass=a.styleClass&&c.styleClass&&a.styleClass!==c.styleClass?a.styleClass+(" "+c.styleClass):c.styleClass;var b;if(c.style)for(b in a.style||(a.style={}),c.style)void 0===a.style[b]&&(a.style[b]=c.style[b]);if(c.attributes)for(b in a.attributes||(a.attributes={}),c.attributes)void 0===a.attributes[b]&&(a.attributes[b]=c.attributes[b])}return a},
_setCurrentGroup:function(a){var c=this._annotationModel,b=null,e=c.getTextModel(),d,g=this._currentGroupAnnotation;if(-1!==a){var f=e.getLineStart(a),k=e.getLineEnd(a);e.getBaseModel&&(f=e.mapOffset(f),k=e.mapOffset(k));for(d=c.getAnnotations(f,k);d.hasNext();)if(e=d.next(),this.isAnnotationTypeVisible(e.type)&&e.start<=f&&e.end>=k&&void 0!==e.groupId){b=e;break}if(g&&b&&g.groupId===b.groupId)return}this._currentGroupAnnotation=null;g&&c.removeAnnotations(g.groupType);if(b&&-1!==a){this._currentGroupAnnotation=
b;d=c.getAnnotations();for(a=[];d.hasNext();)e=d.next(),delete e.groupAnnotation,e.groupId===b.groupId&&(e=e.createGroupAnnotation(),a.push(e));c.replaceAnnotations(null,a)}}});p.AnnotationTypeList.addMixin(m.prototype);g.prototype=new m;g.prototype.getAnnotations=function(a,c){for(var b=m.prototype.getAnnotations.call(this,a,c),e=this._view.getModel(),d=a;d<c;d++){var g=d-this._firstLine&1?this._oddStyle:this._evenStyle,f=d;e.getBaseModel&&(f=e.getLineStart(f),f=e.getBaseModel().getLineAtOffset(e.mapOffset(f)));
b[d]||(b[d]={});b[d].html=this._firstLine+f+"";b[d].style||(b[d].style=g)}return b};g.prototype.getWidestAnnotation=function(){var a=this._view.getModel().getLineCount();return this.getAnnotations(a-1,a)[a-1]};g.prototype.setFirstLine=function(a){this._firstLine=void 0!==a?a:1};g.prototype._onTextModelChanged=function(a){var c=a.start;a=this._view.getModel();var b=a.getBaseModel?a.getBaseModel().getLineCount():a.getLineCount(),b=(this._firstLine+b-1+"").length;this._numOfDigits!==b&&(this._numOfDigits=
b,c=a.getLineAtOffset(c),this._view.redrawLines(c,a.getLineCount(),this))};a.prototype=new m;s.prototype=new m;s.prototype.getRulerStyle=function(){var a={style:{lineHeight:"1px",fontSize:"1px"}};return a=this._mergeStyle(a,this._rulerStyle)};s.prototype._getTooltipContents=function(a,c){if(c&&0===c.length){var e=this._view.getModel(),d=a;e.getBaseModel&&(d=e.getLineStart(d),d=e.getBaseModel().getLineAtOffset(e.mapOffset(d)));return b.formatMessage(l.line,d+1)}return m.prototype._getTooltipContents.call(this,
a,c)};s.prototype._mergeAnnotation=function(a,c,b,e){if(0===b)return a||(a={html:"\x26nbsp;",style:{style:{height:3*e+"px"}}},a.style=this._mergeStyle(a.style,c.overviewStyle)),a};e.prototype=new a;e.prototype.onClick=function(a,c){if(void 0!==a){var b=this._annotationModel;if(b){var e=this._view.getModel(),d=e.getLineStart(a),g=e.getLineEnd(a,!0);e.getBaseModel&&(d=e.mapOffset(d),g=e.mapOffset(g),e=e.getBaseModel());for(var f,b=b.getAnnotations(d,g);!f&&b.hasNext();)g=b.next(),this.isAnnotationTypeVisible(g.type)&&
e.getLineAtOffset(g.start)===e.getLineAtOffset(d)&&(f=g);f&&((e=h.Tooltip.getTooltip(this._view))&&e.hide(),f.expanded?f.collapse():f.expand())}}};e.prototype._getTooltipContents=function(b,c){if(c&&0<c.length){var e=this._view.getModel(),d=e.getLineStart(b);e.getBaseModel&&(d=e.mapOffset(d),e=e.getBaseModel());for(var d=e.getLineAtOffset(d),g=0;g<c.length;g++){var f=c[g];if(this.isAnnotationTypeVisible(f.type)&&e.getLineAtOffset(f.start)===d){if(c[g].expanded)break;return a.prototype._getTooltipContents.call(this,
b,[f])}}}return null};e.prototype._onAnnotationModelChanged=function(b){function c(a){for(f=0;f<a.length;f++)if(g.isAnnotationTypeVisible(a[f].type)){var c=a[f].start;d.getBaseModel&&(c=d.mapOffset(c,!0));-1!==c&&(h=Math.min(h,d.getLineAtOffset(c)))}}if(b.textModelChangedEvent)a.prototype._onAnnotationModelChanged.call(this,b);else{var e=this._view;if(e){var d=e.getModel(),g=this,f,k=d.getLineCount(),h=k;c(b.added);c(b.removed);c(b.changed);b=e.getRulers();for(f=0;f<b.length;f++)e.redrawLines(h,k,
b[f])}}};p=function(a,c){k.call(this,a,"fixed",c)};p.prototype=f.mixin(new k,{setView:function(a){this._destroy();k.prototype.setView.call(this,a);this._create()},_create:function(){function a(c){var b=c.themeClass;b?((b=b.replace("textviewZoom",""))&&(b=" "+b),b="textviewZoom"+b):b="textviewZoom";c.themeClass=b;c.noScroll=!0;c.readonly=!0;return c}function c(){var a=h._metrics.viewPadding,c=h._metrics.viewPadding,b=h.getLineHeight(),e=l.getLineHeight(),d=h.getModel().getLineCount(),b=h._lineHeight?
h._scrollHeight:d*b,e=l._lineHeight?l._scrollHeight:d*e,d=e/b,g=h.getClientArea().height+a.top+a.bottom,c=l.getClientArea().height+c.top+c.bottom;return{zoomFactor:d,documentHeight:b,zoomDocumentHeight:e,clientHeight:g,zoomClientHeight:c,scrollWidth:h._metrics.scrollWidth,windowHeight:g*d,padding:a}}function e(a){a=a||{y:h.getTopPixel()};var b=c();l.setTopPixel(a.y*(b.zoomFactor+(b.windowHeight-b.clientHeight-b.scrollWidth)/b.documentHeight));a=a.y*b.zoomFactor;b=b.clientHeight*b.zoomFactor;w.top=
a;w.bottom=a+b;a=l.convert({y:a},"document","page").y;a-=w.node.getBoundingClientRect().top;p.style.top=a+"px";p.style.height=b-q+"px"}function g(a){a.wrapMode&&!a.wrapOffset&&h._metrics.charWidth?(a=b.createElement(s,"div"),a.style.position="fixed",a.style.left="-1000px",l._clientDiv.appendChild(a),a.innerHTML=Array(Math.ceil(h.getClientArea().width/h._metrics.charWidth)+1).join("a"),a=a.getBoundingClientRect(),a=Math.min(150,Math.ceil(a.right-a.left))+"px"):a="";var c=w.node.style.width;w.node.style.width=
a;return c!==a}function f(a,c,b){b||w.top<=a.y&&a.y<=w.bottom?(w.mouseDown=!0,w.delta=c-p.getBoundingClientRect().top+w.node.getBoundingClientRect().top):(a=l.getOffsetAtLocation(a.x,a.y),h.setSelection(a,a,0.5,function(){}))}function k(a){if(w.mouseDown){var b=c();a=Math.min(b.zoomClientHeight-b.windowHeight,Math.max(0,a-w.delta));h.setTopPixel(a*(b.documentHeight-b.clientHeight)/Math.min(b.zoomDocumentHeight,b.zoomClientHeight-b.windowHeight))}}var h=this.getView();if(h){var m=a(h.getOptions());
m.parent=this.node;var l=this._zoomView=new r.TextView(m);l._clientDiv.contentEditable=!1;l.setModel(h.getModel());var s=h.getOptions("parent").ownerDocument,p=this._windowDiv=b.createElement(s,"div");p.className="rulerZoomWindow";this.node.appendChild(p);var q=parseInt(d.getNodeStyle(p,"border-top-width",0))+parseInt(d.getNodeStyle(p,"border-bottom-width",0)),w=this;h.addEventListener("Scroll",this._scrollListener=function(a){e(a.newValue)});h.addEventListener("Resize",this._resizeListener=function(){g(l.getOptions());
e()});h.addEventListener("Redraw",this._redrawListener=function(a){a.ruler||l.redrawLines(a.startLine,a.endLine)});h.addEventListener("Options",this._optionsListener=function(c){c=a(c.options);l.setOptions(c);g(l.getOptions())});l.addEventListener("LineStyle",this._lineListener=function(a){h.onLineStyle(a)});b.isIOS||b.isAndroid?(p.addEventListener("touchstart",function(a){1===a.touches.length&&(f(a,a.touches[0].clientY,!0),a.preventDefault())}),p.addEventListener("touchend",function(a){0===a.touches.length&&
(w.mouseDown=!1)}),p.addEventListener("touchmove",function(a){1===a.touches.length&&k(a.touches[0].clientY)}),l.addEventListener("TouchStart",function(a){1===a.touchCount&&(f(a,a.event.touches[0].clientY),a.preventDefault())})):(p.style.pointerEvents="none",l.addEventListener("MouseDown",function(a){var c=a.event;(c.which?0===c.button:1===c.button)&&f(a,c.clientY);a.preventDefault()}),l.addEventListener("MouseUp",function(a){w.mouseDown=!1;a.preventDefault()}),l.addEventListener("MouseMove",function(a){k(a.event.clientY);
a.preventDefault()}));(s.defaultView||s.parentWindow).setTimeout(function(){e()},0)}},_destroy:function(){var a=this.getView();a&&(a.removeEventListener("Scroll",this._scrollListener),this._scrollListener=null,a.removeEventListener("Resize",this._resizeListener),this._resizeListener=null,a.removeEventListener("Redraw",this._redrawListener),this._redrawListener=null,a.removeEventListener("Options",this._optionsListener),this._optionsListener=null);if(a=this._zoomView)a.removeEventListener("LineStyle",
this._lineListener),a.setModel(null),a.destroy(),this._zoomView=null}});return{BaseRuler:k,Ruler:m,AnnotationRuler:a,LineNumberRuler:g,OverviewRuler:s,FoldingRuler:e,ZoomRuler:p}});y("orion/editor/textDND",["orion/util"],function(l){function r(l,h){this._view=l;this._undoStack=h;this._dragSelection=null;this._dropOffset=-1;this._dropText=null;var f=this;this._listener={onDragStart:function(d){f._onDragStart(d)},onDragEnd:function(d){f._onDragEnd(d)},onDragEnter:function(d){f._onDragEnter(d)},onDragOver:function(d){f._onDragOver(d)},
onDrop:function(d){f._onDrop(d)},onDestroy:function(d){f._onDestroy(d)}};l.addEventListener("DragStart",this._listener.onDragStart);l.addEventListener("DragEnd",this._listener.onDragEnd);l.addEventListener("DragEnter",this._listener.onDragEnter);l.addEventListener("DragOver",this._listener.onDragOver);l.addEventListener("Drop",this._listener.onDrop);l.addEventListener("Destroy",this._listener.onDestroy)}r.prototype={destroy:function(){var l=this._view;l&&(l.removeEventListener("DragStart",this._listener.onDragStart),
l.removeEventListener("DragEnd",this._listener.onDragEnd),l.removeEventListener("DragEnter",this._listener.onDragEnter),l.removeEventListener("DragOver",this._listener.onDragOver),l.removeEventListener("Drop",this._listener.onDrop),l.removeEventListener("Destroy",this._listener.onDestroy),this._view=null)},_onDestroy:function(l){this.destroy()},_onDragStart:function(l){var h=this._view,f=h.getSelectionText();f&&(this._dragSelection=h.getSelections(),l.event.dataTransfer.effectAllowed="copyMove",l.event.dataTransfer.setData("Text",
f))},_onDragEnd:function(p){if(this._dragSelection){var h=this._view,f=p.event.dataTransfer.dropEffect;if(!l.isFirefox&&("none"!==f||this._dropText))f=p.event.dataTransfer.dropEffect=this._dropEffect;this._undoStack&&this._undoStack.startCompoundChange();(p="move"===f)&&h.setText({text:"",selection:this._dragSelection});if(this._dropText){var f=this._dropText,d=this._dropOffset;p&&this._dragSelection.forEach(function(b){d>=b.end?d-=b.end-b.start:d>=b.start&&(d=b.start)});h.setText(f,d,d);h.setSelection(d,
d+f.length);this._dropText=null;this._dropOffset=-1}this._undoStack&&this._undoStack.endCompoundChange();this._dragSelection=null}},_onDragEnter:function(l){this._onDragOver(l)},_onDragOver:function(p){var h=p.event.dataTransfer.types,f=!this._view.getOptions("readonly");f&&h&&(f=h.contains?h.contains("text/plain")||h.contains("Text"):-1!==h.indexOf("text/plain")||-1!==h.indexOf("Text"));f?l.isFirefox||(this._dropEffect=p.event.dataTransfer.dropEffect=(l.isMac?p.event.altKey:p.event.ctrlKey)?"copy":
"move"):p.event.dataTransfer.dropEffect="none"},_onDrop:function(p){var h=this._view,f=p.event.dataTransfer.getData("Text");f&&(l.isFirefox||(p.event.dataTransfer.dropEffect=this._dropEffect),p=h.getOffsetAtLocation(p.x,p.y),this._dragSelection?(this._dropOffset=p,this._dropText=f):(h.setText(f,p,p),h.setSelection(p,p+f.length)))}};return{TextDND:r}});y("orion/editor/linkedMode","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/objects orion/util".split(" "),
function(l,r,p,h,f){function d(b){this._data=b}function b(b,d,a){var f=b.getTextView();p.KeyMode.call(this,f);this.editor=b;this.undoStack=d;this.contentAssist=a;this.linkedModeModel=null;f.setAction("linkedModeEnter",function(){this.exitLinkedMode(!0);return!0}.bind(this));f.setAction("linkedModeCancel",function(){this.exitLinkedMode(!1);return!0}.bind(this));f.setAction("linkedModeNextGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup((a.selectedGroupIndex+1)%a.groups.length);return!0}.bind(this));
f.setAction("linkedModePreviousGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup(0<a.selectedGroupIndex?a.selectedGroupIndex-1:a.groups.length-1);return!0}.bind(this));this.linkedModeListener={onActivating:function(a){this._groupContentAssistProvider&&(this.contentAssist.setProviders([this._groupContentAssistProvider]),this.contentAssist.setProgress(null))}.bind(this),onModelChanged:function(a){if(!this.ignoreVerify){for(var b=this.editor.mapOffset(a.start),c=this.linkedModeModel,
d,g;c;)if(d=this._getPositionChanged(c,b,b+a.removedCharCount),g=d.position,void 0===g||g.model!==c)this.exitLinkedMode(!1),c=this.linkedModeModel;else break;if(c){c=0;a=a.addedCharCount-a.removedCharCount;d=d.positions;for(var f,k=0;k<d.length;++k){f=d[k];g=f.position;var h=g.offset<=b&&b<=g.offset+g.length;h&&!f.ansestor?(g.offset+=c,g.length+=a,c+=a):(g.offset+=c,f.ansestor&&h&&(g.length+=a));f.escape&&(f.model.escapePosition=g.offset)}this._updateAnnotations(d)}}}.bind(this),onVerify:function(a){if(!this.ignoreVerify){for(var b=
this.editor,c=b.mapOffset(a.start),d=this.editor.mapOffset(a.end),g=this.linkedModeModel,f,k;g;)if(f=this._getPositionChanged(g,c,d),k=f.position,void 0===k||k.model!==g)this.exitLinkedMode(!1),g=this.linkedModeModel;else break;if(g){var h=this._compoundChange;h?h.owner.model===g&&h.owner.group===k.group||(this.endUndo(),this.startUndo()):this.startUndo();g.selectedGroupIndex=k.group;var h=0,m=a.text.length-(d-c);f=f.positions;for(var l,c=c-k.position.offset,s=d-k.position.offset,p=0;p<f.length;++p)l=
f[p],d=l.position,l.oldOffset=d.offset,l.model===g&&l.group===k.group?(d.offset+=h,d.length+=m,h+=m):(d.offset+=h,l.ansestor&&(d.length+=k.count*m)),l.escape&&(l.model.escapePosition=d.offset);this.ignoreVerify=!0;for(p=f.length-1;0<=p;p--)l=f[p],l.model===g&&l.group===k.group&&b.setText(a.text,l.oldOffset+c,l.oldOffset+s,!1);this.ignoreVerify=!1;a.text=null;this._updateAnnotations(f)}}}.bind(this)}}var k={};d.prototype={chop:function(b,d){return d.substring(b.length)},computeProposals:function(b,
d,a){d=a.prefix;b=[];a=(a=this._data.style?this._data.style:null)?a:"emphasis";for(var f=this._data.values,e=0;e<f.length;e++){var n=f[e];"string"===typeof n&&0===n.indexOf(d)?b.push({proposal:this.chop(d,n),description:n,hover:n,style:a}):"object"===typeof n&&n.proposal&&b.push({proposal:this.chop(d,n.proposal),description:n.description?n.description:n.proposal,hover:n.hover?n.hover:n.proposal,style:a})}d=this._data.title?this._data.title:null;0<b.length&&b.splice(0,0,{proposal:"",description:d?
d:"Options",style:"noemphasis_title",unselectable:!0});return b}};b.prototype=new p.KeyMode;f.mixin(b.prototype,{createKeyBindings:function(){var b=r.KeyBinding,d=[];d.push({actionID:"linkedModeEnter",keyBinding:new b(13)});d.push({actionID:"linkedModeCancel",keyBinding:new b(27)});d.push({actionID:"linkedModeNextGroup",keyBinding:new b(9)});d.push({actionID:"linkedModePreviousGroup",keyBinding:new b(9,!1,!0)});return d},enterLinkedMode:function(b){if(!this.linkedModeModel){var d=this.editor.getTextView();
d.addKeyMode(this);d.addEventListener("Verify",this.linkedModeListener.onVerify);d.addEventListener("ModelChanged",this.linkedModeListener.onModelChanged);this.contentAssist.addEventListener("Activating",this.linkedModeListener.onActivating);this.editor.reportStatus(l.linkedModeEntered,null,!0)}this._sortedPositions=null;this.linkedModeModel&&(b.previousModel=this.linkedModeModel,b.parentGroup=this.linkedModeModel.selectedGroupIndex,this.linkedModeModel.nextModel=b);this.linkedModeModel=b;this.selectLinkedGroup(0)},
exitLinkedMode:function(b){if(this.isActive()){this._compoundChange&&(this.endUndo(),this._compoundChange=null);this._sortedPositions=null;var d=this.linkedModeModel;this.linkedModeModel=d.previousModel;d.parentGroup=d.previousModel=void 0;this.linkedModeModel&&(this.linkedModeModel.nextModel=void 0);if(!this.linkedModeModel){var a=this.editor,f=a.getTextView();f.removeKeyMode(this);f.removeEventListener("Verify",this.linkedModeListener.onVerify);f.removeEventListener("ModelChanged",this.linkedModeListener.onModelChanged);
f=this.contentAssist;f.removeEventListener("Activating",this.linkedModeListener.onActivating);f.offset=void 0;this.editor.reportStatus(l.linkedModeExited,null,!0);b&&"number"===typeof d.escapePosition&&a.setCaretOffset(d.escapePosition,!1)}this.selectLinkedGroup(0)}},startUndo:function(){if(this.undoStack){var b=this,d=this.linkedModeModel;this._compoundChange=this.undoStack.startCompoundChange({model:d,group:d.selectedGroupIndex,end:function(){b._compoundChange=null}})}},endUndo:function(){this.undoStack&&
this.undoStack.endCompoundChange()},isActive:function(){return!!this.linkedModeModel},isStatusActive:function(){return!!this.linkedModeModel},selectLinkedGroup:function(b){var g=this.linkedModeModel;if(g){g.selectedGroupIndex=b;b=g.groups[b];var a=b.positions[0],f=this.editor;f.setSelection(a.offset,a.offset+a.length);if(g=this.contentAssist)g.offset=void 0,b.data&&"link"===b.data.type&&b.data.values?((this._groupContentAssistProvider=new d(b.data)).getPrefix=function(){var b=f.getSelection();return b.start===
b.end&&(b=f.getCaretOffset(),a.offset<=b&&b<=a.offset+a.length)?f.getText(a.offset,b):""},g.offset=a.offset,g.deactivate(),g.activate()):this._groupContentAssistProvider&&(this._groupContentAssistProvider=null,g.deactivate())}this._updateAnnotations()},_getModelPositions:function(b,d,a){for(var f=d.groups,e=0;e<f.length;e++)for(var n=f[e].positions,c=0;c<n.length;c++){var k=n[c];a&&(k={offset:k.offset+a,length:k.length});k={index:c,group:e,count:n.length,model:d,position:k};b.push(k);d.nextModel&&
d.nextModel.parentGroup===e&&(k.ansestor=!0,this._getModelPositions(b,d.nextModel,(a||0)+n[c].offset-n[0].offset))}},_getSortedPositions:function(b){var d=this._sortedPositions;if(!d){for(d=[];b.previousModel;)b=b.previousModel;for(this._getModelPositions(d,b);b;)"number"===typeof b.escapePosition&&d.push({escape:!0,model:b,position:{offset:b.escapePosition,length:0}}),b=b.nextModel;d.sort(function(a,b){return a.position.offset-b.position.offset});this._sortedPositions=d}return d},_getPositionChanged:function(b,
d,a){var f;b=this._getSortedPositions(b);for(var e=b.length-1;0<=e;e--)if(!b[e].escape){var n=b[e].position;if(n.offset<=d&&a<=n.offset+n.length){f=b[e];break}}return{position:f,positions:b}},_updateAnnotations:function(b){var d=this.editor.getAnnotationModel();if(d){for(var a=[],f=[],e=d.getAnnotations(),n;e.hasNext();)switch(n=e.next(),n.type){case h.AnnotationType.ANNOTATION_LINKED_GROUP:case h.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP:case h.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:a.push(n)}if(e=
this.linkedModeModel){b=b||this._getSortedPositions(e);for(var c=0;c<b.length;c++)if(n=b[c],n.model===e&&!n.escape){var k=h.AnnotationType.ANNOTATION_LINKED_GROUP;n.group===e.selectedGroupIndex&&(k=0===n.index?h.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:h.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP);n=n.position;n=h.AnnotationType.createAnnotation(k,n.offset,n.offset+n.length,"");f.push(n)}}d.replaceAnnotations(a,f)}}});k.LinkedMode=b;return k});y("orion/editor/factories","orion/editor/actions orion/editor/undoStack orion/editor/rulers orion/editor/annotations orion/editor/textDND orion/editor/linkedMode orion/util".split(" "),
function(l,r,p,h,f,d,b){function k(){}function m(){}function g(){}function a(){}function s(){}function e(){}function n(){}var c={};k.prototype={createKeyBindings:function(a,c,b,e){e=new l.TextActions(a,c,e);var g=new d.LinkedMode(a,c,b);a=new l.SourceCodeActions(a,c,b,g);return{textActions:e,linkedMode:g,sourceCodeActions:a}}};c.KeyBindingsFactory=k;m.prototype={createUndoStack:function(a){a=a.getTextView();return new r.UndoStack(a,200)}};c.UndoFactory=m;g.prototype={createLineNumberRuler:function(a){return new p.LineNumberRuler(a,
"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"})}};c.LineNumberRulerFactory=g;a.prototype={createFoldingRuler:function(a){return new p.FoldingRuler(a,"left",{styleClass:"ruler folding"})}};c.FoldingRulerFactory=a;s.prototype={createZoomRuler:function(a){return new p.ZoomRuler(b.isIOS||b.isAndroid?"right":"innerRight",{styleClass:"ruler zoom"})}};c.ZoomRulerFactory=s;e.prototype={createAnnotationModel:function(a){return new h.AnnotationModel(a)},createAnnotationStyler:function(a,
c){return new h.AnnotationStyler(a,c)},createAnnotationRulers:function(a){var c=new p.AnnotationRuler(a,"left",{styleClass:"ruler annotations"});a=new p.OverviewRuler(a,"right",{styleClass:"ruler overview"});return{annotationRuler:c,overviewRuler:a}}};c.AnnotationFactory=e;n.prototype={createTextDND:function(a,c){return new f.TextDND(a.getTextView(),c)}};c.TextDNDFactory=n;return c});y("orion/editor/editorFeatures",["orion/editor/factories","orion/editor/actions","orion/editor/linkedMode","orion/objects"],
function(l,r,p,h){return h.mixin({},l,r,p)});(function(){function l(b){this.tokens=[];this.tokens.links={};this.options=b||g.defaults;this.rules=a.normal;this.options.gfm&&(this.rules=this.options.tables?a.tables:a.gfm)}function r(a,b){this.options=b||g.defaults;this.links=a;this.rules=s.normal;this.renderer=this.options.renderer||new p;this.renderer.options=this.options;if(!this.links)throw Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?s.breaks:
s.gfm:this.options.pedantic&&(this.rules=s.pedantic)}function p(a){this.options=a||{}}function h(a){this.tokens=[];this.token=null;this.options=a||g.defaults;this.options.renderer=this.options.renderer||new p;this.renderer=this.options.renderer;this.renderer.options=this.options}function f(a,b){return a.replace(!b?/&(?!#?\w+;)/g:/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")}function d(a){return a.replace(/&([#\w]+);/g,function(a,
c){c=c.toLowerCase();return"colon"===c?":":"#"===c.charAt(0)?"x"===c.charAt(1)?String.fromCharCode(parseInt(c.substring(2),16)):String.fromCharCode(+c.substring(1)):""})}function b(a,b){a=a.source;b=b||"";return function u(d,g){if(!d)return RegExp(a,b);g=g.source||g;g=g.replace(/(^|[^\[])\^/g,"$1");a=a.replace(d,g);return u}}function k(){}function m(a){for(var b=1,c,d;b<arguments.length;b++)for(d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a}function g(a,b,c){if(c||
"function"===typeof b){c||(c=b,b=null);b=m({},g.defaults,b||{});var d=b.highlight,k,s,p=0;try{k=l.lex(a,b)}catch(r){return c(r)}s=k.length;var z=function(){var a,e;try{a=h.parse(k,b)}catch(g){e=g}b.highlight=d;return e?c(e):c(null,a)};if(!d||3>d.length)return z();delete b.highlight;if(!s)return z();for(;p<k.length;p++)(function(a){return"code"!==a.type?--s||z():d(a.text,a.lang,function(c,b){if(null==b||b===a.text)return--s||z();a.text=b;a.escaped=!0;--s||z()})})(k[p])}else try{return b&&(b=m({},g.defaults,
b)),h.parse(l.lex(a,b),b)}catch(D){D.message+="\nPlease report this to https://github.com/chjj/marked.";if((b||g.defaults).silent)return"\x3cp\x3eAn error occured:\x3c/p\x3e\x3cpre\x3e"+f(D.message+"",!0)+"\x3c/pre\x3e";throw D;}}var a={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:k,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:k,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,
html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:k,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};a.item=b(a.item,"gm")(/bull/g,a.bullet)();a.list=b(a.list)(/bull/g,a.bullet)("hr","\\n+(?\x3d\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?\x3d"+a.def.source+")")();a.blockquote=b(a.blockquote)("def",a.def)();
a._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b";a.html=b(a.html)("comment",/\x3c!--[\s\S]*?--\x3e/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,a._tag)();a.paragraph=b(a.paragraph)("hr",a.hr)("heading",a.heading)("lheading",a.lheading)("blockquote",a.blockquote)("tag","\x3c"+a._tag)("def",a.def)();a.normal=m({},a);a.gfm=m({},a.normal,
{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/});a.gfm.paragraph=b(a.paragraph)("(?!","(?!"+a.gfm.fences.source.replace("\\1","\\2")+"|"+a.list.source.replace("\\1","\\3")+"|")();a.tables=m({},a.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});l.rules=a;l.lex=function(a,b){return(new l(b)).lex(a)};l.prototype.lex=function(a){a=a.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g,
" ").replace(/\u2424/g,"\n");return this.token(a,!0)};l.prototype.token=function(b,d,c){b=b.replace(/^ +$/gm,"");for(var g,f,k,h,m,l,s;b;){if(k=this.rules.newline.exec(b))b=b.substring(k[0].length),1<k[0].length&&this.tokens.push({type:"space"});if(k=this.rules.code.exec(b))b=b.substring(k[0].length),k=k[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:!this.options.pedantic?k.replace(/\n+$/,""):k});else if(k=this.rules.fences.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"code",
lang:k[2],text:k[3]});else if(k=this.rules.heading.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"heading",depth:k[1].length,text:k[2]});else if(d&&(k=this.rules.nptable.exec(b))){b=b.substring(k[0].length);m={type:"table",header:k[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:k[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:k[3].replace(/\n$/,"").split("\n")};for(l=0;l<m.align.length;l++)/^ *-+: *$/.test(m.align[l])?m.align[l]="right":/^ *:-+: *$/.test(m.align[l])?m.align[l]=
"center":/^ *:-+ *$/.test(m.align[l])?m.align[l]="left":m.align[l]=null;for(l=0;l<m.cells.length;l++)m.cells[l]=m.cells[l].split(/ *\| */);this.tokens.push(m)}else if(k=this.rules.lheading.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"heading",depth:"\x3d"===k[2]?1:2,text:k[1]});else if(k=this.rules.hr.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"hr"});else if(k=this.rules.blockquote.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"blockquote_start"}),k=k[0].replace(/^ *> ?/gm,
""),this.token(k,d,!0),this.tokens.push({type:"blockquote_end"});else if(k=this.rules.list.exec(b)){b=b.substring(k[0].length);h=k[2];this.tokens.push({type:"list_start",ordered:1<h.length});k=k[0].match(this.rules.item);g=!1;s=k.length;for(l=0;l<s;l++)m=k[l],f=m.length,m=m.replace(/^ *([*+-]|\d+\.) +/,""),~m.indexOf("\n ")&&(f-=m.length,m=!this.options.pedantic?m.replace(RegExp("^ {1,"+f+"}","gm"),""):m.replace(/^ {1,4}/gm,"")),this.options.smartLists&&l!==s-1&&(f=a.bullet.exec(k[l+1])[0],h!==f&&
!(1<h.length&&1<f.length)&&(b=k.slice(l+1).join("\n")+b,l=s-1)),f=g||/\n\n(?!\s*$)/.test(m),l!==s-1&&(g="\n"===m.charAt(m.length-1),f||(f=g)),this.tokens.push({type:f?"loose_item_start":"list_item_start"}),this.token(m,!1,c),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(k=this.rules.html.exec(b))b=b.substring(k[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===k[1]||"script"===k[1]||"style"===k[1],text:k[0],isHTML:!0});else if(!c&&
d&&(k=this.rules.def.exec(b)))b=b.substring(k[0].length),this.tokens.links[k[1].toLowerCase()]={href:k[2],title:k[3]},this.tokens.push({type:"def",id:k[1].toLowerCase(),href:k[2],title:k[3]});else if(d&&(k=this.rules.table.exec(b))){b=b.substring(k[0].length);m={type:"table",header:k[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:k[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:k[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(l=0;l<m.align.length;l++)/^ *-+: *$/.test(m.align[l])?m.align[l]=
"right":/^ *:-+: *$/.test(m.align[l])?m.align[l]="center":/^ *:-+ *$/.test(m.align[l])?m.align[l]="left":m.align[l]=null;for(l=0;l<m.cells.length;l++)m.cells[l]=m.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(m)}else if(d&&(k=this.rules.paragraph.exec(b)))b=b.substring(k[0].length),this.tokens.push({type:"paragraph",text:"\n"===k[1].charAt(k[1].length-1)?k[1].slice(0,-1):k[1]});else if(k=this.rules.text.exec(b))b=b.substring(k[0].length),this.tokens.push({type:"text",text:k[0]});
else if(b)throw Error("Infinite loop on byte: "+b.charCodeAt(0));}return this.tokens};var s={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:k,tag:/^\x3c!--[\s\S]*?--\x3e|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,
br:/^ {2,}\n(?!\s*$)/,del:k,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};s.link=b(s.link)("inside",s._inside)("href",s._href)();s.reflink=b(s.reflink)("inside",s._inside)();s.normal=m({},s);s.pedantic=m({},s.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});s.gfm=m({},s.normal,{escape:b(s.escape)("])","~|])")(),
url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:b(s.text)("]|","~]|")("|","|https?://|")()});s.breaks=m({},s.gfm,{br:b(s.br)("{2,}","*")(),text:b(s.gfm.text)("{2,}","*")()});r.rules=s;r.output=function(a,b,c){return(new r(b,c)).output(a)};r.prototype.output=function(a){for(var b="",c,d;a;)if(d=this.rules.escape.exec(a))a=a.substring(d[0].length),b+=d[1];else if(d=this.rules.autolink.exec(a))a=a.substring(d[0].length),"@"===d[2]?(c=":"===d[1].charAt(6)?this.mangle(d[1].substring(7)):
this.mangle(d[1]),d=this.mangle("mailto:")+c):d=c=f(d[1]),b+=this.renderer.link(d,null,c);else if(!this.inLink&&(d=this.rules.url.exec(a)))a=a.substring(d[0].length),d=c=f(d[1]),b+=this.renderer.link(d,null,c);else if(d=this.rules.tag.exec(a))!this.inLink&&/^<a /i.test(d[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(d[0])&&(this.inLink=!1),a=a.substring(d[0].length),b+=this.options.sanitize?f(d[0]):d[0];else if(d=this.rules.link.exec(a))a=a.substring(d[0].length),this.inLink=!0,b+=this.outputLink(d,
{href:d[2],title:d[3]}),this.inLink=!1;else if((d=this.rules.reflink.exec(a))||(d=this.rules.nolink.exec(a)))a=a.substring(d[0].length),c=(d[2]||d[1]).replace(/\s+/g," "),c=this.links[c.toLowerCase()],!c||!c.href?(b+=d[0].charAt(0),a=d[0].substring(1)+a):(this.inLink=!0,b+=this.outputLink(d,c),this.inLink=!1);else if(d=this.rules.strong.exec(a))a=a.substring(d[0].length),b+=this.renderer.strong(this.output(d[2]||d[1]));else if(d=this.rules.em.exec(a))a=a.substring(d[0].length),b+=this.renderer.em(this.output(d[2]||
d[1]));else if(d=this.rules.code.exec(a))a=a.substring(d[0].length),b+=this.renderer.codespan(f(d[2],!0));else if(d=this.rules.br.exec(a))a=a.substring(d[0].length),b+=this.renderer.br();else if(d=this.rules.del.exec(a))a=a.substring(d[0].length),b+=this.renderer.del(this.output(d[1]));else if(d=this.rules.text.exec(a))a=a.substring(d[0].length),b+=f(this.smartypants(d[0]));else if(a)throw Error("Infinite loop on byte: "+a.charCodeAt(0));return b};r.prototype.outputLink=function(a,b){var c=f(b.href),
d=b.title?f(b.title):null;return"!"!==a[0].charAt(0)?this.renderer.link(c,d,this.output(a[1])):this.renderer.image(c,d,f(a[1]))};r.prototype.smartypants=function(a){return!this.options.smartypants?a:a.replace(/--/g,"\u2014").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")};r.prototype.mangle=function(a){for(var b="",c=a.length,d=0,g;d<c;d++)g=a.charCodeAt(d),0.5<Math.random()&&
(g="x"+g.toString(16)),b+="\x26#"+g+";";return b};p.prototype.code=function(a,b,c){if(this.options.highlight){var d=this.options.highlight(a,b);null!=d&&d!==a&&(c=!0,a=d)}return!b?"\x3cpre\x3e\x3ccode\x3e"+(c?a:f(a,!0))+"\n\x3c/code\x3e\x3c/pre\x3e":'\x3cpre\x3e\x3ccode class\x3d"'+this.options.langPrefix+f(b,!0)+'"\x3e'+(c?a:f(a,!0))+"\n\x3c/code\x3e\x3c/pre\x3e\n"};p.prototype.blockquote=function(a){return"\x3cblockquote\x3e\n"+a+"\x3c/blockquote\x3e\n"};p.prototype.def=function(a,b,c){return""};
p.prototype.html=function(a){return a};p.prototype.heading=function(a,b,c){return"\x3ch"+b+' id\x3d"'+this.options.headerPrefix+c.toLowerCase().replace(/[^\w]+/g,"-")+'"\x3e'+a+"\x3c/h"+b+"\x3e\n"};p.prototype.hr=function(){return this.options.xhtml?"\x3chr/\x3e\n":"\x3chr\x3e\n"};p.prototype.list=function(a,b){var c=b?"ol":"ul";return"\x3c"+c+"\x3e\n"+a+"\x3c/"+c+"\x3e\n"};p.prototype.listitem=function(a){return"\x3cli\x3e"+a+"\x3c/li\x3e\n"};p.prototype.paragraph=function(a){return"\x3cp\x3e"+a+
"\x3c/p\x3e\n"};p.prototype.table=function(a,b){return"\x3ctable\x3e\n\x3cthead\x3e\n"+a+"\x3c/thead\x3e\n\x3ctbody\x3e\n"+b+"\x3c/tbody\x3e\n\x3c/table\x3e\n"};p.prototype.tablerow=function(a){return"\x3ctr\x3e\n"+a+"\x3c/tr\x3e\n"};p.prototype.tablecell=function(a,b){var c=b.header?"th":"td";return(b.align?"\x3c"+c+' style\x3d"text-align:'+b.align+'"\x3e':"\x3c"+c+"\x3e")+a+"\x3c/"+c+"\x3e\n"};p.prototype.strong=function(a){return"\x3cstrong\x3e"+a+"\x3c/strong\x3e"};p.prototype.em=function(a){return"\x3cem\x3e"+
a+"\x3c/em\x3e"};p.prototype.codespan=function(a){return"\x3ccode\x3e"+a+"\x3c/code\x3e"};p.prototype.br=function(){return this.options.xhtml?"\x3cbr/\x3e":"\x3cbr\x3e"};p.prototype.del=function(a){return"\x3cdel\x3e"+a+"\x3c/del\x3e"};p.prototype.link=function(a,b,c){if(this.options.sanitize){try{var g=decodeURIComponent(d(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(f){return""}if(0===g.indexOf("javascript:"))return""}a='\x3ca href\x3d"'+a+'"';b&&(a+=' title\x3d"'+b+'"');return a+("\x3e"+c+"\x3c/a\x3e")};
p.prototype.image=function(a,b,c){a='\x3cimg src\x3d"'+a+'" alt\x3d"'+c+'"';b&&(a+=' title\x3d"'+b+'"');return a+=this.options.xhtml?"/\x3e":"\x3e"};h.parse=function(a,b,c){return(new h(b,c)).parse(a)};h.prototype.parse=function(a){this.inline=new r(a.links,this.options,this.renderer);this.tokens=a.reverse();for(a="";this.next();)a+=this.tok();return a};h.prototype.next=function(){return this.token=this.tokens.pop()};h.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0};h.prototype.parseText=
function(){for(var a=this.token.text;"text"===this.peek().type;)a+="\n"+this.next().text;return this.inline.output(a)};h.prototype.tok=function(){switch(this.token.type){case "space":return"";case "def":return this.renderer.def(this.token.id,this.token.href,this.token.title);case "hr":return this.renderer.hr();case "heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case "code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);
case "table":var a="",b="",c,d,g,f;g="";for(c=0;c<this.token.header.length;c++)g+=this.renderer.tablecell(this.inline.output(this.token.header[c]),{header:!0,align:this.token.align[c]});a+=this.renderer.tablerow(g);for(c=0;c<this.token.cells.length;c++){d=this.token.cells[c];g="";for(f=0;f<d.length;f++)g+=this.renderer.tablecell(this.inline.output(d[f]),{header:!1,align:this.token.align[f]});b+=this.renderer.tablerow(g)}return this.renderer.table(a,b);case "blockquote_start":for(b="";"blockquote_end"!==
this.next().type;)b+=this.tok();return this.renderer.blockquote(b);case "list_start":b="";for(a=this.token.ordered;"list_end"!==this.next().type;)b+=this.tok();return this.renderer.list(b,a);case "list_item_start":for(b="";"list_item_end"!==this.next().type;)b+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(b);case "loose_item_start":for(b="";"list_item_end"!==this.next().type;)b+=this.tok();return this.renderer.listitem(b);case "html":return b=!this.token.pre&&
!this.options.pedantic?this.inline.output(this.token.text):this.token.text,this.renderer.html(b);case "paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case "text":return this.renderer.paragraph(this.parseText())}};k.exec=k;g.options=g.setOptions=function(a){m(g.defaults,a);return g};g.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new p,xhtml:!1};g.Parser=
h;g.parser=h.parse;g.Renderer=p;g.Lexer=l;g.lexer=l.lex;g.InlineLexer=r;g.inlineLexer=r.output;g.parse=g;"object"===typeof exports?module.exports=g:"function"===typeof y&&y.amd?y("marked/marked",[],function(){return g}):this.marked=g}).call(function(){return this||("undefined"!==typeof window?window:global)}());y("orion/hover",["marked/marked"],function(l){function r(h,f){this.editor=h;this.hoverFactory=f;this.inputManager=f.inputManager;this.serviceRegistry=f.serviceRegistry;this.commandRegistry=
f.commandRegistry;this._qfToolbars=[]}function p(h,f,d){this.serviceRegistry=h;this.inputManager=f;this.commandRegistry=d;this.filterHoverPlugins();this.inputManager.addEventListener("InputChanged",function(){this.filterHoverPlugins()}.bind(this))}r.prototype={computeHoverInfo:function(h){var f=[];this.hoverFactory._applicableProviders.forEach(function(d){if((d=this.serviceRegistry.getService(d))&&d.computeHoverInfo){var b=this.editor.getEditorContext();f.push(d.computeHoverInfo(b,h))}}.bind(this));
return f},renderMarkDown:function(h){return l(h,{sanitize:!0})},clearQuickFixes:function(){this._qfToolbars.forEach(function(h){h.destroy()});this._qfToolbars=[]},renderQuickFixes:function(h,f){if(h&&f){var d=document.createElement("div");d.className="commandList";var b=this.inputManager.getFileMetadata();b.annotation=h;this.commandRegistry.renderCommands("orion.edit.quickfix",d,b,this.editor,"quickfix",h,[]);delete b.annotation;f.appendChild(d)}}};p.prototype={createHover:function(h){return new r(h,
this)},filterHoverPlugins:function(){this._applicableProviders=[];for(var h=this.serviceRegistry.getServiceReferences("orion.edit.hover"),f=0;f<h.length;f++){var d=h[f],b=this.inputManager.getContentType();if(b){var k=d.getProperty("contentType");k&&-1!==k.indexOf(b.id)&&this._applicableProviders.push(d)}}}};return{HoverFactory:p}});y("orion/editor/contentAssist","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/eventTarget orion/Deferred orion/objects orion/editor/tooltip orion/editor/util orion/util orion/webui/littlelib orion/metrics".split(" "),
function(l,r,p,h,f,d,b,k,m,g,a){function s(a){this.textView=a;this.state=c.INACTIVE;this.clearProviders();var b=this;this._textViewListeners={onModelChanging:function(a){(this._latestModelChangingEvent=a)&&this._updateFilterText(a)}.bind(this),onSelection:function(a){this.isDeactivatingChange(this._latestModelChangingEvent,a)?this.setState(c.INACTIVE):this.isActive()&&(this.state===c.ACTIVE&&this.setState(c.FILTERING),this.filterProposals());this._latestModelChangingEvent=null}.bind(this),onScroll:function(a){this.setState(c.INACTIVE)}.bind(this)};
a.setKeyBinding(m.isMac?new r.KeyBinding(" ",!1,!1,!1,!0):new r.KeyBinding(" ",!0),"contentAssist");a.setKeyBinding(m.isMac?new r.KeyBinding(" ",!1,!1,!0,!0):new r.KeyBinding(" ",!0,!1,!0),"contentAssist");a.setAction("contentAssist",function(){a.getOptions("readonly")||b.activate();return!0},{name:l.contentAssist})}function e(a,c){var b=a.textView;p.KeyMode.call(this,b);this.contentAssist=a;this.widget=c;this.proposals=[];var e=this;this.contentAssist.addEventListener("ProposalsComputed",function(a){e.proposals=
a.data.proposals;if(0===e.proposals.length)e.selectedIndex=-1,e.cancel();else{for(e.selectedIndex=0;e.proposals[e.selectedIndex]&&e.proposals[e.selectedIndex].unselectable;)e.selectedIndex++;if(e.proposals[e.selectedIndex]){if(e.widget){var c=!0;if(a.autoApply){for(a=e.selectedIndex+1;e.proposals[a]&&e.proposals[a].unselectable;)a++;e.proposals[a]||(c=!1,e.contentAssist.apply(e.proposals[e.selectedIndex]))}c&&(e.widget.show(),e.widget.selectNode(e.selectedIndex))}}else e.selectedIndex=-1,e.cancel()}});
b.setAction("contentAssistApply",function(){return this.enter()}.bind(this));b.setAction("contentAssistCancel",function(){return this.cancel()}.bind(this));b.setAction("contentAssistNextProposal",function(){return this.lineDown()}.bind(this));b.setAction("contentAssistPreviousProposal",function(){return this.lineUp()}.bind(this));b.setAction("contentAssistNextPage",function(){return this.pageDown()}.bind(this));b.setAction("contentAssistPreviousPage",function(){return this.pageUp()}.bind(this));b.setAction("contentAssistHome",
function(){this.widget&&this.widget.scrollIndex(0,!0);return this.lineDown(0)}.bind(this));b.setAction("contentAssistEnd",function(){return this.lineUp(this.proposals.length-1)}.bind(this));b.setAction("contentAssistTab",function(){return this.tab()}.bind(this));this.widget&&(this.widget.setContentAssistMode(this),this.widget.createAccessible())}function n(a,c){this.contentAssist=a;this.textView=this.contentAssist.getTextView();this.isShowing=this.textViewListenerAdded=!1;var b=this.textView.getOptions("parent").ownerDocument;
this.parentNode="string"===typeof c?b.getElementById(c):c;if(!this.parentNode){this.parentNode=m.createElement(b,"div");this.parentNode.className="contentassist";var e=b.getElementsByTagName("body")[0];if(e)e.appendChild(this.parentNode);else throw Error("parentNode is required");}k.addEventListener(this.parentNode,"scroll",this.onScroll.bind(this));var d=this;this.textViewListener={onMouseDown:function(a){(a.event.target||a.event.srcElement).parentElement!==d.parentNode&&d.contentAssist.deactivate()}};
this.contentAssist.addEventListener("Deactivating",function(a){d.hide()});this.scrollListener=function(a){d.isShowing&&d.position()};k.addEventListener(b,"scroll",this.scrollListener)}var c={INACTIVE:1,ACTIVE:2,FILTERING:3},u={selected:"selected",hr:"proposal-hr",emphasis:"proposal-emphasis",noemphasis:"proposal-noemphasis",noemphasis_keyword:"proposal-noemphasis-keyword",noemphasis_title:"proposal-noemphasis-title",noemphasis_title_keywords:"proposal-noemphasis-title-keywords",dfault:"proposal-default"};
s.prototype={apply:function(b){if(!b)return!1;var e=this.textView,d=e.getSelection(),g=this._initialCaretOffset,f=g,k=d=Math.max(d.start,d.end),n=e.getModel();n.getBaseModel&&(f=n.mapOffset(f),k=n.mapOffset(k),n=n.getBaseModel());b.overwrite&&(g="string"===typeof b.prefix?f-b.prefix.length:this.getPrefixStart(n,f));f={proposal:b,start:f,end:k};this.setState(c.INACTIVE);e.setText("string"===typeof b?b:b.proposal,g,d);if(b.additionalEdits)for(d=0;d<b.additionalEdits.length;d++)g=b.additionalEdits[d],
e.setText(g.text,g.offset,g.offset+g.length);this.dispatchEvent({type:"ProposalApplied",data:f});a.logEvent("contentAssist","apply");return!0},activate:function(b,e){this.state===c.INACTIVE&&(a.logEvent("contentAssist","activate",void 0,e?0:1),this._autoTriggered=e?!0:!1,this.setState(c.ACTIVE,b))},deactivate:function(){this.setState(c.INACTIVE)},getTextView:function(){return this.textView},isActive:function(){return this.state===c.ACTIVE||this.state===c.FILTERING},isDeactivatingChange:function(a,
c){var b=!1;(Array.isArray(c.newValue)?c.newValue:[c.newValue])[0].start<this._initialCaretOffset||!a?b=!0:a&&(b=0<a.removedLineCount||0<a.addedLineCount);return b},setState:function(a,b){var e;a===c.ACTIVE?(e="Activating",this._mode&&this._mode.setActive(!0)):a===c.INACTIVE&&(e="Deactivating",this._mode&&this._mode.setActive(!1));e&&this.dispatchEvent({type:e,providers:b});this.state=a;this.onStateChange(a)},setMode:function(a){this._mode=a},onStateChange:function(a){a===c.INACTIVE?(this._removeTextViewListeners(),
this._filterText="",this._initialCaretOffset=-1,this._computedProposals=null):a===c.ACTIVE&&(this._filterText="",this._addTextViewListeners(),this.computeProposals())},computeProposals:function(){var a=this.textView.getCaretOffset(),c=this.textView.getSelection(),c=Math.min(c.start,c.end);this._initialCaretOffset=Math.min(a,c);this._computedProposals=null;this._computeProposals(this._initialCaretOffset).then(function(a){if(this.isActive()){var c=this._flatten(a);c&&(Array.isArray(c)&&0<c.length)&&
(this._computedProposals=a);this.dispatchEvent({type:"ProposalsComputed",data:{proposals:c},autoApply:!this._autoTriggered});this._computedProposals&&this._filterText&&this.filterProposals(!0)}}.bind(this))},getPrefixStart:function(a,c){for(var b=c;0<b&&/[A-Za-z0-9_]/.test(a.getText(b-1,b));)b--;return b},handleError:function(a){"undefined"!==typeof console&&(console.log("Error retrieving content assist proposals"),console.log(a&&a.stack))},initialize:function(){this._providers.forEach(function(a){a=
a.provider;"function"===typeof a.initialize&&a.initialize()})},_computeProposals:function(a){var c=this._providers,b=this.textView,e=b.getSelection(),g=b.getModel(),k=a;g.getBaseModel&&(k=g.mapOffset(k),e.start=g.mapOffset(e.start),e.end=g.mapOffset(e.end),g=g.getBaseModel());a=g.getLine(g.getLineAtOffset(k));for(var n=0;n<a.length&&/\s/.test(a.charAt(n));)n++;var n=a.substring(0,n),b=b.getOptions("tabSize","expandTab"),b=b.expandTab?Array(b.tabSize+1).join(" "):"\t",h={line:a,offset:k,prefix:g.getText(this.getPrefixStart(g,
k),k),selection:e,delimiter:g.getLineDelimiter(),tab:b,indentation:n},m=this,c=c.map(function(a){a=a.provider;var c;try{var b,e;if(b=a.computeContentAssist){var n=m.editorContextProvider,t=n.getEditorContext();h=d.mixin(h,n.getOptions());e=b.apply(a,[t,h])}else if(b=a.getProposals||a.computeProposals)e=b.apply(a,[g.getText(),k,h]);c=m.progress?m.progress.progress(e,"Generating content assist proposal"):e}catch(l){return(new f).reject(l)}return f.when(c)});return f.all(c,this.handleError)},filterProposals:function(a){if(this._computedProposals&&
(this._latestModelChangingEvent||a)){a=this.textView.getModel();a.getBaseModel&&(a=a.getBaseModel());a=this.getPrefixStart(a,this._initialCaretOffset);var c=this.textView.getText(a,this._initialCaretOffset),b=c,e=[];this._computedProposals.forEach(function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){if(!a)return!1;b="string"===typeof a.prefix?a.prefix:c;if(u[a.style]===u.hr||u[a.style]===u.noemphasis_title)return!0;var e="";if(a.overwrite){if(a.name)e=a.name;else if(a.proposal)e=a.proposal;else return!1;
return 0===e.indexOf(b+this._filterText)}return a.name||a.proposal?(e=!1,a.name&&(e=0===a.name.indexOf(b+this._filterText)),!e&&a.proposal&&(e=0===a.proposal.indexOf(this._filterText)),e):"string"===typeof a?0===a.indexOf(this._filterText):!1},this),0<a.length&&e.push(a))},this);a=[];e&&(e=this._removeExtraUnselectableElements(e),a=this._flatten(e));this.dispatchEvent({type:"ProposalsComputed",data:{proposals:a},autoApply:!1})}},_removeExtraUnselectableElements:function(a){return a.map(function(a){return a.filter(function(c,
b){var e=!0;if(u[c.style]===u.hr)0===b||a.length-1===b?e=!1:u.hr===u[a[b-1].style]&&(e=!1);else if(u[c.style]===u.noemphasis_title){var d=a[b+1];d?u[d.style]===u.noemphasis_title&&(e=!1):e=!1}return e})})},setEditorContextProvider:function(a){this.editorContextProvider=a},_generateProviderId:function(){this._idcount?this._idcount++:this._idcount=0;return"ContentAssistGeneratedID_"+this._idcount},setAutoTriggerEnabled:function(a){this._autoTriggerEnabled=a;this._updateAutoTriggerListenerState()},setProviders:function(a){var c=
this;this.setProviderInfoArray(a.map(function(a){return a.id?a:{provider:a,id:c._generateProviderId()}}))},setProviderInfoArray:function(a){this.clearProviders();this._providers=a;this._charTriggersInstalled=a.some(function(a){return a.charTriggers});this._updateAutoTriggerListenerState()},getProviders:function(){return this._providers.slice()},clearProviders:function(){this._providers=[];this._charTriggersInstalled=!1;this._updateAutoTriggerListenerState()},setProgress:function(a){this.progress=
a},setStyleAccessor:function(a){this._styleAccessor=a},_flatten:function(a){return a.reduce(function(a,c){var b=a,e=null;c&&Array.isArray(c)&&(e=c.filter(function(a){return a}));if(e&&Array.isArray(e)&&0<e.length){var b=e,d=a,g=e[0].style;g&&(u[g]&&0===u[g].indexOf(u.noemphasis))&&(b=a,d=e);0<b.length&&(e=b[b.length-1].style)&&u.hr!==u[e]&&(b=b.concat({proposal:"",name:"",description:"---------------------------------",style:"hr",unselectable:!0}));b=b.concat(d)}return b},[])},_triggerListener:function(){var a=
this.textView.getCaretOffset(),c=null,b=[];if(this._charTriggersInstalled){var e=this.textView.getText(a-1,a);this._providers.forEach(function(d){var g=d.charTriggers;if(g&&g.test(e)){var g=!1,f=d.excludedStyles;this._styleAccessor&&f&&(c||(c=this._styleAccessor.getStyles(a-1)),g=c.some(function(a){return f.test(a.style)}));g||b.push(d)}},this);0<b.length&&this.activate(b,!0)}},_updateAutoTriggerListenerState:function(){this._boundTriggerListener||(this._boundTriggerListener=this._triggerListener.bind(this));
if(this._triggerListenerInstalled){if(!this._autoTriggerEnabled||!this._charTriggersInstalled)this.textView.removeEventListener("Modify",this._boundTriggerListener),this._triggerListenerInstalled=!1}else this._autoTriggerEnabled&&this._charTriggersInstalled&&(this.textView.addEventListener("Modify",this._boundTriggerListener),this._triggerListenerInstalled=!0)},_addTextViewListeners:function(){this._textViewListenersAdded||(this.textView.addEventListener("ModelChanging",this._textViewListeners.onModelChanging),
this.textView.addEventListener("Scroll",this._textViewListeners.onScroll),this.textView.addEventListener("Selection",this._textViewListeners.onSelection),this._textViewListenersAdded=!0)},_removeTextViewListeners:function(){this._textViewListenersAdded&&(this._latestModelChangingEvent=null,this.textView.removeEventListener("ModelChanging",this._textViewListeners.onModelChanging),this.textView.removeEventListener("Scroll",this._textViewListeners.onScroll),this.textView.removeEventListener("Selection",
this._textViewListeners.onSelection),this._textViewListenersAdded=!1)},_updateFilterText:function(a){var c=a.removedCharCount;c&&(this._filterText=this._filterText.substring(0,this._filterText.length-c));if(a=a.text)this._filterText=this._filterText.concat(a)}};h.EventTarget.addMixin(s.prototype);e.prototype=new p.KeyMode;d.mixin(e.prototype,{createKeyBindings:function(){var a=r.KeyBinding,c=[];c.push({actionID:"contentAssistApply",keyBinding:new a(13)});c.push({actionID:"contentAssistCancel",keyBinding:new a(27)});
c.push({actionID:"contentAssistNextProposal",keyBinding:new a(40)});c.push({actionID:"contentAssistPreviousProposal",keyBinding:new a(38)});c.push({actionID:"contentAssistNextPage",keyBinding:new a(34)});c.push({actionID:"contentAssistPreviousPage",keyBinding:new a(33)});c.push({actionID:"contentAssistHome",keyBinding:new a(g.KEY.HOME)});c.push({actionID:"contentAssistEnd",keyBinding:new a(g.KEY.END)});c.push({actionID:"contentAssistTab",keyBinding:new a(9)});return c},cancel:function(){this.getContentAssist().deactivate()},
getContentAssist:function(){return this.contentAssist},getProposals:function(){return this.proposals},isActive:function(){return this.getContentAssist().isActive()},setActive:function(a){a?this.contentAssist.textView.addKeyMode(this):this.contentAssist.textView.removeKeyMode(this)},lineUp:function(a,c){return this.selectNew(a,c,!1)},lineDown:function(a,c){return this.selectNew(a,c,!0)},selectNew:function(a,c,b){if(b){if(void 0===a&&(a=this.selectedIndex+1),a>=this.proposals.length){if(c)return!0;
a=0}}else if(void 0===a&&(a=this.selectedIndex-1),0>a){if(c)return!0;a=this.proposals.length-1}for(var e=a;this.proposals[a]&&this.proposals[a].unselectable;){if(b){if(a++,a>=this.proposals.length){if(c)return!0;a=0}}else if(a--,0>a){if(c)return!0;a=this.proposals.length-1}if(a===e){a=-1;break}}this.selectedIndex=a;this.widget&&this.widget.selectNode(a);this._showTooltip(!0);return!0},_showTooltip:function(a){var c=b.Tooltip.getTooltip(this.contentAssist.textView),e=this,d={getTooltipInfo:function(){var a=
e.widget.parentNode.getBoundingClientRect(),c={width:350,height:a.height,top:a.top};a.left+a.width>=document.documentElement.clientWidth?(c.left=a.left-c.width,c.left-=10):(c.left=a.left+a.width,c.left+=10);return{context:{proposal:e.proposals[e.selectedIndex]},anchorArea:a,tooltipArea:c}}};a?c.update(d):c.show(d,!0,!1)},_hideTooltip:function(){b.Tooltip.getTooltip(this.contentAssist.textView).hide()},pageUp:function(){if(this.widget){var a=this.widget.getTopIndex();a===this.selectedIndex&&(this.widget.scrollIndex(a,
!1),a=this.widget.getTopIndex());return 0===a?this.lineDown(a,!0):this.lineUp(a,!0)}return this.lineUp()},pageDown:function(){if(this.widget){var a=this.widget.getBottomIndex();a===this.selectedIndex&&(this.widget.scrollIndex(a,!0),a=this.widget.getBottomIndex());return this.lineDown(a,!0)}return this.lineDown()},enter:function(){return this.contentAssist.apply(this.proposals[this.selectedIndex]||null)},tab:function(){return this.widget?(this.widget.parentNode.focus(),!0):!1}});n.prototype={onClick:function(a){a||
(a=window.event);this.contentAssist.apply(this.getProposal(a.target||a.srcElement));this.textView.focus()},onScroll:function(a){this.previousCloneNode&&!this.preserveCloneThroughScroll&&(this._removeCloneNode(),this.previousSelectedNode.classList.add(u.selected));this.preserveCloneThroughScroll=!1},createDiv:function(a,c,b){var e=c.ownerDocument,d=m.createElement(e,"div");d.id="contentoption"+b;d.setAttribute("role","option");d.className=u[a.style]?u[a.style]:u.dfault;"hr"===a.style?a=m.createElement(e,
"hr"):(a=this._createDisplayNode(d,a,b),d.contentAssistProposalIndex=b);d.appendChild(a);c.appendChild(d)},createAccessible:function(){var a=this._contentAssistMode,c=this;k.addEventListener(this.parentNode,"keydown",function(b){b||(b=window.event);b.preventDefault&&b.preventDefault();return b.keyCode===g.KEY.ESCAPE?a.cancel():b.keyCode===g.KEY.UP?a.lineUp():b.keyCode===g.KEY.DOWN?a.lineDown():b.keyCode===g.KEY.ENTER?a.enter():b.keyCode===g.KEY.PAGEDOWN?a.pageDown():b.keyCode===g.KEY.PAGEUP?a.pageUp():
b.keyCode===g.KEY.HOME?(c.scrollIndex(0,!0),a.lineDown(0)):b.keyCode===g.KEY.END?a.lineUp(a.getProposals().length-1):!1})},_createDisplayNode:function(a,c,b){var e=a=null;if("string"===typeof c)e=c;else if(c.description&&"string"===typeof c.description)if(c.name&&"string"===typeof c.name){var d=this._createNameNode(c.name);d.contentAssistProposalIndex=b;a=document.createElement("span");a.appendChild(d);c=document.createTextNode(c.description);a.appendChild(c)}else e=c.description;else e=c.proposal;
e&&(a=this._createNameNode(e));a.contentAssistProposalIndex=b;return a},_createNameNode:function(a){var c=document.createElement("span");c.classList.add("proposal-name");c.appendChild(document.createTextNode(a));return c},getProposal:function(a){var c=null;a=a.contentAssistProposalIndex;void 0!==a&&(c=this._contentAssistMode.getProposals()[a]||null);return c},getTopIndex:function(){for(var a=this.parentNode.childNodes,c=0;c<a.length;c++)if(a[c].offsetTop>=this.parentNode.scrollTop)return c;return 0},
getBottomIndex:function(){for(var a=this.parentNode.childNodes,c=0;c<a.length;c++){var b=a[c];if(b.offsetTop+b.offsetHeight>this.parentNode.scrollTop+this.parentNode.clientHeight)return Math.max(0,c-1)}return a.length-1},scrollIndex:function(a,c){var b=this.parentNode.childNodes[a];b&&(b.scrollIntoView(c),this.preserveCloneThroughScroll=!0)},selectNode:function(a){var c=null;this._hideTimeout&&(window.clearTimeout(this._hideTimeout),this._hideTimeout=null);this._fadeTimer&&(window.clearTimeout(this._fadeTimer),
this._fadeTimer=null);this.previousSelectedNode&&(this.previousSelectedNode.classList.remove(u.selected),this.previousSelectedNode=null,this.previousCloneNode&&this._removeCloneNode());if(-1!==a&&(c=this.parentNode.childNodes[a])){c.classList.add(u.selected);this.parentNode.setAttribute("aria-activedescendant",c.id);c.focus();c.offsetTop<this.parentNode.scrollTop?(c.scrollIntoView(!0),this.preserveCloneThroughScroll=!0):c.offsetTop+c.offsetHeight>this.parentNode.scrollTop+this.parentNode.clientHeight&&
(c.scrollIntoView(!1),this.preserveCloneThroughScroll=!0);var b=(c.firstChild||c).getBoundingClientRect(),e=this.parentNode.clientWidth?this.parentNode.clientWidth:this.parentNode.getBoundingClientRect();a=window.getComputedStyle(this.parentNode);var d=window.getComputedStyle(c),d=parseInt(a.paddingLeft)+parseInt(a.paddingRight)+parseInt(d.paddingLeft)+parseInt(d.paddingRight);if(b.width>=e-d){d=parseInt(a.top);e=c.cloneNode(!0);e.classList.add("cloneProposal");e.style.top=d+c.offsetTop-this.parentNode.scrollTop+
"px";e.style.left=a.left;e.setAttribute("id",e.id+"_clone");b=b.left+b.width-parseInt(document.documentElement.clientWidth);0<b&&(a=parseInt(a.left)-b,0>a&&(a=0),e.style.left=a+"px");var g=document.createElement("div");g.id="clone_contentassist";g.classList.add("contentassist");g.classList.add("cloneWrapper");g.appendChild(e);g.onclick=this.parentNode.onclick;this.parentNode.parentNode.insertBefore(g,this.parentNode);var f=function(a){a.contentAssistProposalIndex=c.contentAssistProposalIndex;if(a.hasChildNodes())for(var b=
0;b<a.childNodes.length;b++)f(a.childNodes[b])};f(g);var k=this;this._hideTimeout=window.setTimeout(function(){k._hideTimeout=null;c.classList.add(u.selected);var a=1;k._fadeTimer=window.setInterval(function(){!k.previousCloneNode||0.01>=a?(k._removeCloneNode(),window.clearInterval(k._fadeTimer),k._fadeTimer=null):(g.style.opacity=a,g.style.filter="alpha(opacity\x3d"+100*a+")",a-=0.1*a)},50)},1500);c.classList.remove(u.selected);this.previousCloneNode=g}}this.previousSelectedNode=c},setContentAssistMode:function(a){this._contentAssistMode=
a},show:function(){var a=this._contentAssistMode.getProposals();if(0===a.length)this.hide();else{this.parentNode.innerHTML="";for(var c=0;c<a.length;c++)this.createDiv(a[c],this.parentNode,c);this.position();this.parentNode.onclick=this.onClick.bind(this);this.isShowing=!0;this._contentAssistMode._showTooltip(!1);this.textViewListenerAdded||(this.textView.addEventListener("MouseDown",this.textViewListener.onMouseDown),this.textViewListenerAdded=!0)}},hide:function(){this.parentNode.ownerDocument.activeElement===
this.parentNode&&this.textView.focus();this.parentNode.style.display="none";this.parentNode.onclick=null;this.isShowing=!1;this._contentAssistMode._hideTooltip();this.textViewListenerAdded&&(this.textView.removeEventListener("MouseDown",this.textViewListener.onMouseDown),this.textViewListenerAdded=!1);this.previousSelectedNode&&(this.previousSelectedNode=null,this.previousCloneNode&&this._removeCloneNode())},position:function(){var a=this.contentAssist,c=this.textView;if(void 0!==a.offset){var a=
a.offset,b=c.getModel();b.getBaseModel&&(a=b.mapOffset(a,!0))}else a=this.textView.getCaretOffset();a=c.getLocationAtOffset(a);a.y+=c.getLineHeight();this.textView.convert(a,"document","page");this.parentNode.style.position="fixed";this.parentNode.style.left=a.x+"px";this.parentNode.style.top=a.y+"px";this.parentNode.style.display="block";this.parentNode.scrollTop=0;b=this.parentNode.ownerDocument;c=b.documentElement.clientWidth;b=b.documentElement.clientHeight-a.y;if(this.parentNode.offsetHeight>
b){var e=a.y-this.textView.getLineHeight();this.parentNode.offsetHeight>e?b>e?this.parentNode.style.maxHeight=b+"px":(this.parentNode.style.maxHeight=e+"px",this.parentNode.style.top="0"):(this.parentNode.style.top=a.y-this.parentNode.offsetHeight-this.textView.getLineHeight()+"px",this.parentNode.style.maxHeight=e+"px")}else this.parentNode.style.maxHeight=b+"px";a.x+this.parentNode.offsetWidth>c?(a=c-this.parentNode.offsetWidth,0>a&&(a=0),this.parentNode.style.left=a+"px",this.parentNode.style.maxWidth=
c-a):this.parentNode.style.maxWidth=c+a.x+"px"},_removeCloneNode:function(){this.parentNode.parentNode.contains(this.previousCloneNode)&&this.parentNode.parentNode.removeChild(this.previousCloneNode);this.previousCloneNode=null}};return{ContentAssist:s,ContentAssistMode:e,ContentAssistWidget:n}});y("orion/editor/emacs",["i18n!orion/editor/nls/messages","orion/editor/keyModes","orion/keyBinding","orion/util"],function(l,r,p,h){function f(d){r.KeyMode.call(this,d)}f.prototype=new r.KeyMode;f.prototype.createKeyBindings=
function(){var d=[];d.push({actionID:"emacs-beginning-of-line",keyBinding:this._createStroke("a",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-end-of-line",keyBinding:this._createStroke("e",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-forward-char",keyBinding:this._createStroke("f",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-backward-char",keyBinding:this._createStroke("b",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-forward-word",keyBinding:this._createStroke("f",!1,!1,!0)});
d.push({actionID:"emacs-backward-word",keyBinding:this._createStroke("b",!1,!1,!0)});d.push({actionID:"emacs-next-line",keyBinding:this._createStroke("n",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-previous-line",keyBinding:this._createStroke("p",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-beginning-of-buffer",keyBinding:this._createStroke(188,!1,!0,!0)});d.push({actionID:"emacs-end-of-buffer",keyBinding:this._createStroke(190,!1,!0,!0)});d.push({actionID:"emacs-delete-backward-char",
keyBinding:this._createStroke(46,!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-delete-char",keyBinding:this._createStroke("d",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-kill-line",keyBinding:this._createStroke("k",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-kill-word",keyBinding:this._createStroke("d",!1,!1,!0)});d.push({actionID:"emacs-backward-kill-word",keyBinding:this._createStroke(46,!1,!1,!0)});d.push({actionID:"undo",keyBinding:this._createSequence([this._createStroke("x",
!0),this._createStroke("u")])});d.push({actionID:"redo",keyBinding:this._createSequence([this._createStroke("x",!0),this._createStroke("r")])});d.push({actionID:"emacs-scroll-up",keyBinding:this._createStroke("v",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-scroll-down",keyBinding:this._createStroke("v",!1,!1,!0)});d.push({actionID:"emacs-set-mark-command",keyBinding:this._createStroke(" ",!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-reset-mark-command",keyBinding:this._createStroke("g",
!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-exchange-point-and-mark",keyBinding:this._createSequence([this._createStroke("x",!h.isMac,!1,!1,h.isMac),this._createStroke("x",!h.isMac,!1,!1,h.isMac)])});for(var b=0;9>=b;b++)d.push({actionID:"emacs-digit-argument-"+b,keyBinding:this._createStroke(48+b,!h.isMac,!1,!1,h.isMac)}),d.push({actionID:"emacs-digit-argument-"+b,keyBinding:this._createStroke(48+b,!1,!1,!0)}),d.push({actionID:"emacs-digit-argument-"+b,keyBinding:this._createStroke(48+b,!h.isMac,
!1,!0,h.isMac)});d.push({actionID:"emacs-negative-argument",keyBinding:this._createStroke(189,!h.isMac,!1,!1,h.isMac)});d.push({actionID:"emacs-negative-argument",keyBinding:this._createStroke(189,!1,!1,!0)});d.push({actionID:"emacs-negative-argument",keyBinding:this._createStroke(189,!h.isMac,!1,!0,h.isMac)});d.push({actionID:"emacs-uppercase",keyBinding:this._createStroke("u",!1,!1,!0)});d.push({actionID:"emacs-lowercase",keyBinding:this._createStroke("l",!1,!1,!0)});d.push({actionID:"emacs-capitalize",
keyBinding:this._createStroke("c",!1,!1,!0)});d.push({actionID:"contentAssist",keyBinding:this._createStroke(191,!1,!1,!0)});d.push({actionID:"find",keyBinding:this._createStroke("r",!1,!1,!0)});d.push({actionID:"incrementalFind",keyBinding:this._createStroke("s",!0)});d.push({actionID:"incrementalFindReverse",keyBinding:this._createStroke("r",!0)});d.push({actionID:"save",keyBinding:this._createSequence([this._createStroke("x",!h.isMac,!1,!1,h.isMac),this._createStroke("s",!h.isMac,!1,!1,h.isMac)])});
this._createActions(this.getView());return d};f.prototype._createStroke=function(d,b,f,h,g){d=new p.KeyStroke(d,b,f,h,g);d.scopeName=l.emacs;return d};f.prototype._createSequence=function(d){d=new p.KeySequence(d);d.scopeName=l.emacs;return d};f.prototype._getData=function(){var d={count:(this._argument||1)*(this._sign||1)};this._argument=0;this._sign=1;return d};f.prototype._moveCursor=function(d){var b=this._getData();this._marker&&(b.select=!0);return this.getView().invokeAction(d,!1,b)};f.prototype._digitArgument=
function(d){this._argument=10*(this._argument||0)+d;return!0};f.prototype._negativeArgument=function(){this._sign=-1*(this._sign||1);return!0};f.prototype._createActions=function(d){var b=this;d.setAction("emacs-beginning-of-line",function(){return b._moveCursor("lineStart")},{name:l.lineStart});d.setAction("emacs-end-of-line",function(){return b._moveCursor("lineEnd")},{name:l.lineEnd});d.setAction("emacs-forward-char",function(){return b._moveCursor("charNext")},{name:l.charNext});d.setAction("emacs-backward-char",
function(){return b._moveCursor("charPrevious")},{name:l.charPrevious});d.setAction("emacs-forward-word",function(){return b._moveCursor("wordNext")},{name:l.wordNext});d.setAction("emacs-backward-word",function(){return b._moveCursor("wordPrevious")},{name:l.wordPrevious});d.setAction("emacs-next-line",function(){return b._moveCursor("lineDown")},{name:l.lineDown});d.setAction("emacs-previous-line",function(){return b._moveCursor("lineUp")},{name:l.lineUp});d.setAction("emacs-beginning-of-buffer",
function(){return b._moveCursor("textStart")},{name:l.textStart});d.setAction("emacs-end-of-buffer",function(){return b._moveCursor("textEnd")},{name:l.textEnd});d.setAction("emacs-delete-backward-char",function(){return d.invokeAction("deletePrevious")},{name:l.deletePrevious});d.setAction("emacs-delete-char",function(){return d.invokeAction("deletePrevious")},{name:l.deletePrevious});d.setAction("emacs-kill-line",function(){return d.invokeAction("deleteLineEnd")},{name:l.deleteLineEnd});d.setAction("emacs-kill-word",
function(){return d.invokeAction("deleteWordNext")},{name:l.deleteWordNext});d.setAction("emacs-backward-kill-word",function(){return d.invokeAction("deleteWordPrevious")},{name:l.deleteWordPrevious});d.setAction("emacs-scroll-up",function(){return b._moveCursor("pageDown")},{name:l.pageDown});d.setAction("emacs-scroll-down",function(){return b._moveCursor("pageUp")},{name:l.pageUp});d.setAction("emacs-set-mark-command",function(){var f=d.getCaretOffset();d.setCaretOffset(f);b._marker=f;return!0},
{name:l.setMarkCommand});d.setAction("emacs-exchange-point-and-mark",function(){if(void 0!==b._marker){var f=d.getCaretOffset(),h=d.getSelection();if(h.end===f){var g=h.start;h.start=h.end;h.end=g}b._marker=f;d.setSelection(h.start,h.end)}return!0},{name:l.exchangeMarkPoint});d.setAction("emacs-reset-mark-command",function(){var f=d.getCaretOffset();d.setCaretOffset(f);b._marker=void 0;return!0},{name:l.clearMark});d.setAction("emacs-digit-argument-0",function(){return b._digitArgument(0)},{name:h.formatMessage(l.digitArgument,
"0")});d.setAction("emacs-digit-argument-1",function(){return b._digitArgument(1)},{name:h.formatMessage(l.digitArgument,"1")});d.setAction("emacs-digit-argument-2",function(){return b._digitArgument(2)},{name:h.formatMessage(l.digitArgument,"2")});d.setAction("emacs-digit-argument-3",function(){return b._digitArgument(3)},{name:h.formatMessage(l.digitArgument,"3")});d.setAction("emacs-digit-argument-4",function(){return b._digitArgument(4)},{name:h.formatMessage(l.digitArgument,"4")});d.setAction("emacs-digit-argument-5",
function(){return b._digitArgument(5)},{name:h.formatMessage(l.digitArgument,"5")});d.setAction("emacs-digit-argument-6",function(){return b._digitArgument(6)},{name:h.formatMessage(l.digitArgument,"6")});d.setAction("emacs-digit-argument-7",function(){return b._digitArgument(7)},{name:h.formatMessage(l.digitArgument,"7")});d.setAction("emacs-digit-argument-8",function(){return b._digitArgument(8)},{name:h.formatMessage(l.digitArgument,"8")});d.setAction("emacs-digit-argument-9",function(){return b._digitArgument(9)},
{name:h.formatMessage(l.digitArgument,"9")});d.setAction("emacs-negative-argument",function(){return b._negativeArgument()},{name:l.negativeArgument});d.setAction("emacs-uppercase",function(){var f=b._getData();f.unit="word";return d.invokeAction("uppercase",!1,f)},{name:l.uppercase});d.setAction("emacs-lowercase",function(){var f=b._getData();f.unit="word";return d.invokeAction("lowercase",!1,f)},{name:l.lowercase});d.setAction("emacs-capitalize",function(){var f=b._getData();f.unit="word";return d.invokeAction("capitalize",
!1,f)},{name:l.capitalize})};return{EmacsMode:f}});y("orion/editor/vi",["i18n!orion/editor/nls/messages","orion/editor/keyModes","orion/keyBinding","orion/util"],function(l,r,p,h){function f(a,b){for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e])}function d(a,b,e,d,g,f,k){a=new p.KeyStroke(a,b,e,d,g,f);a.scopeName=k||l.vi;return a}function b(a,b){var e=new p.KeySequence(a);e.scopeName=b||l.vi;return e}function k(a,b,e){this.key=b;this.msg=e;this.number="";r.KeyMode.call(this,a);a&&this._createActions(a)}
function m(a){var b=a.getView();this.viMode=a;r.KeyMode.call(this,b);this._createActions(b)}function g(a,b,e,d){this.viMode=a;this.nextMode=b;k.call(this,a.getView(),e,d)}function a(a){var b=a.getView();r.KeyMode.call(this,b);this.viMode=a;this._createActions(b)}function s(c,b){k.call(this,c,"",l.vimove);this.insertMode=new a(this);this.changeMode=new g(this,this.insertMode,"c",l.vichange);this.deleteMode=new g(this,this,"d",l.videlete);this.yankMode=new g(this,this,"y",l.viyank);this.statusReporter=
b}var e,n;k.prototype=new r.KeyMode;f(k.prototype,{_msg:function(a){return{name:h.formatMessage(l[a],this.msg)}},createKeyBindings:function(){for(var a=[],b=this.key,b=b?"-"+b+"-":"-",e=0;9>=e;e++)a.push({actionID:"vi"+b+e,keyBinding:d(e+"",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi"+b+"Left",keyBinding:d("h",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"Left",keyBinding:d("h",!0,!1,!1,!1)});a.push({actionID:"vi"+b+"Left",keyBinding:d(8)});a.push({actionID:"vi"+b+"Left",keyBinding:d(37)});
a.push({actionID:"vi"+b+"Down",keyBinding:d("j",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"Down",keyBinding:d(40)});a.push({actionID:"vi"+b+"Up",keyBinding:d("k",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"Up",keyBinding:d(38)});a.push({actionID:"vi"+b+"Right",keyBinding:d("l",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"Right",keyBinding:d(39)});a.push({actionID:"vi"+b+"Right",keyBinding:d(32)});a.push({actionID:"vi"+b+"w",keyBinding:d("w",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+
b+"b",keyBinding:d("b",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"W",keyBinding:d("W",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"B",keyBinding:d("B",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"e",keyBinding:d("e",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"E",keyBinding:d("E",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"$",keyBinding:d("$",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"^_",keyBinding:d("^",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"^_",
keyBinding:d("_",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"+",keyBinding:d("+",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"+",keyBinding:d(13)});a.push({actionID:"vi"+b+"-",keyBinding:d("-",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"|",keyBinding:d("|",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"H",keyBinding:d("H",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"M",keyBinding:d("M",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"L",keyBinding:d("L",!1,!1,!1,!1,
"keypress")});a.push({actionID:"vi"+b+"/",keyBinding:d("/",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"?",keyBinding:d("?",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"n",keyBinding:d("n",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"N",keyBinding:d("N",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"f",keyBinding:d("f",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"F",keyBinding:d("F",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"t",keyBinding:d("t",!1,!1,!1,!1,"keypress")});
a.push({actionID:"vi"+b+"T",keyBinding:d("T",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+",",keyBinding:d(",",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+";",keyBinding:d(";",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi"+b+"G",keyBinding:d("G",!1,!1,!1,!1,"keypress")});return a},_createActions:function(a){function b(e){e=a.getModel().getLine(e);for(var d=0,g=e.charCodeAt(d);32===g||9===g;)d++,g=e.charCodeAt(d);return d}function e(a,b){a&&g.getView().setCaretOffset(a.start);b.editDone&&
b.editDone()}var d=this.key,d=d?"-"+d+"-":"-",g=this;a.setAction("vi"+d+"0",function(){return g._storeNumber(0)});a.setAction("vi"+d+"1",function(){return g._storeNumber(1)});a.setAction("vi"+d+"2",function(){return g._storeNumber(2)});a.setAction("vi"+d+"3",function(){return g._storeNumber(3)});a.setAction("vi"+d+"4",function(){return g._storeNumber(4)});a.setAction("vi"+d+"5",function(){return g._storeNumber(5)});a.setAction("vi"+d+"6",function(){return g._storeNumber(6)});a.setAction("vi"+d+"7",
function(){return g._storeNumber(7)});a.setAction("vi"+d+"8",function(){return g._storeNumber(8)});a.setAction("vi"+d+"9",function(){return g._storeNumber(9)});a.setAction("vi"+d+"Left",function(){return g._invoke("charPrevious",{unit:"character"})},this._msg("viLeft"));a.setAction("vi"+d+"Right",function(){return g._invoke("charNext",{unit:"character"})},this._msg("viRight"));a.setAction("vi"+d+"Up",function(){return g._invoke("lineUp",{editLine:!0})},this._msg("viUp"));a.setAction("vi"+d+"Down",
function(){return g._invoke("lineDown",{editLine:!0})},this._msg("viDown"));a.setAction("vi"+d+"w",function(){return g._invoke("wordNext",{unit:"word"})},this._msg("viw"));a.setAction("vi"+d+"b",function(){return g._invoke("wordPrevious",{unit:"word"})},this._msg("vib"));a.setAction("vi"+d+"W",function(){return g._invoke("wordNext",{unit:"wordWS"})},this._msg("viW"));a.setAction("vi"+d+"B",function(){return g._invoke("wordPrevious",{unit:"wordWS"})},this._msg("viB"));a.setAction("vi"+d+"e",function(){g._invoke("charNext",
{unit:"character"});g._invoke("wordNext",{unit:"wordend"});g._invoke("charPrevious",{unit:"character"});return!0},this._msg("vie"));a.setAction("vi"+d+"E",function(){return g._invoke("wordNext",{unit:"wordendWS"})},this._msg("viE"));a.setAction("vi"+d+"$",function(){return g._invoke("lineEnd")},this._msg("vi$"));a.setAction("vi"+d+"^_",function(){return g._invoke(function(){var e=a.getModel(),d=a.getCaretOffset(),d=e.getLineAtOffset(d);a.setCaretOffset(e.getLineStart(d)+b(d))})},this._msg("vi^_"));
a.setAction("vi"+d+"+",function(){return g._invoke(function(e){var d=a.getModel(),g=a.getCaretOffset(),f=d.getLineCount()-1;e=Math.min(d.getLineAtOffset(g)+e.count,f);a.setCaretOffset(d.getLineStart(e)+b(e))},{editLine:!0})},this._msg("vi+"));a.setAction("vi"+d+"-",function(){return g._invoke(function(e){var d=a.getModel(),g=a.getCaretOffset();e=Math.max(d.getLineAtOffset(g)-e.count,0);a.setCaretOffset(d.getLineStart(e)+b(e))},{editLine:!0})},this._msg("vi-"));a.setAction("vi"+d+"|",function(){return g._invoke(function(b){var e=
a.getModel(),d=a.getCaretOffset(),d=e.getLineAtOffset(d);a.setCaretOffset(Math.min(e.getLineStart(d)+b.count-1,e.getLineEnd(d)))})},this._msg("vi|"));a.setAction("vi"+d+"H",function(){return g._invoke(function(b){b=a.getModel().getLineStart(a.getTopIndex(!0)+(b.count-1));a.setCaretOffset(b)},{editLine:!0})},this._msg("viH"));a.setAction("vi"+d+"M",function(){return g._invoke(function(b){b=Math.ceil((a.getBottomIndex(!0)-a.getTopIndex(!0))/2)+a.getTopIndex(!0);a.setCaretOffset(a.getModel().getLineStart(b))},
{editLine:!0})},this._msg("viM"));a.setAction("vi"+d+"L",function(){return g._invoke(function(b){a.setCaretOffset(a.getModel().getLineStart(a.getBottomIndex(!0)-(b.count-1)))},{editLine:!0})},this._msg("viL"));a.setAction("vi"+d+"/",function(){var a={hideAfterFind:!0,incremental:!1,reverse:!1,findCallback:function(b){g._searchFwd=!0;e(b,a)}};return g._invoke("find",a)},this._msg("vi/"));a.setAction("vi"+d+"?",function(){var a={hideAfterFind:!0,incremental:!1,reverse:!0,findCallback:function(b){g._searchFwd=
!1;e(b,a)}};return g._invoke("find",a)},this._msg("vi?"));a.setAction("vi"+d+"n",function(){var b,d=a.getCaretOffset();g._searchFwd?(b="findNext",d++):b="findPrevious";var f={start:d,findCallback:function(a){e(a,f)}};return g._invoke(b,f)},this._msg("vin"));a.setAction("vi"+d+"N",function(){var b,d=a.getCaretOffset();g._searchFwd?b="findPrevious":(b="findNext",d++);var f={start:d,findCallback:function(a){e(a,f)}};return g._invoke(b,f)},this._msg("viN"));a.setAction("vi"+d+"f",function(){var b=a.getModel(),
e=a.getCaretOffset();return g._findChar(e,b.getLineEnd(b.getLineAtOffset(e)),!1,0)},this._msg("vif"));a.setAction("vi"+d+"F",function(){var b=a.getModel(),e=a.getCaretOffset();return g._findChar(b.getLineStart(b.getLineAtOffset(e)),e,!0,0)},this._msg("viF"));a.setAction("vi"+d+"t",function(){var b=a.getModel(),e=a.getCaretOffset();return g._findChar(e,b.getLineEnd(b.getLineAtOffset(e)),!1,-1)},this._msg("vit"));a.setAction("vi"+d+"T",function(){var b=a.getModel(),e=a.getCaretOffset();return g._findChar(b.getLineStart(b.getLineAtOffset(e)),
e,!0,1)},this._msg("viT"));a.setAction("vi"+d+",",function(){return g._findNextChar(g._charTempOptions.reverse)},this._msg("vi,"));a.setAction("vi"+d+";",function(){return g._findNextChar(!g._charTempOptions.reverse)},this._msg("vi;"));a.setAction("vi"+d+"G",function(){if(""===g.number){var b=a.getModel();b.getBaseModel&&(b=b.getBaseModel());g.number=b.getLineCount()}return g._invoke(function(b){b=b||{};b.line=b.count;b.editLine=!0;b.callback=function(){b.editDone&&b.editDone()};a.invokeAction("gotoLine",
!1,b)})},this._msg("viG"))},_invoke:function(a,b){var e=this.getView();b=b||{};b.count=this._getCount();"function"===typeof a?a(b):e.invokeAction(a,!1,b);return!0},_getCount:function(){var a=1;""!==this.number&&(a=this.number>>0);this.number="";return a},_findChar:function(a,b,e,d){this._charTempOptions={};this._charTempOptions.start=a;this._charTempOptions.end=b;this._charTempOptions.hideAfterFind=!0;this._charTempOptions.incremental=!1;this._charTempOptions.reverse=e;this._charTempOptions.offset=
d;var g=this._charTempOptions,f=this;this._charTempOptions.findCallback=function(a){a&&f.getView().setCaretOffset(a.start+d);g.editDone&&g.editDone()};return this._invoke("find",this._charTempOptions)},_findNextChar:function(a){if(this._charTempOptions){var b=this.getView(),e={};e.hideAfterFind=this._charTempOptions.hideAfterFind;e.incremental=this._charTempOptions.incremental;e.reverse=this._charTempOptions.reverse;e.wrap=!1;var d=this;e.findCallback=function(a){a&&d.getView().setCaretOffset(a.start+
d._charTempOptions.offset);e.editDone&&e.editDone()};var g=b.getModel();if(a)return e.start=b.getCaretOffset()+1-this._charTempOptions.offset,e.end=g.getLineEnd(g.getLineAtOffset(e.start)),e.reverse=!1,this._invoke("findNext",e);e.start=b.getCaretOffset()-this._charTempOptions.offset;e.end=g.getLineStart(g.getLineAtOffset(e.start));e.reverse=!0;return this._invoke("findPrevious",e)}return!0},_storeNumber:function(a){var b=this;if(0===a&&!this.number)return this._invoke(function(){b.getView().invokeAction("lineStart",
!0)});this.number+=a;return!0}});m.prototype=new r.KeyMode;f(m.prototype,{createKeyBindings:function(){var a=[];a.push({actionID:"vi-:-ESC",keyBinding:d(27),predefined:!0});return a},_createActions:function(a){var b=this;a.setAction("vi-:-ESC",function(){a.removeKeyMode(b);a.addKeyMode(b.viMode);return!0})},match:function(a){var b=r.KeyMode.prototype.match.call(this,a);b||(b=this.getView().getKeyModes()[0].match(a));return b},storeNumber:function(a){this.number=a}});g.prototype=new k;f(g.prototype,
{createKeyBindings:function(){var a=k.prototype.createKeyBindings.call(this);a.push({actionID:"vi-"+this.key+"ESC",keyBinding:d(27),predefined:!0});a.push({actionID:"vi-"+this.key+"-"+this.key,keyBinding:d(this.key,!1,!1,!1,!1,"keypress")});return a},_invoke:function(a,b){b=b||{};var d=this.getView(),g=d.getCaretOffset(),f=g,h=d.getModel(),m=this;b.editDone=function(){var a=d.getCaretOffset();if(f>a){var c=f;f=a;a=c}b.editLine&&(f=h.getLineStart(h.getLineAtOffset(f)),a=h.getLineEnd(h.getLineAtOffset(a),
"c"===m.key?!1:!0));"y"===m.key?(e=d.getText(f,a),n=b.editLine,d.setCaretOffset(g)):d.setText("",f,a);d.removeKeyMode(m);d.addKeyMode(m.nextMode)};k.prototype._invoke.call(this,a,b);b.editDone();return!0},_getCount:function(){var a=1;""!==this.firstNumber&&(a=this.firstNumber>>0);var b=1;""!==this.number&&(b=this.number>>0);this.number=this.firstNumber="";return a*b},_createActions:function(a){k.prototype._createActions.call(this,a);var b=this;a.setAction("vi-"+b.key+"ESC",function(){a.removeKeyMode(b);
a.addKeyMode(b.viMode);return!0});a.setAction("vi-"+b.key+"-"+b.key,function(){return b._invoke("lineEnd",{editLine:!0})},this._msg("viycd"))},storeNumber:function(a){this.firstNumber=a},_modeAdded:function(){this.secondNumber=""},_modeRemoved:function(){this.number=this.firstNumber=this.command=""}});a.prototype=new r.KeyMode;f(a.prototype,{createKeyBindings:function(){var a=[];a.push({actionID:"vi-insert-ESC",keyBinding:d(27),predefined:!0});return a},_createActions:function(a){var b=this;a.setAction("vi-insert-ESC",
function(){a.removeKeyMode(b);a.addKeyMode(b.viMode);return!0})},match:function(a){var b=r.KeyMode.prototype.match.call(this,a);b||(b=this.getView().getKeyModes()[0].match(a));return b},storeNumber:function(a){}});s.prototype=new k;f(s.prototype,{createKeyBindings:function(){var a=k.prototype.createKeyBindings.call(this);a.push({actionID:"vi-ctrl-f",keyBinding:d("f",!0)});a.push({actionID:"vi-ctrl-b",keyBinding:d("b",!0)});a.push({actionID:"vi-ctrl-e",keyBinding:d("e",!0)});a.push({actionID:"vi-ctrl-y",
keyBinding:d("y",!0)});a.push({actionID:"statusLineMode",keyBinding:d(":",!1,!1,!1,!1,"keypress")});a.push({actionID:"vi-a",keyBinding:d("a",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-A",keyBinding:d("A",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-i",keyBinding:d("i",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-I",keyBinding:d("I",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-o",keyBinding:d("o",!1,!1,!1,!1,"keypress"),predefined:!0});
a.push({actionID:"vi-O",keyBinding:d("O",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-R",keyBinding:d("R",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-s",keyBinding:d("s",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-S",keyBinding:d("S",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-p",keyBinding:d("p",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-P",keyBinding:d("P",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-u",
keyBinding:d("u",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-c",keyBinding:d("c",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-d",keyBinding:d("d",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-y",keyBinding:d("y",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-~",keyBinding:d("~",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-x",keyBinding:d("x",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-X",keyBinding:d("X",
!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-C",keyBinding:d("C",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-D",keyBinding:d("D",!1,!1,!1,!1,"keypress"),predefined:!0});a.push({actionID:"vi-*",keyBinding:d("*",!1,!1,!1,!1,"keypress"),predefined:!0});return a},getKeyBindings:function(a){var e=r.KeyMode.prototype.getKeyBindings.call(this,a),e=e||[],g=this.changeMode.getKeyBindings(a),f;if(!this.changeMode.isActive())for(f=0;f<g.length;f++)g[f]=b([d("c",!1,!1,!1,!1,"keypress"),
g[f]]);e=e.concat(g);g=this.deleteMode.getKeyBindings(a);if(!this.deleteMode.isActive())for(f=0;f<g.length;f++)g[f]=b([d("d",!1,!1,!1,!1,"keypress"),g[f]]);e=e.concat(g);g=this.yankMode.getKeyBindings(a);if(!this.yankMode.isActive())for(f=0;f<g.length;f++)g[f]=b([d("y",!1,!1,!1,!1,"keypress"),g[f]]);return e=e.concat(g)},match:function(a){var b=r.KeyMode.prototype.match.call(this,a);!b&&"keypress"===a.type&&(b="noop");return b},_createActions:function(a){k.prototype._createActions.call(this,a);var b=
this;a.setAction("vi-ctrl-f",function(){return b._invoke("pageDown")},{name:l.pageDown});a.setAction("vi-ctrl-b",function(){return b._invoke("pageUp")},{name:l.pageUp});a.setAction("vi-ctrl-e",function(){return b._invoke("scrollLineDown")},{name:l.scrollLineDown});a.setAction("vi-ctrl-y",function(){return b._invoke("scrollLineUp")},{name:l.scrollLineUp});a.setAction("vi-a",function(){return b._toInsertMode("charNext")},{name:l.via});a.setAction("vi-A",function(){return b._toInsertMode("lineEnd")},
{name:l.viA});a.setAction("vi-i",function(){return b._toInsertMode("noop")},{name:l.vii});a.setAction("vi-I",function(){return b._toInsertMode("lineStart")},{name:l.viI});a.setAction("vi-O",function(){b._invoke("lineUp");b._invoke("lineEnd");b._toInsertMode("enter");return!0},{name:l.viO});a.setAction("vi-o",function(){b._invoke("lineEnd");b._toInsertMode("enter");return!0},{name:l.vio});a.setAction("vi-R",function(){return b._toInsertMode("toggleOverwriteMode")},{name:l.viR});a.setAction("vi-s",
function(){return b._toInsertMode("deleteNext",{unit:"char"})},{name:l.vis});a.setAction("vi-S",function(){return b._toInsertMode("deleteLines",{unit:"line"})},{name:l.viS});a.setAction("vi-p",function(){return b._invoke(function(){var a=b.getView(),c=a.getSelection();if(c.start===c.end){var d=a.getModel(),g=a.getCaretOffset();n?c.start=c.end=d.getLineEnd(d.getLineAtOffset(g),!0):(c.start++,c.end++)}a.setText(e,c.start,c.end)})},{name:l.vip});a.setAction("vi-P",function(){return b._invoke(function(){var a=
b.getView(),c=a.getSelection();if(c.start===c.end){var d=a.getModel(),g=a.getCaretOffset();n&&(c.start=c.end=d.getLineStart(d.getLineAtOffset(g)))}a.setText(e,c.start,c.end)})},{name:l.viP});a.setAction("vi-u",function(){return b._invoke("undo")},{name:l.Undo});a.setAction("vi-c",function(){a.removeKeyMode(b);a.addKeyMode(b.changeMode);b.changeMode.storeNumber(b.number);b.number="";return!0});a.setAction("vi-d",function(){a.removeKeyMode(b);a.addKeyMode(b.deleteMode);b.deleteMode.storeNumber(b.number);
b.number="";return!0});a.setAction("vi-y",function(){a.removeKeyMode(b);a.addKeyMode(b.yankMode);b.yankMode.storeNumber(b.number);b.number="";return!0});a.setAction("vi-~",function(){return b._invoke("reversecase")},{name:l.reversecase});a.setAction("vi-x",function(){return b._invoke("deleteNext")},{name:l.deleteNext});a.setAction("vi-X",function(){return b._invoke("deletePrevious")},{name:l.deletePrevious});a.setAction("vi-C",function(){return b._toInsertMode("deleteLineEnd")},{name:l.viC});a.setAction("vi-D",
function(){return b._invoke("deleteLineEnd")},{name:l.deleteLineEnd});a.setAction("vi-*",function(){var a=b.getView(),c=a.getCaretOffset(),c=a.getNextOffset(c+1,{count:-1,unit:"word"}),e=a.getNextOffset(c,{count:1,unit:"wordend"}),a=a.getText(c,e);b._searchFwd=!0;return b._invoke("find",{hideAfterFind:!0,incremental:!1,reverse:!1,findString:a})},{name:l.viStar})},_reportStatus:function(a){this.statusReporter&&this.statusReporter(a)},_toInsertMode:function(a,b){b=b||{};var e=1;""!==this.number&&(e=
this.number>>0);b.count=e;e=this.getView();this.insertMode.storeNumber(this.number);e.invokeAction(a,!1,b);e.removeKeyMode(this);e.addKeyMode(this.insertMode);this.number="";return!0},_modeAdded:function(){this.getView().setOptions({blockCursorVisible:!0})},_modeRemoved:function(){var a=this.getView();a.setOptions({blockCursorVisible:!1});a.removeKeyMode(this.insertMode);a.removeKeyMode(this.changeMode);a.removeKeyMode(this.deleteMode)}});return{VIMode:s}});y("orion/editorPreferences",[],function(){return{}});
y("orion/widgets/themes/ThemePreferences",[],function(){return{}});y("orion/widgets/themes/editor/ThemeData",[],function(){return{}});y("orion/widgets/settings/EditorSettings",[],function(){return null});y("orion/searchAndReplace/textSearcher",[],function(){return{TextSearcher:null}});y("orion/webui/dialogs/OpenResourceDialog",[],function(){return{OpenResourceDialog:{}}});y("orion/widgets/input/DropDownMenu",["orion/objects","orion/webui/littlelib"],function(l,r){function p(h,f,d){if(h=r.node(h))this._parent=
h;else throw Error("Parent node of dropdown menu not found");this.options=d=d||{};this.navDropDownId=this._parent.id+"_navdropdown";this.selectionClass=d.selectionClass;h=document.createElement("div");h.classList.add("dropdownMenu");h.classList.add("dropdownMenuOpen");h.id=this.navDropDownId;h.style.display="none";this._parent.appendChild(h);this._dropdownMenu=h;if(f=r.node(f))this._triggerNode=f;else throw"Trigger node of dropdown menu not found";"hidden"===this._triggerNode.style.visibility&&(this._triggerNode.style.visibility=
"visible");d.noClick||(this._triggerNode.onclick=this.click.bind(this));this._dropdownMenu.addEventListener("keydown",function(b){b.keyCode===r.KEY.ESCAPE&&this.clearPanel()}.bind(this))}l.mixin(p.prototype,{click:function(){"none"===this._dropdownMenu.style.display?this.updateContent(this.getContentNode(),function(){r.setFramesEnabled(!1);this._dropdownMenu.style.display="";this._positionDropdown();this.selectionClass&&this._triggerNode.classList.add(this.selectionClass);this.handle=r.addAutoDismiss([this._triggerNode,
this._dropdownMenu],this.clearPanel.bind(this));if(this.options.onShow)this.options.onShow()}.bind(this)):this.clearPanel()},clearPanel:function(){if(this.isVisible()&&(this._dropdownMenu.style.display="none",r.setFramesEnabled(!0),this.selectionClass&&this._triggerNode.classList.remove(this.selectionClass),this.options.onHide))this.options.onHide()},addContent:function(h){this._dropdownMenu.innerHTML=h},getContentNode:function(){return this._dropdownMenu},updateContent:function(h,f){f()},_positionDropdown:function(){this._dropdownMenu.style.right=
"";var h=r.bounds(this._dropdownMenu),f=r.bounds(document.body);h.left+h.width>f.left+f.width&&(h=r.bounds(this._boundingNode(this._triggerNode)),f=r.bounds(this._triggerNode),this._dropdownMenu.style.right=h.width-(f.left-h.left+f.width)+"px")},_boundingNode:function(h){var f=window.getComputedStyle(h,null);return null===f||"absolute"===f.getPropertyValue("position")||!h.parentNode||h===document.body?h:this._boundingNode(h.parentNode)},isDestroyed:function(){return!this._dropdownMenu.parentNode},
isVisible:function(){return"none"!==this._dropdownMenu.style.display&&!this.isDestroyed()},focus:function(){this._dropdownMenu.focus()},destroy:function(){this._parent&&(r.setFramesEnabled(!0),r.empty(this._parent),this._parent=this.select=null)}});return p});y("orion/URITemplate",[],function(){function l(a){this._text=a}function r(a){return a.replace("%25","%")}function p(a,b){if("U"===b)return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()});
if("U+R"===b)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(g,r);if("U+R-,"===b)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw Error("Unknown allowed character set: "+b);}function h(a,b,e){for(var d=[],c=0;c<a.length;c++)"undefined"!==typeof a[c]&&d.push(p(a[c],b));return d.join(e)}function f(a,b,e,d){for(var c=Object.keys(a),g=[],f=0;f<c.length;f++)"undefined"!==typeof a[c[f]]&&g.push(p(c[f],b)+e+p(a[c[f]],b));return g.join(d)}function d(a){if(0===
a.length)throw Error("Invalid Expression: 0 length expression");(this._operator=k[a[0]])?a=a.substring(1):this._operator=k.NUL;for(var b=[],e=a.split(","),d=0;d<e.length;d++){var c=e[d].match(m);if(null===c)throw Error("Bad VarSpec: "+a);b.push({name:c[1],explode:!!c[2],prefix:c[3]?parseInt(c[3],10):-1})}this._varSpecList=b}function b(a){for(var b=[],e=0,g=a.indexOf("{",e);-1!==g;){b.push(new l(a.substring(e,g)));e=a.indexOf("}",g+1);if(-1===e)throw Error("Invalid template: "+a);b.push(new d(a.substring(g+
1,e)));e+=1;g=a.indexOf("{",e)}b.push(new l(a.substring(e)));this._templateComponents=b}var k={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"\x26",named:!0,ifemp:"\x3d",allow:"U"},"\x26":{first:"\x26",sep:"\x26",named:!0,ifemp:"\x3d",allow:"U"},"#":{first:"#",sep:",",
named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},m=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,g=/%25[0-9A-F][0-9A-F]/g;l.prototype={expand:function(a){return encodeURI(this._text)}};d.prototype={expand:function(a){for(var b=[],e=0;e<this._varSpecList.length;e++){var d=this._varSpecList[e],c=d.name,g=a[c],k=typeof g;if("undefined"!==k&&null!==g){var m=0===b.length?this._operator.first:this._operator.sep;
if("string"===k)this._operator.named&&(m+=p(c,"U+R"),m+=0===g.length?this._operator.ifemp:"\x3d"),-1!==d.prefix&&d.prefix<g.length&&(g=g.substring(0,d.prefix)),m+=p(g,this._operator.allow);else if(Array.isArray(g)){if(0===g.length)continue;d.explode?m+=h(g,this._operator.allow,this._operator.sep):(d=h(g,this._operator.allow,","),this._operator.named&&(m+=p(c,"U+R"),m+=0===d.length?this._operator.ifemp:"\x3d"),m+=d)}else if("object"===k){if(0===Object.keys(g).length)continue;d.explode?m+=f(g,this._operator.allow,
"\x3d",this._operator.sep):(d=f(g,this._operator.allow,",",","),this._operator.named&&(m+=p(c,"U+R"),m+=0===d.length?this._operator.ifemp:"\x3d"),m+=d)}else throw Error("bad param type: "+c+" : "+k);b.push(m)}}return b.join("")}};b.prototype={expand:function(a){for(var b=[],e=0;e<this._templateComponents.length;e++)b.push(this._templateComponents[e].expand(a));return b.join("")}};return b});y("orion/PageLinks","require orion/Deferred orion/PageUtil orion/URITemplate orion/i18nUtil orion/objects orion/URL-shim".split(" "),
function(l,r,p,h,f,d){function b(){if(l.toUrl){var a=new URL(l.toUrl("orion/"),self.location.href);return(new URL("../",a)).href.slice(0,-1)}return(new URL("/",self.location.href)).href.slice(0,-1)}function k(a){var b={};a.getPropertyKeys().forEach(function(e){"objectClass"!==e&&("service.names"!==e&&"service.id"!==e&&"__plugin__"!==e)&&(b[e]=a.getProperty(e))});return b}function m(a,c){var e=a.getServiceReferences(c||"orion.page.link"),d=p.matchResourceParameters(window.location.href),g={OrionHome:b(),
Location:d.resource},f=[];e.forEach(function(a){a=k(a);if(a.uriTemplate&&(a.nls||a.name)){var b=(new h(a.uriTemplate)).expand(g),b=p.validateURLScheme(b);a.href=b;a.textContent=a.name||a.nameKey;f.push((new r).resolve(a))}});return r.all(f)}function g(a){var b=this.categories=Object.create(null);a.forEach(function(a){b[a.id]=a})}function a(a){this.allPageLinks=a;this.allPageLinks.sort(s)}function s(a,b){var e=a.textContent&&a.textContent.toLowerCase(),d=b.textContent&&b.textContent.toLowerCase();
return e<d?-1:e>d?1:0}var e;d.mixin(g.prototype,{getCategoryIDs:function(){return Object.keys(this.categories)},getCategory:function(a){return this.categories[a]||null}});d.mixin(a.prototype,{createLinkElements:function(){return this.allPageLinks.map(function(a){var b=a.href;a=a.textContent;var e=document.createElement("a");e.href=b;e.target="_self";e.classList.add("targetSelector");e.textContent=a;return e})},getAllLinks:function(){return this.allPageLinks}});return{getCategoriesInfo:function(a){var b;
return!e?(b=[],a.getServiceReferences("orion.page.link.category").forEach(function(e){var d=k(e);if(d.id&&(d.name||d.nameKey))d.service=a.getService(e),d.textContent=d.name,b.push((new r).resolve(d))}),r.all(b).then(function(a){return e=new g(a)})):(new r).resolve(e)},getPageLinksInfo:function(b,c){return m(b,c).then(function(b){return new a(b)})},getOrionHome:b}});y("orion/extensionCommands","orion/Deferred orion/commands orion/contentTypes orion/URITemplate orion/i18nUtil orion/PageLinks i18n!orion/edit/nls/messages orion/URL-shim".split(" "),
function(l,r,p,h,f,d,b){function k(a){var b={};a.getPropertyKeys().forEach(function(c){b[c]=a.getProperty(c)});return b}var m={},g=d.getOrionHome();m._cloneItemWithoutChildren=function n(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),d;for(d in a)"children"!==d&&"Children"!==d&&(b[d]=n(a[d]));return b};m._getOpenWithNavCommandExtensions=function(a,b){function d(a,b){for(var c=a.getServiceReferences("orion.navigate.openWith"),g=[],f=[],k=0;k<c.length;k++){var h=c[k];if(h.getProperty("editor")===
b.id){var n=h.getProperty("contentType");n instanceof Array?g=g.concat(n):g.push(n||"*/*");h=h.getProperty("excludedContentTypes");h instanceof Array?f=f.concat(h):null!==h&&"undefined"!==typeof h&&f.push(h)}}0===g.length&&(g=null);0===f.length&&(f=null);return{contentTypes:g,excludedContentTypes:f}}for(var g=function(){for(var b=a.getServiceReferences("orion.edit.editor"),c=[],d=0;d<b.length;d++){var g=b[d],f=g.getProperty("id");c.push({id:f,"default":g.getProperty("default")||!1,name:g.getProperty("name"),
nameKey:g.getProperty("nameKey"),nls:g.getProperty("nls"),uriTemplate:g.getProperty("orionTemplate")||g.getProperty("uriTemplate"),validationProperties:g.getProperty("validationProperties")||[]})}return c}(),f=[],k,h=0;h<g.length;h++){var m=g[h],l=d(a,m),l={properties:{name:m.name||m.id,nameKey:m.nameKey,id:"eclipse.openWithCommand."+m.id,contentType:l.contentTypes,excludedContentTypes:l.excludedContentTypes,uriTemplate:m.uriTemplate,nls:m.nls,forceSingleItem:!0,isEditor:m["default"]?"default":"editor",
validationProperties:m.validationProperties},service:{}};"orion.editor"===m.id?k=l:f.push(l)}k&&f.push(k);return f};m._makeValidator=function(a,b,d,f){function k(a,b,c,d,g){var f=!1,h;if("!"===b.charAt(0))return"undefined"===typeof a[b.substring(1)];if("undefined"!==typeof a[b]){if("undefined"===typeof c)h=a[b],f=!0;else if("string"===typeof c){if(!typeof("string"===a[b]))return!1;if(d.variableName){if(c=RegExp(c).exec(a[b]))f=c[0],h="before"===d.variableMatchPosition?a[b].substring(0,c.index):"after"===
d.variableMatchPosition?a[b].substring(c.index+f.length):"only"===d.variableMatchPosition?f:a[b],f=!0}else return RegExp(c).test(a[b])}else a[b]===c&&(h=a[b],f=!0);b=d.variableName;d=d.replacements;if(f&&b&&(g[b]=h,g.itemCached=a,d)){if("string"!==typeof h)return window.console.log("Cannot replace "+b+", value is not a string: "+h),f;for(a=0;a<d.length;a++){h=!1;if(d[a].pattern){c=d[a].pattern;var n=d[a].replacement||"";g[b]=g[b].replace(RegExp(c),n).replace(RegExp(c),n)}else h=!0;h&&window.console.log("Invalid replacements specified in validation property.  "+
d[a])}}return f}return!1}function m(a,b,c,d){var g=c.match,f,h;if(0<=(f=b.indexOf("["))){if(0>(h=b.indexOf("]")))return!1;var n=b.substring(0,f),l;if(!(l=a[n])||!Array.isArray(l))return!1;f=b.substring(f+1,h);f=parseInt(f,10);if(isNaN(f))return!1;0>f&&(f+=l.length);b=b.substring(h+1);b=n+":"+String(f)+b}return 0<=b.indexOf("|")?(f=b.substring(0,b.indexOf("|")),b=b.substring(b.indexOf("|")+1),m(a,f,c,d)?!0:m(a,b,c,d)):0<=b.indexOf(":")?(f=b.substring(0,b.indexOf(":")),b=b.substring(b.indexOf(":")+
1),a[f]?m(a[f],b,c,d):!1):k(a,b,g,c,d)}function l(b,c,d){if(d.info.validationProperties)for(var g=0;g<d.info.validationProperties.length;g++){var f=d.info.validationProperties[g];if("undefined"!==typeof f.source){if(!m(b,f.source,f,d))return!1}else return window.console.log("Invalid validationProperties in "+a.id+".  No source property specified."),!1}if(!d.info.contentType&&!d.info.excludedContentTypes)return!0;if(b.Directory)return d.info.contentType&&0<=d.info.contentType.indexOf("*/*")?!0:!1;
var g=!0,k=c?p.getFilenameContentType(b.Name,c):null,k=k||{id:"application/octet-stream"};d.info.excludedContentTypes&&c&&(g=d.info.excludedContentTypes.every(function(a){a=a.replace(/([*?])/g,".$1");return-1!==k.id.search(a)?!1:!0}));g&&(d.info.contentType&&c)&&(g=d.info.contentType.some(function(a){a=a.replace(/([*?])/g,".$1");return-1!==k.id.search(a)?!0:!1}));return g}return{info:a,validationFunction:function(a){"function"===typeof f&&(a=f.call(this,a));if(a){if(Array.isArray(a)){if((this.info.forceSingleItem||
this.info.uriTemplate)&&1!==a.length||1>a.length)return!1}else a=[a];for(var b=0;b<a.length;b++)if(!l(a[b],d,this))return!1;return!0}return!1},generatesURI:function(){return!!this.info.uriTemplate},getURI:function(a){if(this.info.uriTemplate){var b={},c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);if(this.info.validationProperties)for(c=0;c<this.info.validationProperties.length;c++){var d=this.info.validationProperties[c];d.source&&d.variableName&&(this.itemCached===a&&this[d.variableName]||
m(a,d.source,d,this),a[d.variableName]?window.console.log("Variable name "+d.variableName+" in the extension "+this.info.id+" conflicts with an existing property in the item metadata."):b[d.variableName]=this[d.variableName])}b.OrionHome=g;return(new h(this.info.uriTemplate)).expand(b)}return null}}};var a=b.UnnamedCommand;m._createCommandOptions=function(b,c,d,g,f,k){var h=new l;(function(a,h){var l=m._makeValidator(b,d,g,k);a.visibleWhen=l.validationFunction.bind(l);f&&(l.generatesURI.bind(l)()?
a.hrefCallback=function(a){a=Array.isArray(a.items)?a.items[0]:a.items;return l.getURI.bind(l)(a)}:a.callback=function(g){var f;if(b.forceSingleItem)g=Array.isArray(g.items)?g.items[0]:g.items,f=m._cloneItemWithoutChildren(g);else if(Array.isArray(g.items)){f=[];for(var k=0;k<g.items.length;k++)f.push(m._cloneItemWithoutChildren(g.items[k]))}else f=m._cloneItemWithoutChildren(g.items);if(d)var h=d.getService("orion.page.progress");c.run?h?h.progress(c.run(f),"Running command: "+a.name):c.run(f):d&&
(h?h.progress(d.getService(c).run(f),"Running command: "+a.name):d.getService(c).run(f))});h.resolve(a)})({name:b.name||b.nameKey||a,image:b.image,id:b.id||b.name,tooltip:b.tooltip||b.tooltipKey||"",isEditor:b.isEditor,showGlobally:b.showGlobally},h);return h};m.getOpenWithCommand=function(a,b,d){var g;a=d||m.getOpenWithCommands(a);for(d=0;d<a.length;d++)if(a[d].visibleWhen(b)){var f="default"===a[d].isEditor;if(!g||f)if(g=a[d],f)break}return g};m.getOpenWithCommands=function(a){var b=[],d;for(d in a._commandList){var g=
a._commandList[d];g.isEditor&&b.push(g)}return b};var s;m.createAndPlaceFileCommandsExtension=function(a,c,d,g,f,k){return m.createFileCommands(a,null,k?"all":void 0,!!k,c).then(function(a){f&&0<a.length&&(c.addCommandGroup(d,"eclipse.openWith",1E3,b.OpenWith,f,null,null,null,"dropdownSelection"),c.addCommandGroup(d,"eclipse.fileCommandExtensions",1E3,b.OpenRelated,f));a.forEach(function(a){var b=null;f&&(b=a.isEditor?f+"/eclipse.openWith":f+"/eclipse.fileCommandExtensions");c.registerCommandContribution(d,
a.id,g,b)});return{}})};m.createFileCommands=function(a,b,d,g,f){d=void 0===d?"global":d;g=void 0===g?!0:g;var k=[];m._cachedFileCommands||m._createCachedFileCommands(a);("all"===d||"global"===d)&&m._cachedFileCommands.forEach(function(a){var b=a.properties;("all"===d||b.forceSingleItem&&b.showGlobally)&&k.push(a)});return l.when(function(){var d=a.getService("orion.core.contentTypeRegistry")||b;return s||l.when(d.getContentTypes(),function(a){return s=a})}(),function(){g&&(m._cachedOpenWithExtensions||
(m._cachedOpenWithExtensions=m._getOpenWithNavCommandExtensions(a,s)),k=k.concat(m._cachedOpenWithExtensions),f._addedOpenWithCommands=g);var b=k.map(function(b){var c=b.properties;b=b.service;var d=f.findCommand(c.id||c.name);return d?(new l).resolve(d):m._createCommandOptions(c,b,a,s,!0).then(function(a){a=new r.Command(a);f.addCommand(a);return a})});return l.all(b,function(a){return{_error:a}}).then(function(a){return a})})};m._createCachedFileCommands=function(a){var b=a.getServiceReferences("orion.navigate.command");
m._cachedFileCommands=[];for(var d=0;d<b.length;d++)if("orion.navigateFromMetadata"!==b[d].getProperty("id")){var g=a.getService(b[d]),f=k(b[d]);m._cachedFileCommands.push({properties:f,service:g})}};m.getFileCommandIds=function(){var a=[];if(m._cachedFileCommands)m._cachedFileCommands.length&&(a=m._cachedFileCommands.map(function(a){return a.properties.id}));else throw"extensionCommandUtils._cachedFileCommands is not initialized";return a};m.createOpenWithCommands=function(a,b,d){return d&&d._addedOpenWithCommands?
(new l).resolve(m.getOpenWithCommands(d)):m.createFileCommands(a,b,"none",!0,d)};return m});y("orion/searchUtils",["i18n!orion/nls/messages","require","orion/regex","orion/URITemplate"],function(l,r,p,h){function f(b,d,f){var g="";f&&(g="^");if(g=p.parse("/"+g+b.searchStr+"/"))f=g.pattern,g=g.flags,-1===g.indexOf("i")&&!d.caseSensitive&&(g+="i"),b.regExp={pattern:f,flags:g},b.wildCard=!0}var d={ALL_FILE_TYPE:"*.*",getSearchParams:function(b,f,h){if(b){var g=!0;"*"===f&&(f="");""===f&&(g=h&&h.type!==
d.ALL_FILE_TYPE);if(g)return b.createSearchParams(f,!1,!1,h)}else window.alert(l.NoSearchAvailableErr);return null},generateSearchHelper:function(b,k){var h=b.keyword,g=h,a={};b.fileType&&(b.fileType!==d.ALL_FILE_TYPE&&""===h)&&(g="*."+b.fileType);if(b.regEx)a.searchStr=h,f(a,b,k);else{var l=-1<h.indexOf("*"),e=-1<h.indexOf("?");l&&(h=h.split("*").join(".*"));e&&(h=h.split("?").join("."));!l&&!e&&!b.nameSearch?(a.searchStr=b.caseSensitive?h.split("\\").join(""):h.split("\\").join("").toLowerCase(),
a.wildCard=!1):(a.searchStr=b.caseSensitive?h:h.toLowerCase(),f(a,b,k),a.wildCard=!0)}a.searchStrLength=a.searchStr.length;return{params:b,inFileQuery:a,displayedSearchTerm:g}},convertSearchParams:function(b){void 0!==b.rows&&(b.rows=parseInt(b.rows,10));void 0!==b.start&&(b.start=parseInt(b.start,10));"string"===typeof b.regEx&&(b.regEx="true"===b.regEx.toLowerCase());"string"===typeof b.caseSensitive&&(b.caseSensitive="true"===b.caseSensitive.toLowerCase());"string"===typeof b.nameSearch&&(b.nameSearch=
"true"===b.nameSearch.toLowerCase());void 0!==b.fileNamePatterns&&(b.fileNamePatterns=d.getFileNamePatternsArray(b.fileNamePatterns))},getFileNamePatternsArray:function(b){var d=void 0;b&&(b=b.trim(),b=b.replace(/^(\s*,\s*)+/g,""),b=b.replace(/([^\\]),(\s*,\s*)*/g,"$1/"),b=b.replace(/(\s*\/\s*)/g,"/"),b=b.replace(/\/\/+/g,"/"),b=b.replace(/\/+$/g,""),d=b.split("/"));return d},copySearchParams:function(b,d){var f={},g;for(g in b)if(void 0!==b[g]&&null!==b[g]&&(d||"replace"!==g))f[g]=b[g];return f},
generateFindURLBinding:function(b,d,f,g,a){b={find:d.searchStr,regEx:d.wildCard?!0:void 0,caseSensitive:b.caseSensitive?!0:void 0,replaceWith:"string"===typeof g?g:void 0,atLine:"number"===typeof f?f:void 0};return a?b:","+(new h("{,params*}")).expand({params:b})},convertFindURLBinding:function(b){"string"===typeof b.regEx&&(b.regEx="true"===b.regEx.toLowerCase());"string"===typeof b.caseSensitive&&(b.caseSensitive="true"===b.caseSensitive.toLowerCase());"string"===typeof b.atLine&&(b.atLine=parseInt(b.atLine,
10))},replaceRegEx:function(b,d,f){return b.replace(RegExp(d.pattern,d.flags),f)},replaceStringLiteral:function(b,f,h){f=p.parse("/"+f+"/gim");return d.replaceRegEx(b,f,h)},searchOnelineLiteral:function(b,d,f){var g;g=0;for(var a=!1,h=[];!(g=d.indexOf(b.searchStr,g),0>g);){h.push({startIndex:g,length:b.searchStrLength});a=!0;if(f)break;g+=b.searchStrLength}return a?h:null},findRegExp:function(b,d,f,g){if(!d)return null;f=f||"";f+=(-1===f.indexOf("g")?"g":"")+(-1===f.indexOf("m")?"m":"");var a=null;
return(a=RegExp(d,f).exec(b.substring(g)))&&{startIndex:a.index+g,length:a[0].length}},searchOnelineRegEx:function(b,f,h){for(var g=0,a=!1,l=[];;)if(g=d.findRegExp(f,b.regExp.pattern,b.regExp.flags,g)){l.push(g);a=!0;if(h)break;g=g.startIndex+g.length}else break;return a?l:null},generateNewContents:function(b,f,h,g,a,l){if(g&&f){b||(h.contents=[]);for(var e=0;e<f.length;e++){for(var n=f[e],c=!1,u=!1,t=[],p,r=0,E=0;E<g.children.length;E++)if(g.children[E].lineNumber-1===e){r=E;for(c=0;c<g.children[E].matches.length;c++)!1!==
g.children[E+c].checked&&t.push(c);u=0<t.length;p=g.children[E].matches;c=!0;break}if(c){if(u){t=d.replaceCheckedMatches(n,a,p,t,l);n=t.replacedStr;for(c=0;c<g.children[r].matches.length;c++)g.children[r+c].newMatches=t.newMatches}else for(c=0;c<g.children[r].matches.length;c++)g.children[r+c].newMatches=g.children[r+c].matches;b?h.contents[e]=n:h.contents.push(n)}else b||h.contents.push(n)}}},generateMatchContext:function(b,d,f){var g=[],a=2*b+1,h;d.length<=a?(h=0,b=d.length-1):(h=f-b,0>h?(h=0,b=
h+a-1):(b=f+b,b>d.length-1&&(b=d.length-1,h=b-a+1)));for(a=h;a<=b;a++)g.push({context:d[a],current:a===f});return g},splitFile:function(b){for(var d=0,f=0,g=0,a=0,h=[];;){-1!==d&&d<=g&&(d=b.indexOf("\r",g));-1!==f&&f<=g&&(f=b.indexOf("\n",g));if(-1===f&&-1===d){h.push(b.substring(a));break}var e=1;-1!==d&&-1!==f?d+1===f?(e=2,g=f+1):g=(d<f?d:f)+1:g=-1!==d?d+1:f+1;h.push(b.substring(a,g-e));a=g}return h},searchWithinFile:function(b,f,h,g,a,l){h=d.splitFile(h);a&&(f.contents=h);if(f){f.children=[];for(var e=
g=0;e<h.length;e++){var n=h[e];if(n&&0<n.length){var c=l?n:n.toLowerCase();if(c=b.wildCard?d.searchOnelineRegEx(b,c):d.searchOnelineLiteral(b,c)){var u,t=e+1;if(a)for(var p=0;p<c.length;p++)u=p+1,u={parent:f,checked:f.checked,type:"detail",matches:c,lineNumber:t,matchNumber:u,name:n,location:f.location+"-"+t+"-"+u},f.children.push(u);else u={parent:f,context:d.generateMatchContext(2,h,e),checked:f.checked,type:"detail",matches:c,lineNumber:t,name:n,location:f.location+"-"+t},f.children.push(u);g+=
c.length}}}f.totalMatches=g}},replaceCheckedMatches:function(b,d,f,g,a){for(var h=0,e="",n=[],c=0;c<f.length;c++){h!==f[c].startIndex&&(e+=b.substring(h,f[c].startIndex));f[c].length&&(a=f[c].length);for(var h=!1,l=0;l<g.length;l++)if(g[l]===c){h=!0;break}h?(n.push({startIndex:e.length,length:d.length}),e+=d):(n.push({startIndex:e.length,length:a}),e+=b.substring(f[c].startIndex,f[c].startIndex+a));h=f[c].startIndex+a}h<b.length&&(e+=b.substring(h));return{replacedStr:e,newMatches:n}},fullPathNameByMeta:function(b){var d=
b.length,f="";if(0<d)for(d-=1;-1<d;d--)f=f+(""===f?"":"/")+b[d].Name;return f}};return d});y("orion/editorCommands","i18n!orion/edit/nls/messages orion/i18nUtil orion/webui/littlelib orion/webui/dialogs/OpenResourceDialog orion/widgets/input/DropDownMenu orion/Deferred orion/URITemplate orion/commands orion/keyBinding orion/commandRegistry orion/extensionCommands orion/contentTypes orion/searchUtils orion/objects orion/PageUtil orion/PageLinks orion/editor/annotations orion/regex orion/uiUtils orion/util".split(" "),
function(l,r,p,h,f,d,b,k,m,g,a,s,e,n,c,u,t,v,A,E){function z(a){var c=new b(a.uriTemplate),e=a.params||{};e.OrionHome=e.OrionHome||u.getOrionHome();var c=c.expand(e),d=document.createElement("div"),g=document.createElement("iframe");g.id=a.id;g.name=a.id;g.type="text/html";g.sandbox="allow-scripts allow-same-origin allow-forms allow-popups";g.frameborder=void 0!==a.border?a.border:1;g.src=c;g.className="delegatedUI";a.width&&(d.style.width=a.width,g.style.width=a.width);a.height&&(d.style.height=
a.height,g.style.height=a.height);g.style.visibility="hidden";null!==a.parent&&(a.parent||window.document.body).appendChild(d);d.appendChild(g);g.style.left=a.left||(window.innerWidth-parseInt(g.clientWidth,10))/2+"px";g.style.top=a.top||(window.innerHeight-parseInt(g.clientHeight,10))/2+"px";g.style.visibility="";window.addEventListener("message",function H(b){if(b.source===g.contentWindow&&"string"===typeof b.data&&(b=JSON.parse(b.data),"orion.page.delegatedUI"===b.pageService&&b.source===a.id)){if(b.cancelled)a.cancelled&&
a.cancelled();else if(b.result)a.done&&a.done(b.result);else if(b.Status||b.status)a.status&&a.status(b.Status||b.status);window.removeEventListener("message",H,!1);d.parentNode&&d.parentNode.removeChild(d)}},!1);return d}function y(a,b){b&&"undefined"!==typeof b.HTML&&delete b.HTML;var c=a.getService("orion.page.message");if(c)return c.setProgressResult(b).then(null,function(a){console.log(a);throw a;});console.log(b);return(new d).resolve(b)}function B(a){return{_error:a}}function C(a){this.serviceRegistry=
a.serviceRegistry;this.commandService=a.commandRegistry;this.fileClient=a.fileClient;this.inputManager=a.inputManager;this.renderToolbars=a.renderToolbars;this.toolbarId=a.toolbarId;this.saveToolbarId=a.saveToolbarId;this.editToolbarId=a.editToolbarId;this.pageNavId=a.navToolbarId;this.editorContextMenuId=a.editorContextMenuId;this.isReadOnly=a.readonly;this.textSearcher=a.textSearcher;this.searcher=a.searcher;this.localSettings=a.localSettings;this.editorPreferences=a.editorPreferences;this.differ=
a.differ;this.blamer=a.blamer;var b=this;this.listener={onServiceAdded:function(a){b._onServiceAdded(a.serviceReference)},onServiceRemoved:function(a){b._onServiceRemoved(a.serviceReference)}};this.serviceRegistry.addEventListener("registered",this.listener.onServiceAdded);this.serviceRegistry.addEventListener("unregistering",this.listener.onServiceRemoved)}var q={},w=null;q.createDelegatedUI=z;C.prototype={createCommands:function(){this._createSettingsCommand();this._createSearchFilesCommand();this._createGotoLineCommnand();
this._createFindCommnand();this._createBlameCommand();this._createDiffCommand();this._createShowTooltipCommand();this._createUndoStackCommands();this._createSaveCommand();return this._createEditCommands()},getEditCommands:function(){var a=[],b=this.commandService,c;for(c in b._commandList){var e=b._commandList[c];e.editInfo&&a.push(e)}return a},updateCommands:function(a){a=a||{};this.editor=a.editor;this.inputManager=a.inputManager;this.localSettings=a.localSettings;this.differ=a.differ;this.blamer=
a.blamer;this.textSearcher=a.textSearcher;this._recreateEditCommands&&this._createEditCommands().then(function(){this.registerCommands();this.registerContextMenuCommands();this.renderToolbars&&this.renderToolbars()}.bind(this))},registerCommands:function(){function a(b){if(!b)return null;var c=new m.KeyBinding;m.KeyBinding.apply(c,b);return c}var b=this.commandService;b.registerCommandContribution("settingsActions","orion.edit.settings",1,null,!1,new m.KeyBinding("s",!0,!0),null,this);b.registerCommandContribution(this.editToolbarId||
this.toolbarId,"orion.edit.undo",400,this.editToolbarId?"orion.menuBarEditGroup/orion.edit.undoGroup":null,!this.editToolbarId,new m.KeyBinding("z",!0),null,this);b.registerCommandContribution(this.editToolbarId||this.toolbarId,"orion.edit.redo",401,this.editToolbarId?"orion.menuBarEditGroup/orion.edit.undoGroup":null,!this.editToolbarId,E.isMac?new m.KeyBinding("z",!0,!0):new m.KeyBinding("y",!0),null,this);b.registerCommandContribution(this.editToolbarId||this.pageNavId,"orion.edit.searchFiles",
1,this.editToolbarId?"orion.menuBarEditGroup/orion.findGroup":null,!this.editToolbarId,new m.KeyBinding("h",!0),null,this);b.registerCommandContribution(this.saveToolbarId||this.toolbarId,"orion.edit.save",1,this.saveToolbarId?"orion.menuBarFileGroup/orion.edit.saveGroup":null,!1,new m.KeyBinding("s",!0),null,this);b.registerCommandContribution(this.editToolbarId||this.pageNavId,"orion.edit.gotoLine",3,this.editToolbarId?"orion.menuBarEditGroup/orion.findGroup":null,!this.editToolbarId,new m.KeyBinding("l",
!E.isMac,!1,!1,E.isMac),new g.URLBinding("gotoLine","line"),this);b.registerCommandContribution(this.editToolbarId||this.pageNavId,"orion.edit.find",0,this.editToolbarId?"orion.menuBarEditGroup/orion.findGroup":null,!this.editToolbarId,new m.KeyBinding("f",!0),new g.URLBinding("find","find"),this);b.registerCommandContribution(this.toolbarId,"orion.edit.blame",1,"orion.menuBarToolsGroup",!1,new m.KeyBinding("b",!0,!0),new g.URLBinding("blame","blame"),this);b.registerCommandContribution(this.toolbarId,
"orion.edit.diff",2,"orion.menuBarToolsGroup",!1,new m.KeyBinding("d",!0,!0),new g.URLBinding("diff","diff"),this);b.registerCommandContribution(this.toolbarId,"orion.edit.showTooltip",3,"orion.menuBarToolsGroup",!1,new m.KeyBinding(113),null,this);for(var c=this.getEditCommands(),e=0,d=100;e<c.length;e++,d++){var f=c[e],k=f.editInfo;k.scopeId?b.registerCommandContribution(k.scopeId,f.id,d,k.scopeId+"Group",k.bindingOnly,a(k.key),null,this):b.registerCommandContribution(this.toolbarId,f.id,d,"orion.menuBarToolsGroup",
k.bindingOnly,a(k.key),null,this)}},registerContextMenuCommands:function(){var a=this.commandService;a.addCommandGroup(this.editorContextMenuId,"orion.editorContextMenuGroup",100,null,null,null,null,null,"dropdownSelection");var b=1;a.registerCommandContribution(this.editorContextMenuId,"orion.edit.undo",b++,"orion.editorContextMenuGroup/orion.edit.undoGroup",!1);a.registerCommandContribution(this.editorContextMenuId,"orion.edit.redo",b++,"orion.editorContextMenuGroup/orion.edit.undoGroup",!1);a.registerCommandContribution(this.editorContextMenuId,
"orion.edit.find",b++,"orion.editorContextMenuGroup/orion.findGroup",!1);a.registerCommandContribution(this.editorContextMenuId,"orion.edit.searchFiles",b++,"orion.editorContextMenuGroup/orion.findGroup",!1);a.registerCommandContribution(this.editorContextMenuId,"orion.edit.gotoLine",b++,"orion.editorContextMenuGroup/orion.findGroup",!1);a.addCommandGroup(this.editorContextMenuId,"orion.editorContextMenuToolsGroup",400,l.Tools,"orion.editorContextMenuGroup");a.registerCommandContribution(this.editorContextMenuId,
"orion.edit.blame",1,"orion.editorContextMenuGroup/orion.editorContextMenuToolsGroup",!1);a.registerCommandContribution(this.editorContextMenuId,"orion.edit.diff",2,"orion.editorContextMenuGroup/orion.editorContextMenuToolsGroup",!1);for(var a=this.getEditCommands(),b=0,c=100;b<a.length;b++,c++)this.commandService.registerCommandContribution(this.editorContextMenuId,a[b].id,c,"orion.editorContextMenuGroup/orion.editorContextMenuToolsGroup")},overwriteKeyBindings:function(a){var b=this;this.editor=
a;if(a.getTextView&&a.getTextView()){var c=a.getTextView();c.setKeyBinding(new m.KeyBinding("s",!0),"save");var e=b.commandService.findCommand("orion.edit.save");c.setAction("save",function(){e.callback.call({inputManager:b.inputManager});return!0},e);c.setAction("gotoLine",function(c){if(c)return a.onGotoLine(c.line-1,0,void 0,c.callback),!0;b.commandService.runCommand("orion.edit.gotoLine");return!0},b.commandService.findCommand("orion.edit.gotoLine"));this.textSearcher&&c.setAction("find",function(a){if(a)return b.textSearcher.show(a),
!0;b.commandService.runCommand("orion.edit.find",null,null,new g.ParametersDescription([new g.CommandParameter("useEditorSelection","text","","true")],{clientCollect:!0}));return!0},b.commandService.findCommand("orion.edit.find"))}},showKeyBindings:function(a){var b=this.editor;if(b&&b.getTextView&&b.getTextView()){var c=b.getTextView(),e=c.getActions(!0).filter(function(a){return(a=c.getActionDescription(a))&&a.name});e.sort(function(a,b){return c.getActionDescription(a).name.localeCompare(c.getActionDescription(b).name)});
a.createHeader(l.Editor);for(var d=function(a){return function(){c.focus();return c.invokeAction(a)}},b={},g,f=0;f<e.length;f++)for(var k=e[f],h=c.getActionDescription(k),n=c.getKeyBindings(k),m=0;m<n.length;m++){g=n[m];var s=A.getUserKeyString(g);g.scopeName?(b[g.scopeName]||(b[g.scopeName]=[]),b[g.scopeName].push({bindingString:s,name:h.name,execute:d(k)})):a.createItem(s,h.name,d(k))}for(var q in b)if(b[q].length){a.createHeader(q);for(e=0;e<b[q].length;e++)g=b[q][e],a.createItem(g.bindingString,
g.name,g.execute)}}},_createSettingsCommand:function(){var a=this,b=new k.Command({imageClass:"core-sprite-wrench",tooltip:l.LocalEditorSettings,id:"orion.edit.settings",visibleWhen:function(b,c){var e=c.handler.editor||a.editor;return e&&e.installed&&c.handler.localSettings},callback:function(c){var e=this.localSettings||a.localSettings,d=b.settingsDropDown;if(!d||d.isDestroyed())d=b.settingsDropDown=new f(c.domNode.parentNode,c.domNode,{noClick:!0,selectionClass:"dropdownSelection",onShow:function(){d.focus()},
onHide:function(){a.editor.focus()}}),d.updateContent=e.show.bind(e),c=d.getContentNode(),c.tabIndex=c.style.marginTop=0;d.click()}});this.commandService.addCommand(b)},_createUndoStackCommands:function(){var a=this,b=new k.Command({name:l.Undo,id:"orion.edit.undo",visibleWhen:function(b,c){var e=c.handler.editor||a.editor;return e&&e.installed},callback:function(){(this.editor||a.editor).getUndoStack().undo()}});this.commandService.addCommand(b);b=new k.Command({name:l.Redo,id:"orion.edit.redo",
visibleWhen:function(b,c){var e=c.handler.editor||a.editor;return e&&e.installed},callback:function(){(this.editor||a.editor).getUndoStack().redo()}});this.commandService.addCommand(b)},_createSearchFilesCommand:function(){var a=this,b=!1,c=new k.Command({name:l.searchFiles,tooltip:l.searchFiles,id:"orion.edit.searchFiles",visibleWhen:function(b,c){var e=c.handler.editor||a.editor,d=c.handler.searcher||a.searcher;return e&&e.installed&&d},callback:function(){var c=this.editor||a.editor;if(!b){var e=
c.getSelection(),e=c.getText(e.start,e.end),d=a.serviceRegistry.getService("orion.page.progress"),g=new h.OpenResourceDialog({searcher:a.searcher,progress:d,searchRenderer:a.searcher.defaultRenderer,nameSearch:!1,title:l.searchFiles,message:l.searchTerm,initialText:e,onHide:function(){b=!1;c.focus()}});window.setTimeout(function(){b=!0;g.show(p.node(a.toolbarId))},0)}}});this.commandService.addCommand(c)},_createSaveCommand:function(){var a=this,b=new k.Command({name:l.Save,tooltip:l.saveFile,imageClass:"core-sprite-save",
id:"orion.edit.save",visibleWhen:function(b,c){var e=c.handler.inputManager||a.inputManager,d=c.handler.editor||a.editor||e&&e.getEditor();return!d||!d.installed||!e||!e.isSaveEnabled()?!1:!0},callback:function(){(this.inputManager||a.inputManager).save()}});this.commandService.addCommand(b)},_createGotoLineCommnand:function(){var a=this,b=new g.ParametersDescription([new g.CommandParameter("line","number",l.gotoLinePrompt)],{hasOptionalParameters:!1},function(b){b=b.handler.editor||a.editor;b=b.getModel().getLineAtOffset(b.getCaretOffset())+
1;return[new g.CommandParameter("line","number",l.gotoLinePrompt,b.toString())]}),b=new k.Command({name:l.gotoLine,tooltip:l.gotoLineTooltip,id:"orion.edit.gotoLine",visibleWhen:function(b,c){var e=c.handler.editor||a.editor;return e&&e.installed},parameters:b,callback:function(b){var c=this.editor||a.editor,e=c.getModel();b.parameters&&b.parameters.valueFor("line")?b=b.parameters.valueFor("line"):(b=e.getLineAtOffset(c.getCaretOffset()),(b=prompt(l.gotoLinePrompt,b+1))&&(b=parseInt(b,10)));if(b)c.onGotoLine(b-
1,0)}});this.commandService.addCommand(b)},_createFindCommnand:function(){var a=this,b=new g.ParametersDescription([new g.CommandParameter("find","text","Find:")],{clientCollect:!0},function(b){var c=b.handler.editor||a.editor;b=b.handler.textSearcher||a.textSearcher;var e=c.getSelection(),d="";e.end>e.start&&(d=c.getModel().getText(e.start,e.end),b&&b.getOptions().regex&&(d=v.escape(d)));return[new g.CommandParameter("find","text","Find:",d)]}),d=new k.Command({name:l.Find,tooltip:l.Find,id:"orion.edit.find",
visibleWhen:function(b,c){var e=c.handler.editor||a.editor,d=c.handler.textSearcher||a.textSearcher;return e&&e.installed&&d},parameters:b,callback:function(b){var g=p.node("replaceCompareDiv");if(g&&g.classList.contains("replaceCompareDivVisible"))return!1;var g=this.editor||a.editor,f=this.textSearcher||a.textSearcher;d.textSearcher&&d.textSearcher!==f&&d.textSearcher.hide();d.textSearcher=f;var k="",h=null,n=g.getSelection();n.end>n.start&&b.parameters.valueFor("useEditorSelection")?(k=g.getModel().getText(n.start,
n.end),f.getOptions().regex&&(k=v.escape(k))):b.parameters&&b.parameters.valueFor("find")&&(k=b.parameters.valueFor("find"),h=c.matchResourceParameters(),e.convertFindURLBinding(h));h?(f.setOptions({regex:h.regEx,caseInsensitive:!h.caseSensitive}),b={},h.atLine&&(b.start=g.getModel().getLineStart(h.atLine-1)),f.show({findString:k,replaceString:h.replaceWith}),f.find(!0,b),a.commandService.closeParameterCollector()):f.show({findString:k})}});this.commandService.addCommand(d)},_createBlameCommand:function(){var a=
this,b=new k.Command({name:l.Blame,tooltip:l.BlameTooltip,id:"orion.edit.blame",parameters:new g.ParametersDescription([new g.CommandParameter("blame","boolean")],{clientCollect:!0}),visibleWhen:function(b,c){var e=c.handler.editor||a.editor,d=c.handler.blamer||a.blamer;return e&&e.installed&&d&&d.isVisible()},callback:function(b){for(var c=!1,e=this.editor||a.editor,d=this.blamer||a.blamer,g=e.getAnnotationModel().getAnnotations();g.hasNext();)if(g.next().type===t.AnnotationType.ANNOTATION_BLAME){c=
!0;break}c=!c;b.parameters&&b.parameters.valueFor("blame")&&(c="true"===b.parameters.valueFor("blame"));c?d.doBlame():e.showBlame([]);e.focus()}});this.commandService.addCommand(b)},_createDiffCommand:function(){var a=this,b=new k.Command({name:l.Diff,tooltip:l.DiffTooltip,id:"orion.edit.diff",visibleWhen:function(b,c){var e=c.handler.editor||a.editor,d=c.handler.differ||a.differ;return e&&e.installed&&d&&d.isVisible()},callback:function(){var b=this.editor||a.editor,c=this.differ||a.differ;c.toggleEnabled();
var e=this.editorPreferences;e.getPrefs(function(a){a.diffService=c.isEnabled();e.setPrefs(a)});b.focus()}});this.commandService.addCommand(b)},_createShowTooltipCommand:function(){var a=this,b=new k.Command({name:l.showTooltip,tooltip:l.showTooltipTooltip,id:"orion.edit.showTooltip",visibleWhen:function(b,c){var e=c.handler.editor||a.editor;return e&&e.installed},callback:function(){var b=this.editor||a.editor,c=b.getTooltip(),e=b.getTextView(),d=e.getCaretOffset(),e=e.getLocationAtOffset(d);c.show({x:e.x,
y:e.y,getTooltipInfo:function(){return b._getTooltipInfo(this.x,this.y)}},!1,!0)}});this.commandService.addCommand(b)},_onServiceRemoved:function(a){-1!==a.getProperty("objectClass").indexOf("orion.edit.command")&&(this._recreateEditCommands=!0)},_onServiceAdded:function(a){-1!==a.getProperty("objectClass").indexOf("orion.edit.command")&&(this._recreateEditCommands=!0)},_createEditCommands:function(){var b=this;this._recreateEditCommands=!1;var c=this.serviceRegistry,e=this.commandService,g=c.getServiceReferences("orion.edit.command"),
f=c.getService("orion.page.progress"),h=y.bind(null,c),m=function(a,c,e){var d=e.visibleWhen;e.visibleWhen=function(c,e){var g=e.handler.editor||b.editor,f=e.handler.inputManager||b.inputManager;return!g||(!g.installed||!f)||a.editor&&g.id&&a.editor!==g.id||b.inputManager.getReadOnly()?!1:!d||d(c)};e.callback=function(d){var g=this.editor||b.editor,k=this.inputManager||b.inputManager,m=g.getSelection?g.getSelection():{start:0,end:0},s=g.getModel(),q=function(a){"object"===typeof a&&a?(a.text&&g.setText(a.text),
a.selection&&(g.setSelection&&g.setSelection(a.selection.start,a.selection.end,!0),g.focus())):"string"===typeof a&&(g.setText(a,m.start,m.end,!0),g.setSelection&&g.setSelection(m.start,m.start+a.length),g.focus())};c.execute?(s={contentType:k.getContentType(),input:k.getInput(),offset:g.getCaretOffset()},"orion.edit.quickfix"===a.scopeId&&(s.annotation={start:d.userData.start,end:d.userData.end,title:d.userData.title,id:d.userData.id,data:d.userData.data}),d=g.getEditorContext(),d.openDelegatedUI=
function(){var a=arguments[0],a=a||{};a.done=q;a.status=h;a.params=a.params||{};n.mixin(a.params,k.getFileMetadata());z.apply(null,Array.prototype.slice.call(arguments))},d.setStatus=h,g.focus(),d=c.execute(d,s),s=null):(d=c.run(s.getText(m.start,m.end),s.getText(),m,k.getInput()),s=function(b){if(b&&b.uriTemplate){var c={};c.uriTemplate=b.uriTemplate;c.params=k.getFileMetadata();c.id=a.id;c.width=b.width;c.height=b.height;c.done=q;c.status=h;z(c)}else b&&(b.Status||b.status)?h(b.Status||b.status):
q(b)});f.showWhile(d,r.formatMessage(l.running,e.name)).then(s);return!0};return new k.Command(e)};return d.when(function(a){if(w)return w;var b=a.getService("orion.core.contentTypeRegistry");b||(b=new s.ContentTypeRegistry(a),b=a.getService("orion.core.contentTypeRegistry"));return b.getContentTypes().then(function(a){return w=a})}(this.serviceRegistry),function(){var c=[];g.forEach(function(d){for(var g=b.serviceRegistry.getService(d),f={},k=d.getPropertyKeys(),h=0;h<k.length;h++)f[k[h]]=d.getProperty(k[h]);
f.forceSingleItem=!0;d=a._createCommandOptions(f,d,b.serviceRegistry,w,!1,function(a){return b.inputManager.getFileMetadata()}).then(function(a){a=m(f,g,a);a.editInfo=f;e.addCommand(a);return a});c.push(d)});return d.all(c,B)})}};q.EditorCommandFactory=C;q.handleStatusMessage=y;return q});y("orion/globalCommands",[],function(){return{}});y("orion/edit/dispatcher",["orion/edit/dispatcher"],function(){function l(l,p,h,f){this.serviceRegistry=l;this.editor=h;this.inputManager=f;this.ctRegistry=p;this.serviceReferences=
{};var d=this;this.inputManager.addEventListener("InputChanged",function(b){d.contentType=b.contentType;d.updateListeners()}.bind(this));this.listener={onServiceAdded:function(b){d._onServiceAdded(b.serviceReference)},onServiceRemoved:function(b){d._onServiceRemoved(b.serviceReference)}};this.serviceRegistry.addEventListener("registered",this.listener.onServiceAdded);this.serviceRegistry.addEventListener("unregistering",this.listener.onServiceRemoved)}l.prototype={updateListeners:function(){this._removeAllListeners();
for(var l=this.serviceRegistry.getServiceReferences("orion.edit.model"),p=0;p<l.length;p++)this._wireServiceReference(l[p])},_wireServiceReference:function(l){var p=l.getProperty("contentType");"undefined"!==typeof p&&null!==p&&this.ctRegistry.isSomeExtensionOf(this.contentType,p)&&this._wireService(l,this.serviceRegistry.getService(l))},_wireService:function(l,p){var h=this.editor.getTextView();if(!h)throw Error("TextView not installed");for(var f=Object.keys(p),d=0;d<f.length;d++){var b=f[d],k=
p[b];"on"!==b.substr(0,2)||"function"!==typeof k||(b=b.substr(2),this._wireServiceMethod(l,p,k,h,b))}},_wireServiceMethod:function(l,p,h,f,d){var b=this;p=function(d){d.file=b.getServiceFileObject();h(d).then()};l=l.getProperty("service.id");this.serviceReferences[l]=this.serviceReferences[l]||[];this.serviceReferences[l].push([f,d,p]);f.addEventListener(d,p)},_onServiceRemoved:function(l){l=l.getProperty("service.id");this._removeListeners(l)},_onServiceAdded:function(l){-1!==l.getProperty("objectClass").indexOf("orion.edit.model")&&
this._wireServiceReference(l)},_removeListeners:function(l){var p=this.serviceReferences[l];if(p){for(var h=0;h<p.length;h++){var f=p[h];f[0].removeEventListener(f[1],f[2])}delete this.serviceReferences[l]}},_removeAllListeners:function(){for(var l=Object.keys(this.serviceReferences),p=0;p<l.length;p++)this._removeListeners(l[p])},getServiceFileObject:function(){var r=this.inputManager.getFileMetadata();return!r?null:l.toServiceFileObject(r,this.inputManager.getContentType())}};l.toServiceFileObject=
function(l,p){var h=Object.create(null);h.name=l.Name;h.location=l.Location;p&&(h.contentType=Object.create(null),h.contentType.id=p.id,h.contentType.name=p.name,h.contentType.imageClass=p.imageClass,h.contentType.extension=p.extension);return h};return{Dispatcher:l}});y("orion/edit/editorContext",[],function(){return{getEditorContext:function(l,r){var p=Object.create(null);l.getServiceReferences(r||"orion.edit.context").forEach(function(h){var f=l.getService(h);Object.keys(f).forEach(function(d){"function"===
typeof f[d]&&(p[d]=f[d].bind(f))})});return p},getOptions:function(l,r){var p=Object.create(null);l.getServiceReferences(r||"orion.edit.context").forEach(function(h){h.getPropertyKeys().forEach(function(f){"service.id"!==f&&("service.names"!==f&&"objectClass"!==f)&&(p[f]=h.getProperty(f))})});return p}}});y("orion/serviceTracker",[],function(){function l(h,f){function d(a){var b=a.getProperty("service.id"),c=this.addingService(a);c&&(k[b]=a,m[b]=c)}function b(a){var b=a.getProperty("service.id"),
c=m[b];delete k[b];delete m[b];this.removedService(a,c)}this.serviceRegistry=h;var k={},m={},g=r,a,l;this.close=function(){if(g!==p)throw"Already closed";g=r;h.removeEventListener("registered",a);h.removeEventListener("unregistering",l);l=a=null;var e=this;this.getServiceReferences().forEach(function(a){b.call(e,a)});if("function"===typeof this.onClose)this.onClose()};this.getServiceReferences=function(){var a=Object.keys(k);return!a.length?null:a.map(function(a){return k[a]})};this.open=function(){if(g!==
r)throw"Already open";g=p;var e=this;a=function(a){if(-1!==a.serviceReference.getProperty("objectClass").indexOf(f)&&(d.call(e,a.serviceReference),"function"===typeof e.onServiceAdded))return e.onServiceAdded(a.serviceReference,e.serviceRegistry.getService(a.serviceReference))};l=function(a){-1!==a.serviceReference.getProperty("objectClass").indexOf(f)&&b.call(e,a.serviceReference)};h.addEventListener("registered",a);h.addEventListener("unregistering",l);h.getServiceReferences(f).forEach(function(a){d.call(e,
a);if("function"===typeof e.onServiceAdded)return e.onServiceAdded(a,h.getService(a))});if("function"===typeof this.onOpen)this.onOpen()}}var r=0,p=1;l.prototype={addingService:function(h){return this.serviceRegistry.getService(h)},onOpen:null,onClose:null,onServiceAdded:null,removedService:function(h,f){}};return l});y("orion/edit/typedefs",["orion/objects","orion/serviceTracker","orion/i18nUtil"],function(l,r,p){function h(f){this.props=Object.create(null);this.defs=Object.create(null);this.registration=
null;var d=new r(f,"orion.core.typedef"),b=this;d.onServiceAdded=function(d){var f=d.getProperty("id"),g=d.getProperty("defs");if(!f||!g)throw Error(p.formatMessage("${0} [service id: ${1}]","TypeDef registration missing required 'id' or 'defs'",d.getProperty("service.id")));var a={};d.getPropertyKeys().forEach(function(b){"defs"!==b&&("service.id"!==b&&"service.names"!==b&&"objectClass"!==b)&&(a[b]=d.getProperty(b))});b.props[f]=a;b.defs[f]=g;b._updateRegistration()};d.removedService=function(d){d=
d.getProperty("id");delete b.props[d];delete b.defs[d];b._updateRegistration()};d.open();this.registration=f.registerService("orion.edit.context",{getTypeDef:this.getTypeDef.bind(this)},null);this._updateRegistration()}l.mixin(h.prototype,{_updateRegistration:function(){this.registration&&this.registration.setProperties({typeDefs:this.getAllProperties()})},getTypeDef:function(f){return this.defs[f]||null},getProperties:function(f){return this.props[f]||null},getAllProperties:function(){return this.props}});
return h});y("examples/editor/textStyler",[],function(){return{}});y("orion/editor/textStyler",["orion/editor/annotations","orion/editor/eventTarget","orion/metrics"],function(l,r,p){function h(b,a,d){this._patternManager=new f(b,a);this._contentType=d}function f(b,a){this._unnamedCounter=0;this._patterns=[];this._rootId=a;b.forEach(function(a){this._addRepositoryPatterns(a.repository||{},a.id);this._addPatterns(a.patterns||[],a.id)}.bind(this))}function d(b,a,d,e,f,c,k){this.start=b.start;this.end=
b.end;this.contentStart=b.contentStart;this.contentEnd=b.contentEnd;this.name=a;this.typeId=d;this.styler=e;this.parent=c;k&&k(this);this._subBlocks=e.computeBlocks(f,f.getText(this.contentStart,this.end),this,this.contentStart,null,null,null)}function b(b){this._styler=b}function k(d,a,f){this._highlightCaretLine=this._whitespacesVisible=!1;this._detectTasks=this._foldingEnabled=!0;this._annotationProviders=[];this._view=d;this._annotationModel=a;this._stylerAdapter=f;this._stylerAdapter.setStyler(this);
this._accessor=new b(this);this._bracketAnnotations;var e=this;this._listener={onChanged:function(a){e._onModelChanged(a)},onDestroy:function(a){e._onDestroy(a)},onLineStyle:function(a){e._onLineStyle(a)},onMouseDown:function(a){e._onMouseDown(a)},onSelection:function(a){e._onSelection(a)}};var k=d.getModel();k.getBaseModel&&(k=k.getBaseModel());k.addEventListener("Changed",this._listener.onChanged);d.addEventListener("MouseDown",this._listener.onMouseDown);d.addEventListener("Selection",this._listener.onSelection);
d.addEventListener("Destroy",this._listener.onDestroy);d.addEventListener("LineStyle",this._listener.onLineStyle);var c=k.getCharCount(),h={start:0,contentStart:0,end:c,contentEnd:c};if(5E4<=c)var m=(new Date).getTime();this._rootBlock=this._stylerAdapter.createBlock(h,this,k,null);m&&(h=(new Date).getTime()-m,10<h&&p.logTiming("editor","styler compute blocks (ms/50000 chars)",5E4*h/c,f.getContentType()));a&&(f=[],a.removeAnnotations(l.AnnotationType.ANNOTATION_FOLDING),this._computeFolding(this._rootBlock.getBlocks(),
d.getModel(),f),this._detectTasks&&(a.removeAnnotations(l.AnnotationType.ANNOTATION_TASK),this._computeTasks(this._rootBlock,k,f)),a.replaceAnnotations([],f));d.redrawLines()}var m=function(b,a,d,e,f){var c;void 0===e&&(e=-1);void 0===f&&(f=b.length);for(;1<f-e;)if(c=Math.floor((f+e)/2),a<=b[c].start)f=c;else if(d&&a<b[c].end){f=c;break}else e=c;return f};h.prototype={blockSpansBeyondEnd:function(b){return b.pattern.regexEnd===this._eolRegex},computeBlocks:function(b,a,d,e,f,c,k){if(!a)return[];var h=
[],m=[],l;f=f||0;c=c||Infinity;k=k||Infinity;d.blockPatterns.forEach(function(b){(l=this._findMatch(b.regexBegin||b.regex,a,f))&&m.push({result:l,pattern:b})}.bind(this));if(!m.length)return h;m.sort(function(a,b){return a.result.index<b.result.index?-1:a.result.index>b.result.index?1:a.pattern.pattern.index<b.pattern.pattern.index?-1:1});for(var p=0;0<m.length;){var r=m[0];m.splice(0,1);if(c<r.result.index)break;if(!(r.result.index<p)){var p=e+r.result.index,y=r.result.index,B=null,C=r.pattern.regexEnd;
if(C){var y=y+r.result[0].length,q=r.pattern,w=this._substituteCaptureValues(C,r.result);w!==C&&(q={pattern:q.pattern,regexBegin:q.regexBegin,regexEnd:w},C=w);for(w=y;!B;){l=this._findMatch(C,a,w);l||(this._eolRegex.lastIndex=0,l=this._eolRegex.exec(a),q={pattern:q.pattern,regexBegin:q.regexBegin,regexEnd:this._eolRegex});var w=this.createBlock({start:p,end:e+l.index+l[0].length,contentStart:e+y,contentEnd:e+l.index},d.styler,b,d,q),x=w.getBlocks();if(!x.length||x[x.length-1].end<=l.index+e)B=w;w=
l.index+l[0].length}}else B=this.createBlock({start:p,end:p+r.result[0].length,contentStart:p,contentEnd:p+r.result[0].length},d.styler,b,d,r.pattern);h.push(B);if(h.length===k||c<=B.end)break;p=B.end-e}this._updateMatch(r,a,m,p,c)}return h},computeStyle:function(b,a,d){if(!b.pattern)return null;var e={start:b.start,end:b.end,style:b.pattern.pattern.name};if(b.contentStart<=d&&d<b.contentEnd)return b.pattern.pattern.contentName?{start:b.contentStart,end:b.contentEnd,style:b.pattern.pattern.contentName}:
e;var f,c;if(d<b.contentStart){c=b.pattern.pattern.beginCaptures||b.pattern.pattern.captures;if(!c)return e;f=b.pattern.regexBegin;a=a.getText(b.start,b.contentStart);b=b.start}else{c=b.pattern.pattern.endCaptures||b.pattern.pattern.captures;if(!c)return e;f=b.pattern.regexEnd;a=a.getText(b.contentEnd,b.end);b=b.contentEnd}f.lastIndex=0;if(f=f.exec(a))if(a=[],this._getCaptureStyles(f,c,b,a),(c=a[m(a,d,!0)])&&c.start<=d&&d<c.end)return c;return e},createBlock:function(b,a,f,e,k){return new d(b,k?k.pattern.name:
null,k?k.pattern.id:null,a,f,e,function(a){a.pattern=k;a.linePatterns=[];a.blockPatterns=[];a.enclosurePatterns={};this._initPatterns(this._patternManager,a)}.bind(this))},getBlockContentStyleName:function(b){return b.pattern.pattern.contentName||b.pattern.pattern.name},getBlockEndStyle:function(b,a,d,e){var f;if(b.pattern.regexEnd&&(f=this._findMatch(b.pattern.regexEnd,a,0)))(a=b.pattern.pattern.endCaptures||b.pattern.pattern.captures)?this._getCaptureStyles(f,a,d-f[0].length,e):b.pattern.pattern.name&&
e.push({start:d-f[0].length,end:d,style:b.pattern.pattern.name});return f?f[0]:null},getBlockFoldBounds:function(b,a){return{start:b.start,end:b.end}},getBlockStartStyle:function(b,a,d,e){var f;if(b.pattern.regexBegin&&(f=this._findMatch(b.pattern.regexBegin,a,0)))(a=b.pattern.pattern.beginCaptures||b.pattern.pattern.captures)?this._getCaptureStyles(f,a,d,e):e.push({start:d,end:d+f[0].length,style:b.pattern.pattern.name});return f?f[0]:null},getBracketMatch:function(b,a){for(var d,e=Object.keys(b.enclosurePatterns),
f=0;f<e.length;f++){var c=b.enclosurePatterns[e[f]],k=this._findMatch(c.regex,a,0);if(k&&0===k.index){d=c;break}}if(!d)return null;f=!1;-1!==d.pattern.name.indexOf(this._PUNCTUATION_SECTION_BEGIN)?(f=!0,e=d.pattern.name.replace(this._PUNCTUATION_SECTION_BEGIN,this._PUNCTUATION_SECTION_END)):e=d.pattern.name.replace(this._PUNCTUATION_SECTION_END,this._PUNCTUATION_SECTION_BEGIN);return!b.enclosurePatterns[e]?null:{beginName:d.pattern.name,endName:e,atStart:f}},getContentType:function(){return this._contentType},
parse:function(b,a,d,e,f,c){if(b&&(e=e.linePatterns)){var k=[],h;e.forEach(function(a){var c=a.regex||a.regexBegin;c.oldLastIndex=c.lastIndex;(h=this._findMatch(c,b,d))&&k.push({result:h,pattern:a})}.bind(this));k.sort(function(a,b){return a.result.index<b.result.index?-1:a.result.index>b.result.index?1:a.pattern.pattern.index<b.pattern.pattern.index?-1:1});for(var m=d;0<k.length;){var l=k[0];k.splice(0,1);if(!(l.result.index<m)){var p=l.result.index,r,m=[];if(l.pattern.regex){h=l.result;r=p+h[0].length;
r={start:a+p,end:a+r,style:l.pattern.pattern.name};if(!c){l.pattern.pattern.captures&&this._getCaptureStyles(h,l.pattern.pattern.captures,a+p,m);m.sort(function(a,b){return a.start<b.start?-1:a.start>b.start?1:0});for(p=0;p<m.length-1;p++)if(m[p+1].start<m[p].end){var y={start:m[p+1].end,end:m[p].end,style:m[p].style};m[p].end=m[p+1].start;m.splice(p+2,0,y)}}this._mergeStyles(r,m,f)}else m=l.pattern.regexEnd,m=this._substituteCaptureValues(m,l.result),h=this._findMatch(m,b,l.result.index+l.result[0].length),
h||(this._eolRegex.lastIndex=0,h=this._eolRegex.exec(b)),r=h.index+h[0].length,f.push({start:a+p,end:a+r,style:l.pattern.pattern.name});m=h.index+h[0].length}this._updateMatch(l,b,k,m)}e.forEach(function(a){a=a.regex||a.regexBegin;a.lastIndex=a.oldLastIndex})}},setStyler:function(b){},verifyBlock:function(b,a,d,e){var f=null,c=[],k;d.parent.blockPatterns.forEach(function(b){(k=this._findMatch(b.regexBegin||b.regex,a,0))&&c.push({result:k,pattern:b})}.bind(this));c.sort(function(a,b){return!a.result.index&&
b.result.index?-1:a.result.index&&!b.result.index?1:!a.result.index&&!b.result.index?a.pattern.pattern.index<b.pattern.pattern.index?-1:1:0});if(!c.length||0!==c[0].result.index||c[0].pattern.pattern.id!==d.pattern.pattern.id)f=!1;else{k=c[0];var h=k.pattern.regexEnd;if(h){for(var h=this._substituteCaptureValues(h,k.result),m=k.result[0].length,l=this._findMatch(h,a,m);null===f&&l&&d.start+l.index!==d.contentEnd+e;){var p=this.computeBlocks(b,a,d,d.start,m,l.index+1,null);!p.length||p[p.length-1].end<=
d.start+l.index?f=!1:p.length?(m=p[p.length-1].end-d.start,l=this._findMatch(h,a,m)):l=null}l||(this._eolRegex.lastIndex=0,l=this._eolRegex.exec(a),f=d.start+l.index===d.end+e)}else f=d.start+k.result[0].length===d.end+e}return null!==f?f:!0},_findMatch:function(b,a,d,e){var f=d,c=b.lastIndex;this._linebreakRegex.lastIndex=d;d=this._linebreakRegex.exec(a);var k,h;b.lastIndex=0;if(d){for(h=d.index;0<=--h&&!(k=a.charAt(h),k===this._NEWLINE||k===this._CR););k=a.substring(h+1,d.index+d[1].length);b.lastIndex=
h=d.index-h-1}for(;d&&d.index<a.length;){var m;if(e){var l=b.lastIndex;b.test(k)&&(b.lastIndex=l,m=b.exec(k))}else m=b.exec(k);if(m)return m.index+=f,m.index-=h,b.lastIndex=c,m;h=0;f+=d[0].length;if(d=this._linebreakRegex.exec(a))k=d[1],b.lastIndex=0}b.lastIndex=c;return null},_getCaptureStyles:function(b,a,d,e){if(a[0])e.push({start:d,end:d+b[0].length,style:a[0].name});else for(var f=0,c=1;c<b.length;c++)if(b[c]){var k=a[c];if(k){var h=d+f;e.push({start:h,end:h+b[c].length,style:k.name})}f+=b[c].length}},
_initPatterns:function(b,a){if(a.pattern&&a.pattern.pattern.linePatterns)a.linePatterns=a.pattern.pattern.linePatterns,a.blockPatterns=a.pattern.pattern.blockPatterns,a.enclosurePatterns=a.pattern.pattern.enclosurePatterns;else{var d=b.getPatterns(a.pattern?a.pattern.pattern:null),e=function(a){a="string"===typeof a?a:a.match;var b=this._ignoreCaseRegex.exec(a),c=this._FLAGS;b&&(a=a.substring(b[0].length),c+="i");return RegExp(a,c)}.bind(this),f=-1,c=0;d.forEach(function(b){var d;if(b.match&&!b.begin&&
!b.end){if(d={regex:e(b.match),pattern:b},a.linePatterns.push(d),b.name&&0===b.name.indexOf("punctuation.section")&&(-1!==b.name.indexOf(this._PUNCTUATION_SECTION_BEGIN)||-1!==b.name.indexOf(this._PUNCTUATION_SECTION_END)))a.enclosurePatterns[b.name]=d}else!b.match&&(b.begin&&b.end)&&(f=c,d={regexBegin:e(b.begin),regexEnd:e(b.end),pattern:b},a.linePatterns.push(d));c++}.bind(this));a.blockPatterns=a.linePatterns.slice(0,f+1);a.pattern&&(a.pattern.pattern.enclosurePatterns=a.enclosurePatterns,a.pattern.pattern.linePatterns=
a.linePatterns,a.pattern.pattern.blockPatterns=a.blockPatterns)}},_mergeStyles:function(b,a,d){var e=b.start;a.forEach(function(a){e<=a.start&&d.push({start:e,end:a.start,style:b.style});d.push(a);e=a.end});e<b.end&&d.push({start:e,end:b.end,style:b.style})},_substituteCaptureValues:function(b,a){var d=b.toString();this._captureReferenceRegex.lastIndex=0;if(!this._captureReferenceRegex.test(d))return b;this._captureReferenceRegex.lastIndex=0;for(var e=this._captureReferenceRegex.exec(d);e;)d=d.replace(e[0],
a[e[1]]||""),this._captureReferenceRegex.lastIndex=0,e=this._captureReferenceRegex.exec(d);return RegExp(d.substring(1,d.length-1-this._FLAGS.length),this._FLAGS)},_updateMatch:function(b,a,d,e,f){var c=b.pattern.regex?b.pattern.regex:b.pattern.regexBegin;f=f||Infinity;if((a=this._findMatch(c,a,e,!0))&&a.index<f){b.result=a;for(f=0;f<d.length;f++)if(a.index<d[f].result.index||a.index===d[f].result.index&&b.pattern.pattern.index<d[f].pattern.pattern.index){d.splice(f,0,b);return}d.push(b)}},_captureReferenceRegex:/\\(\d)/g,
_eolRegex:/$/,_ignoreCaseRegex:/^\(\?i\)\s*/,_linebreakRegex:/(.*)(?:[\r\n]|$)/g,_CR:"\r",_FLAGS:"g",_NEWLINE:"\n",_PUNCTUATION_SECTION_BEGIN:".begin",_PUNCTUATION_SECTION_END:".end"};f.prototype={getPatterns:function(b){b?(b="string"===typeof b?b:b.qualifiedId,b+="#"):b=this._rootId+"#"+this._NO_ID;var a=[0],d={},e=RegExp("^"+b+"[^#]+$");this._patterns.forEach(function(b){if(e.test(b.qualifiedId))if(b.include)this._processInclude(b,a,d);else{var g=JSON.parse(JSON.stringify(b));g.index=a[0]++;d[b.qualifiedId]=
g}}.bind(this));var f=[];Object.keys(d).forEach(function(a){f.push(d[a])});return f},_addPattern:function(b,a,d){b.parentId=d;b.id=a;b.qualifiedId=b.parentId+"#"+b.id;this._patterns.push(b);b.patterns&&!b.include&&this._addPatterns(b.patterns,b.qualifiedId)},_addPatterns:function(b,a){b.forEach(function(b){this._addPattern(b,this._NO_ID+this._unnamedCounter++,a)}.bind(this))},_addRepositoryPatterns:function(b,a){Object.keys(b).forEach(function(d){this._addPattern(b[d],d,a)}.bind(this))},_processInclude:function(b,
a,d){var e,f=b.include.indexOf("#");e=0===f?RegExp("^"+b.qualifiedId.substring(0,b.qualifiedId.indexOf("#"))+b.include+"$"):-1===f?RegExp("^"+b.include+"#"+this._NO_ID+"[^#]+$"):RegExp("^"+b.include+"$");this._patterns.forEach(function(b){if(e.test(b.qualifiedId))if(b.include)this._processInclude(b,a,d);else if(!d[b.qualifiedId]){var g=JSON.parse(JSON.stringify(b));g.index=a[0]++;d[b.qualifiedId]=g}}.bind(this))},_NO_ID:"NoID"};d.prototype={adjustBounds:function(b,a){b<this.start&&(this.start+=a);
b<this.contentStart&&(this.contentStart+=a);b<=this.end&&(this.end+=a);b<=this.contentEnd&&(this.contentEnd+=a);this._subBlocks.forEach(function(d){b<=d.end&&d.adjustBounds(b,a)})},getBlocks:function(){return this._subBlocks},getBlockAtIndex:function(b){return m(this.getBlocks(),b,!0)},isRenderingWhitespace:function(){return this.styler._isRenderingWhitespace()}};b.prototype={getStyles:function(b){return this._styler.getStyles(b)}};k.prototype={addAnnotationProvider:function(b){"function"===typeof b&&
this._annotationProviders.push(b)},computeBlocks:function(b,a,d,e,f,c,k){return this._stylerAdapter.computeBlocks(b,a,d,e,f,c,k)},destroy:function(){if(this._view){var b=this._view.getModel();b.getBaseModel&&(b=b.getBaseModel());b.removeEventListener("Changed",this._listener.onChanged);this._view.removeEventListener("MouseDown",this._listener.onMouseDown);this._view.removeEventListener("Selection",this._listener.onSelection);this._view.removeEventListener("Destroy",this._listener.onDestroy);this._view.removeEventListener("LineStyle",
this._listener.onLineStyle);this._view=null}},getAnnotationModel:function(){return this._annotationModel},getBlockAtIndex:function(b){return this._findBlock(this._rootBlock,b)},getRootBlock:function(){return this._rootBlock},getStyleAccessor:function(){return this._accessor},getStyles:function(b){var a=[],d=this._view.getModel();d.getBaseModel&&(d=d.getBaseModel());var e=this._findBlock(this._rootBlock,b),f=d.getLineAtOffset(b),c=d.getLine(f),k=[];this._stylerAdapter.parse(c,d.getLineStart(f),0,e,
k);for((f=k[m(k,b,!0)])&&(f.start<=b&&b<f.end)&&a.push(f);e;)(f=this._stylerAdapter.computeStyle(e,d,b))&&a.splice(0,0,f),e=e.parent;return a},getTextModel:function(){var b=this._view.getModel();b.getBaseModel&&(b=b.getBaseModel());return b},removeAnnotationProvider:function(b){"function"===typeof b&&(b=this._annotationProviders.indexOf(b),-1!==b&&this._annotationProviders.splice(b,1))},setDetectHyperlinks:function(){},setDetectTasks:function(b){this._detectTasks=b},setFoldingEnabled:function(b){this._foldingEnabled=
b},setHighlightCaretLine:function(b){this._highlightCaretLine=b},setWhitespacesVisible:function(b,a){this._whitespacesVisible!==b&&(this._whitespacesVisible=b,a&&this._view.redraw())},_computeFolding:function(b,a,d){if(a.getBaseModel){var e=a.getBaseModel();b.forEach(function(b){var c=this._stylerAdapter.getBlockFoldBounds(b,e);(c=this._createFoldingAnnotation(a,e,c.start,c.end))&&d.push(c);this._computeFolding(b.getBlocks(),a,d)}.bind(this))}},_computeTasks:function(b,a,d,e,f){e=e||b.start;f=f||
b.end;if(b.start<=f&&e<=b.end&&this._annotationModel){var c=l.AnnotationType.ANNOTATION_TASK;if(b.name&&0===b.name.indexOf("comment")){var k=[],h=a.getLineAtOffset(b.contentStart),h=a.getLineStart(h);this._stylerAdapter.parse(a.getText(h,b.end),h,b.contentStart-h,b,k,!0);for(h=0;h<k.length;h++)"meta.annotation.task.todo"===k[h].style&&(e<=k[h].start&&k[h].end<=f)&&d.push(l.AnnotationType.createAnnotation(c,k[h].start,k[h].end,a.getText(k[h].start,k[h].end)))}b.getBlocks().forEach(function(b){this._computeTasks(b,
a,d,e,f)}.bind(this))}},_createFoldingAnnotation:function(b,a,d,e){var f=a.getLineAtOffset(d),c=a.getLineAtOffset(e);return f===c||f+1===c&&a.getLineStart(c)===a.getLineEnd(c)?null:new (l.AnnotationType.getType(l.AnnotationType.ANNOTATION_FOLDING))(d,e,b)},_findBlock:function(b,a){var d=b.getBlocks();if(!d.length)return b;var e=m(d,a,!0);return e<d.length&&d[e].start<=a&&a<d[e].end?this._findBlock(d[e],a):b},_findBrackets:function(b,a,d,e,f,c){for(var k=[],h=[],l=f,p=d.getBlocks(),r=m(p,f,!0);r<p.length&&
!(p[r].start>=c);r++){var z=p[r].start,y=p[r].end;if(l<z){var B=b.getLineAtOffset(l),B=b.getLineStart(B);this._stylerAdapter.parse(e.substring(B-f,z-f),B,l-B,d,h);h.forEach(function(b){b.style&&(0===b.style.indexOf(a.beginName)?k.push(b.start+1):0===b.style.indexOf(a.endName)&&k.push(-(b.start+1)))});h=[]}l=y}l<c&&(B=b.getLineAtOffset(l),B=b.getLineStart(B),this._stylerAdapter.parse(e.substring(B-f,c-f),B,l-B,d,h),h.forEach(function(b){b.style&&(0===b.style.indexOf(a.beginName)?k.push(b.start+1):
0===b.style.indexOf(a.endName)&&k.push(-(b.start+1)))}));return k},_findMatchingBracket:function(b,a,d){var e=b.getLineAtOffset(d),f=b.getLineEnd(e),c=b.getText(d,f),c=this._stylerAdapter.getBracketMatch(a,c);if(!c)return-1;for(var k=b.getLine(e),h=b.getLineStart(e),f=this._findBrackets(b,c,a,k,h,f),m=0;m<f.length;m++)if(k=0<=f[m]?1:-1,f[m]*k-1===d){d=1;if(c.atStart){for(m++;m<f.length;m++)if(k=0<=f[m]?1:-1,d+=k,0===d)return f[m]*k-1;e+=1;for(m=b.getLineCount();e<m;){k=b.getLine(e);h=b.getLineStart(e);
f=b.getLineEnd(e);f=this._findBrackets(b,c,a,k,h,f);for(h=0;h<f.length;h++)if(k=0<=f[h]?1:-1,d+=k,0===d)return f[h]*k-1;e++}}else{for(m--;0<=m;m--)if(k=0<=f[m]?1:-1,d+=k,0===d)return f[m]*k-1;for(e-=1;0<=e;){k=b.getLine(e);h=b.getLineStart(e);f=b.getLineEnd(e);f=this._findBrackets(b,c,a,k,h,f);for(m=f.length-1;0<=m;m--)if(k=0<=f[m]?1:-1,d+=k,0===d)return f[m]*k-1;e--}}break}return-1},_getLineStyle:function(b){if(this._highlightCaretLine){var a=this._view,d=a.getModel(),e=!1;if(!a.getSelections().some(function(a){return a.start===
a.end?(e=e||d.getLineAtOffset(a.start)===b,!1):!0})&&e)return this._caretLineStyle}return null},_getStyles:function(b,a,d,e,f){var c=e+d.length,k=[],h=e+f;f=b.getBlocks();for(var l=m(f,h,!0);l<f.length&&!(f[l].start>=c);l++){var p=f[l].start,r=f[l].end;if(h<p){var z=a.getLineAtOffset(h),z=a.getLineStart(z);this._stylerAdapter.parse(d.substring(z-e,p-e),z,h-z,b,k)}var y=Math.max(h,p);y===p&&(p=this._stylerAdapter.getBlockStartStyle(f[l],d.substring(y-e),y,k))&&(y+=p.length);var p=Math.min(c,r),B=[];
p===r&&(h=d.substring(p-h-(f[l].end-f[l].contentEnd)),(h=this._stylerAdapter.getBlockEndStyle(f[l],h,p,B))&&(p-=h.length));var z=a.getLineAtOffset(y),z=a.getLineStart(z),h=this._getStyles(f[l],a,d.substring(z-e,p-e),z,y-z),C=this._stylerAdapter.getBlockContentStyleName(f[l]);if(C){var q=y;h.forEach(function(a){a.start-q&&k.push({start:q,end:a.start,style:C});a.mergeable&&(a.style+=","+C);k.push(a);q=a.end});p-q&&k.push({start:q,end:p,style:C})}else k=k.concat(h);k=k.concat(B);h=r}h<c&&(z=a.getLineAtOffset(h),
z=a.getLineStart(z),this._stylerAdapter.parse(d.substring(z-e,c-e),z,h-z,b,k));return k},_isRenderingWhitespace:function(){return this._whitespacesVisible},_onDestroy:function(){this.destroy()},_onLineStyle:function(b){b.textView===this._view&&(b.style=this._getLineStyle(b.lineIndex));var a=b.lineStart,d=b.textView.getModel();if(d.getBaseModel)var a=d.mapOffset(a),e=d.getBaseModel();b.ranges=this._getStyles(this._rootBlock,e||d,b.lineText,a,0);for(a=b.ranges.length-1;0<=a;a--){var f=b.ranges[a];if(f.style){if(f.style=
{styleClass:f.style.replace(/\./g," ")},e){var c=f.end-f.start;f.start=d.mapOffset(f.start,!0);f.end=f.start+c}}else b.ranges.splice(a,1)}this._isRenderingWhitespace()&&(this._spliceStyles(this._spacePattern,b.ranges,b.lineText,b.lineStart),this._spliceStyles(this._tabPattern,b.ranges,b.lineText,b.lineStart))},_onModelChanged:function(b){var a=b.start,d=b.removedCharCount;b=b.addedCharCount-d;var e=this._view.getModel(),f=e.getBaseModel?e.getBaseModel():e,d=a+d,c=f.getCharCount(),k=f.getLineStart(f.getLineAtOffset(a)),
h=this._findBlock(this._rootBlock,a),p,r,y,z,D,B,C;do{y=h.parent;if(!p&&y){if(0>b&&h.end-a<=-b){h=y;continue}D=f.getText(h.start,Math.min(c,h.end+b+1));if(!this._stylerAdapter.verifyBlock(f,D,h,b)){h=y;continue}}r=h.getBlocks();var q=r.length,w=m(r,k,!0),x=m(r,d,!1,w-1,q);p=!1;if(w&&r.length&&r[w-1].end===a){D=f.getText(r[w-1].start,Math.min(c,a+1));var F=this.computeBlocks(f,D,h,r[w-1].start,null,null,null);F.length&&F[0].end!==r[w-1].end&&(w--,p=!0)}w<q&&r[w].start<=k&&(k<r[w].end||p)?(C=r[w].start,
C>a&&(C+=b)):w===q&&0<q&&h.end-b===r[q-1].end?(C=r[--w].start,C>a&&(C+=b)):C=Math.max(k,h.contentStart);B=x<q?r[x].end:h.contentEnd;a<=B&&(B+=b);B=Math.min(B,c-1);D=f.getText(C,B+1);F=this.computeBlocks(f,D,h,C,null,null,null);if(x<q){if(F.length&&F[F.length-1].end===B&&F[F.length-1].typeId===r[x].typeId)break;if(F.length&&this._stylerAdapter.blockSpansBeyondEnd(F[F.length-1])){x++;for(var J=F[F.length-1].getBlocks(),J=(J.length?J[J.length-1]:F[F.length-1]).typeId;x<q;){if(r[x].typeId===J){var M=
r[x].end+b,M=Math.min(M,c-1);D=f.getText(C,M+1);D=this.computeBlocks(f,D,h,C,null,null,null);if(D.length&&D[D.length-1].end===M){B=M;F=D;break}}x++}if(x<q)break}}else if(!F.length||F[F.length-1].end<=h.contentEnd+b)break;if(!y){B=c;x=q;D=f.getText(C,B);F=this.computeBlocks(f,D,h,C,null,null,null);break}h=y;z=!0}while(1);this._rootBlock.adjustBounds(a,b);x=Math.min(x+1,q);z||(z=x-w!==F.length);if(!z)for(q=0;q<F.length;q++)if(p=r[w+q],c=F[q],p.start!==c.start||p.end!==c.end||p.typeId!==c.typeId){z=
!0;break}!r.length&&!F.length?(p=[h],this.dispatchEvent({type:"BlocksChanged",oldBlocks:[h],newBlocks:p}),h=p[0]):this.dispatchEvent({type:"BlocksChanged",oldBlocks:r.slice(w,x),newBlocks:F});w=[w,x-w].concat(F);Array.prototype.splice.apply(r,w);z&&(r=C,z=B,e!==f&&(r=e.mapOffset(r,!0),z=e.mapOffset(z,!0)),this._view.redrawRange(r,z));if(this._annotationModel){var G=[],I=[],H=[];r=this._annotationModel.getAnnotations(C,B);z=this._foldingEnabled&&f!==e;for(w=h.parent||h;r.hasNext();)if(x=r.next(),z&&
x.type===l.AnnotationType.ANNOTATION_FOLDING){H.push(x);for(p=this._findBlock(w,x.start);p;){var P=this._stylerAdapter.getBlockFoldBounds(p,f);if(x.start===P.start&&x.end===P.end)break;p=p.parent}p&&x.start===P.start&&x.end===P.end?(F=x.start,p=x.end,F>a&&(F-=b),p>a&&(p-=b),F<=a&&(a<p&&F<=d&&d<p)&&(F=f.getLineAtOffset(x.start),p=f.getLineAtOffset(x.end),F!==p?x.expanded||x.expand():G.push(x))):(G.push(x),x.expand())}else x.type===l.AnnotationType.ANNOTATION_TASK&&h.start<=x.start&&x.end<=h.end&&G.push(x);
z&&w.getBlocks().forEach(function(a){this._updateFolding(a,f,e,H,I,C,B)}.bind(this));this._detectTasks&&this._computeTasks(h,f,I,C,B);this._annotationProviders.forEach(function(a){var b=[],c=[];a(this._annotationModel,f,h,C,B,b,c);G=G.concat(b);I=I.concat(c)}.bind(this));this._annotationModel.replaceAnnotations(G,I)}},_onMouseDown:function(b){if(2===b.clickCount){var a=this._view.getModel(),d=this._view.getOffsetAtLocation(b.x,b.y);if(0<d){var e=d-1,f=a;a.getBaseModel&&(e=a.mapOffset(e),f=a.getBaseModel());
var c=this._findBlock(this._rootBlock,e),e=this._findMatchingBracket(f,c,e);-1!==e&&(b.preventDefault(),b=e,a.getBaseModel&&(b=a.mapOffset(b,!0)),d>b&&(d--,b++),this._view.setSelection(b,d))}}},_onSelection:function(b){var a=Array.isArray(b.oldValue)?b.oldValue:[b.oldValue];b=Array.isArray(b.newValue)?b.newValue:[b.newValue];var d=this._view,e=d.getModel(),f;if(this._highlightCaretLine){var c=function(a){var b={};return a.some(function(a){if(a.isEmpty())b[e.getLineAtOffset(a.start).toString()]=!0;
else return!0;return!1})?{}:b},a=c(a),c=c(b),k=function(a,b){for(var c in a)b[c]||(f=c>>0,d.redrawLines(f,f+1))};k(a,c);k(c,a)}if(this._annotationModel){var a=this._bracketAnnotations,h,m;if(1===b.length&&b[0].isEmpty()&&0<(m=b[0].getCaret()))m-=1,e.getBaseModel&&(m=e.mapOffset(m),e=e.getBaseModel()),b=this._findBlock(this._rootBlock,m),b=this._findMatchingBracket(e,b,m),-1!==b&&(h=[l.AnnotationType.createAnnotation(l.AnnotationType.ANNOTATION_MATCHING_BRACKET,b,b+1),l.AnnotationType.createAnnotation(l.AnnotationType.ANNOTATION_CURRENT_BRACKET,
m,m+1)]);this._bracketAnnotations=h;this._annotationModel.replaceAnnotations(a,h)}},_spliceStyles:function(b,a,d,e){for(var f=b.regex,c=f.lastIndex=0,k=f.exec(d);k;){for(k=e+k.index;c<a.length&&!(k<a[c].end);)c++;var h={start:k,end:k+1,style:JSON.parse(JSON.stringify(b.style))};if(c<a.length&&a[c].start<=k){var m={start:k+1,end:a[c].end,style:a[c].style};a[c].end=k;a.splice(c+1,0,m);a.splice(c+1,0,h);c+=2;h.style.styleClass+=" "+a[c].style.styleClass}else a.splice(c,0,h),c++;k=f.exec(d)}},_updateFolding:function(b,
a,d,e,f,c,k){c=c||b.start;k=k||b.end;var h=this._stylerAdapter.getBlockFoldBounds(b,a);if(!b.doNotFold&&h.start<=k&&c<=h.end){var l=m(e,h.start,!0);l<e.length&&e[l].start===h.start&&e[l].end===h.end||(h=this._createFoldingAnnotation(d,a,h.start,h.end))&&f.push(h);b.getBlocks().forEach(function(b){this._updateFolding(b,a,d,e,f,c,k)}.bind(this))}},_caretLineStyle:{styleClass:"meta annotation currentLine"},_spacePattern:{regex:/[ ]/g,style:{styleClass:"punctuation separator space",unmergeable:!0}},_tabPattern:{regex:/\t/g,
style:{styleClass:"punctuation separator tab",unmergeable:!0}}};r.EventTarget.addMixin(k.prototype);return{TextStyler:k,Block:d,createPatternBasedAdapter:function(b,a,d){return new h(b,a,d)}}});y("orion/editor/textMateStyler",["orion/regex"],function(l){function r(f){var d;if(f instanceof Array){d=Array(f.length);for(var b=0;b<f.length;b++)d[b]=r(f[b])}else for(b in d={},f)if(Object.prototype.hasOwnProperty.call(f,b)){var k=f[b];d[b]="object"===typeof k&&null!==k?r(k):k}return d}function p(f,d,b){this.initialize(f);
this.grammar=r(d);this.externalGrammars=b?r(b):[];this._styles={};this._tree=null;this._allGrammars={};this.preprocess(this.grammar)}var h={unsupported:[{regex:/\(\?[ims\-]:/,func:function(f){return"option on/off for subexp"}},{regex:/\(\?<([=!])/,func:function(f){return"\x3d"===f[1]?"lookbehind":"negative lookbehind"}},{regex:/\(\?>/,func:function(f){return"atomic group"}}],toRegExp:function(f){function d(b,a){throw Error('Unsupported regex feature "'+b+'": "'+a[0]+'" at index: '+a.index+" in "+
a.input);}var b="",k;f=h.processGlobalFlag("x",f,function(b){for(var a="",d=!1,e=b.length,f=0;f<e;){var c=b.charAt(f);if(!d&&"#"===c)for(;f<e&&"\r"!==c&&"\n"!==c;)c=b.charAt(++f);else if(!d&&/\s/.test(c))for(;f<e&&/\s/.test(c);)c=b.charAt(++f);else"\\"===c?(a+=c,/\s/.test(b.charAt(f+1))||(a+=b.charAt(f+1),f+=1)):("["===c?d=!0:"]"===c&&(d=!1),a+=c),f+=1}return a});f=h.processGlobalFlag("i",f,function(d){b+="i";return d});for(k=0;k<this.unsupported.length;k++){var m;(m=this.unsupported[k].regex.exec(f))&&
d(this.unsupported[k].func(m),m)}return RegExp(f,b)},processGlobalFlag:function(f,d,b){var k="(?"+f+")";f="(?"+f+":";if(d.substring(0,k.length)===k)return b(d.substring(k.length));if(d.substring(0,f.length)===f){for(var k=0,h=d.length,g=-1,a=0;a<h&&-1===g;a++)switch(d.charAt(a)){case "\\":a++;break;case "(":k++;break;case ")":k--,0===k&&(g=a)}k=g;if(k<d.length-1)throw Error("Only a "+f+") group that encloses the entire regex is supported in: "+d);return b(d.substring(f.length,k))}return d},hasBackReference:function(f){return/\\\d+/.test(f.source)},
getSubstitutedRegex:function(f,d,b){b="undefined"===typeof b?!0:!1;f=f.source.split(/(\\\d+)/g);for(var k=[],h=0;h<f.length;h++){var g=f[h],a=/\\(\d+)/.exec(g);a?(g=d[a[1]]||"",k.push(b?l.escape(g):g)):k.push(g)}return RegExp(k.join(""))},groupify:function(f,d){for(var b=f.source,k=b.length,h=[],g=0,a=[],l=1,e=1,n=[],c={},p={},r=0;r<k;r++){var v=h[h.length-1],A=b.charAt(r);switch(A){case "(":4===v&&(h.pop(),n.push(")"),a[a.length-1].end=r);var y=r+2<k?b.charAt(r+1)+""+b.charAt(r+2):null;if("?:"===
y||"?\x3d"===y||"?!"===y){var z;"?:"===y?z=1:(z=3,g++);h.push(z);a.push({start:r,end:-1,type:z});n.push(A);n.push(y);r+=y.length}else h.push(2),a.push({start:r,end:-1,type:2,oldNum:l,num:e}),n.push(A),0===g&&(p[e]=null),c[l]=e,l++,e++;break;case ")":v=h.pop();3===v&&g--;a[a.length-1].end=r;n.push(A);break;case "*":case "+":case "?":case "}":var D=A,B=b.charAt(r-1),y=r-1;if("}"===A){for(z=r-1;"{"!==b.charAt(z)&&0<=z;z--);B=b.charAt(z-1);y=z-1;D=b.substring(z,r+1)}z=a[a.length-1];if(")"===B&&(2===z.type||
4===z.type)){n.splice(z.start,0,"(");n.push(D);n.push(")");A={start:z.start,end:n.length-1,type:4,num:z.num};for(B=0;B<a.length;B++)if(v=a[B],(2===v.type||4===v.type)&&v.start>=z.start&&v.end<=y)v.start+=1,v.end+=1,v.num+=1,2===v.type&&(c[v.oldNum]=v.num);a.push(A);e++;break}default:"|"!==A&&(2!==v&&4!==v)&&0===g&&(h.push(4),a.push({start:r,end:-1,type:4,num:e}),n.push("("),p[e]=null,e++),n.push(A),"\\"===A&&(A=b.charAt(r+1),n.push(A),r+=1)}}for(;h.length;)h.pop(),n.push(")");b=RegExp(n.join(""));
k={};d=d||c;for(var C in d)d.hasOwnProperty(C)&&(k[C]="\\"+d[C]);b=this.getSubstitutedRegex(b,k,!1);return[b,c,p]},complexCaptures:function(f){if(!f)return!1;for(var d in f)if(f.hasOwnProperty(d)&&"0"!==d)return!0;return!1}};p.prototype={initialize:function(f){this.textView=f;this.textView.stylerOptions=this;var d=this;this._listener={onModelChanged:function(b){d.onModelChanged(b)},onDestroy:function(b){d.onDestroy(b)},onLineStyle:function(b){d.onLineStyle(b)},onStorage:function(b){d.onStorage(b)}};
f.addEventListener("ModelChanged",this._listener.onModelChanged);f.addEventListener("Destroy",this._listener.onDestroy);f.addEventListener("LineStyle",this._listener.onLineStyle);f.redrawLines()},onDestroy:function(f){this.destroy()},destroy:function(){this.textView&&(this.textView.removeEventListener("ModelChanged",this._listener.onModelChanged),this.textView.removeEventListener("Destroy",this._listener.onDestroy),this.textView.removeEventListener("LineStyle",this._listener.onLineStyle),this.textView=
null);this._listener=this._tree=this._styles=this.grammar=null},preprocess:function(f){for(f=[f];0!==f.length;){var d=f.pop();if(!d._resolvedRule||!d._typedRule)if(d._resolvedRule=this._resolve(d),d._typedRule=this._createTypedRule(d),this.addStyles(d.name),this.addStyles(d.contentName),this.addStylesForCaptures(d.captures),this.addStylesForCaptures(d.beginCaptures),this.addStylesForCaptures(d.endCaptures),d._resolvedRule!==d&&f.push(d._resolvedRule),d.patterns)for(var b=0;b<d.patterns.length;b++)f.push(d.patterns[b])}},
addStyles:function(f){if(f&&!this._styles[f]){this._styles[f]=[];for(var d=f.split("."),b=0;b<d.length;b++)this._styles[f].push(d.slice(0,b+1).join("-"))}},addStylesForCaptures:function(f){for(var d in f)f.hasOwnProperty(d)&&this.addStyles(f[d].name)},ContainerRule:function(){function f(d){this.rule=d;this.subrules=d.patterns}f.prototype.valueOf=function(){return"aa"};return f}(),BeginEndRule:function(){function f(d){this.rule=d;this.beginRegex=h.toRegExp(d.begin);this.endRegex=h.toRegExp(d.end);
this.subrules=d.patterns||[];this.endRegexHasBackRef=h.hasBackReference(this.endRegex);var b=h.complexCaptures(d.captures);d=h.complexCaptures(d.beginCaptures)||h.complexCaptures(d.endCaptures);if(this.isComplex=b||d)b=h.groupify(this.beginRegex),this.beginRegex=b[0],this.beginOld2New=b[1],this.beginConsuming=b[2],b=h.groupify(this.endRegex,this.beginOld2New),this.endRegex=b[0],this.endOld2New=b[1],this.endConsuming=b[2]}f.prototype.valueOf=function(){return this.beginRegex};return f}(),MatchRule:function(){function f(d){this.rule=
d;this.matchRegex=h.toRegExp(d.match);if(this.isComplex=h.complexCaptures(d.captures))d=h.groupify(this.matchRegex),this.matchRegex=d[0],this.matchOld2New=d[1],this.matchConsuming=d[2]}f.prototype.valueOf=function(){return this.matchRegex};return f}(),_createTypedRule:function(f){return f.match?new this.MatchRule(f):f.begin?new this.BeginEndRule(f):new this.ContainerRule(f)},_resolve:function(f){var d=f;if(f.include){if(f.begin||f.end||f.match)throw Error('Unexpected regex pattern in "include" rule '+
f.include);f=f.include;if("#"===f.charAt(0)){if(d=this.grammar.repository&&this.grammar.repository[f.substring(1)],!d)throw Error("Couldn't find included rule "+f+" in grammar repository");}else if("$self"===f)d=this.grammar;else{if("$base"===f)throw Error('Include "$base" is not supported');d=this._allGrammars[f];if(!d)for(var b=0;b<this.externalGrammars.length;b++){var h=this.externalGrammars[b];if(h.scopeName===f){this.preprocess(h);d=this._allGrammars[f]=h;break}}}}return d},ContainerNode:function(){function f(d,
b){this.parent=d;this.rule=b;this.children=[];this.end=this.start=null}f.prototype.addChild=function(d){this.children.push(d)};f.prototype.valueOf=function(){var d=this.rule;return"ContainerNode { "+(d.include||"")+" "+(d.name||"")+(d.comment||"")+"}"};return f}(),BeginEndNode:function(){function f(d,b,f){this.parent=d;this.rule=b;this.children=[];this.setStart(f);this.endMatch=this.end=null;this.endRegexSubstituted=b.endRegexHasBackRef?h.getSubstitutedRegex(b.endRegex,f):null}f.prototype.addChild=
function(d){this.children.push(d)};f.prototype.getIndexInParent=function(d){return this.parent?this.parent.children.indexOf(this):-1};f.prototype.setStart=function(d){this.start=d.index;this.beginMatch=d};f.prototype.setEnd=function(d){d&&"object"===typeof d?(this.endMatch=d,this.end=d.index+d[0].length):(this.endMatch=null,this.end=d)};f.prototype.shiftStart=function(d){this.start+=d;this.beginMatch.index+=d};f.prototype.shiftEnd=function(d){this.end+=d;this.endMatch&&(this.endMatch.index+=d)};f.prototype.valueOf=
function(){return"{"+this.rule.beginRegex+" range\x3d"+this.start+".."+this.end+"}"};return f}(),push:function(f,d){if(d)for(var b=d.length;0<b;)f.push(d[--b])},exec:function(f,d,b){if(d=f.exec(d))d.index+=b;f.lastIndex=0;return d},afterMatch:function(f){return f.index+f[0].length},getEndMatch:function(f,d,b){if(f instanceof this.BeginEndNode){var h=f.rule;f=f.endRegexSubstituted||h.endRegex;return!f?null:this.exec(f,d,b)}return null},initialParse:function(){this.textView.getModel().getCharCount();
this._tree=new this.ContainerNode(null,this.grammar._typedRule);this.parse(this._tree,!1,0)},onModelChanged:function(f){var d=f.addedCharCount,b=f.removedCharCount;f=f.start;if(this._tree){var h=this.textView.getModel(),m=h.getCharCount(),h=h.getLineEnd(h.getLineAtOffset(f)-1),g=this.getFirstDamaged(h,h),h=-1===h?0:h,d=g?this.parse(g,!0,h,f,d,b):m;this.textView.redrawRange(h,d)}else this.initialParse()},getFirstDamaged:function(f,d){if(0>f)return this._tree;for(var b=[this._tree],h=null;b.length;){var m=
b.pop();if(!m.parent||this.isDamaged(m,f,d)){m instanceof this.BeginEndNode&&(h=m);for(var g=0;g<m.children.length;g++)b.push(m.children[g])}}return h||this._tree},isDamaged:function(f,d,b){return f.start<=b&&f.end>d},parse:function(f,d,b,h,m,g){var a=this.textView.getModel(),l=a.getLineStart(a.getLineCount()-1),e=a.getCharCount(),n=this.getInitialExpected(f,b),c=-1;d&&(f.repaired=!0,f.endNeedsUpdate=!0,c=(c=f.children[f.children.length-1])?a.getLineEnd(a.getLineAtOffset(c.end+(m-g))):-1,h=a.getLineEnd(a.getLineAtOffset(h+
g)),c=Math.max(c,h));c=-1===c?e:c;h=n;for(var p=f,r=!1,v=b,A=-1;p&&(!d||v<c);){var y=this.getNextMatch(a,p,v);y||(v=v>=l?e:a.getLineStart(a.getLineAtOffset(v)+1));var z=y&&y.match,D=y&&y.rule,B=y&&y.isEnd;if(y&&y.isSub)v=this.afterMatch(z),D instanceof this.BeginEndRule&&(r=!0,d&&D===h.rule&&p===h.parent?(p=h,p.setStart(z),p.repaired=!0,p.endNeedsUpdate=!0,h=this.getNextExpected(h,"begin")):(d&&(this.prune(p,h),d=!1),z=new this.BeginEndNode(p,D,z),p.addChild(z),p=z));else if(B||v===e)p instanceof
this.BeginEndNode&&(z?(r=!0,A=Math.max(A,p.end),p.setEnd(z),v=this.afterMatch(z),d&&p===h&&p.parent===h.parent?(p.repaired=!0,delete p.endNeedsUpdate,h=this.getNextExpected(h,"end")):d&&(this.prune(p,h),d=!1)):(p.setEnd(e),delete p.endNeedsUpdate)),p=p.parent;d&&(v>=c&&!r)&&(this.prune(f,n),d=!1)}this.removeUnrepairedChildren(f,d,b);this.cleanup(d,f,b,c,e,m,g);return d?Math.max(A,v):v},removeUnrepairedChildren:function(f,d,b){if(d){d=f.children;for(var h=-1,m=0;m<d.length;m++){var g=d[m];if(!g.repaired&&
this.isDamaged(g,b,Number.MAX_VALUE)){h=m;break}}-1!==h&&(f.children.length=h)}},cleanup:function(f,d,b,h,m,g,a){if(f){f=g-a;m=this.getIntersecting(h-f+1,m);d=this.getIntersecting(b,h);for(b=0;b<m.length;b++)h=m[b],!h.repaired&&h instanceof this.BeginEndNode&&(h.shiftEnd(f),h.shiftStart(f));for(b=0;b<d.length;b++)h=d[b],h.repaired&&h.endNeedsUpdate&&h.shiftEnd(f),delete h.endNeedsUpdate,delete h.repaired}else{d=this.getIntersecting(b,h);for(b=0;b<d.length;b++)delete d[b].repaired}},getNextMatch:function(f,
d,b,h){var m=f.getLineAtOffset(b),m=f.getLineEnd(m),g=f.getText(b,m),a=[],l=[];f=[];m=[];for(this.push(a,d.rule.subrules);a.length;){var e=a.length?a.pop():null,e=e&&e._resolvedRule._typedRule;if(e instanceof this.ContainerRule&&-1===l.indexOf(e))l.push(e),this.push(a,e.subrules);else if(!e||!h||e.matchRegex){var n=e&&this.exec(e.matchRegex||e.beginRegex,g,b);n&&(f.push(n),m.push(e))}}a=Number.MAX_VALUE;l=-1;for(e=0;e<f.length;e++)n=f[e],n.index<a&&(a=n.index,l=e);if(!h&&(b=this.getEndMatch(d,g,b)))if(h=
d.rule.applyEndPatternLast,-1===l||b.index<a||!h&&b.index===a)return{isEnd:!0,rule:d.rule,match:b};return-1===l?null:{isSub:!0,rule:m[l],match:f[l]}},getInitialExpected:function(f,d){var b,h;if(f===this._tree)for(b=0;b<f.children.length;b++){if(h=f.children[b],h.start>=d)return h}else if(f instanceof this.BeginEndNode&&f.endMatch){var l=f.endMatch.index;for(b=0;b<f.children.length&&!(h=f.children[b],h.start>=d);b++);if(h&&h.start<l)return h}return f},getNextExpected:function(f,d){if("begin"===d){var b=
f.children[0];return b?b:f}if("end"===d&&(b=f.parent)){var h=b.children[b.children.indexOf(f)+1];return h?h:b}return null},prune:function(f,d){d.parent===f?f.children.length=d.getIndexInParent():f instanceof this.BeginEndNode&&(f.endMatch=null,f.end=null);f.parent&&(f.parent.children.length=f.getIndexInParent()+1)},onLineStyle:function(f){this._tree||this.initialParse();var d=f.lineStart,b=this.textView.getModel(),h=b.getLineEnd(f.lineIndex),l=b.getLineEnd(b.getLineAtOffset(d)-1),l=this.getFirstDamaged(l,
l),d=this.getLineScope(b,l,d,h);f.ranges=this.toStyleRanges(d);f.ranges.sort(function(b,a){return b.start-a.start})},getLineScope:function(f,d,b,h){for(var l=b,g=this.getInitialExpected(d,b),a=[],p=[];d&&l<h;){var e=this.getNextMatch(f,d,l);if(!e)break;var n=e&&e.match,c=e&&e.rule,r=e&&e.isSub,e=e&&e.isEnd;n.index!==l&&p.push({start:l,end:n.index,node:d});r?(l=this.afterMatch(n),c instanceof this.BeginEndRule?(this.addBeginScope(a,n,c),d=g,g=this.getNextExpected(g,"begin")):this.addMatchScope(a,n,
c)):e&&(l=this.afterMatch(n),this.addEndScope(a,n,c),g=this.getNextExpected(g,"end"),d=d.parent)}l<h&&p.push({start:l,end:h,node:d});f=this.getInheritedLineScope(p,b,h);return a.concat(f)},getInheritedLineScope:function(f,d,b){d=[];for(b=0;b<f.length;b++)for(var h=f[b],l=h.node;l;){var g=l.rule.rule,a=g.name;if(g=g.contentName||a){this.addScopeRange(d,h.start,h.end,g);break}l=l.parent}return d},addBeginScope:function(f,d,b){var h=b.rule;this.addCapturesScope(f,d,h.beginCaptures||h.captures,b.isComplex,
b.beginOld2New,b.beginConsuming)},addEndScope:function(f,d,b){var h=b.rule;this.addCapturesScope(f,d,h.endCaptures||h.captures,b.isComplex,b.endOld2New,b.endConsuming)},addMatchScope:function(f,d,b){var h=b.rule,l=h.name;(h=h.captures)?this.addCapturesScope(f,d,h,b.isComplex,b.matchOld2New,b.matchConsuming):this.addScope(f,d,l)},addScope:function(f,d,b){b&&f.push({start:d.index,end:this.afterMatch(d),scope:b})},addScopeRange:function(f,d,b,h){h&&f.push({start:d,end:b,scope:h})},addCapturesScope:function(f,
d,b,h,l,g){if(b)if(h){h={1:0};for(var a=0,p=1;void 0!==d[p];p++)void 0!==g[p]&&(a+=d[p].length),void 0!==d[p+1]&&(h[p+1]=a);g=d.index;for(a=1;b[a];a++){var p=b[a].name,e=l[a],n=g+h[e];"undefined"!==typeof d[e]&&this.addScopeRange(f,n,n+d[e].length,p)}}else this.addScope(f,d,b[0]&&b[0].name)},getIntersecting:function(f,d){for(var b=[],h=this._tree?[this._tree]:[];h.length;){var l=h.pop(),g=!1;l instanceof this.ContainerNode?g=!0:this.isDamaged(l,f,d)&&(g=!0,b.push(l));if(g)for(var g=l.children.length,
a=0;a<g;a++)h.push(l.children[a])}return b.reverse()},toStyleRanges:function(f){for(var d=[],b=0;b<f.length;b++){var h=f[b],l=this._styles[h.scope];if(!l)throw Error("styles not found for "+h.scope);l=l.join(" ");d.push({start:h.start,end:h.end,style:{styleClass:l}})}return d}};return{RegexUtil:h,TextMateStyler:p}});y("orion/editor/AsyncStyler",["i18n!orion/editor/nls/messages","orion/editor/annotations"],function(l,r){function p(b){return-1!==b.getProperty("objectClass").indexOf(f)&&"highlighter"===
b.getProperty("type")}function h(b,d,f){this.initialize(b,d,f);this.lineStyles=[]}var f="orion.edit.highlighter",d=f+" service must be an event emitter";r.AnnotationType.registerType("orion.annotation.highlightError",{title:l.syntaxError,html:"\x3cdiv class\x3d'annotationHTML error'\x3e\x3c/div\x3e",rangeStyle:{styleClass:"annotationRange error"}});h.prototype={initialize:function(b,d,h){this.textView=b;this.serviceRegistry=d;this.annotationModel=h;this.services=[];var g=this;this.listener={onModelChanging:function(a){g.onModelChanging(a)},
onModelChanged:function(a){g.onModelChanged(a)},onDestroy:function(a){g.onDestroy(a)},onLineStyle:function(a){g.onLineStyle(a)},onStyleReady:function(a){g.onStyleReady(a)},onServiceAdded:function(a){g.onServiceAdded(a.serviceReference,g.serviceRegistry.getService(a.serviceReference))},onServiceRemoved:function(a){g.onServiceRemoved(a.serviceReference,g.serviceRegistry.getService(a.serviceReference))}};b.addEventListener("ModelChanging",this.listener.onModelChanging);b.addEventListener("ModelChanged",
this.listener.onModelChanged);b.addEventListener("Destroy",this.listener.onDestroy);b.addEventListener("LineStyle",this.listener.onLineStyle);d.addEventListener("registered",this.listener.onServiceAdded);d.addEventListener("unregistering",this.listener.onServiceRemoved);b=d.getServiceReferences(f);for(h=0;h<b.length;h++){var a=b[h];p(a)&&this.addServiceListener(d.getService(a))}},onDestroy:function(b){this.destroy()},destroy:function(){this.textView&&(this.textView.removeEventListener("ModelChanging",
this.listener.onModelChanging),this.textView.removeEventListener("ModelChanged",this.listener.onModelChanged),this.textView.removeEventListener("Destroy",this.listener.onDestroy),this.textView.removeEventListener("LineStyle",this.listener.onLineStyle),this.textView=null);if(this.services){for(var b=0;b<this.services.length;b++)this.removeServiceListener(this.services[b]);this.services=null}this.serviceRegistry&&(this.serviceRegistry.removeEventListener("registered",this.listener.onServiceAdded),this.serviceRegistry.removeEventListener("unregistering",
this.listener.onServiceRemoved),this.serviceRegistry=null);this.lineStyles=this.listener=null},onModelChanging:function(b){this.startLine=this.textView.getModel().getLineAtOffset(b.start)},onModelChanged:function(b){var d=this.startLine;(b.addedLineCount||b.removedLineCount)&&Array.prototype.splice.apply(this.lineStyles,[d,b.removedLineCount].concat(this._getEmptyStyle(b.addedLineCount)))},onStyleReady:function(b){var d=b.lineStyles||b.style;b=Number.MAX_VALUE;var f=-1,g=this.textView.getModel(),
a;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(this.lineStyles[a]=d[a],b=Math.min(b,a),f=Math.max(f,a));b=Math.max(b,0);f=Math.min(f,g.getLineCount());if(d=this.annotationModel){for(var h=d.getAnnotations(g.getLineStart(b),g.getLineEnd(f)),e=[];h.hasNext();){var l=h.next();"orion.annotation.highlightError"===l.type&&e.push(l)}h=[];for(l=b;l<=f;l++){a=l;var c=this.lineStyles[a],c=c&&c.errors;a=g.getLineStart(a);if(c)for(var p=0;p<c.length;p++){var t=c[p];h.push(r.AnnotationType.createAnnotation("orion.annotation.highlightError",
t.start+a,t.end+a))}}d.replaceAnnotations(e,h)}this.textView.redrawLines(b,f+1)},onLineStyle:function(b){var d=this.lineStyles[b.lineIndex];if(d)if(d.ranges){for(var d=d.ranges,f=b.lineStart,g=d.length,a=[],h=0;h<g;h++){var e=d[h];a.push({start:e.start+f,end:e.end+f,style:e.style})}b.ranges=a}else d.style&&(b.style=d.style)},_getEmptyStyle:function(b){for(var d=[],f=0;f<b;f++)d.push(null);return d},setContentType:function(b){this.contentType=b;if(this.services)for(b=0;b<this.services.length;b++){var d=
this.services[b];if(d.setContentType){var f=this.serviceRegistry.getService("orion.page.progress");f?f.progress(d.setContentType(this.contentType),"Styling content type: "+this.contentType.id?this.contentType.id:this.contentType):d.setContentType(this.contentType)}}},onServiceAdded:function(b,d){p(b)&&this.addServiceListener(d)},onServiceRemoved:function(b,d){-1!==this.services.indexOf(d)&&this.removeServiceListener(d)},addServiceListener:function(b){if("function"===typeof b.addEventListener){if(b.addEventListener("orion.edit.highlighter.styleReady",
this.listener.onStyleReady),this.services.push(b),b.setContentType&&this.contentType){var f=this.serviceRegistry.getService("orion.page.progress");f?f.progress(b.setContentType(this.contentType),"Styling content type: "+this.contentType.id?this.contentType.id:this.contentType):b.setContentType(this.contentType)}}else"undefined"!==typeof console&&console.log(Error(d))},removeServiceListener:function(b){"function"===typeof b.removeEventListener?(b.removeEventListener("orion.edit.highlighter.styleReady",
this.listener.onStyleReady),b=this.services.indexOf(b),-1!==b&&this.services.splice(b,1)):"undefined"!==typeof console&&console.log(Error(d))}};return h});y("orion/highlight",["examples/editor/textStyler","orion/editor/textStyler","orion/editor/textMateStyler","orion/editor/AsyncStyler","orion/Deferred"],function(l,r,p,h,f){function d(b,d,a,s,e,n,c){function u(b,c){var e=b.getProperty("contentType")||b.getProperty("contentTypes"),h=b.getProperty("fileTypes");return e?f.when(d.isSomeExtensionOf(a,
e)).then(function(a){return a?b:null}):c&&h&&-1!==h.indexOf(c)?(e=new f,e.resolve(b),e):null}function t(a){var b=null;switch(a&&a.id){case "application/javascript":case "application/json":b=new l.TextStyler(s,"js",e);break;case "text/x-java-source":b=new l.TextStyler(s,"java",e);break;case "text/css":b=new l.TextStyler(s,"css",e)}return b}if(!k){var v=t(a);if(v)return n=new f,n.resolve(v),n}k&&!this.orionGrammars&&(this.orionGrammars={});v=n&&n.split(".").pop().toLowerCase();n=b.getServiceReferences("orion.edit.highlighter");
for(var A=[],y=[],z=0;z<n.length;z++){var D=n[z],B=D.getProperty("type");"grammar"===B||!k&&"undefined"===typeof B?A.push(D.getProperty("grammar")):"highlighter"!==B&&(B=D.getProperty("id"))&&!this.orionGrammars[B]&&(this.orionGrammars[B]={id:B,contentTypes:D.getProperty("contentTypes"),patterns:D.getProperty("patterns"),repository:D.getProperty("repository")});(D=u(D,v))&&y.push(D)}return f.all(y,function(a){return{_error:a}}).then(function(d){for(var f,g=d.length-1;0<=g;g--){var l=d[g];if(l&&!l._error&&
(c||"highlighter"!==l.getProperty("type"))){f=l;break}}var n;if(f)if(d=f.getProperty("type"),"highlighter"===d)n=new h(s,b,e),n.setContentType(a);else if("grammar"===d||!k&&"undefined"===typeof d)f=f.getProperty("grammar"),n=new p.TextMateStyler(s,f,A);else{if(k){n=[];for(var t in this.orionGrammars)n.push(this.orionGrammars[t]);f=new r.createPatternBasedAdapter(n,f.getProperty("id"),a.id);n=new r.TextStyler(s,e,f)}}else if(k&&(!a||"text/x-markdown"!==a.id))f=new r.createPatternBasedAdapter([],""),
n=new r.TextStyler(s,e,f);return n})}function b(b,d){this.serviceRegistry=b;this.contentTypeService=d;this.styler=null}var k=1;b.prototype={setup:function(b,f,a,h,e){e="undefined"===typeof e?!0:e;this.styler&&(this.styler.destroy&&this.styler.destroy(),this.styler=null);var k=this;return d(this.serviceRegistry,this.contentTypeService?this.contentTypeService:this.serviceRegistry.getService("orion.core.contentTypeRegistry"),b,f,a,h,e).then(function(a){return k.styler=a})},getStyler:function(){return this.styler}};
return{createStyler:d,SyntaxHighlighter:b}});y("orion/markOccurrences",["orion/Deferred"],function(l){function r(l,h,f){this.registry=l;this.inputManager=h;this.editor=f}r.prototype={setOccurrencesVisible:function(l){this.occurrencesVisible!==l&&((this.occurrencesVisible=l)||this.editor.showOccurrences([]))},findOccurrences:function(){function p(b,d,f){function a(a,b,c){a=b.getProperty("contentType");return h.isSomeExtensionOf(c,a).then(function(a){return a?b:null})}for(var h=b.getService("orion.core.contentTypeRegistry"),
e=b.getServiceReferences("orion.edit.occurrences"),n=[],c=0;c<e.length;c++){var p=e[c],r=p.getProperty("pattern");p.getProperty("contentType")?n.push(a(b,p,d)):r&&RegExp(r).test(f)&&(r=new l,r.resolve(p),n.push(r))}return l.all(n,function(a){return{_error:a}}).then(function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d&&!d._error&&b.push(d)}return b})}var h,f=this,d=f.registry.getService("orion.edit.occurrences"),b=function(b){h&&window.clearTimeout(h);f.occurrencesVisible&&(h=window.setTimeout(function(){h=
null;var b=f.editor,g=b.getSelections();1<g.length?f.editor.showOccurrences([]):(g={selection:g[0],contentType:f.inputManager.getContentType().id},d.computeOccurrences(b.getEditorContext(),g).then(function(a){f.editor.showOccurrences(a)}))},500))};f.inputManager.addEventListener("InputChanged",function(d){var l=f.editor.getTextView();l&&(l.removeEventListener("Selection",b),p(f.registry,d.contentType,d.title).then(function(d){!d||0===d.length?h&&window.clearTimeout(h):l.addEventListener("Selection",
b)}))})}};return{MarkOccurrences:r}});y("orion/syntaxchecker",["orion/Deferred","orion/edit/editorContext","orion/i18nUtil"],function(l,r,p){function h(f,d,b){function h(a,b){var d=a.getProperty("contentType");return m.isSomeExtensionOf(b,d).then(function(b){return b?a:null})}var m=f.getService("orion.core.contentTypeRegistry");f=f.getServiceReferences("orion.edit.validator");for(var g=[],a=0;a<f.length;a++){var p=f[a],e=p.getProperty("pattern");p.getProperty("contentType")?g.push(h(p,d)):e&&RegExp(e).test(b)&&
(e=new l,e.resolve(p),g.push(e))}return l.all(g,function(a){return{_error:a}}).then(function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];e&&!e._error&&b.push(e)}return b})}return{SyntaxChecker:function(){function f(b,d){this.registry=b;this.textModel=d}function d(b,d,f){b=Math.max(b,d);return b=Math.min(b,f)}function b(b){b=b||{};b=b.problems||b.errors||b;return Array.isArray(b)?b:[]}f.prototype={checkSyntax:function(d,f,g,a,p){if(!d||g)return(new l).resolve([]);if(!g){var e=this.registry,n=this;
return h(e,d,f).then(function(c){var g=e.getService("orion.page.progress");c=c.map(function(c){c=e.getService(c);var h;c.computeProblems?(h={contentType:d.id,title:f},h=c.computeProblems(p?p:r.getEditorContext(e),h)):c.checkSyntax&&(h=c.checkSyntax(f,a));return g.progress(h,"Validating "+f).then(b)});return l.all(c,function(a){return{_error:a}}).then(function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d._error||(n._fixup(d),b=b.concat(d))}return(new l).resolve(b)})})}},setTextModel:function(b){this.textModel=
b},_fixup:function(b){for(var f=this.textModel,g=0;g<b.length;g++){var a=b[g];a.description=a.description||a.reason;a.severity=a.severity||"error";a.start="number"===typeof a.start?a.start:a.character;if("number"===typeof a.line){var h=f.getLine(a.line-1,!1).length;a.start=d(a.start,1,h);a.end="number"===typeof a.end?a.end:-1;a.end=d(a.end,a.start+1,h+1)}else if(h=f.getCharCount(),a.start=d(a.start,0,h),a.end="number"===typeof a.end?a.end:-1,a.end=d(a.end,a.start,h),a.end===h&&1<f.getLineCount()&&
h===f.getLineStart(f.getLineCount()-1)){var e=f.getLineCount()-2,h=f.getLineStart(e),e=f.getLineEnd(e);h===e?a.start=a.end=e:(a.start=e-1,a.end=e)}}}};return f}(),getValidators:h}});y("orion/liveEditSession",["orion/Deferred"],function(l){function r(d){return d instanceof Error?d:Error(d)}function p(d,b){this.registry=d;this.editor=b}var h,f=[];p.prototype={start:function(d,b){function k(a,b){function d(a,b){var c=a.getProperty("contentType");return f.isSomeExtensionOf(b,c).then(function(b){return b?
a:null})}for(var f=a.getService("orion.core.contentTypeRegistry"),c=a.getServiceReferences("orion.edit.live"),g=[],h=0;h<c.length;h++){var k=c[h];k.getProperty("contentType")&&g.push(d(k,b))}return l.all(g,r).then(function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d&&!(d instanceof Error)&&b.push(d)}return b})}if(h!==b&&(f&&f.forEach(function(a){a.endEdit(h)}),f=[],h=b,d)){var m=this.editor,g=this.registry;k(g,d).then(function(a){a=a.map(function(a){a=g.getService(a);if(a.startEdit){var e={contentType:d.id,
title:b};f.push(a);var h=m.getEditorContext();return a.startEdit(h,e)}});l.all(a,r)})}}};return p});y("orion/problems",["orion/EventTarget"],function(l){function r(p,h){this._serviceRegistry=p;l.attach(this);this._serviceRegistration=p.registerService(h||"orion.core.marker",this)}r.prototype={_setProblems:function(l){this.problems=l;this.dispatchEvent({type:"problemsChanged",problems:l})}};r.prototype.constructor=r;return{ProblemService:r}});y("orion/blamer",["orion/extensionCommands","orion/PageLinks",
"orion/URITemplate"],function(l,r,p){function h(f,d,b){this.serviceRegistry=f;this.inputManager=d;this.editor=b}h.prototype={getBlamer:function(){for(var f=this.inputManager.getFileMetadata(),d=this.serviceRegistry.getServiceReferences("orion.edit.blamer"),b=0;b<d.length;b++){var h=d[b],m={};m.validationProperties=h.getProperty("validationProperties");m.forceSingleItem=!0;m=l._makeValidator(m,this.serviceRegistry);if(m.validationFunction.bind(m)(f))return this.serviceRegistry.getService(h)}return null},
isVisible:function(){return!!this.getBlamer()},doBlame:function(){var f=this.getBlamer();if(f){var d=function(b){for(var d=r.getOrionHome(),f=0;f<b.length;f++){var a=b[f],h=new p(a.CommitLink),e={};e.OrionHome=d;a.CommitLink=h.expand(e)}this.editor.showBlame(b)}.bind(this),b={metadata:this.inputManager.getFileMetadata()};f.computeBlame(this.editor.getEditorContext(),b).then(d)}}};return{Blamer:h}});y("orion/compare/diffParser",[],function(){var l=l||{};l.DiffParser=function(){function l(h,f){this._lineDelimiter=
h?h:p?"\r\n":"\n";this._diffLineDelimiter=f?f:this._lineDelimiter;this._DEBUG=!1}var p=-1!==window.navigator.platform.indexOf("Win");l.prototype={_init:function(){this._oFileContents=[];this._diffContents=[];this._oBlocks=[];this._nBlocks=[];this._hunkRanges=[];this._lastToken=" ";this._deltaMap=[];this._nFileContents=[];this._nNewLineAtEnd=this._oNewLineAtEnd=!0;this._diffContentIndex=1},getOriginalBlocks:function(){return this._oBlocks},getNewBlocks:function(){return this._nBlocks},setLineDelim:function(h){this._diffLineDelimiter=
this._lineDelimiter=h},getDiffArray:function(){return{array:this._diffContents,index:this._diffContentIndex}},parse:function(h,f,d,b){this._init();if(""===f)return{outPutFile:h,mapper:[]};this._oFileContents=""===h?[]:h.split(this._lineDelimiter);this._diffContents=f.split(this._diffLineDelimiter);f=this._diffContents.length;this._hunkRanges=[];for(var k=0;k<f;k++){var l=this._parseHunkRange(k);l&&this._hunkRanges.push(l)}if(0===this._hunkRanges.length)return{outPutFile:h,mapper:[]};this._DEBUG&&
(console.log("***Diff contents: \n"),this._diffContents.forEach(function(b){console.log(b)}),console.log("***Hunk ranges: \n"),console.log(JSON.stringify(this._hunkRanges)));for(h=0;h<this._hunkRanges.length;h++)this._parseHunkBlock(h);this._DEBUG&&(console.log("***Original Hunk range blocks: \n"),console.log(JSON.stringify(this._oBlocks)),console.log("***New Hunk range blocks: \n"),console.log(JSON.stringify(this._nBlocks)));this._buildMap(d);this._DEBUG&&(console.log("***New Line at end of file(original): \n"),
console.log(JSON.stringify(this._oNewLineAtEnd)),console.log("***New Line at end of file(new): \n"),console.log(JSON.stringify(this._nNewLineAtEnd)),console.log("***Mapper: \n"),this._logMap(),console.log("***Total line number in original file: "+this._oFileContents.length));b||this._buildNewFile();return{outPutFile:this._nFileContents.join(this._diffLineDelimiter),mapper:this._deltaMap}},_logMap:function(){for(var h=0;h<this._deltaMap.length;h++)if(console.log(JSON.stringify(this._deltaMap[h])),
0<this._deltaMap[h][2]){console.log("    **Diff content on change/add: \n");for(var f=0;f<this._deltaMap[h][0];f++)console.log("    "+this._diffContents[this._deltaMap[h][2]+f-1])}},_logNewFile:function(){for(var h=0;h<this._nFileContents.length;h++)console.log(this._nFileContents[h])},_createBlock:function(h,f,d,b){b===d&&" "===h||(d=[d,b-d,"s"],"-"===h?d[2]="r":"+"===h?d[2]="a":"c"===h&&(d[2]="c"),f.push(d))},_createMinusBlock:function(h,f,d,b){var k=this._oBlocks.length;0===k||h!==this._oBlocks[k-
1][0]?(this._oBlocks.push([0===h?1:h,d,b]),this._nBlocks.push([f,0,-2])):(this._oBlocks[k-1][1]+=d,this._oBlocks[k-1][2]=b)},_createPlusBlock:function(h,f,d,b){var k=this._nBlocks.length;0===k||f!==this._nBlocks[k-1][0]?(this._oBlocks.push([0===h?1:h,0]),this._nBlocks.push([f,d,b])):(this._nBlocks[k-1][1]+=d,this._nBlocks[k-1][2]=b)},_parseHunkBlock:function(h){for(var f=" ",d=this._hunkRanges[h][0]+1,b=h===this._hunkRanges.length-1?this._diffContents.length:this._hunkRanges[h+1][0],k=0,l=0,g=this._hunkRanges[h][1],
a=this._hunkRanges[h][3],p=d,e=d,n=d;n<b;n++)if(0!==this._diffContents[n].length){var c=this._diffContents[n][0];if("\\"===c&&("\\ No newline at end of file"===this._diffContents[n].substring(0,this._diffContents[n].length-1)||"\\ No newline at end of file"===this._diffContents[n]))"-"===f?this._oNewLineAtEnd=!1:" "===f?this._oNewLineAtEnd=this._nNewLineAtEnd=!1:this._nNewLineAtEnd=!1,n>d&&"\r"===this._diffContents[n-1][this._diffContents[n-1].length-1]&&(this._diffContents[n-1]=this._diffContents[n-
1].substring(0,this._diffContents[n-1].length-1));else{switch(c){case "-":case "+":case " ":break;default:continue}if(f!==c){"+"===c&&(p=n);"-"===c&&(e=n);switch(f){case " ":g=this._hunkRanges[h][1]+k;a=this._hunkRanges[h][3]+l;break;case "-":this._createMinusBlock(g,a,this._hunkRanges[h][1]+k-g,e);break;case "+":this._createPlusBlock(g,a,this._hunkRanges[h][3]+l-a,p)}f=c}switch(c){case "-":k++;break;case "+":l++;break;case " ":k++,l++}}}switch(f){case "-":this._createMinusBlock(g,a,this._hunkRanges[h][1]+
k-g,e);break;case "+":this._createPlusBlock(g,a,this._hunkRanges[h][3]+l-a,p)}},_detectConflictes:function(h,f){if(0>h)return!1;for(var d=h+f,b=h;b<d;b++){var k=this._diffContents[b];if(-1<k.indexOf("\x3c\x3c\x3c\x3c\x3c")||-1<k.indexOf("\x3e\x3e\x3e\x3e\x3e"))return!0}return!1},_buildMap:function(h){var f=this._oBlocks.length,d=this._oFileContents.length,b=0,k;k=1;for(var l=0;l<f;l++)k=this._oBlocks[l][0]-k,0<k&&(this._deltaMap.push([k,k,0]),b+=k),h&&this._detectConflictes(this._nBlocks[l][2],this._nBlocks[l][1])?
this._deltaMap.push([this._nBlocks[l][1],this._oBlocks[l][1],this._nBlocks[l][2]+1,1]):this._deltaMap.push([this._nBlocks[l][1],this._oBlocks[l][1],this._nBlocks[l][2]+1]),b+=this._oBlocks[l][1],k=this._oBlocks[l][0]+this._oBlocks[l][1];0<d-k&&(this._deltaMap.push([d-k+1,d-k+1,0]),b+=d-k+1);b<d&&(k=d-b,h=this._deltaMap[this._deltaMap.length-1],0===h[2]?(h[0]+=k,h[1]+=k):-1===h[2]?this._deltaMap.push([k,k,0]):this._nNewLineAtEnd===this._oNewLineAtEnd?this._deltaMap.push([k,k,0]):(this._nNewLineAtEnd&&
(h[0]+=k),this._oNewLineAtEnd&&(h[1]+=k)))},_buildNewFile:function(){var h=1,f=!1,d=this._deltaMap.length,b,k;for(b=0;b<d;b++){f=!1;if(0===this._deltaMap[b][2]){for(k=0;k<this._deltaMap[b][0];k++)this._nFileContents.push(this._oFileContents[h+k-1]);f=!0}else if(0<this._deltaMap[b][2])for(k=0;k<this._deltaMap[b][0];k++)this._nFileContents.push(this._diffContents[this._deltaMap[b][2]+k-1].substring(1));h+=this._deltaMap[b][1]}this._nNewLineAtEnd&&!f&&this._nFileContents.push("")},_converHRangeBody:function(h,
f){if(h){var d=parseInt(h,10);f.push(0<=d?d:1)}else f.push(1)},_parseHunkRange:function(h){var f=this._diffContents[h],d=/^@@\s*\+([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*-([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*@@+/,b=/^@@\s*-([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*\+([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*@@+/.exec(f),k=null;if(b&&5===b.length)k=[h],this._converHRangeBody(b[1],k),this._converHRangeBody(b[2],k),this._converHRangeBody(b[3],k),this._converHRangeBody(b[4],k);else if((b=d.exec(f))&&5===b.length)k=[h],this._converHRangeBody(b[3],
k),this._converHRangeBody(b[4],k),this._converHRangeBody(b[1],k),this._converHRangeBody(b[2],k);return k}};return l}();return l});y("orion/differ",["orion/extensionCommands","orion/compare/diffParser"],function(l,r){function p(h,f,d){this._serviceRegistry=h;this._inputManager=f;this._editor=d;this._enabled=!1;this.init()}p.prototype={init:function(){var h=this;this._changeListener=function(){h._enabled&&(h.occurrenceTimer&&window.clearTimeout(h.occurrenceTimer),h.occurrenceTimer=window.setTimeout(function(){h.occurrenceTimer=
null;h.doDiff()},500))};this._inputManager.addEventListener("InputChanged",function(){var f=h._editor.getTextView();f&&f.removeEventListener("ModelChanged",h._changeListener);(h.service=h.getDiffer())&&f&&f.addEventListener("ModelChanged",h._changeListener)})},isVisible:function(){return!!this.getDiffer()},getDiffer:function(){for(var h=this._inputManager.getFileMetadata(),f=this._serviceRegistry.getServiceReferences("orion.edit.diff"),d=0;d<f.length;d++){var b=f[d],k={};k.validationProperties=b.getProperty("validationProperties");
k.forceSingleItem=!0;k=l._makeValidator(k,this._serviceRegistry);if(k.validationFunction.bind(k)(h))return this._serviceRegistry.getService(b)}return null},showAnnotations:function(h){var f=this,d=new r.DiffParser,b={metadata:this._inputManager.getFileMetadata()};h.computeDiff(this._editor.getEditorContext(),b).then(function(b){d.setLineDelim("\n");d.parse("",b);b=d.getOriginalBlocks();var h=d.getNewBlocks(),g=d.getDiffArray();b=f.getDiffRanges(b,h,g);f._enabled&&f._editor.showDiffAnnotations(b)})},
getDiffRanges:function(h,f){for(var d=[],b=0;b<f.length;b++){var k=f[b][0],l=h[b][1],g=f[b][1];0===g?d.push({lineStart:k-1,lineEnd:k,type:"deleted"}):0===l?d.push({lineStart:k-1,lineEnd:k+g-1,type:"added"}):d.push({lineStart:k-1,lineEnd:k+g-1,type:"modified"})}return d},toggleEnabled:function(){this.setEnabled(!this.isEnabled())},setEnabled:function(h){this._enabled=h;this.doDiff()},isEnabled:function(){return this._enabled},doDiff:function(){if(this._enabled){if(this.service){var h=this;this._inputManager.save().then(function(){h.showAnnotations(h.service)})}}else this._editor.showDiffAnnotations([])}};
p.prototype.constructor=p;return{Differ:p}});y("orion/webui/contextmenu",["orion/webui/littlelib","orion/webui/dropdown","orion/objects"],function(l,r,p){function h(d){d.skipTriggerEventListeners=!0;f.call(this,d);this._initialize()}var f=r.Dropdown;h.prototype=Object.create(f.prototype);h.prototype.constructor=h;p.mixin(h.prototype,{_initialize:function(){this._dropdownNode.dropdown||(this._dropdownNode.dropdown=this);this._boundcontextmenuEventHandler=this._contextmenuEventHandler.bind(this);this._boundContextMenuCloser=
this._contextMenuCloser.bind(this);this._triggerNode.addEventListener("contextmenu",this._boundcontextmenuEventHandler,!0);window.addEventListener("contextmenu",this._boundContextMenuCloser,!1)},_contextMenuCloser:function(d){this.close(d)},_contextmenuEventHandler:function(d){this.open(d)?l.stop(d):this.close()}});h.prototype.open=function(d){this._triggerNode.addEventListener("click",this._boundContextMenuCloser,!1);return f.prototype.open.call(this,d)};h.prototype.close=function(d){this._triggerNode.removeEventListener("click",
this._boundContextMenuCloser,!1);return f.prototype.close.call(this,d)};h.prototype._positionDropdown=function(d){if(d){var b=d.clientX;d=d.clientY;this._dropdownNode.style.position="fixed";this._dropdownNode.style.left=b+1+"px";this._dropdownNode.style.top=d+"px";var h=l.bounds(this._dropdownNode),m=h.width,h=h.height,g=l.bounds(document.body),m=b+m-(g.left+g.width);0<m&&(this._dropdownNode.style.left=Math.floor(b-m)+"px");b=d+h-(g.top+g.height);0<b&&(this._dropdownNode.style.top=Math.floor(d-b)+
"px")}else f.prototype._positionDropdown.call(this)};h.prototype.destroy=function(){this._triggerNode.removeEventListener("contextmenu",this._boundcontextmenuEventHandler,!0);this._triggerNode.removeEventListener("click",this._boundContextMenuCloser,!1);window.removeEventListener("contextmenu",this._boundContextMenuCloser,!1);this._dropdownNode.dropdown=null;f.prototype.destroy.call(this)};return{ContextMenu:h}});y("orion/editorView","i18n!orion/edit/nls/messages orion/editor/editor orion/editor/eventTarget orion/editor/textView orion/editor/textModel orion/editor/projectionTextModel orion/editor/editorFeatures orion/hover orion/editor/contentAssist orion/editor/emacs orion/editor/vi orion/editorPreferences orion/widgets/themes/ThemePreferences orion/widgets/themes/editor/ThemeData orion/widgets/settings/EditorSettings orion/searchAndReplace/textSearcher orion/editorCommands orion/globalCommands orion/edit/dispatcher orion/edit/editorContext orion/edit/typedefs orion/highlight orion/markOccurrences orion/syntaxchecker orion/liveEditSession orion/problems orion/blamer orion/differ orion/keyBinding orion/util orion/Deferred orion/webui/contextmenu orion/metrics orion/objects".split(" "),
function(l,r,p,h,f,d,b,k,m,g,a,s,e,n,c,u,t,v,y,E,z,D,B,C,q,w,x,F,J,M,G,I,H,P){function L(a){this._parent=a.parent;"string"===typeof this._parent&&(this._parent=document.getElementById(a.parent));this.id=a.id||"";this.activateContext=a.activateContext;this.renderToolbars=a.renderToolbars;this.serviceRegistry=a.serviceRegistry;this.contentTypeRegistry=a.contentTypeRegistry;this.commandRegistry=a.commandRegistry;this.progress=a.progress;this.statusService=a.statusService;this.editorCommands=a.editorCommands;
this.fileClient=a.fileService;this.inputManager=a.inputManager;this.preferences=a.preferences;this.readonly=a.readonly;this.searcher=a.searcher;this.statusReporter=a.statusReporter;this.model=a.model;this.undoStack=a.undoStack;this.problemsServiceID=a.problemsServiceID||"orion.core.marker";this.editContextServiceID=a.editContextServiceID||"orion.edit.context";this.syntaxHighlighter=new D.SyntaxHighlighter(this.serviceRegistry);this.typeDefRegistry=new z(this.serviceRegistry);(a=v.getKeyAssist?v.getKeyAssist():
null)&&a.addProvider(this.editorCommands);var b=v.getMainSplitter?v.getMainSplitter():null;b&&b.splitter.addEventListener("resize",function(a){this.editor&&a.node===b.main&&this.editor.resize()}.bind(this));v.getGlobalEventTarget&&v.getGlobalEventTarget().addEventListener("toggleTrim",function(){this.editor&&this.editor.resize()}.bind(this));this.settings={};this._init()}var N=y.Dispatcher;L.prototype={updateKeyMode:function(b,c){this.emacs&&c.removeKeyMode(this.emacs);this.vi&&c.removeKeyMode(this.vi);
"Emacs"===b.keyBindings?(this.emacs||(this.emacs=new g.EmacsMode(c)),c.addKeyMode(this.emacs)):"vi"===b.keyBindings&&(this.vi||(this.vi=new a.VIMode(c,this.statusReporter)),c.addKeyMode(this.vi))},setContents:function(a,b){var c=this.contentTypeRegistry.getContentType(b),d="txt";c&&(c.extension&&0<c.extension.length)&&(d=c.extension[0]);var e="/__embed/"+this.id+"/foo."+d;return(e===this.lastFileLocation||!this.lastFileLocation?(new G).resolve():this.fileClient.deleteFile(this.lastFileLocation)).then(function(){return this.fileClient.write(e,
a).then(function(){this.lastFileLocation=e;this.inputManager.setInput(e)}.bind(this))}.bind(this))},getParent:function(){return this._parent},getSettings:function(){return this.settings},setParent:function(a){this._parent=a},updateSourceCodeActions:function(a,b){b&&(b.setAutoPairParentheses(a.autoPairParentheses),b.setAutoPairBraces(a.autoPairBraces),b.setAutoPairSquareBrackets(a.autoPairSquareBrackets),b.setAutoPairAngleBrackets(a.autoPairAngleBrackets),b.setAutoPairQuotations(a.autoPairQuotations),
b.setAutoCompleteComments(a.autoCompleteComments),b.setSmartIndentation(a.smartIndentation))},updateViewOptions:function(a){var b=0;a.showMargin&&(b=a.marginOffset,"number"!==typeof b&&(b=a.marginOffset=parseInt(b,10)));var c=0;a.wordWrap&&(c=b);return{readonly:this.readonly||this.inputManager.getReadOnly(),tabSize:a.tabSize||4,expandTab:a.expandTab,wrapMode:a.wordWrap,wrapOffset:c,marginOffset:b,scrollAnimation:a.scrollAnimation?a.scrollAnimationTimeout:0}},updateSettings:function(a){this.settings=
a;var b=this.editor,c=this.inputManager;c.setAutoLoadEnabled(a.autoLoad);c.setAutoSaveTimeout(a.autoSave?a.autoSaveTimeout:-1);c.setSaveDiffsEnabled(a.saveDiffs);this.differ.setEnabled(this.settings.diffService);this.updateStyler(a);var d=b.getTextView();d&&(this.updateKeyMode(a,d),d.setOptions(this.updateViewOptions(a)));this.updateSourceCodeActions(a,b.getSourceCodeActions());b.setAnnotationRulerVisible(a.annotationRuler);b.setLineNumberRulerVisible(a.lineNumberRuler);b.setFoldingRulerVisible(a.foldingRuler);
b.setOverviewRulerVisible(a.overviewRuler);b.setZoomRulerVisible(a.zoomRuler);this.renderToolbars&&this.renderToolbars(c.getFileMetadata());this.markOccurrences.setOccurrencesVisible(a.showOccurrences);b.getContentAssist()&&b.getContentAssist().setAutoTriggerEnabled(a.contentAssistAutoTrigger);this.dispatchEvent({type:"Settings",newSettings:this.settings})},updateStyler:function(a){var b=this.syntaxHighlighter.getStyler();b&&b.setWhitespacesVisible&&b.setWhitespacesVisible(a.showWhitespaces,!0)},
recordSession:function(){var a=this.editor,b=a.getTextView(),c=this.inputManager;if(b&&c&&(c=c.getFileMetadata())){var d=sessionStorage.editorViewSection?JSON.parse(sessionStorage.editorViewSection):{},a=a.getSelections().map(function(a){return a.getOrientedSelection()});d[c.Location]={ETag:c.ETag,topIndex:b.getTopIndex(),selections:a};sessionStorage.editorViewSection=JSON.stringify(d)}},loadSession:function(a){var b=this.editor,c=b.getTextView(),d=this.inputManager;if(c&&d&&(d=d.getFileMetadata())){var e=
(sessionStorage.editorViewSection?JSON.parse(sessionStorage.editorViewSection):{})[d.Location];e&&e.ETag===d.ETag&&(a.session={apply:function(){b.setSelections(e.selections);c.setTopIndex(e.topIndex)}})}},_init:function(){this.preferences&&(this.editorCommands.editorPreferences=this.editorPreferences=this.editorCommands.editorPreferences||new s.EditorPreferences(this.preferences),this.editorPreferences.addEventListener("Changed",function(a){(a=a.preferences)?this.updateSettings(a):this.editorPreferences.getPrefs(this.updateSettings.bind(this))}.bind(this)),
this.editorCommands.themePreferences=this.themePreferences=this.editorCommands.themePreferences||new e.ThemePreferences(this.preferences,new n.ThemeData),this.themePreferences.apply());var a=this,g=this.commandRegistry,p=this.serviceRegistry,v=this.activateContext,y=this.inputManager,z=this.progress,A=this.contentTypeRegistry,D=this.editorCommands,H=function(b,c,d){var e=y.getContentType(),f=b.getTitle();b=p.getServiceReferences("orion.edit.contentAssist").concat(p.getServiceReferences("orion.edit.contentassist"));
(d=d&&d.providers)||(d=b.map(function(a){var b=a.getProperty("contentType"),c=a.getProperty("pattern");if(b&&A.isSomeExtensionOf(e,b)||c&&RegExp(c).test(f)){var b=p.getService(a),c=a.getProperty("service.id").toString(),d=a.getProperty("charTriggers");a=a.getProperty("excludedStyles");d&&(d=RegExp(d));a&&(a=RegExp(a));return{provider:b,id:c,charTriggers:d,excludedStyles:a}}return null}).filter(function(a){return!!a}));var g={};Object.keys(E).forEach(function(b){"function"===typeof E[b]&&(g[b]=E[b].bind(null,
p,a.editContextServiceID))});c.setEditorContextProvider(g);c.setProviders(d);c.setAutoTriggerEnabled(a.settings.contentAssistAutoTrigger);c.setProgress(z);c.setStyleAccessor(a.getStyleAccessor())},I=this.readonly?null:{createContentAssistMode:function(a){var b=new m.ContentAssist(a.getTextView());b.addEventListener("Activating",H.bind(null,a,b));var c=new m.ContentAssistWidget(b,"contentassist"),c=new m.ContentAssistMode(b,c);b.setMode(c);H(a,b);b.initialize();return c}},G=this.editor=new r.Editor({textViewFactory:function(){var b=
a.updateViewOptions(a.settings);P.mixin(b,{parent:a._parent,model:new d.ProjectionTextModel(a.model||new f.TextModel),wrappable:!0});return new h.TextView(b)},undoStackFactory:a.undoStack?{createUndoStack:function(b){a.undoStack.setView(b.getTextView());return a.undoStack}}:new b.UndoFactory,textDNDFactory:new b.TextDNDFactory,annotationFactory:new b.AnnotationFactory,foldingRulerFactory:new b.FoldingRulerFactory,zoomRulerFactory:new b.ZoomRulerFactory,lineNumberRulerFactory:new b.LineNumberRulerFactory,
hoverFactory:new k.HoverFactory(p,y,g),contentAssistFactory:I,keyBindingFactory:function(c,d,e,f){d=a.textSearcher=u.TextSearcher?new u.TextSearcher(c,p,g,e):null;e=(new b.KeyBindingsFactory).createKeyBindings(c,e,f,d);a.updateSourceCodeActions(a.settings,e.sourceCodeActions);D.overwriteKeyBindings(c);var h=c.getTextView();if(c=g.findCommand("orion.keyAssist"))h.setKeyBinding(new J.KeyStroke(191,!1,!0,!M.isMac,M.isMac),c.id),h.setAction(c.id,c.callback,c);h.setAction("toggleWrapMode",function(){h.invokeAction("toggleWrapMode",
!0);var b=h.getOptions("wrapMode");a.settings.wordWrap=b;a.editorPreferences&&a.editorPreferences.setPrefs(a.settings);return!0});h.setKeyBinding(new J.KeyStroke("z",!0,!1,!0),"toggleZoomRuler");h.setAction("toggleZoomRuler",function(){if(!a.settings.zoomRulerVisible)return!1;a.settings.zoomRuler=!a.settings.zoomRuler;a.editorPreferences&&a.editorPreferences.setPrefs(a.settings);return!0},{name:l.toggleZoomRuler});a.vi=a.emacs=null;a.updateKeyMode(a.settings,h);return e},statusReporter:this.statusReporter,
domNode:this._parent});G.id="orion.editor";G.processParameters=function(a){for(var b=["start","end","line","offset","length"],c=0;c<b.length;c++){var d=b[c];a[d]&&(a[d]=parseInt(a[d],10))}return this.showSelection(a.start,a.end,a.line,a.offset,a.length)};G.getEditorContext=function(){return E.getEditorContext(p,a.editContextServiceID)};this.dispatcher=new N(this.serviceRegistry,this.contentTypeRegistry,G,y);this.themePreferences&&this.editorPreferences&&(this.localSettings=c?new c({local:!0,editor:G,
themePreferences:this.themePreferences,preferences:this.editorPreferences}):null);var L=new q(p,G),I=function(){a.recordSession()};y.addEventListener("InputChanging",I);window.addEventListener("beforeunload",I);y.addEventListener("InputChanged",function(b){a.loadSession(b);var c=G.getTextView();if(c){if(L.start(y.getContentType(),b.title),c.setOptions(this.updateViewOptions(this.settings)),this.syntaxHighlighter.setup(b.contentType,G.getTextView(),G.getAnnotationModel(),b.title,!0).then(function(){this.updateStyler(this.settings);
G.getContentAssist()&&H(G,G.getContentAssist())}.bind(this)),c.onInputChanged)c.onInputChanged({type:b.type})}else L.start()}.bind(this));y.addEventListener("Saving",function(b){a.settings.trimTrailingWhiteSpace&&G.getTextView().invokeAction("trimTrailingWhitespaces");var c=G.getTextView();if(c&&c.onSaving)c.onSaving({type:b.type})});this.blamer=new x.Blamer(p,y,G);this.differ=new F.Differ(p,y,G);this.problemService=new w.ProblemService(p,this.problemsServiceID);(I=p.getService(this.problemsServiceID))&&
I.addEventListener("problemsChanged",function(a){G.showProblems(a.problems)});I=this.markOccurrences=new B.MarkOccurrences(p,y,G);I.setOccurrencesVisible(this.settings.occurrencesVisible);I.findOccurrences();var Q=new C.SyntaxChecker(p,G.getModel());G.addEventListener("InputChanged",function(b){Q.setTextModel(G.getModel());Q.checkSyntax(y.getContentType(),b.title,b.message,b.contents,G.getEditorContext()).then(function(b){p.getService(a.problemsServiceID)._setProblems(b)});y.getReadOnly()&&G.reportStatus(l.readonly,
"error")});var O=Object.create(null);"getCaretOffset setCaretOffset getSelection setSelection getSelections setSelections getText setText getLineAtOffset getLineStart isDirty markClean".split(" ").forEach(function(a){O[a]=G[a].bind(G)});O.showMarkers=function(b){p.getService(a.problemsServiceID)._setProblems(b)};O.enterLinkedMode=function(a){G.getLinkedMode().enterLinkedMode(a)};O.openEditor=function(a,b){v.openEditor(a,b)};O.getFileMetadata=function(){return a.dispatcher.getServiceFileObject()};
O.setStatus=t.handleStatusMessage.bind(null,p);p.registerService(this.editContextServiceID,O,null)},create:function(){this.editor.install();this.editorPreferences&&this.editorPreferences.getPrefs(this.updateSettings.bind(this));this._createContextMenu()},destroy:function(){this.editor.uninstall()},getStyleAccessor:function(){var a=null,b=this.syntaxHighlighter.getStyler();b&&b.getStyleAccessor&&(a=b.getStyleAccessor());return a},_createContextMenu:function(){this._editorContextMenuNode=document.createElement("ul");
this._editorContextMenuNode.className="dropdownMenu";this._editorContextMenuNode.setAttribute("role","menu");this._parent.parentNode.appendChild(this._editorContextMenuNode);var a=this.editor.getTextView(),a=new I.ContextMenu({dropdown:this._editorContextMenuNode,triggerNode:a._clientDiv}),b=function(a){var b=a.event;if(b.target){a=this.editor.getTextView();for(var b=a.convert({x:b.clientX,y:b.clientY},"page","document"),b=a.getOffsetAtLocation(b.x,b.y),c=!1,d=a.getSelections(),e=0;e<d.length;e++){var f=
d[e];if(f.start<=b&&f.end>=b){c=!0;break}}c||a.setCaretOffset(b);this.commandRegistry.destroy(this._editorContextMenuNode);this.commandRegistry.renderCommands("editorContextMenuActions",this._editorContextMenuNode,null,this,"menu");H.logEvent("contextMenu","opened","editor")}}.bind(this);a.addEventListener("triggered",b)}};p.EventTarget.addMixin(L.prototype);return{EditorView:L}});y("embeddedEditor/helper/editorSetup","orion/editor/textModel orion/editor/undoStack orion/commandRegistry orion/inputManager orion/fileClient orion/contentTypes orion/editorView orion/editorCommands orion/objects".split(" "),
function(l,r,p,h,f,d,b,k,m){function g(a){this._serviceRegistry=a.serviceRegistry;this._pluginRegistry=a.pluginRegistry;this._commandRegistry=new p.CommandRegistry({});this._fileClient=new f.FileClient(this._serviceRegistry);this._contentTypeRegistry=new d.ContentTypeRegistry(this._serviceRegistry);this._editorCommands=new k.EditorCommandFactory({serviceRegistry:this._serviceRegistry,commandRegistry:this._commandRegistry,fileClient:this._fileClient,toolbarId:"_orion_hidden_actions",navToolbarId:"_orion_hidden_actions"});
this._progressService={progress:function(a,b,d){return a},showWhile:function(a,b,d){return a}};this._serviceRegistry.registerService("orion.page.progress",this._progressService)}m.mixin(g.prototype,{destroy:function(){},createInputManager:function(){var a=this._inputManager=new h.InputManager({serviceRegistry:this._serviceRegistry,fileClient:this._fileClient,progressService:this._progressService,selection:this.selection,contentTypeRegistry:this._contentTypeRegistry});a.addEventListener("InputChanged",
function(a){a.editor=this.editorView.editor;this.pageActionsScope="_orion_hidden_actions";this._commandRegistry.destroy(this.pageActionsScope);this._commandRegistry.renderCommands(this.pageActionsScope,this.pageActionsScope,a.metadata,a.editor,"tool")}.bind(this));a.addEventListener("InputChanging",function(a){a.editor=this.editorView.editor}.bind(this))},defaultOptions:function(a){var b=new l.TextModel,d=(0).toString(),f=Object.create(null);f.openEditor=function(a,b){this.editorView.editor.setSelection(b.start,
b.end)}.bind(this);return{activateContext:f,id:d,parent:a,model:b,undoStack:new r.UndoStack(b,500),serviceRegistry:this._serviceRegistry,pluginRegistry:this._pluginRegistry,commandRegistry:this._commandRegistry,contentTypeRegistry:this._contentTypeRegistry,editorCommands:this._editorCommands,progressService:this._progressService,inputManager:this._inputManager,fileService:this._fileClient,problemsServiceID:"orion.core.marker"+d,editContextServiceID:"orion.edit.context"+d,editModelContextServiceID:"orion.edit.model.context"+
d,readonly:!1}},createEditor:function(a){return this._editorCommands.createCommands().then(function(){this._editorCommands.registerCommands();this.createInputManager();this.editorView=new b.EditorView(this.defaultOptions(a.parent));this.editorView.create();this._inputManager.editor=this.editorView.editor;this._inputManager.setAutoSaveTimeout(300);this._editorCommands.inputManager=this._inputManager;a.contentType&&a.contents&&this.editorView.setContents(a.contents,a.contentType);return this.editorView}.bind(this))}});
return{EditorSetupHelper:g}});y("embeddedEditor/builder/embeddedEditor",["embeddedEditor/helper/bootstrap","embeddedEditor/helper/editorSetup","orion/objects"],function(l,r,p){function h(){}p.mixin(h.prototype,{create:function(f){return l.startup(f).then(function(d){return(new r.EditorSetupHelper({serviceRegistry:d.serviceRegistry,pluginRegistry:d.pluginRegistry})).createEditor(f)})}});return h});return O("embeddedEditor/builder/embeddedEditor")});